!function(){function e(e){e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function t(e){e.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui")}var n,o,r;!function(e){function t(e,t){return x.call(e,t)}function i(e,t){var n,i,o,r,a,s,l,c,u,d,p,f,h=t&&t.split("/"),g=y.map,m=g&&g["*"]||{};if(e){for(e=e.split("/"),a=e.length-1,y.nodeIdCompat&&C.test(e[a])&&(e[a]=e[a].replace(C,"")),"."===e[0].charAt(0)&&h&&(f=h.slice(0,h.length-1),e=f.concat(e)),u=0;u<e.length;u++)if(p=e[u],"."===p)e.splice(u,1),u-=1;else if(".."===p){if(0===u||1===u&&".."===e[2]||".."===e[u-1])continue;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}if((h||m)&&g){for(n=e.split("/"),u=n.length;u>0;u-=1){if(i=n.slice(0,u).join("/"),h)for(d=h.length;d>0;d-=1)if(o=g[h.slice(0,d).join("/")],o&&(o=o[i])){r=o,s=u;break}if(r)break;!l&&m&&m[i]&&(l=m[i],c=u)}!r&&l&&(r=l,s=c),r&&(n.splice(0,s,r),e=n.join("/"))}return e}function a(t,n){return function(){var i=_.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),h.apply(e,i.concat([t,n]))}}function s(e){return function(t){return i(t,e)}}function l(e){return function(t){v[e]=t}}function c(n){if(t(b,n)){var i=b[n];delete b[n],w[n]=!0,f.apply(e,i)}if(!t(v,n)&&!t(w,n))throw new Error("No "+n);return v[n]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function d(e){return e?u(e):[]}function p(e){return function(){return y&&y.config&&y.config[e]||{}}}var f,h,g,m,v={},b={},y={},w={},x=Object.prototype.hasOwnProperty,_=[].slice,C=/\.js$/;g=function(e,t){var n,o=u(e),r=o[0],a=t[1];return e=o[1],r&&(r=i(r,a),n=c(r)),r?e=n&&n.normalize?n.normalize(e,s(a)):i(e,a):(e=i(e,a),o=u(e),r=o[0],e=o[1],r&&(n=c(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},m={require:function(e){return a(e)},exports:function(e){var t=v[e];return"undefined"!=typeof t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:p(e)}}},f=function(n,i,o,r){var s,u,p,f,h,y,x,_=[],C=typeof o;if(r=r||n,y=d(r),"undefined"===C||"function"===C){for(i=!i.length&&o.length?["require","exports","module"]:i,h=0;h<i.length;h+=1)if(f=g(i[h],y),u=f.f,"require"===u)_[h]=m.require(n);else if("exports"===u)_[h]=m.exports(n),x=!0;else if("module"===u)s=_[h]=m.module(n);else if(t(v,u)||t(b,u)||t(w,u))_[h]=c(u);else{if(!f.p)throw new Error(n+" missing "+u);f.p.load(f.n,a(r,!0),l(u),{}),_[h]=v[u]}p=o?o.apply(v[n],_):void 0,n&&(s&&s.exports!==e&&s.exports!==v[n]?v[n]=s.exports:p===e&&x||(v[n]=p))}else n&&(v[n]=o)},n=o=h=function(t,n,i,o,r){if("string"==typeof t)return m[t]?m[t](n):c(g(t,d(n)).f);if(!t.splice){if(y=t,y.deps&&h(y.deps,y.callback),!n)return;n.splice?(t=n,n=i,i=null):t=e}return n=n||function(){},"function"==typeof i&&(i=o,o=r),o?f(e,t,n,i):setTimeout(function(){f(e,t,n,i)},4),h},h.config=function(e){return h(e)},n._defined=v,r=function(e,n,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(i=n,n=[]),t(v,e)||t(b,e)||(b[e]=[e,n,i])},r.amd={jQuery:!0}}(),r("../../current/bower_components/almond/almond.js",function(){}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=!!e&&"length"in e&&e.length,n=he.type(e);return"function"!==n&&!he.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function i(e,t,n){if(he.isFunction(t))return he.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return he.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ke.test(t))return he.filter(t,e,n);t=he.filter(t,e)}return he.grep(e,function(e){return he.inArray(e,t)>-1!==n})}function o(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function a(e){var t={};return he.each(e.match(Oe)||[],function(e,n){t[n]=!0}),t}function s(){oe.addEventListener?(oe.removeEventListener("DOMContentLoaded",l),e.removeEventListener("load",l)):(oe.detachEvent("onreadystatechange",l),e.detachEvent("onload",l))}function l(){(oe.addEventListener||"load"===e.event.type||"complete"===oe.readyState)&&(s(),he.ready())}function c(e,t,n){if(void 0===n&&1===e.nodeType){var i="data-"+t.replace(Re,"-$1").toLowerCase();if(n=e.getAttribute(i),"string"==typeof n){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Ae.test(n)?he.parseJSON(n):n)}catch(o){}he.data(e,t,n)}else n=void 0}return n}function u(e){var t;for(t in e)if(("data"!==t||!he.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function d(e,t,n,i){if(Pe(e)){var o,r,a=he.expando,s=e.nodeType,l=s?he.cache:e,c=s?e[a]:e[a]&&a;if(c&&l[c]&&(i||l[c].data)||void 0!==n||"string"!=typeof t)return c||(c=s?e[a]=ie.pop()||he.guid++:a),l[c]||(l[c]=s?{}:{toJSON:he.noop}),"object"!=typeof t&&"function"!=typeof t||(i?l[c]=he.extend(l[c],t):l[c].data=he.extend(l[c].data,t)),r=l[c],i||(r.data||(r.data={}),r=r.data),void 0!==n&&(r[he.camelCase(t)]=n),"string"==typeof t?(o=r[t],null==o&&(o=r[he.camelCase(t)])):o=r,o}}function p(e,t,n){if(Pe(e)){var i,o,r=e.nodeType,a=r?he.cache:e,s=r?e[he.expando]:he.expando;if(a[s]){if(t&&(i=n?a[s]:a[s].data)){he.isArray(t)?t=t.concat(he.map(t,he.camelCase)):t in i?t=[t]:(t=he.camelCase(t),t=t in i?[t]:t.split(" ")),o=t.length;for(;o--;)delete i[t[o]];if(n?!u(i):!he.isEmptyObject(i))return}(n||(delete a[s].data,u(a[s])))&&(r?he.cleanData([e],!0):pe.deleteExpando||a!=a.window?delete a[s]:a[s]=void 0)}}}function f(e,t,n,i){var o,r=1,a=20,s=i?function(){return i.cur()}:function(){return he.css(e,t,"")},l=s(),c=n&&n[3]||(he.cssNumber[t]?"":"px"),u=(he.cssNumber[t]||"px"!==c&&+l)&&ze.exec(he.css(e,t));if(u&&u[3]!==c){c=c||u[3],n=n||[],u=+l||1;do r=r||".5",u/=r,he.style(e,t,u+c);while(r!==(r=s()/l)&&1!==r&&--a)}return n&&(u=+u||+l||0,o=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=o)),o}function h(e){var t=Ve.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function g(e,t){var n,i,o=0,r="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):void 0;if(!r)for(r=[],n=e.childNodes||e;null!=(i=n[o]);o++)!t||he.nodeName(i,t)?r.push(i):he.merge(r,g(i,t));return void 0===t||t&&he.nodeName(e,t)?he.merge([e],r):r}function m(e,t){for(var n,i=0;null!=(n=e[i]);i++)he._data(n,"globalEval",!t||he._data(t[i],"globalEval"))}function v(e){Be.test(e.type)&&(e.defaultChecked=e.checked)}function b(e,t,n,i,o){for(var r,a,s,l,c,u,d,p=e.length,f=h(t),b=[],y=0;y<p;y++)if(a=e[y],a||0===a)if("object"===he.type(a))he.merge(b,a.nodeType?[a]:a);else if(Ye.test(a)){for(l=l||f.appendChild(t.createElement("div")),c=(We.exec(a)||["",""])[1].toLowerCase(),d=Ue[c]||Ue._default,l.innerHTML=d[1]+he.htmlPrefilter(a)+d[2],r=d[0];r--;)l=l.lastChild;if(!pe.leadingWhitespace&&qe.test(a)&&b.push(t.createTextNode(qe.exec(a)[0])),!pe.tbody)for(a="table"!==c||Je.test(a)?"<table>"!==d[1]||Je.test(a)?0:l:l.firstChild,r=a&&a.childNodes.length;r--;)he.nodeName(u=a.childNodes[r],"tbody")&&!u.childNodes.length&&a.removeChild(u);for(he.merge(b,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=f.lastChild}else b.push(t.createTextNode(a));for(l&&f.removeChild(l),pe.appendChecked||he.grep(g(b,"input"),v),y=0;a=b[y++];)if(i&&he.inArray(a,i)>-1)o&&o.push(a);else if(s=he.contains(a.ownerDocument,a),l=g(f.appendChild(a),"script"),s&&m(l),n)for(r=0;a=l[r++];)$e.test(a.type||"")&&n.push(a);return l=null,f}function y(){return!0}function w(){return!1}function x(){try{return oe.activeElement}catch(e){}}function _(e,t,n,i,o,r){var a,s;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=void 0);for(s in t)_(e,s,n,i,t[s],r);return e}if(null==i&&null==o?(o=n,i=n=void 0):null==o&&("string"==typeof n?(o=i,i=void 0):(o=i,i=n,n=void 0)),o===!1)o=w;else if(!o)return e;return 1===r&&(a=o,o=function(e){return he().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=he.guid++)),e.each(function(){he.event.add(this,t,o,i,n)})}function C(e,t){return he.nodeName(e,"table")&&he.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function k(e){return e.type=(null!==he.find.attr(e,"type"))+"/"+e.type,e}function D(e){var t=rt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function S(e,t){if(1===t.nodeType&&he.hasData(e)){var n,i,o,r=he._data(e),a=he._data(t,r),s=r.events;if(s){delete a.handle,a.events={};for(n in s)for(i=0,o=s[n].length;i<o;i++)he.event.add(t,n,s[n][i])}a.data&&(a.data=he.extend({},a.data))}}function T(e,t){var n,i,o;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!pe.noCloneEvent&&t[he.expando]){o=he._data(t);for(i in o.events)he.removeEvent(t,i,o.handle);t.removeAttribute(he.expando)}"script"===n&&t.text!==e.text?(k(t).text=e.text,D(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),pe.html5Clone&&e.innerHTML&&!he.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Be.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}}function E(e,t,n,i){t=ae.apply([],t);var o,r,a,s,l,c,u=0,d=e.length,p=d-1,f=t[0],h=he.isFunction(f);if(h||d>1&&"string"==typeof f&&!pe.checkClone&&ot.test(f))return e.each(function(o){var r=e.eq(o);h&&(t[0]=f.call(this,o,r.html())),E(r,t,n,i)});if(d&&(c=b(t,e[0].ownerDocument,!1,e,i),o=c.firstChild,1===c.childNodes.length&&(c=o),o||i)){for(s=he.map(g(c,"script"),k),a=s.length;u<d;u++)r=c,u!==p&&(r=he.clone(r,!0,!0),a&&he.merge(s,g(r,"script"))),n.call(e[u],r,u);if(a)for(l=s[s.length-1].ownerDocument,he.map(s,D),u=0;u<a;u++)r=s[u],$e.test(r.type||"")&&!he._data(r,"globalEval")&&he.contains(l,r)&&(r.src?he._evalUrl&&he._evalUrl(r.src):he.globalEval((r.text||r.textContent||r.innerHTML||"").replace(at,"")));c=o=null}return e}function M(e,t,n){for(var i,o=t?he.filter(t,e):e,r=0;null!=(i=o[r]);r++)n||1!==i.nodeType||he.cleanData(g(i)),i.parentNode&&(n&&he.contains(i.ownerDocument,i)&&m(g(i,"script")),i.parentNode.removeChild(i));return e}function O(e,t){var n=he(t.createElement(e)).appendTo(t.body),i=he.css(n[0],"display");return n.detach(),i}function H(e){var t=oe,n=ut[e];return n||(n=O(e,t),"none"!==n&&n||(ct=(ct||he("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(ct[0].contentWindow||ct[0].contentDocument).document,t.write(),t.close(),n=O(e,t),ct.detach()),ut[e]=n),n}function N(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function P(e){if(e in Dt)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=kt.length;n--;)if(e=kt[n]+t,e in Dt)return e}function A(e,t){for(var n,i,o,r=[],a=0,s=e.length;a<s;a++)i=e[a],i.style&&(r[a]=he._data(i,"olddisplay"),n=i.style.display,t?(r[a]||"none"!==n||(i.style.display=""),""===i.style.display&&Le(i)&&(r[a]=he._data(i,"olddisplay",H(i.nodeName)))):(o=Le(i),(n&&"none"!==n||!o)&&he._data(i,"olddisplay",o?n:he.css(i,"display"))));for(a=0;a<s;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?r[a]||"":"none"));return e}function R(e,t,n){var i=xt.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function I(e,t,n,i,o){for(var r=n===(i?"border":"content")?4:"width"===t?1:0,a=0;r<4;r+=2)"margin"===n&&(a+=he.css(e,n+Fe[r],!0,o)),i?("content"===n&&(a-=he.css(e,"padding"+Fe[r],!0,o)),"margin"!==n&&(a-=he.css(e,"border"+Fe[r]+"Width",!0,o))):(a+=he.css(e,"padding"+Fe[r],!0,o),"padding"!==n&&(a+=he.css(e,"border"+Fe[r]+"Width",!0,o)));return a}function z(e,t,n){var i=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=gt(e),a=pe.boxSizing&&"border-box"===he.css(e,"boxSizing",!1,r);if(o<=0||null==o){if(o=mt(e,t,r),(o<0||null==o)&&(o=e.style[t]),pt.test(o))return o;i=a&&(pe.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+I(e,t,n||(a?"border":"content"),i,r)+"px"}function F(e,t,n,i,o){return new F.prototype.init(e,t,n,i,o)}function L(){return e.setTimeout(function(){St=void 0}),St=he.now()}function j(e,t){var n,i={height:e},o=0;for(t=t?1:0;o<4;o+=2-t)n=Fe[o],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function B(e,t,n){for(var i,o=(q.tweeners[t]||[]).concat(q.tweeners["*"]),r=0,a=o.length;r<a;r++)if(i=o[r].call(n,t,e))return i}function W(e,t,n){var i,o,r,a,s,l,c,u,d=this,p={},f=e.style,h=e.nodeType&&Le(e),g=he._data(e,"fxshow");n.queue||(s=he._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,he.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],c=he.css(e,"display"),u="none"===c?he._data(e,"olddisplay")||H(e.nodeName):c,"inline"===u&&"none"===he.css(e,"float")&&(pe.inlineBlockNeedsLayout&&"inline"!==H(e.nodeName)?f.zoom=1:f.display="inline-block")),n.overflow&&(f.overflow="hidden",pe.shrinkWrapBlocks()||d.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(i in t)if(o=t[i],Et.exec(o)){if(delete t[i],r=r||"toggle"===o,o===(h?"hide":"show")){if("show"!==o||!g||void 0===g[i])continue;h=!0}p[i]=g&&g[i]||he.style(e,i)}else c=void 0;if(he.isEmptyObject(p))"inline"===("none"===c?H(e.nodeName):c)&&(f.display=c);else{g?"hidden"in g&&(h=g.hidden):g=he._data(e,"fxshow",{}),r&&(g.hidden=!h),h?he(e).show():d.done(function(){he(e).hide()}),d.done(function(){var t;he._removeData(e,"fxshow");for(t in p)he.style(e,t,p[t])});for(i in p)a=B(h?g[i]:0,i,d),i in g||(g[i]=a.start,h&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function $(e,t){var n,i,o,r,a;for(n in e)if(i=he.camelCase(n),o=t[i],r=e[n],he.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),a=he.cssHooks[i],a&&"expand"in a){r=a.expand(r),delete e[i];for(n in r)n in e||(e[n]=r[n],t[n]=o)}else t[i]=o}function q(e,t,n){var i,o,r=0,a=q.prefilters.length,s=he.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=St||L(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,r=1-i,a=0,l=c.tweens.length;a<l;a++)c.tweens[a].run(r);return s.notifyWith(e,[c,r,n]),r<1&&l?n:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:he.extend({},t),opts:he.extend(!0,{specialEasing:{},easing:he.easing._default},n),originalProperties:t,originalOptions:n,startTime:St||L(),duration:n.duration,tweens:[],createTween:function(t,n){var i=he.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(o)return this;for(o=!0;n<i;n++)c.tweens[n].run(1);return t?(s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c,t])):s.rejectWith(e,[c,t]),this}}),u=c.props;for($(u,c.opts.specialEasing);r<a;r++)if(i=q.prefilters[r].call(c,e,u,c.opts))return he.isFunction(i.stop)&&(he._queueHooks(c.elem,c.opts.queue).stop=he.proxy(i.stop,i)),i;return he.map(u,B,c),he.isFunction(c.opts.start)&&c.opts.start.call(e,c),he.fx.timer(he.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function V(e){return he.attr(e,"class")||""}function U(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o=0,r=t.toLowerCase().match(Oe)||[];if(he.isFunction(n))for(;i=r[o++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function Y(e,t,n,i){function o(s){var l;return r[s]=!0,he.each(e[s]||[],function(e,s){var c=s(t,n,i);return"string"!=typeof c||a||r[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),o(c),!1)}),l}var r={},a=e===Qt;return o(t.dataTypes[0])||!r["*"]&&o("*")}function J(e,t){var n,i,o=he.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((o[i]?e:n||(n={}))[i]=t[i]);return n&&he.extend(!0,e,n),e}function X(e,t,n){for(var i,o,r,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===o&&(o=e.mimeType||t.getResponseHeader("Content-Type"));if(o)for(a in s)if(s[a]&&s[a].test(o)){l.unshift(a);break}if(l[0]in n)r=l[0];else{for(a in n){if(!l[0]||e.converters[a+" "+l[0]]){r=a;break}i||(i=a)}r=r||i}if(r)return r!==l[0]&&l.unshift(r),n[r]}function K(e,t,n,i){var o,r,a,s,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(r=u.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(a=c[l+" "+r]||c["* "+r],!a)for(o in c)if(s=o.split(" "),s[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){a===!0?a=c[o]:c[o]!==!0&&(r=s[0],u.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}function G(e){return e.style&&e.style.display||he.css(e,"display")}function Z(e){if(!he.contains(e.ownerDocument||oe,e))return!0;for(;e&&1===e.nodeType;){if("none"===G(e)||"hidden"===e.type)return!0;e=e.parentNode}return!1}function Q(e,t,n,i){var o;if(he.isArray(t))he.each(t,function(t,o){n||rn.test(e)?i(e,o):Q(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,n,i)});else if(n||"object"!==he.type(t))i(e,t);else for(o in t)Q(e+"["+o+"]",t[o],n,i)}function ee(){try{return new e.XMLHttpRequest}catch(t){}}function te(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function ne(e){return he.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var ie=[],oe=e.document,re=ie.slice,ae=ie.concat,se=ie.push,le=ie.indexOf,ce={},ue=ce.toString,de=ce.hasOwnProperty,pe={},fe="1.12.4",he=function(e,t){return new he.fn.init(e,t)},ge=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,me=/^-ms-/,ve=/-([\da-z])/gi,be=function(e,t){return t.toUpperCase()};he.fn=he.prototype={jquery:fe,constructor:he,selector:"",length:0,toArray:function(){return re.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:re.call(this)},pushStack:function(e){var t=he.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return he.each(this,e)},map:function(e){return this.pushStack(he.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(re.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:se,sort:ie.sort,splice:ie.splice},he.extend=he.fn.extend=function(){var e,t,n,i,o,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||he.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(o=arguments[s]))for(i in o)e=a[i],n=o[i],a!==n&&(c&&n&&(he.isPlainObject(n)||(t=he.isArray(n)))?(t?(t=!1,r=e&&he.isArray(e)?e:[]):r=e&&he.isPlainObject(e)?e:{},a[i]=he.extend(c,r,n)):void 0!==n&&(a[i]=n));return a},he.extend({expando:"jQuery"+(fe+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===he.type(e)},isArray:Array.isArray||function(e){return"array"===he.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!he.isArray(e)&&t-parseFloat(t)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==he.type(e)||e.nodeType||he.isWindow(e))return!1;try{if(e.constructor&&!de.call(e,"constructor")&&!de.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(!pe.ownFirst)for(t in e)return de.call(e,t);for(t in e);return void 0===t||de.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?ce[ue.call(e)]||"object":typeof e},globalEval:function(t){t&&he.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(me,"ms-").replace(ve,be)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var i,o=0;if(n(e))for(i=e.length;o<i&&t.call(e[o],o,e[o])!==!1;o++);else for(o in e)if(t.call(e[o],o,e[o])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ge,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?he.merge(i,"string"==typeof e?[e]:e):se.call(i,e)),i},inArray:function(e,t,n){var i;if(t){if(le)return le.call(t,e,n);for(i=t.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,i=0,o=e.length;i<n;)e[o++]=t[i++];if(n!==n)for(;void 0!==t[i];)e[o++]=t[i++];return e.length=o,e},grep:function(e,t,n){for(var i,o=[],r=0,a=e.length,s=!n;r<a;r++)i=!t(e[r],r),i!==s&&o.push(e[r]);return o},map:function(e,t,i){var o,r,a=0,s=[];if(n(e))for(o=e.length;a<o;a++)r=t(e[a],a,i),null!=r&&s.push(r);else for(a in e)r=t(e[a],a,i),null!=r&&s.push(r);return ae.apply([],s)},guid:1,proxy:function(e,t){var n,i,o;if("string"==typeof t&&(o=e[t],t=e,e=o),he.isFunction(e))return n=re.call(arguments,2),i=function(){return e.apply(t||this,n.concat(re.call(arguments)))},i.guid=e.guid=e.guid||he.guid++,i},now:function(){return+new Date},support:pe}),"function"==typeof Symbol&&(he.fn[Symbol.iterator]=ie[Symbol.iterator]),he.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){ce["[object "+t+"]"]=t.toLowerCase()});var ye=function(e){function t(e,t,n,i){var o,r,a,s,l,c,d,f,h=t&&t.ownerDocument,g=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==g&&9!==g&&11!==g)return n;if(!i&&((t?t.ownerDocument||t:j)!==N&&H(t),t=t||N,A)){if(11!==g&&(c=ve.exec(e)))if(o=c[1]){if(9===g){if(!(a=t.getElementById(o)))return n;if(a.id===o)return n.push(a),n}else if(h&&(a=h.getElementById(o))&&F(t,a)&&a.id===o)return n.push(a),n}else{if(c[2])return Z.apply(n,t.getElementsByTagName(e)),n;if((o=c[3])&&x.getElementsByClassName&&t.getElementsByClassName)return Z.apply(n,t.getElementsByClassName(o)),n}if(x.qsa&&!V[e+" "]&&(!R||!R.test(e))){if(1!==g)h=t,f=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(ye,"\\$&"):t.setAttribute("id",s=L),d=D(e),r=d.length,l=pe.test(s)?"#"+s:"[id='"+s+"']";r--;)d[r]=l+" "+p(d[r]);f=d.join(","),h=be.test(e)&&u(t.parentNode)||t}if(f)try{return Z.apply(n,h.querySelectorAll(f)),n}catch(m){}finally{s===L&&t.removeAttribute("id")}}}return T(e.replace(se,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>_.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[L]=!0,e}function o(e){var t=N.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var n=e.split("|"),i=n.length;i--;)_.attrHandle[n[i]]=t}function a(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return i(function(t){return t=+t,i(function(n,i){for(var o,r=e([],n.length,t),a=r.length;a--;)n[o=r[a]]&&(n[o]=!(i[o]=n[o]))})})}function u(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function d(){}function p(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function f(e,t,n){var i=t.dir,o=n&&"parentNode"===i,r=W++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var s,l,c,u=[B,r];if(a){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||o){if(c=t[L]||(t[L]={}),l=c[t.uniqueID]||(c[t.uniqueID]={}),(s=l[i])&&s[0]===B&&s[1]===r)return u[2]=s[2];if(l[i]=u,u[2]=e(t,n,a))return!0}}}function h(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function g(e,n,i){for(var o=0,r=n.length;o<r;o++)t(e,n[o],i);return i}function m(e,t,n,i,o){for(var r,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(r=e[s])&&(n&&!n(r,i,o)||(a.push(r),c&&t.push(s)));return a}function v(e,t,n,o,r,a){return o&&!o[L]&&(o=v(o)),r&&!r[L]&&(r=v(r,a)),i(function(i,a,s,l){var c,u,d,p=[],f=[],h=a.length,v=i||g(t||"*",s.nodeType?[s]:s,[]),b=!e||!i&&t?v:m(v,p,e,s,l),y=n?r||(i?e:h||o)?[]:a:b;if(n&&n(b,y,s,l),o)for(c=m(y,f),o(c,[],s,l),u=c.length;u--;)(d=c[u])&&(y[f[u]]=!(b[f[u]]=d));if(i){if(r||e){if(r){for(c=[],u=y.length;u--;)(d=y[u])&&c.push(b[u]=d);r(null,y=[],c,l)}for(u=y.length;u--;)(d=y[u])&&(c=r?ee(i,d):p[u])>-1&&(i[c]=!(a[c]=d))}}else y=m(y===a?y.splice(h,y.length):y),r?r(null,a,y,l):Z.apply(a,y)})}function b(e){for(var t,n,i,o=e.length,r=_.relative[e[0].type],a=r||_.relative[" "],s=r?1:0,l=f(function(e){return e===t},a,!0),c=f(function(e){return ee(t,e)>-1},a,!0),u=[function(e,n,i){var o=!r&&(i||n!==E)||((t=n).nodeType?l(e,n,i):c(e,n,i));return t=null,o}];s<o;s++)if(n=_.relative[e[s].type])u=[f(h(u),n)];else{if(n=_.filter[e[s].type].apply(null,e[s].matches),n[L]){for(i=++s;i<o&&!_.relative[e[i].type];i++);return v(s>1&&h(u),s>1&&p(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(se,"$1"),n,s<i&&b(e.slice(s,i)),i<o&&b(e=e.slice(i)),i<o&&p(e))}u.push(n)}return h(u)}function y(e,n){var o=n.length>0,r=e.length>0,a=function(i,a,s,l,c){var u,d,p,f=0,h="0",g=i&&[],v=[],b=E,y=i||r&&_.find.TAG("*",c),w=B+=null==b?1:Math.random()||.1,x=y.length;for(c&&(E=a===N||a||c);h!==x&&null!=(u=y[h]);h++){if(r&&u){for(d=0,a||u.ownerDocument===N||(H(u),s=!A);p=e[d++];)if(p(u,a||N,s)){l.push(u);break}c&&(B=w)}o&&((u=!p&&u)&&f--,i&&g.push(u))}if(f+=h,o&&h!==f){for(d=0;p=n[d++];)p(g,v,a,s);if(i){if(f>0)for(;h--;)g[h]||v[h]||(v[h]=K.call(l));v=m(v)}Z.apply(l,v),c&&!i&&v.length>0&&f+n.length>1&&t.uniqueSort(l)}return c&&(B=w,E=b),g};return o?i(a):a}var w,x,_,C,k,D,S,T,E,M,O,H,N,P,A,R,I,z,F,L="sizzle"+1*new Date,j=e.document,B=0,W=0,$=n(),q=n(),V=n(),U=function(e,t){return e===t&&(O=!0),0},Y=1<<31,J={}.hasOwnProperty,X=[],K=X.pop,G=X.push,Z=X.push,Q=X.slice,ee=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe="\\["+ne+"*("+ie+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ie+"))|)"+ne+"*\\]",re=":("+ie+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",ae=new RegExp(ne+"+","g"),se=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),le=new RegExp("^"+ne+"*,"+ne+"*"),ce=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ue=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),de=new RegExp(re),pe=new RegExp("^"+ie+"$"),fe={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie+"|[*])"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+re),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},he=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,me=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,ye=/'|\\/g,we=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),xe=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},_e=function(){H()};try{Z.apply(X=Q.call(j.childNodes),j.childNodes),X[j.childNodes.length].nodeType}catch(Ce){Z={apply:X.length?function(e,t){G.apply(e,Q.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}x=t.support={},k=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},H=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:j;return i!==N&&9===i.nodeType&&i.documentElement?(N=i,P=N.documentElement,A=!k(N),(n=N.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",_e,!1):n.attachEvent&&n.attachEvent("onunload",_e)),x.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=o(function(e){return e.appendChild(N.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=me.test(N.getElementsByClassName),x.getById=o(function(e){return P.appendChild(e).id=L,!N.getElementsByName||!N.getElementsByName(L).length}),x.getById?(_.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&A){var n=t.getElementById(e);return n?[n]:[]}},_.filter.ID=function(e){var t=e.replace(we,xe);return function(e){return e.getAttribute("id")===t}}):(delete _.find.ID,_.filter.ID=function(e){var t=e.replace(we,xe);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),_.find.TAG=x.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):x.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},_.find.CLASS=x.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&A)return t.getElementsByClassName(e)},I=[],R=[],(x.qsa=me.test(N.querySelectorAll))&&(o(function(e){P.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&R.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||R.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+L+"-]").length||R.push("~="),e.querySelectorAll(":checked").length||R.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||R.push(".#.+[+~]")}),o(function(e){var t=N.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&R.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||R.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),R.push(",.*:")})),(x.matchesSelector=me.test(z=P.matches||P.webkitMatchesSelector||P.mozMatchesSelector||P.oMatchesSelector||P.msMatchesSelector))&&o(function(e){x.disconnectedMatch=z.call(e,"div"),z.call(e,"[s!='']:x"),I.push("!=",re)}),R=R.length&&new RegExp(R.join("|")),I=I.length&&new RegExp(I.join("|")),t=me.test(P.compareDocumentPosition),F=t||me.test(P.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},U=t?function(e,t){if(e===t)return O=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!x.sortDetached&&t.compareDocumentPosition(e)===n?e===N||e.ownerDocument===j&&F(j,e)?-1:t===N||t.ownerDocument===j&&F(j,t)?1:M?ee(M,e)-ee(M,t):0:4&n?-1:1)}:function(e,t){if(e===t)return O=!0,0;var n,i=0,o=e.parentNode,r=t.parentNode,s=[e],l=[t];if(!o||!r)return e===N?-1:t===N?1:o?-1:r?1:M?ee(M,e)-ee(M,t):0;if(o===r)return a(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;s[i]===l[i];)i++;return i?a(s[i],l[i]):s[i]===j?-1:l[i]===j?1:0},N):N},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==N&&H(e),n=n.replace(ue,"='$1']"),
x.matchesSelector&&A&&!V[n+" "]&&(!I||!I.test(n))&&(!R||!R.test(n)))try{var i=z.call(e,n);if(i||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(o){}return t(n,N,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==N&&H(e),F(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==N&&H(e);var n=_.attrHandle[t.toLowerCase()],i=n&&J.call(_.attrHandle,t.toLowerCase())?n(e,t,!A):void 0;return void 0!==i?i:x.attributes||!A?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,o=0;if(O=!x.detectDuplicates,M=!x.sortStable&&e.slice(0),e.sort(U),O){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)e.splice(n[i],1)}return M=null,e},C=t.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=C(t);return n},_=t.selectors={cacheLength:50,createPseudo:i,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(we,xe),e[3]=(e[3]||e[4]||e[5]||"").replace(we,xe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&de.test(n)&&(t=D(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(we,xe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=$[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&$(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(o){var r=t.attr(o,e);return null==r?"!="===n:!n||(r+="","="===n?r===i:"!="===n?r!==i:"^="===n?i&&0===r.indexOf(i):"*="===n?i&&r.indexOf(i)>-1:"$="===n?i&&r.slice(-i.length)===i:"~="===n?(" "+r.replace(ae," ")+" ").indexOf(i)>-1:"|="===n&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,n,i,o){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var c,u,d,p,f,h,g=r!==a?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),b=!l&&!s,y=!1;if(m){if(r){for(;g;){for(p=t;p=p[g];)if(s?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&b){for(p=m,d=p[L]||(p[L]={}),u=d[p.uniqueID]||(d[p.uniqueID]={}),c=u[e]||[],f=c[0]===B&&c[1],y=f&&c[2],p=f&&m.childNodes[f];p=++f&&p&&p[g]||(y=f=0)||h.pop();)if(1===p.nodeType&&++y&&p===t){u[e]=[B,f,y];break}}else if(b&&(p=t,d=p[L]||(p[L]={}),u=d[p.uniqueID]||(d[p.uniqueID]={}),c=u[e]||[],f=c[0]===B&&c[1],y=f),y===!1)for(;(p=++f&&p&&p[g]||(y=f=0)||h.pop())&&((s?p.nodeName.toLowerCase()!==v:1!==p.nodeType)||!++y||(b&&(d=p[L]||(p[L]={}),u=d[p.uniqueID]||(d[p.uniqueID]={}),u[e]=[B,y]),p!==t)););return y-=o,y===i||y%i===0&&y/i>=0}}},PSEUDO:function(e,n){var o,r=_.pseudos[e]||_.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[L]?r(n):r.length>1?(o=[e,e,"",n],_.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,o=r(e,n),a=o.length;a--;)i=ee(e,o[a]),e[i]=!(t[i]=o[a])}):function(e){return r(e,0,o)}):r}},pseudos:{not:i(function(e){var t=[],n=[],o=S(e.replace(se,"$1"));return o[L]?i(function(e,t,n,i){for(var r,a=o(e,null,i,[]),s=e.length;s--;)(r=a[s])&&(e[s]=!(t[s]=r))}):function(e,i,r){return t[0]=e,o(t,null,r,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(we,xe),function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:i(function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(we,xe).toLowerCase(),function(t){var n;do if(n=A?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===P},focus:function(e){return e===N.activeElement&&(!N.hasFocus||N.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!_.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return he.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[n<0?n+t:n]}),even:c(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i);return e}),gt:c(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}},_.pseudos.nth=_.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[w]=s(w);for(w in{submit:!0,reset:!0})_.pseudos[w]=l(w);return d.prototype=_.filters=_.pseudos,_.setFilters=new d,D=t.tokenize=function(e,n){var i,o,r,a,s,l,c,u=q[e+" "];if(u)return n?0:u.slice(0);for(s=e,l=[],c=_.preFilter;s;){i&&!(o=le.exec(s))||(o&&(s=s.slice(o[0].length)||s),l.push(r=[])),i=!1,(o=ce.exec(s))&&(i=o.shift(),r.push({value:i,type:o[0].replace(se," ")}),s=s.slice(i.length));for(a in _.filter)!(o=fe[a].exec(s))||c[a]&&!(o=c[a](o))||(i=o.shift(),r.push({value:i,type:a,matches:o}),s=s.slice(i.length));if(!i)break}return n?s.length:s?t.error(e):q(e,l).slice(0)},S=t.compile=function(e,t){var n,i=[],o=[],r=V[e+" "];if(!r){for(t||(t=D(e)),n=t.length;n--;)r=b(t[n]),r[L]?i.push(r):o.push(r);r=V(e,y(o,i)),r.selector=e}return r},T=t.select=function(e,t,n,i){var o,r,a,s,l,c="function"==typeof e&&e,d=!i&&D(e=c.selector||e);if(n=n||[],1===d.length){if(r=d[0]=d[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&x.getById&&9===t.nodeType&&A&&_.relative[r[1].type]){if(t=(_.find.ID(a.matches[0].replace(we,xe),t)||[])[0],!t)return n;c&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(o=fe.needsContext.test(e)?0:r.length;o--&&(a=r[o],!_.relative[s=a.type]);)if((l=_.find[s])&&(i=l(a.matches[0].replace(we,xe),be.test(r[0].type)&&u(t.parentNode)||t))){if(r.splice(o,1),e=i.length&&p(r),!e)return Z.apply(n,i),n;break}}return(c||S(e,d))(i,t,!A,n,!t||be.test(e)&&u(t.parentNode)||t),n},x.sortStable=L.split("").sort(U).join("")===L,x.detectDuplicates=!!O,H(),x.sortDetached=o(function(e){return 1&e.compareDocumentPosition(N.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||r("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||r("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||r(te,function(e,t,n){var i;if(!n)return e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);he.find=ye,he.expr=ye.selectors,he.expr[":"]=he.expr.pseudos,he.uniqueSort=he.unique=ye.uniqueSort,he.text=ye.getText,he.isXMLDoc=ye.isXML,he.contains=ye.contains;var we=function(e,t,n){for(var i=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&he(e).is(n))break;i.push(e)}return i},xe=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},_e=he.expr.match.needsContext,Ce=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,ke=/^.[^:#\[\.,]*$/;he.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?he.find.matchesSelector(i,e)?[i]:[]:he.find.matches(e,he.grep(t,function(e){return 1===e.nodeType}))},he.fn.extend({find:function(e){var t,n=[],i=this,o=i.length;if("string"!=typeof e)return this.pushStack(he(e).filter(function(){for(t=0;t<o;t++)if(he.contains(i[t],this))return!0}));for(t=0;t<o;t++)he.find(e,i[t],n);return n=this.pushStack(o>1?he.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&_e.test(e)?he(e):e||[],!1).length}});var De,Se=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Te=he.fn.init=function(e,t,n){var i,o;if(!e)return this;if(n=n||De,"string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:Se.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof he?t[0]:t,he.merge(this,he.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:oe,!0)),Ce.test(i[1])&&he.isPlainObject(t))for(i in t)he.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if(o=oe.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return De.find(e);this.length=1,this[0]=o}return this.context=oe,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):he.isFunction(e)?"undefined"!=typeof n.ready?n.ready(e):e(he):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),he.makeArray(e,this))};Te.prototype=he.fn,De=he(oe);var Ee=/^(?:parents|prev(?:Until|All))/,Me={children:!0,contents:!0,next:!0,prev:!0};he.fn.extend({has:function(e){var t,n=he(e,this),i=n.length;return this.filter(function(){for(t=0;t<i;t++)if(he.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,i=0,o=this.length,r=[],a=_e.test(e)||"string"!=typeof e?he(e,t||this.context):0;i<o;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&he.find.matchesSelector(n,e))){r.push(n);break}return this.pushStack(r.length>1?he.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?he.inArray(this[0],he(e)):he.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(he.uniqueSort(he.merge(this.get(),he(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),he.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return we(e,"parentNode")},parentsUntil:function(e,t,n){return we(e,"parentNode",n)},next:function(e){return o(e,"nextSibling")},prev:function(e){return o(e,"previousSibling")},nextAll:function(e){return we(e,"nextSibling")},prevAll:function(e){return we(e,"previousSibling")},nextUntil:function(e,t,n){return we(e,"nextSibling",n)},prevUntil:function(e,t,n){return we(e,"previousSibling",n)},siblings:function(e){return xe((e.parentNode||{}).firstChild,e)},children:function(e){return xe(e.firstChild)},contents:function(e){return he.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:he.merge([],e.childNodes)}},function(e,t){he.fn[e]=function(n,i){var o=he.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=he.filter(i,o)),this.length>1&&(Me[e]||(o=he.uniqueSort(o)),Ee.test(e)&&(o=o.reverse())),this.pushStack(o)}});var Oe=/\S+/g;he.Callbacks=function(e){e="string"==typeof e?a(e):he.extend({},e);var t,n,i,o,r=[],s=[],l=-1,c=function(){for(o=e.once,i=t=!0;s.length;l=-1)for(n=s.shift();++l<r.length;)r[l].apply(n[0],n[1])===!1&&e.stopOnFalse&&(l=r.length,n=!1);e.memory||(n=!1),t=!1,o&&(r=n?[]:"")},u={add:function(){return r&&(n&&!t&&(l=r.length-1,s.push(n)),function i(t){he.each(t,function(t,n){he.isFunction(n)?e.unique&&u.has(n)||r.push(n):n&&n.length&&"string"!==he.type(n)&&i(n)})}(arguments),n&&!t&&c()),this},remove:function(){return he.each(arguments,function(e,t){for(var n;(n=he.inArray(t,r,n))>-1;)r.splice(n,1),n<=l&&l--}),this},has:function(e){return e?he.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=s=[],r=n="",this},disabled:function(){return!r},lock:function(){return o=!0,n||u.disable(),this},locked:function(){return!!o},fireWith:function(e,n){return o||(n=n||[],n=[e,n.slice?n.slice():n],s.push(n),t||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},he.extend({Deferred:function(e){var t=[["resolve","done",he.Callbacks("once memory"),"resolved"],["reject","fail",he.Callbacks("once memory"),"rejected"],["notify","progress",he.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return he.Deferred(function(n){he.each(t,function(t,r){var a=he.isFunction(e[t])&&e[t];o[r[1]](function(){var e=a&&a.apply(this,arguments);e&&he.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this===i?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?he.extend(e,i):i}},o={};return i.pipe=i.then,he.each(t,function(e,r){var a=r[2],s=r[3];i[r[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?i:this,arguments),this},o[r[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,i,o=0,r=re.call(arguments),a=r.length,s=1!==a||e&&he.isFunction(e.promise)?a:0,l=1===s?e:he.Deferred(),c=function(e,n,i){return function(o){n[e]=this,i[e]=arguments.length>1?re.call(arguments):o,i===t?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);o<a;o++)r[o]&&he.isFunction(r[o].promise)?r[o].promise().progress(c(o,n,t)).done(c(o,i,r)).fail(l.reject):--s;return s||l.resolveWith(i,r),l.promise()}});var He;he.fn.ready=function(e){return he.ready.promise().done(e),this},he.extend({isReady:!1,readyWait:1,holdReady:function(e){e?he.readyWait++:he.ready(!0)},ready:function(e){(e===!0?--he.readyWait:he.isReady)||(he.isReady=!0,e!==!0&&--he.readyWait>0||(He.resolveWith(oe,[he]),he.fn.triggerHandler&&(he(oe).triggerHandler("ready"),he(oe).off("ready"))))}}),he.ready.promise=function(t){if(!He)if(He=he.Deferred(),"complete"===oe.readyState||"loading"!==oe.readyState&&!oe.documentElement.doScroll)e.setTimeout(he.ready);else if(oe.addEventListener)oe.addEventListener("DOMContentLoaded",l),e.addEventListener("load",l);else{oe.attachEvent("onreadystatechange",l),e.attachEvent("onload",l);var n=!1;try{n=null==e.frameElement&&oe.documentElement}catch(i){}n&&n.doScroll&&!function o(){if(!he.isReady){try{n.doScroll("left")}catch(t){return e.setTimeout(o,50)}s(),he.ready()}}()}return He.promise(t)},he.ready.promise();var Ne;for(Ne in he(pe))break;pe.ownFirst="0"===Ne,pe.inlineBlockNeedsLayout=!1,he(function(){var e,t,n,i;n=oe.getElementsByTagName("body")[0],n&&n.style&&(t=oe.createElement("div"),i=oe.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",pe.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(i))}),function(){var e=oe.createElement("div");pe.deleteExpando=!0;try{delete e.test}catch(t){pe.deleteExpando=!1}e=null}();var Pe=function(e){var t=he.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return(1===n||9===n)&&(!t||t!==!0&&e.getAttribute("classid")===t)},Ae=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Re=/([A-Z])/g;he.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?he.cache[e[he.expando]]:e[he.expando],!!e&&!u(e)},data:function(e,t,n){return d(e,t,n)},removeData:function(e,t){return p(e,t)},_data:function(e,t,n){return d(e,t,n,!0)},_removeData:function(e,t){return p(e,t,!0)}}),he.fn.extend({data:function(e,t){var n,i,o,r=this[0],a=r&&r.attributes;if(void 0===e){if(this.length&&(o=he.data(r),1===r.nodeType&&!he._data(r,"parsedAttrs"))){for(n=a.length;n--;)a[n]&&(i=a[n].name,0===i.indexOf("data-")&&(i=he.camelCase(i.slice(5)),c(r,i,o[i])));he._data(r,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){he.data(this,e)}):arguments.length>1?this.each(function(){he.data(this,e,t)}):r?c(r,e,he.data(r,e)):void 0},removeData:function(e){return this.each(function(){he.removeData(this,e)})}}),he.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=he._data(e,t),n&&(!i||he.isArray(n)?i=he._data(e,t,he.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=he.queue(e,t),i=n.length,o=n.shift(),r=he._queueHooks(e,t),a=function(){he.dequeue(e,t)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,a,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return he._data(e,n)||he._data(e,n,{empty:he.Callbacks("once memory").add(function(){he._removeData(e,t+"queue"),he._removeData(e,n)})})}}),he.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?he.queue(this[0],e):void 0===t?this:this.each(function(){var n=he.queue(this,e,t);he._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&he.dequeue(this,e)})},dequeue:function(e){return this.each(function(){he.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,o=he.Deferred(),r=this,a=this.length,s=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)n=he._data(r[a],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(s));return s(),o.promise(t)}}),function(){var e;pe.shrinkWrapBlocks=function(){if(null!=e)return e;e=!1;var t,n,i;return n=oe.getElementsByTagName("body")[0],n&&n.style?(t=oe.createElement("div"),i=oe.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(oe.createElement("div")).style.width="5px",e=3!==t.offsetWidth),n.removeChild(i),e):void 0}}();var Ie=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ze=new RegExp("^(?:([+-])=|)("+Ie+")([a-z%]*)$","i"),Fe=["Top","Right","Bottom","Left"],Le=function(e,t){return e=t||e,"none"===he.css(e,"display")||!he.contains(e.ownerDocument,e)},je=function(e,t,n,i,o,r,a){var s=0,l=e.length,c=null==n;if("object"===he.type(n)){o=!0;for(s in n)je(e,t,s,n[s],!0,r,a)}else if(void 0!==i&&(o=!0,he.isFunction(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(he(e),n)})),t))for(;s<l;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return o?e:c?t.call(e):l?t(e[0],n):r},Be=/^(?:checkbox|radio)$/i,We=/<([\w:-]+)/,$e=/^$|\/(?:java|ecma)script/i,qe=/^\s+/,Ve="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!function(){var e=oe.createElement("div"),t=oe.createDocumentFragment(),n=oe.createElement("input");e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",pe.leadingWhitespace=3===e.firstChild.nodeType,pe.tbody=!e.getElementsByTagName("tbody").length,pe.htmlSerialize=!!e.getElementsByTagName("link").length,pe.html5Clone="<:nav></:nav>"!==oe.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,t.appendChild(n),pe.appendChecked=n.checked,e.innerHTML="<textarea>x</textarea>",pe.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,t.appendChild(e),n=oe.createElement("input"),n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),pe.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,pe.noCloneEvent=!!e.addEventListener,e[he.expando]=1,pe.attributes=!e.getAttribute(he.expando)}();var Ue={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:pe.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};Ue.optgroup=Ue.option,Ue.tbody=Ue.tfoot=Ue.colgroup=Ue.caption=Ue.thead,Ue.th=Ue.td;var Ye=/<|&#?\w+;/,Je=/<tbody/i;!function(){var t,n,i=oe.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(pe[t]=n in e)||(i.setAttribute(n,"t"),pe[t]=i.attributes[n].expando===!1);i=null}();var Xe=/^(?:input|select|textarea)$/i,Ke=/^key/,Ge=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ze=/^(?:focusinfocus|focusoutblur)$/,Qe=/^([^.]*)(?:\.(.+)|)/;he.event={global:{},add:function(e,t,n,i,o){var r,a,s,l,c,u,d,p,f,h,g,m=he._data(e);if(m){for(n.handler&&(l=n,n=l.handler,o=l.selector),n.guid||(n.guid=he.guid++),(a=m.events)||(a=m.events={}),(u=m.handle)||(u=m.handle=function(e){return"undefined"==typeof he||e&&he.event.triggered===e.type?void 0:he.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(Oe)||[""],s=t.length;s--;)r=Qe.exec(t[s])||[],f=g=r[1],h=(r[2]||"").split(".").sort(),f&&(c=he.event.special[f]||{},f=(o?c.delegateType:c.bindType)||f,c=he.event.special[f]||{},d=he.extend({type:f,origType:g,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&he.expr.match.needsContext.test(o),namespace:h.join(".")},l),(p=a[f])||(p=a[f]=[],p.delegateCount=0,c.setup&&c.setup.call(e,i,h,u)!==!1||(e.addEventListener?e.addEventListener(f,u,!1):e.attachEvent&&e.attachEvent("on"+f,u))),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),he.event.global[f]=!0);e=null}},remove:function(e,t,n,i,o){var r,a,s,l,c,u,d,p,f,h,g,m=he.hasData(e)&&he._data(e);if(m&&(u=m.events)){for(t=(t||"").match(Oe)||[""],c=t.length;c--;)if(s=Qe.exec(t[c])||[],f=g=s[1],h=(s[2]||"").split(".").sort(),f){for(d=he.event.special[f]||{},f=(i?d.delegateType:d.bindType)||f,p=u[f]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=p.length;r--;)a=p[r],!o&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(p.splice(r,1),a.selector&&p.delegateCount--,d.remove&&d.remove.call(e,a));l&&!p.length&&(d.teardown&&d.teardown.call(e,h,m.handle)!==!1||he.removeEvent(e,f,m.handle),delete u[f])}else for(f in u)he.event.remove(e,f+t[c],n,i,!0);he.isEmptyObject(u)&&(delete m.handle,he._removeData(e,"events"))}},trigger:function(t,n,i,o){var r,a,s,l,c,u,d,p=[i||oe],f=de.call(t,"type")?t.type:t,h=de.call(t,"namespace")?t.namespace.split("."):[];if(s=u=i=i||oe,3!==i.nodeType&&8!==i.nodeType&&!Ze.test(f+he.event.triggered)&&(f.indexOf(".")>-1&&(h=f.split("."),f=h.shift(),h.sort()),a=f.indexOf(":")<0&&"on"+f,t=t[he.expando]?t:new he.Event(f,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=h.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:he.makeArray(n,[t]),c=he.event.special[f]||{},o||!c.trigger||c.trigger.apply(i,n)!==!1)){if(!o&&!c.noBubble&&!he.isWindow(i)){for(l=c.delegateType||f,Ze.test(l+f)||(s=s.parentNode);s;s=s.parentNode)p.push(s),u=s;u===(i.ownerDocument||oe)&&p.push(u.defaultView||u.parentWindow||e)}for(d=0;(s=p[d++])&&!t.isPropagationStopped();)t.type=d>1?l:c.bindType||f,r=(he._data(s,"events")||{})[t.type]&&he._data(s,"handle"),r&&r.apply(s,n),r=a&&s[a],r&&r.apply&&Pe(s)&&(t.result=r.apply(s,n),t.result===!1&&t.preventDefault());if(t.type=f,!o&&!t.isDefaultPrevented()&&(!c._default||c._default.apply(p.pop(),n)===!1)&&Pe(i)&&a&&i[f]&&!he.isWindow(i)){u=i[a],u&&(i[a]=null),he.event.triggered=f;try{i[f]()}catch(g){}he.event.triggered=void 0,u&&(i[a]=u)}return t.result}},dispatch:function(e){e=he.event.fix(e);var t,n,i,o,r,a=[],s=re.call(arguments),l=(he._data(this,"events")||{})[e.type]||[],c=he.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(a=he.event.handlers.call(this,e,l),t=0;(o=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(r.namespace)||(e.handleObj=r,e.data=r.data,i=((he.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,s),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,o,r,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(i=[],n=0;n<s;n++)r=t[n],o=r.selector+" ",void 0===i[o]&&(i[o]=r.needsContext?he(o,this).index(l)>-1:he.find(o,this,null,[l]).length),i[o]&&i.push(r);i.length&&a.push({elem:l,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[he.expando])return e;var t,n,i,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Ge.test(o)?this.mouseHooks:Ke.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new he.Event(r),t=i.length;t--;)n=i[t],e[n]=r[n];return e.target||(e.target=r.srcElement||oe),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,o,r=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||oe,o=i.documentElement,n=i.body,e.pageX=t.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==x()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===x()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(he.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return he.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n){var i=he.extend(new he.Event,n,{type:e,isSimulated:!0});he.event.trigger(i,null,t),i.isDefaultPrevented()&&n.preventDefault()}},he.removeEvent=oe.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)}:function(e,t,n){var i="on"+t;e.detachEvent&&("undefined"==typeof e[i]&&(e[i]=null),e.detachEvent(i,n))},he.Event=function(e,t){return this instanceof he.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?y:w):this.type=e,t&&he.extend(this,t),this.timeStamp=e&&e.timeStamp||he.now(),void(this[he.expando]=!0)):new he.Event(e,t)},he.Event.prototype={constructor:he.Event,isDefaultPrevented:w,isPropagationStopped:w,isImmediatePropagationStopped:w,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=y,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=y,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=y,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},he.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){he.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,o=e.relatedTarget,r=e.handleObj;return o&&(o===i||he.contains(i,o))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),pe.submit||(he.event.special.submit={setup:function(){return!he.nodeName(this,"form")&&void he.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=he.nodeName(t,"input")||he.nodeName(t,"button")?he.prop(t,"form"):void 0;n&&!he._data(n,"submit")&&(he.event.add(n,"submit._submit",function(e){e._submitBubble=!0}),he._data(n,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&he.event.simulate("submit",this.parentNode,e))},teardown:function(){return!he.nodeName(this,"form")&&void he.event.remove(this,"._submit")}}),pe.change||(he.event.special.change={setup:function(){return Xe.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(he.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),he.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),he.event.simulate("change",this,e)})),!1):void he.event.add(this,"beforeactivate._change",function(e){var t=e.target;Xe.test(t.nodeName)&&!he._data(t,"change")&&(he.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||he.event.simulate("change",this.parentNode,e)}),he._data(t,"change",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return he.event.remove(this,"._change"),!Xe.test(this.nodeName)}}),pe.focusin||he.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){he.event.simulate(t,e.target,he.event.fix(e))};he.event.special[t]={setup:function(){var i=this.ownerDocument||this,o=he._data(i,t);o||i.addEventListener(e,n,!0),he._data(i,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=he._data(i,t)-1;o?he._data(i,t,o):(i.removeEventListener(e,n,!0),he._removeData(i,t))}}}),he.fn.extend({on:function(e,t,n,i){return _(this,e,t,n,i)},one:function(e,t,n,i){return _(this,e,t,n,i,1)},off:function(e,t,n){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,he(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return t!==!1&&"function"!=typeof t||(n=t,t=void 0),n===!1&&(n=w),this.each(function(){he.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){he.event.trigger(e,t,this);
})},triggerHandler:function(e,t){var n=this[0];if(n)return he.event.trigger(e,t,n,!0)}});var et=/ jQuery\d+="(?:null|\d+)"/g,tt=new RegExp("<(?:"+Ve+")[\\s/>]","i"),nt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,it=/<script|<style|<link/i,ot=/checked\s*(?:[^=]|=\s*.checked.)/i,rt=/^true\/(.*)/,at=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,st=h(oe),lt=st.appendChild(oe.createElement("div"));he.extend({htmlPrefilter:function(e){return e.replace(nt,"<$1></$2>")},clone:function(e,t,n){var i,o,r,a,s,l=he.contains(e.ownerDocument,e);if(pe.html5Clone||he.isXMLDoc(e)||!tt.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(lt.innerHTML=e.outerHTML,lt.removeChild(r=lt.firstChild)),!(pe.noCloneEvent&&pe.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||he.isXMLDoc(e)))for(i=g(r),s=g(e),a=0;null!=(o=s[a]);++a)i[a]&&T(o,i[a]);if(t)if(n)for(s=s||g(e),i=i||g(r),a=0;null!=(o=s[a]);a++)S(o,i[a]);else S(e,r);return i=g(r,"script"),i.length>0&&m(i,!l&&g(e,"script")),i=s=o=null,r},cleanData:function(e,t){for(var n,i,o,r,a=0,s=he.expando,l=he.cache,c=pe.attributes,u=he.event.special;null!=(n=e[a]);a++)if((t||Pe(n))&&(o=n[s],r=o&&l[o])){if(r.events)for(i in r.events)u[i]?he.event.remove(n,i):he.removeEvent(n,i,r.handle);l[o]&&(delete l[o],c||"undefined"==typeof n.removeAttribute?n[s]=void 0:n.removeAttribute(s),ie.push(o))}}}),he.fn.extend({domManip:E,detach:function(e){return M(this,e,!0)},remove:function(e){return M(this,e)},text:function(e){return je(this,function(e){return void 0===e?he.text(this):this.empty().append((this[0]&&this[0].ownerDocument||oe).createTextNode(e))},null,e,arguments.length)},append:function(){return E(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=C(this,e);t.appendChild(e)}})},prepend:function(){return E(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=C(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return E(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return E(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&he.cleanData(g(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&he.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return he.clone(this,e,t)})},html:function(e){return je(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(et,""):void 0;if("string"==typeof e&&!it.test(e)&&(pe.htmlSerialize||!tt.test(e))&&(pe.leadingWhitespace||!qe.test(e))&&!Ue[(We.exec(e)||["",""])[1].toLowerCase()]){e=he.htmlPrefilter(e);try{for(;n<i;n++)t=this[n]||{},1===t.nodeType&&(he.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return E(this,arguments,function(t){var n=this.parentNode;he.inArray(this,e)<0&&(he.cleanData(g(this)),n&&n.replaceChild(t,this))},e)}}),he.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){he.fn[e]=function(e){for(var n,i=0,o=[],r=he(e),a=r.length-1;i<=a;i++)n=i===a?this:this.clone(!0),he(r[i])[t](n),se.apply(o,n.get());return this.pushStack(o)}});var ct,ut={HTML:"block",BODY:"block"},dt=/^margin/,pt=new RegExp("^("+Ie+")(?!px)[a-z%]+$","i"),ft=function(e,t,n,i){var o,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];o=n.apply(e,i||[]);for(r in t)e.style[r]=a[r];return o},ht=oe.documentElement;!function(){function t(){var t,u,d=oe.documentElement;d.appendChild(l),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",n=o=s=!1,i=a=!0,e.getComputedStyle&&(u=e.getComputedStyle(c),n="1%"!==(u||{}).top,s="2px"===(u||{}).marginLeft,o="4px"===(u||{width:"4px"}).width,c.style.marginRight="50%",i="4px"===(u||{marginRight:"4px"}).marginRight,t=c.appendChild(oe.createElement("div")),t.style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",c.style.width="1px",a=!parseFloat((e.getComputedStyle(t)||{}).marginRight),c.removeChild(t)),c.style.display="none",r=0===c.getClientRects().length,r&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",t=c.getElementsByTagName("td"),t[0].style.cssText="margin:0;border:0;padding:0;display:none",r=0===t[0].offsetHeight,r&&(t[0].style.display="",t[1].style.display="none",r=0===t[0].offsetHeight)),d.removeChild(l)}var n,i,o,r,a,s,l=oe.createElement("div"),c=oe.createElement("div");c.style&&(c.style.cssText="float:left;opacity:.5",pe.opacity="0.5"===c.style.opacity,pe.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",pe.clearCloneStyle="content-box"===c.style.backgroundClip,l=oe.createElement("div"),l.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",l.appendChild(c),pe.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,he.extend(pe,{reliableHiddenOffsets:function(){return null==n&&t(),r},boxSizingReliable:function(){return null==n&&t(),o},pixelMarginRight:function(){return null==n&&t(),i},pixelPosition:function(){return null==n&&t(),n},reliableMarginRight:function(){return null==n&&t(),a},reliableMarginLeft:function(){return null==n&&t(),s}}))}();var gt,mt,vt=/^(top|right|bottom|left)$/;e.getComputedStyle?(gt=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},mt=function(e,t,n){var i,o,r,a,s=e.style;return n=n||gt(e),a=n?n.getPropertyValue(t)||n[t]:void 0,""!==a&&void 0!==a||he.contains(e.ownerDocument,e)||(a=he.style(e,t)),n&&!pe.pixelMarginRight()&&pt.test(a)&&dt.test(t)&&(i=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=o,s.maxWidth=r),void 0===a?a:a+""}):ht.currentStyle&&(gt=function(e){return e.currentStyle},mt=function(e,t,n){var i,o,r,a,s=e.style;return n=n||gt(e),a=n?n[t]:void 0,null==a&&s&&s[t]&&(a=s[t]),pt.test(a)&&!vt.test(t)&&(i=s.left,o=e.runtimeStyle,r=o&&o.left,r&&(o.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=i,r&&(o.left=r)),void 0===a?a:a+""||"auto"});var bt=/alpha\([^)]*\)/i,yt=/opacity\s*=\s*([^)]*)/i,wt=/^(none|table(?!-c[ea]).+)/,xt=new RegExp("^("+Ie+")(.*)$","i"),_t={position:"absolute",visibility:"hidden",display:"block"},Ct={letterSpacing:"0",fontWeight:"400"},kt=["Webkit","O","Moz","ms"],Dt=oe.createElement("div").style;he.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=mt(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":pe.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,a,s=he.camelCase(t),l=e.style;if(t=he.cssProps[s]||(he.cssProps[s]=P(s)||s),a=he.cssHooks[t]||he.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(o=a.get(e,!1,i))?o:l[t];if(r=typeof n,"string"===r&&(o=ze.exec(n))&&o[1]&&(n=f(e,t,o),r="number"),null!=n&&n===n&&("number"===r&&(n+=o&&o[3]||(he.cssNumber[s]?"":"px")),pe.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(n=a.set(e,n,i)))))try{l[t]=n}catch(c){}}},css:function(e,t,n,i){var o,r,a,s=he.camelCase(t);return t=he.cssProps[s]||(he.cssProps[s]=P(s)||s),a=he.cssHooks[t]||he.cssHooks[s],a&&"get"in a&&(r=a.get(e,!0,n)),void 0===r&&(r=mt(e,t,i)),"normal"===r&&t in Ct&&(r=Ct[t]),""===n||n?(o=parseFloat(r),n===!0||isFinite(o)?o||0:r):r}}),he.each(["height","width"],function(e,t){he.cssHooks[t]={get:function(e,n,i){if(n)return wt.test(he.css(e,"display"))&&0===e.offsetWidth?ft(e,_t,function(){return z(e,t,i)}):z(e,t,i)},set:function(e,n,i){var o=i&&gt(e);return R(e,n,i?I(e,t,i,pe.boxSizing&&"border-box"===he.css(e,"boxSizing",!1,o),o):0)}}}),pe.opacity||(he.cssHooks.opacity={get:function(e,t){return yt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,o=he.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===he.trim(r.replace(bt,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=bt.test(r)?r.replace(bt,o):r+" "+o)}}),he.cssHooks.marginRight=N(pe.reliableMarginRight,function(e,t){if(t)return ft(e,{display:"inline-block"},mt,[e,"marginRight"])}),he.cssHooks.marginLeft=N(pe.reliableMarginLeft,function(e,t){if(t)return(parseFloat(mt(e,"marginLeft"))||(he.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-ft(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px"}),he.each({margin:"",padding:"",border:"Width"},function(e,t){he.cssHooks[e+t]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];i<4;i++)o[e+Fe[i]+t]=r[i]||r[i-2]||r[0];return o}},dt.test(e)||(he.cssHooks[e+t].set=R)}),he.fn.extend({css:function(e,t){return je(this,function(e,t,n){var i,o,r={},a=0;if(he.isArray(t)){for(i=gt(e),o=t.length;a<o;a++)r[t[a]]=he.css(e,t[a],!1,i);return r}return void 0!==n?he.style(e,t,n):he.css(e,t)},e,t,arguments.length>1)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Le(this)?he(this).show():he(this).hide()})}}),he.Tween=F,F.prototype={constructor:F,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||he.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(he.cssNumber[n]?"":"px")},cur:function(){var e=F.propHooks[this.prop];return e&&e.get?e.get(this):F.propHooks._default.get(this)},run:function(e){var t,n=F.propHooks[this.prop];return this.options.duration?this.pos=t=he.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):F.propHooks._default.set(this),this}},F.prototype.init.prototype=F.prototype,F.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=he.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){he.fx.step[e.prop]?he.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[he.cssProps[e.prop]]&&!he.cssHooks[e.prop]?e.elem[e.prop]=e.now:he.style(e.elem,e.prop,e.now+e.unit)}}},F.propHooks.scrollTop=F.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},he.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},he.fx=F.prototype.init,he.fx.step={};var St,Tt,Et=/^(?:toggle|show|hide)$/,Mt=/queueHooks$/;he.Animation=he.extend(q,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return f(n.elem,e,ze.exec(t),n),n}]},tweener:function(e,t){he.isFunction(e)?(t=e,e=["*"]):e=e.match(Oe);for(var n,i=0,o=e.length;i<o;i++)n=e[i],q.tweeners[n]=q.tweeners[n]||[],q.tweeners[n].unshift(t)},prefilters:[W],prefilter:function(e,t){t?q.prefilters.unshift(e):q.prefilters.push(e)}}),he.speed=function(e,t,n){var i=e&&"object"==typeof e?he.extend({},e):{complete:n||!n&&t||he.isFunction(e)&&e,duration:e,easing:n&&t||t&&!he.isFunction(t)&&t};return i.duration=he.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in he.fx.speeds?he.fx.speeds[i.duration]:he.fx.speeds._default,null!=i.queue&&i.queue!==!0||(i.queue="fx"),i.old=i.complete,i.complete=function(){he.isFunction(i.old)&&i.old.call(this),i.queue&&he.dequeue(this,i.queue)},i},he.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Le).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=he.isEmptyObject(e),r=he.speed(t,n,i),a=function(){var t=q(this,he.extend({},e),r);(o||he._data(this,"finish"))&&t.stop(!0)};return a.finish=a,o||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",r=he.timers,a=he._data(this);if(o)a[o]&&a[o].stop&&i(a[o]);else for(o in a)a[o]&&a[o].stop&&Mt.test(o)&&i(a[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(n),t=!1,r.splice(o,1));!t&&n||he.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=he._data(this),i=n[e+"queue"],o=n[e+"queueHooks"],r=he.timers,a=i?i.length:0;for(n.finish=!0,he.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<a;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),he.each(["toggle","show","hide"],function(e,t){var n=he.fn[t];he.fn[t]=function(e,i,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(j(t,!0),e,i,o)}}),he.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){he.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),he.timers=[],he.fx.tick=function(){var e,t=he.timers,n=0;for(St=he.now();n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||he.fx.stop(),St=void 0},he.fx.timer=function(e){he.timers.push(e),e()?he.fx.start():he.timers.pop()},he.fx.interval=13,he.fx.start=function(){Tt||(Tt=e.setInterval(he.fx.tick,he.fx.interval))},he.fx.stop=function(){e.clearInterval(Tt),Tt=null},he.fx.speeds={slow:600,fast:200,_default:400},he.fn.delay=function(t,n){return t=he.fx?he.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,i){var o=e.setTimeout(n,t);i.stop=function(){e.clearTimeout(o)}})},function(){var e,t=oe.createElement("input"),n=oe.createElement("div"),i=oe.createElement("select"),o=i.appendChild(oe.createElement("option"));n=oe.createElement("div"),n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=n.getElementsByTagName("a")[0],t.setAttribute("type","checkbox"),n.appendChild(t),e=n.getElementsByTagName("a")[0],e.style.cssText="top:1px",pe.getSetAttribute="t"!==n.className,pe.style=/top/.test(e.getAttribute("style")),pe.hrefNormalized="/a"===e.getAttribute("href"),pe.checkOn=!!t.value,pe.optSelected=o.selected,pe.enctype=!!oe.createElement("form").enctype,i.disabled=!0,pe.optDisabled=!o.disabled,t=oe.createElement("input"),t.setAttribute("value",""),pe.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),pe.radioValue="t"===t.value}();var Ot=/\r/g,Ht=/[\x20\t\r\n\f]+/g;he.fn.extend({val:function(e){var t,n,i,o=this[0];{if(arguments.length)return i=he.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=i?e.call(this,n,he(this).val()):e,null==o?o="":"number"==typeof o?o+="":he.isArray(o)&&(o=he.map(o,function(e){return null==e?"":e+""})),t=he.valHooks[this.type]||he.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return t=he.valHooks[o.type]||he.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:(n=o.value,"string"==typeof n?n.replace(Ot,""):null==n?"":n)}}}),he.extend({valHooks:{option:{get:function(e){var t=he.find.attr(e,"value");return null!=t?t:he.trim(he.text(e)).replace(Ht," ")}},select:{get:function(e){for(var t,n,i=e.options,o=e.selectedIndex,r="select-one"===e.type||o<0,a=r?null:[],s=r?o+1:i.length,l=o<0?s:r?o:0;l<s;l++)if(n=i[l],(n.selected||l===o)&&(pe.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!he.nodeName(n.parentNode,"optgroup"))){if(t=he(n).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var n,i,o=e.options,r=he.makeArray(t),a=o.length;a--;)if(i=o[a],he.inArray(he.valHooks.option.get(i),r)>-1)try{i.selected=n=!0}catch(s){i.scrollHeight}else i.selected=!1;return n||(e.selectedIndex=-1),o}}}}),he.each(["radio","checkbox"],function(){he.valHooks[this]={set:function(e,t){if(he.isArray(t))return e.checked=he.inArray(he(e).val(),t)>-1}},pe.checkOn||(he.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Nt,Pt,At=he.expr.attrHandle,Rt=/^(?:checked|selected)$/i,It=pe.getSetAttribute,zt=pe.input;he.fn.extend({attr:function(e,t){return je(this,he.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){he.removeAttr(this,e)})}}),he.extend({attr:function(e,t,n){var i,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return"undefined"==typeof e.getAttribute?he.prop(e,t,n):(1===r&&he.isXMLDoc(e)||(t=t.toLowerCase(),o=he.attrHooks[t]||(he.expr.match.bool.test(t)?Pt:Nt)),void 0!==n?null===n?void he.removeAttr(e,t):o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:(e.setAttribute(t,n+""),n):o&&"get"in o&&null!==(i=o.get(e,t))?i:(i=he.find.attr(e,t),null==i?void 0:i))},attrHooks:{type:{set:function(e,t){if(!pe.radioValue&&"radio"===t&&he.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i,o=0,r=t&&t.match(Oe);if(r&&1===e.nodeType)for(;n=r[o++];)i=he.propFix[n]||n,he.expr.match.bool.test(n)?zt&&It||!Rt.test(n)?e[i]=!1:e[he.camelCase("default-"+n)]=e[i]=!1:he.attr(e,n,""),e.removeAttribute(It?n:i)}}),Pt={set:function(e,t,n){return t===!1?he.removeAttr(e,n):zt&&It||!Rt.test(n)?e.setAttribute(!It&&he.propFix[n]||n,n):e[he.camelCase("default-"+n)]=e[n]=!0,n}},he.each(he.expr.match.bool.source.match(/\w+/g),function(e,t){var n=At[t]||he.find.attr;zt&&It||!Rt.test(t)?At[t]=function(e,t,i){var o,r;return i||(r=At[t],At[t]=o,o=null!=n(e,t,i)?t.toLowerCase():null,At[t]=r),o}:At[t]=function(e,t,n){if(!n)return e[he.camelCase("default-"+t)]?t.toLowerCase():null}}),zt&&It||(he.attrHooks.value={set:function(e,t,n){return he.nodeName(e,"input")?void(e.defaultValue=t):Nt&&Nt.set(e,t,n)}}),It||(Nt={set:function(e,t,n){var i=e.getAttributeNode(n);if(i||e.setAttributeNode(i=e.ownerDocument.createAttribute(n)),i.value=t+="","value"===n||t===e.getAttribute(n))return t}},At.id=At.name=At.coords=function(e,t,n){var i;if(!n)return(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},he.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);if(n&&n.specified)return n.value},set:Nt.set},he.attrHooks.contenteditable={set:function(e,t,n){Nt.set(e,""!==t&&t,n)}},he.each(["width","height"],function(e,t){he.attrHooks[t]={set:function(e,n){if(""===n)return e.setAttribute(t,"auto"),n}}})),pe.style||(he.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Ft=/^(?:input|select|textarea|button|object)$/i,Lt=/^(?:a|area)$/i;he.fn.extend({prop:function(e,t){return je(this,he.prop,e,t,arguments.length>1)},removeProp:function(e){return e=he.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),he.extend({prop:function(e,t,n){var i,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&he.isXMLDoc(e)||(t=he.propFix[t]||t,o=he.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:e[t]=n:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=he.find.attr(e,"tabindex");return t?parseInt(t,10):Ft.test(e.nodeName)||Lt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),pe.hrefNormalized||he.each(["href","src"],function(e,t){he.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),pe.optSelected||(he.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),he.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){he.propFix[this.toLowerCase()]=this}),pe.enctype||(he.propFix.enctype="encoding");var jt=/[\t\r\n\f]/g;he.fn.extend({addClass:function(e){var t,n,i,o,r,a,s,l=0;if(he.isFunction(e))return this.each(function(t){he(this).addClass(e.call(this,t,V(this)))});if("string"==typeof e&&e)for(t=e.match(Oe)||[];n=this[l++];)if(o=V(n),i=1===n.nodeType&&(" "+o+" ").replace(jt," ")){for(a=0;r=t[a++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");s=he.trim(i),o!==s&&he.attr(n,"class",s)}return this},removeClass:function(e){var t,n,i,o,r,a,s,l=0;if(he.isFunction(e))return this.each(function(t){he(this).removeClass(e.call(this,t,V(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(Oe)||[];n=this[l++];)if(o=V(n),i=1===n.nodeType&&(" "+o+" ").replace(jt," ")){for(a=0;r=t[a++];)for(;i.indexOf(" "+r+" ")>-1;)i=i.replace(" "+r+" "," ");s=he.trim(i),o!==s&&he.attr(n,"class",s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):he.isFunction(e)?this.each(function(n){he(this).toggleClass(e.call(this,n,V(this),t),t)}):this.each(function(){var t,i,o,r;if("string"===n)for(i=0,o=he(this),r=e.match(Oe)||[];t=r[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||(t=V(this),t&&he._data(this,"__className__",t),he.attr(this,"class",t||e===!1?"":he._data(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+V(n)+" ").replace(jt," ").indexOf(t)>-1)return!0;return!1}}),he.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){he.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),he.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});var Bt=e.location,Wt=he.now(),$t=/\?/,qt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;he.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,i=null,o=he.trim(t+"");return o&&!he.trim(o.replace(qt,function(e,t,o,r){return n&&t&&(i=0),0===i?e:(n=o||t,i+=!r-!o,"")}))?Function("return "+o)():he.error("Invalid JSON: "+t)},he.parseXML=function(t){var n,i;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(i=new e.DOMParser,n=i.parseFromString(t,"text/xml")):(n=new e.ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(o){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||he.error("Invalid XML: "+t),n};var Vt=/#.*$/,Ut=/([?&])_=[^&]*/,Yt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Jt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Xt=/^(?:GET|HEAD)$/,Kt=/^\/\//,Gt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Zt={},Qt={},en="*/".concat("*"),tn=Bt.href,nn=Gt.exec(tn.toLowerCase())||[];he.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:tn,type:"GET",isLocal:Jt.test(nn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":en,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":he.parseJSON,"text xml":he.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?J(J(e,he.ajaxSettings),t):J(he.ajaxSettings,e)},ajaxPrefilter:U(Zt),ajaxTransport:U(Qt),ajax:function(t,n){function i(t,n,i,o){var r,d,b,y,x,C=n;2!==w&&(w=2,l&&e.clearTimeout(l),u=void 0,s=o||"",_.readyState=t>0?4:0,r=t>=200&&t<300||304===t,i&&(y=X(p,_,i)),y=K(p,y,_,r),r?(p.ifModified&&(x=_.getResponseHeader("Last-Modified"),x&&(he.lastModified[a]=x),x=_.getResponseHeader("etag"),x&&(he.etag[a]=x)),204===t||"HEAD"===p.type?C="nocontent":304===t?C="notmodified":(C=y.state,d=y.data,b=y.error,r=!b)):(b=C,!t&&C||(C="error",t<0&&(t=0))),_.status=t,_.statusText=(n||C)+"",r?g.resolveWith(f,[d,C,_]):g.rejectWith(f,[_,C,b]),_.statusCode(v),v=void 0,c&&h.trigger(r?"ajaxSuccess":"ajaxError",[_,p,r?d:b]),m.fireWith(f,[_,C]),c&&(h.trigger("ajaxComplete",[_,p]),--he.active||he.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=void 0),n=n||{};var o,r,a,s,l,c,u,d,p=he.ajaxSetup({},n),f=p.context||p,h=p.context&&(f.nodeType||f.jquery)?he(f):he.event,g=he.Deferred(),m=he.Callbacks("once memory"),v=p.statusCode||{},b={},y={},w=0,x="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!d)for(d={};t=Yt.exec(s);)d[t[1].toLowerCase()]=t[2];t=d[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=y[n]=y[n]||e,b[e]=t),this},overrideMimeType:function(e){return w||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(w<2)for(t in e)v[t]=[v[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||x;return u&&u.abort(t),i(0,t),this}};if(g.promise(_).complete=m.add,_.success=_.done,_.error=_.fail,p.url=((t||p.url||tn)+"").replace(Vt,"").replace(Kt,nn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=he.trim(p.dataType||"*").toLowerCase().match(Oe)||[""],null==p.crossDomain&&(o=Gt.exec(p.url.toLowerCase()),p.crossDomain=!(!o||o[1]===nn[1]&&o[2]===nn[2]&&(o[3]||("http:"===o[1]?"80":"443"))===(nn[3]||("http:"===nn[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=he.param(p.data,p.traditional)),Y(Zt,p,n,_),2===w)return _;c=he.event&&p.global,c&&0===he.active++&&he.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Xt.test(p.type),a=p.url,p.hasContent||(p.data&&(a=p.url+=($t.test(a)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=Ut.test(a)?a.replace(Ut,"$1_="+Wt++):a+($t.test(a)?"&":"?")+"_="+Wt++)),p.ifModified&&(he.lastModified[a]&&_.setRequestHeader("If-Modified-Since",he.lastModified[a]),he.etag[a]&&_.setRequestHeader("If-None-Match",he.etag[a])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&_.setRequestHeader("Content-Type",p.contentType),_.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+en+"; q=0.01":""):p.accepts["*"]);for(r in p.headers)_.setRequestHeader(r,p.headers[r]);if(p.beforeSend&&(p.beforeSend.call(f,_,p)===!1||2===w))return _.abort();x="abort";for(r in{success:1,error:1,complete:1})_[r](p[r]);if(u=Y(Qt,p,n,_)){if(_.readyState=1,c&&h.trigger("ajaxSend",[_,p]),2===w)return _;p.async&&p.timeout>0&&(l=e.setTimeout(function(){_.abort("timeout")},p.timeout));try{w=1,u.send(b,i)}catch(C){if(!(w<2))throw C;i(-1,C)}}else i(-1,"No Transport");return _},getJSON:function(e,t,n){return he.get(e,t,n,"json")},getScript:function(e,t){return he.get(e,void 0,t,"script")}}),he.each(["get","post"],function(e,t){he[t]=function(e,n,i,o){return he.isFunction(n)&&(o=o||i,i=n,n=void 0),he.ajax(he.extend({url:e,type:t,dataType:o,data:n,success:i},he.isPlainObject(e)&&e))}}),he._evalUrl=function(e){return he.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},he.fn.extend({wrapAll:function(e){if(he.isFunction(e))return this.each(function(t){he(this).wrapAll(e.call(this,t))});if(this[0]){var t=he(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return he.isFunction(e)?this.each(function(t){he(this).wrapInner(e.call(this,t))}):this.each(function(){var t=he(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=he.isFunction(e);return this.each(function(n){he(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){he.nodeName(this,"body")||he(this).replaceWith(this.childNodes)}).end()}}),he.expr.filters.hidden=function(e){return pe.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:Z(e)},he.expr.filters.visible=function(e){return!he.expr.filters.hidden(e)};var on=/%20/g,rn=/\[\]$/,an=/\r?\n/g,sn=/^(?:submit|button|image|reset|file)$/i,ln=/^(?:input|select|textarea|keygen)/i;he.param=function(e,t){var n,i=[],o=function(e,t){t=he.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=he.ajaxSettings&&he.ajaxSettings.traditional),he.isArray(e)||e.jquery&&!he.isPlainObject(e))he.each(e,function(){o(this.name,this.value)});else for(n in e)Q(n,e[n],t,o);return i.join("&").replace(on,"+")},he.fn.extend({serialize:function(){return he.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=he.prop(this,"elements");return e?he.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!he(this).is(":disabled")&&ln.test(this.nodeName)&&!sn.test(e)&&(this.checked||!Be.test(e))}).map(function(e,t){var n=he(this).val();return null==n?null:he.isArray(n)?he.map(n,function(e){return{name:t.name,value:e.replace(an,"\r\n")}}):{name:t.name,value:n.replace(an,"\r\n")}}).get()}}),he.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return this.isLocal?te():oe.documentMode>8?ee():/^(get|post|head|put|delete|options)$/i.test(this.type)&&ee()||te()}:ee;var cn=0,un={},dn=he.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in un)un[e](void 0,!0)}),pe.cors=!!dn&&"withCredentials"in dn,dn=pe.ajax=!!dn,dn&&he.ajaxTransport(function(t){if(!t.crossDomain||pe.cors){var n;return{send:function(i,o){var r,a=t.xhr(),s=++cn;if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)a[r]=t.xhrFields[r];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)void 0!==i[r]&&a.setRequestHeader(r,i[r]+"");a.send(t.hasContent&&t.data||null),n=function(e,i){var r,l,c;if(n&&(i||4===a.readyState))if(delete un[s],n=void 0,a.onreadystatechange=he.noop,i)4!==a.readyState&&a.abort();else{c={},r=a.status,"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(u){l=""}r||!t.isLocal||t.crossDomain?1223===r&&(r=204):r=c.text?200:404}c&&o(r,l,c,a.getAllResponseHeaders())},t.async?4===a.readyState?e.setTimeout(n):a.onreadystatechange=un[s]=n:n()},abort:function(){n&&n(void 0,!0)}}}}),he.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return he.globalEval(e),e}}}),he.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),he.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=oe.head||he("head")[0]||oe.documentElement;return{send:function(i,o){t=oe.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||o(200,"success"))},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var pn=[],fn=/(=)\?(?=&|$)|\?\?/;he.ajaxSetup({jsonp:"callback",jsonpCallback:function(){
var e=pn.pop()||he.expando+"_"+Wt++;return this[e]=!0,e}}),he.ajaxPrefilter("json jsonp",function(t,n,i){var o,r,a,s=t.jsonp!==!1&&(fn.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&fn.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=he.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(fn,"$1"+o):t.jsonp!==!1&&(t.url+=($t.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return a||he.error(o+" was not called"),a[0]},t.dataTypes[0]="json",r=e[o],e[o]=function(){a=arguments},i.always(function(){void 0===r?he(e).removeProp(o):e[o]=r,t[o]&&(t.jsonpCallback=n.jsonpCallback,pn.push(o)),a&&he.isFunction(r)&&r(a[0]),a=r=void 0}),"script"}),he.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||oe;var i=Ce.exec(e),o=!n&&[];return i?[t.createElement(i[1])]:(i=b([e],t,o),o&&o.length&&he(o).remove(),he.merge([],i.childNodes))};var hn=he.fn.load;he.fn.load=function(e,t,n){if("string"!=typeof e&&hn)return hn.apply(this,arguments);var i,o,r,a=this,s=e.indexOf(" ");return s>-1&&(i=he.trim(e.slice(s,e.length)),e=e.slice(0,s)),he.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&he.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){r=arguments,a.html(i?he("<div>").append(he.parseHTML(e)).find(i):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,r||[e.responseText,t,e])})}),this},he.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){he.fn[t]=function(e){return this.on(t,e)}}),he.expr.filters.animated=function(e){return he.grep(he.timers,function(t){return e===t.elem}).length},he.offset={setOffset:function(e,t,n){var i,o,r,a,s,l,c,u=he.css(e,"position"),d=he(e),p={};"static"===u&&(e.style.position="relative"),s=d.offset(),r=he.css(e,"top"),l=he.css(e,"left"),c=("absolute"===u||"fixed"===u)&&he.inArray("auto",[r,l])>-1,c?(i=d.position(),a=i.top,o=i.left):(a=parseFloat(r)||0,o=parseFloat(l)||0),he.isFunction(t)&&(t=t.call(e,n,he.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+o),"using"in t?t.using.call(e,p):d.css(p)}},he.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){he.offset.setOffset(this,e,t)});var t,n,i={top:0,left:0},o=this[0],r=o&&o.ownerDocument;if(r)return t=r.documentElement,he.contains(t,o)?("undefined"!=typeof o.getBoundingClientRect&&(i=o.getBoundingClientRect()),n=ne(r),{top:i.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):i},position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===he.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),he.nodeName(e[0],"html")||(n=e.offset()),n.top+=he.css(e[0],"borderTopWidth",!0),n.left+=he.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-he.css(i,"marginTop",!0),left:t.left-n.left-he.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!he.nodeName(e,"html")&&"static"===he.css(e,"position");)e=e.offsetParent;return e||ht})}}),he.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);he.fn[e]=function(i){return je(this,function(e,i,o){var r=ne(e);return void 0===o?r?t in r?r[t]:r.document.documentElement[i]:e[i]:void(r?r.scrollTo(n?he(r).scrollLeft():o,n?o:he(r).scrollTop()):e[i]=o)},e,i,arguments.length,null)}}),he.each(["top","left"],function(e,t){he.cssHooks[t]=N(pe.pixelPosition,function(e,n){if(n)return n=mt(e,t),pt.test(n)?he(e).position()[t]+"px":n})}),he.each({Height:"height",Width:"width"},function(e,t){he.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){he.fn[i]=function(i,o){var r=arguments.length&&(n||"boolean"!=typeof i),a=n||(i===!0||o===!0?"margin":"border");return je(this,function(t,n,i){var o;return he.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?he.css(t,n,a):he.style(t,n,i,a)},t,r?i:void 0,r,null)}})}),he.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),he.fn.size=function(){return this.length},he.fn.andSelf=he.fn.addBack,"function"==typeof r&&r.amd&&r("jquery",[],function(){return he});var gn=e.jQuery,mn=e.$;return he.noConflict=function(t){return e.$===he&&(e.$=mn),t&&e.jQuery===he&&(e.jQuery=gn),he},t||(e.jQuery=e.$=he),he}),function(){var e=!0;!function(t){var n=this||(0,eval)("this"),i=n.document,a=n.navigator,s=n.jQuery,l=n.JSON;!function(e){if("function"==typeof o&&"object"==typeof exports&&"object"==typeof module){var t=module.exports||exports;e(t)}else"function"==typeof r&&r.amd?r("knockout",["exports"],e):e(n.ko={})}(function(o){function r(e,t){var n=null===e||typeof e in g;return!!n&&e===t}function c(e,n){var i;return function(){i||(i=setTimeout(function(){i=t,e()},n))}}function u(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function d(e){var t=this;return e&&h.utils.objectForEach(e,function(e,n){var i=h.extenders[e];"function"==typeof i&&(t=i(t,n)||t)}),t}function p(e){h.bindingHandlers[e]={init:function(t,n,i,o,r){var a=function(){var t={};return t[e]=n(),t};return h.bindingHandlers.event.init.call(this,t,a,i,o,r)}}}function f(e,t,n,i){h.bindingHandlers[e]={init:function(e,o,r,a,s){var l,c;return h.computed(function(){var r=h.utils.unwrapObservable(o()),a=!n!=!r,u=!c,d=u||t||a!==l;d&&(u&&h.computedContext.getDependenciesCount()&&(c=h.utils.cloneNodes(h.virtualElements.childNodes(e),!0)),a?(u||h.virtualElements.setDomNodeChildren(e,h.utils.cloneNodes(c)),h.applyBindingsToDescendants(i?i(s,r):s,e)):h.virtualElements.emptyNode(e),l=a)},null,{disposeWhenNodeIsRemoved:e}),{controlsDescendantBindings:!0}}},h.expressionRewriting.bindingRewriteValidators[e]=!1,h.virtualElements.allowedBindings[e]=!0}var h="undefined"!=typeof o?o:{};h.exportSymbol=function(e,t){for(var n=e.split("."),i=h,o=0;o<n.length-1;o++)i=i[n[o]];i[n[n.length-1]]=t},h.exportProperty=function(e,t,n){e[t]=n},h.version="3.1.0",h.exportSymbol("version",h.version),h.utils=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function o(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function r(e,t){return e.__proto__=t,e}function c(e,t){if("input"!==h.utils.tagNameLower(e)||!e.type)return!1;if("click"!=t.toLowerCase())return!1;var n=e.type;return"checkbox"==n||"radio"==n}var u={__proto__:[]}instanceof Array,d={},p={},f=a&&/Firefox\/2/i.test(a.userAgent)?"KeyboardEvent":"UIEvents";d[f]=["keyup","keydown","keypress"],d.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"],e(d,function(e,t){if(t.length)for(var n=0,i=t.length;n<i;n++)p[t[n]]=e});var g={propertychange:!0},m=i&&function(){for(var e=3,n=i.createElement("div"),o=n.getElementsByTagName("i");n.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",o[0];);return e>4?e:t}(),v=6===m,b=7===m;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n)},arrayIndexOf:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},arrayFirst:function(e,t,n){for(var i=0,o=e.length;i<o;i++)if(t.call(n,e[i],i))return e[i];return null},arrayRemoveItem:function(e,t){var n=h.utils.arrayIndexOf(e,t);n>0?e.splice(n,1):0===n&&e.shift()},arrayGetDistinctValues:function(e){e=e||[];for(var t=[],n=0,i=e.length;n<i;n++)h.utils.arrayIndexOf(t,e[n])<0&&t.push(e[n]);return t},arrayMap:function(e,t){e=e||[];for(var n=[],i=0,o=e.length;i<o;i++)n.push(t(e[i],i));return n},arrayFilter:function(e,t){e=e||[];for(var n=[],i=0,o=e.length;i<o;i++)t(e[i],i)&&n.push(e[i]);return n},arrayPushAll:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,i=t.length;n<i;n++)e.push(t[n]);return e},addOrRemoveItem:function(e,t,n){var i=h.utils.arrayIndexOf(h.utils.peekObservable(e),t);i<0?n&&e.push(t):n||e.splice(i,1)},canSetPrototype:u,extend:o,setPrototypeOf:r,setPrototypeOfOrExtend:u?r:o,objectForEach:e,objectMap:function(e,t){if(!e)return e;var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i],i,e));return n},emptyDomNode:function(e){for(;e.firstChild;)h.removeNode(e.firstChild)},moveCleanedNodesToContainerElement:function(e){for(var t=h.utils.makeArray(e),n=i.createElement("div"),o=0,r=t.length;o<r;o++)n.appendChild(h.cleanNode(t[o]));return n},cloneNodes:function(e,t){for(var n=0,i=e.length,o=[];n<i;n++){var r=e[n].cloneNode(!0);o.push(t?h.cleanNode(r):r)}return o},setDomNodeChildren:function(e,t){if(h.utils.emptyDomNode(e),t)for(var n=0,i=t.length;n<i;n++)e.appendChild(t[n])},replaceDomNodes:function(e,t){var n=e.nodeType?[e]:e;if(n.length>0){for(var i=n[0],o=i.parentNode,r=0,a=t.length;r<a;r++)o.insertBefore(t[r],i);for(var r=0,a=n.length;r<a;r++)h.removeNode(n[r])}},fixUpContinuousNodeArray:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.shift();if(e.length>1){var n=e[0],i=e[e.length-1];for(e.length=0;n!==i;)if(e.push(n),n=n.nextSibling,!n)return;e.push(i)}}return e},setOptionNodeSelectionState:function(e,t){m<7?e.setAttribute("selected",t):e.selected=t},stringTrim:function(e){return null===e||e===t?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},stringTokenize:function(e,t){for(var n=[],i=(e||"").split(t),o=0,r=i.length;o<r;o++){var a=h.utils.stringTrim(i[o]);""!==a&&n.push(a)}return n},stringStartsWith:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},domNodeIsContainedBy:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},domNodeIsAttachedToDocument:function(e){return h.utils.domNodeIsContainedBy(e,e.ownerDocument.documentElement)},anyDomNodeIsAttachedToDocument:function(e){return!!h.utils.arrayFirst(e,h.utils.domNodeIsAttachedToDocument)},tagNameLower:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},registerEventHandler:function(e,t,n){var i=m&&g[t];if(!i&&s)s(e).bind(t,n);else if(i||"function"!=typeof e.addEventListener){if("undefined"==typeof e.attachEvent)throw new Error("Browser doesn't support addEventListener or attachEvent");var o=function(t){n.call(e,t)},r="on"+t;e.attachEvent(r,o),h.utils.domNodeDisposal.addDisposeCallback(e,function(){e.detachEvent(r,o)})}else e.addEventListener(t,n,!1)},triggerEvent:function(e,t){if(!e||!e.nodeType)throw new Error("element must be a DOM node when calling triggerEvent");var o=c(e,t);if(s&&!o)s(e).trigger(t);else if("function"==typeof i.createEvent){if("function"!=typeof e.dispatchEvent)throw new Error("The supplied element doesn't support dispatchEvent");var r=p[t]||"HTMLEvents",a=i.createEvent(r);a.initEvent(t,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(a)}else if(o&&e.click)e.click();else{if("undefined"==typeof e.fireEvent)throw new Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}},unwrapObservable:function(e){return h.isObservable(e)?e():e},peekObservable:function(e){return h.isObservable(e)?e.peek():e},toggleDomNodeCssClass:function(e,t,n){if(t){var i=/\S+/g,o=e.className.match(i)||[];h.utils.arrayForEach(t.match(i),function(e){h.utils.addOrRemoveItem(o,e,n)}),e.className=o.join(" ")}},setTextContent:function(e,n){var i=h.utils.unwrapObservable(n);null!==i&&i!==t||(i="");var o=h.virtualElements.firstChild(e);!o||3!=o.nodeType||h.virtualElements.nextSibling(o)?h.virtualElements.setDomNodeChildren(e,[e.ownerDocument.createTextNode(i)]):o.data=i,h.utils.forceRefresh(e)},setElementName:function(e,t){if(e.name=t,m<=7)try{e.mergeAttributes(i.createElement("<input name='"+e.name+"'/>"),!1)}catch(n){}},forceRefresh:function(e){if(m>=9){var t=1==e.nodeType?e:e.parentNode;t.style&&(t.style.zoom=t.style.zoom)}},ensureSelectElementIsRenderedCorrectly:function(e){if(m){var t=e.style.width;e.style.width=0,e.style.width=t}},range:function(e,t){e=h.utils.unwrapObservable(e),t=h.utils.unwrapObservable(t);for(var n=[],i=e;i<=t;i++)n.push(i);return n},makeArray:function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n]);return t},isIe6:v,isIe7:b,ieVersion:m,getFormFields:function(e,t){for(var n=h.utils.makeArray(e.getElementsByTagName("input")).concat(h.utils.makeArray(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},o=[],r=n.length-1;r>=0;r--)i(n[r])&&o.push(n[r]);return o},parseJson:function(e){return"string"==typeof e&&(e=h.utils.stringTrim(e))?l&&l.parse?l.parse(e):new Function("return "+e)():null},stringifyJson:function(e,t,n){if(!l||!l.stringify)throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return l.stringify(h.utils.unwrapObservable(e),t,n)},postJson:function(t,n,o){o=o||{};var r=o.params||{},a=o.includeFields||this.fieldsIncludedWithJsonPost,s=t;if("object"==typeof t&&"form"===h.utils.tagNameLower(t)){var l=t;s=l.action;for(var c=a.length-1;c>=0;c--)for(var u=h.utils.getFormFields(l,a[c]),d=u.length-1;d>=0;d--)r[u[d].name]=u[d].value}n=h.utils.unwrapObservable(n);var p=i.createElement("form");p.style.display="none",p.action=s,p.method="post";for(var f in n){var g=i.createElement("input");g.name=f,g.value=h.utils.stringifyJson(h.utils.unwrapObservable(n[f])),p.appendChild(g)}e(r,function(e,t){var n=i.createElement("input");n.name=e,n.value=t,p.appendChild(n)}),i.body.appendChild(p),o.submitter?o.submitter(p):p.submit(),setTimeout(function(){p.parentNode.removeChild(p)},0)}}}(),h.exportSymbol("utils",h.utils),h.exportSymbol("utils.arrayForEach",h.utils.arrayForEach),h.exportSymbol("utils.arrayFirst",h.utils.arrayFirst),h.exportSymbol("utils.arrayFilter",h.utils.arrayFilter),h.exportSymbol("utils.arrayGetDistinctValues",h.utils.arrayGetDistinctValues),h.exportSymbol("utils.arrayIndexOf",h.utils.arrayIndexOf),h.exportSymbol("utils.arrayMap",h.utils.arrayMap),h.exportSymbol("utils.arrayPushAll",h.utils.arrayPushAll),h.exportSymbol("utils.arrayRemoveItem",h.utils.arrayRemoveItem),h.exportSymbol("utils.extend",h.utils.extend),h.exportSymbol("utils.fieldsIncludedWithJsonPost",h.utils.fieldsIncludedWithJsonPost),h.exportSymbol("utils.getFormFields",h.utils.getFormFields),h.exportSymbol("utils.peekObservable",h.utils.peekObservable),h.exportSymbol("utils.postJson",h.utils.postJson),h.exportSymbol("utils.parseJson",h.utils.parseJson),h.exportSymbol("utils.registerEventHandler",h.utils.registerEventHandler),h.exportSymbol("utils.stringifyJson",h.utils.stringifyJson),h.exportSymbol("utils.range",h.utils.range),h.exportSymbol("utils.toggleDomNodeCssClass",h.utils.toggleDomNodeCssClass),h.exportSymbol("utils.triggerEvent",h.utils.triggerEvent),h.exportSymbol("utils.unwrapObservable",h.utils.unwrapObservable),h.exportSymbol("utils.objectForEach",h.utils.objectForEach),h.exportSymbol("utils.addOrRemoveItem",h.utils.addOrRemoveItem),h.exportSymbol("unwrap",h.utils.unwrapObservable),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments),e=n.shift();return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),h.utils.domData=new function(){function e(e,r){var a=e[i],s=a&&"null"!==a&&o[a];if(!s){if(!r)return t;a=e[i]="ko"+n++,o[a]={}}return o[a]}var n=0,i="__ko__"+(new Date).getTime(),o={};return{get:function(n,i){var o=e(n,!1);return o===t?t:o[i]},set:function(n,i,o){if(o!==t||e(n,!1)!==t){var r=e(n,!0);r[i]=o}},clear:function(e){var t=e[i];return!!t&&(delete o[t],e[i]=null,!0)},nextKey:function(){return n++ +i}}},h.exportSymbol("utils.domData",h.utils.domData),h.exportSymbol("utils.domData.clear",h.utils.domData.clear),h.utils.domNodeDisposal=new function(){function e(e,n){var i=h.utils.domData.get(e,r);return i===t&&n&&(i=[],h.utils.domData.set(e,r,i)),i}function n(e){h.utils.domData.set(e,r,t)}function i(t){var n=e(t,!1);if(n){n=n.slice(0);for(var i=0;i<n.length;i++)n[i](t)}h.utils.domData.clear(t),h.utils.domNodeDisposal.cleanExternalData(t),l[t.nodeType]&&o(t)}function o(e){for(var t,n=e.firstChild;t=n;)n=t.nextSibling,8===t.nodeType&&i(t)}var r=h.utils.domData.nextKey(),a={1:!0,8:!0,9:!0},l={1:!0,9:!0};return{addDisposeCallback:function(t,n){if("function"!=typeof n)throw new Error("Callback must be a function");e(t,!0).push(n)},removeDisposeCallback:function(t,i){var o=e(t,!1);o&&(h.utils.arrayRemoveItem(o,i),0==o.length&&n(t))},cleanNode:function(e){if(a[e.nodeType]&&(i(e),l[e.nodeType])){var t=[];h.utils.arrayPushAll(t,e.getElementsByTagName("*"));for(var n=0,o=t.length;n<o;n++)i(t[n])}return e},removeNode:function(e){h.cleanNode(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){s&&"function"==typeof s.cleanData&&s.cleanData([e])}}},h.cleanNode=h.utils.domNodeDisposal.cleanNode,h.removeNode=h.utils.domNodeDisposal.removeNode,h.exportSymbol("cleanNode",h.cleanNode),h.exportSymbol("removeNode",h.removeNode),h.exportSymbol("utils.domNodeDisposal",h.utils.domNodeDisposal),h.exportSymbol("utils.domNodeDisposal.addDisposeCallback",h.utils.domNodeDisposal.addDisposeCallback),h.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",h.utils.domNodeDisposal.removeDisposeCallback),function(){function e(e){var t=h.utils.stringTrim(e).toLowerCase(),o=i.createElement("div"),r=t.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!t.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!t.indexOf("<td")||!t.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],a="ignored<div>"+r[1]+e+r[2]+"</div>";for("function"==typeof n.innerShiv?o.appendChild(n.innerShiv(a)):o.innerHTML=a;r[0]--;)o=o.lastChild;return h.utils.makeArray(o.lastChild.childNodes)}function o(e){if(s.parseHTML)return s.parseHTML(e)||[];var t=s.clean([e]);if(t&&t[0]){for(var n=t[0];n.parentNode&&11!==n.parentNode.nodeType;)n=n.parentNode;n.parentNode&&n.parentNode.removeChild(n)}return t}h.utils.parseHtmlFragment=function(t){return s?o(t):e(t)},h.utils.setHtml=function(e,n){if(h.utils.emptyDomNode(e),n=h.utils.unwrapObservable(n),null!==n&&n!==t)if("string"!=typeof n&&(n=n.toString()),s)s(e).html(n);else for(var i=h.utils.parseHtmlFragment(n),o=0;o<i.length;o++)e.appendChild(i[o])}}(),h.exportSymbol("utils.parseHtmlFragment",h.utils.parseHtmlFragment),h.exportSymbol("utils.setHtml",h.utils.setHtml),h.memoization=function(){function e(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)}function n(){return e()+e()}function i(e,t){if(e)if(8==e.nodeType){var n=h.memoization.parseMemoText(e.nodeValue);null!=n&&t.push({domNode:e,memoId:n})}else if(1==e.nodeType)for(var o=0,r=e.childNodes,a=r.length;o<a;o++)i(r[o],t)}var o={};return{memoize:function(e){if("function"!=typeof e)throw new Error("You can only pass a function to ko.memoization.memoize()");var t=n();return o[t]=e,"<!--[ko_memo:"+t+"]-->"},unmemoize:function(e,n){var i=o[e];if(i===t)throw new Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return i.apply(null,n||[]),!0}finally{delete o[e]}},unmemoizeDomNodeAndDescendants:function(e,t){var n=[];i(e,n);for(var o=0,r=n.length;o<r;o++){var a=n[o].domNode,s=[a];t&&h.utils.arrayPushAll(s,t),h.memoization.unmemoize(n[o].memoId,s),a.nodeValue="",a.parentNode&&a.parentNode.removeChild(a)}},parseMemoText:function(e){var t=e.match(/^\[ko_memo\:(.*?)\]$/);return t?t[1]:null}}}(),h.exportSymbol("memoization",h.memoization),h.exportSymbol("memoization.memoize",h.memoization.memoize),h.exportSymbol("memoization.unmemoize",h.memoization.unmemoize),h.exportSymbol("memoization.parseMemoText",h.memoization.parseMemoText),h.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",h.memoization.unmemoizeDomNodeAndDescendants),h.extenders={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return h.dependentObservable({read:e,write:function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)}})},rateLimit:function(e,t){var n,i,o;"number"==typeof t?n=t:(n=t.timeout,i=t.method),o="notifyWhenChangesStop"==i?u:c,e.limit(function(e){return o(e,n)})},notify:function(e,t){e.equalityComparer="always"==t?null:r}};var g={undefined:1,"boolean":1,number:1,string:1};h.exportSymbol("extenders",h.extenders),h.subscription=function(e,t,n){this.target=e,this.callback=t,this.disposeCallback=n,this.isDisposed=!1,h.exportProperty(this,"dispose",this.dispose)},h.subscription.prototype.dispose=function(){this.isDisposed=!0,this.disposeCallback()},h.subscribable=function(){h.utils.setPrototypeOfOrExtend(this,h.subscribable.fn),this._subscriptions={}};var m="change",v={subscribe:function(e,t,n){var i=this;n=n||m;var o=t?e.bind(t):e,r=new h.subscription(i,o,function(){h.utils.arrayRemoveItem(i._subscriptions[n],r)});return i.peek&&i.peek(),i._subscriptions[n]||(i._subscriptions[n]=[]),i._subscriptions[n].push(r),r},notifySubscribers:function(e,t){if(t=t||m,this.hasSubscriptionsForEvent(t))try{h.dependencyDetection.begin();for(var n,i=this._subscriptions[t].slice(0),o=0;n=i[o];++o)n.isDisposed||n.callback(e)}finally{h.dependencyDetection.end()}},limit:function(e){var t,n,i,o=this,r=h.isObservable(o),a="beforeChange";o._origNotifySubscribers||(o._origNotifySubscribers=o.notifySubscribers,o.notifySubscribers=function(e,t){t&&t!==m?t===a?o._rateLimitedBeforeChange(e):o._origNotifySubscribers(e,t):o._rateLimitedChange(e)});var s=e(function(){r&&i===o&&(i=o()),t=!1,o.isDifferent(n,i)&&o._origNotifySubscribers(n=i)});o._rateLimitedChange=function(e){t=!0,i=e,s()},o._rateLimitedBeforeChange=function(e){t||(n=e,o._origNotifySubscribers(e,a))}},hasSubscriptionsForEvent:function(e){return this._subscriptions[e]&&this._subscriptions[e].length},getSubscriptionsCount:function(){var e=0;return h.utils.objectForEach(this._subscriptions,function(t,n){e+=n.length}),e},isDifferent:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:d};h.exportProperty(v,"subscribe",v.subscribe),h.exportProperty(v,"extend",v.extend),h.exportProperty(v,"getSubscriptionsCount",v.getSubscriptionsCount),h.utils.canSetPrototype&&h.utils.setPrototypeOf(v,Function.prototype),h.subscribable.fn=v,h.isSubscribable=function(e){return null!=e&&"function"==typeof e.subscribe&&"function"==typeof e.notifySubscribers},h.exportSymbol("subscribable",h.subscribable),h.exportSymbol("isSubscribable",h.isSubscribable),h.computedContext=h.dependencyDetection=function(){function e(){return++r}function t(e){o.push(i),i=e}function n(){i=o.pop()}var i,o=[],r=0;return{begin:t,end:n,registerDependency:function(t){if(i){if(!h.isSubscribable(t))throw new Error("Only subscribable things can act as dependencies");i.callback(t,t._id||(t._id=e()))}},ignore:function(e,i,o){try{return t(),e.apply(i,o||[])}finally{n()}},getDependenciesCount:function(){if(i)return i.computed.getDependenciesCount()},isInitial:function(){if(i)return i.isInitial}}}(),h.exportSymbol("computedContext",h.computedContext),h.exportSymbol("computedContext.getDependenciesCount",h.computedContext.getDependenciesCount),h.exportSymbol("computedContext.isInitial",h.computedContext.isInitial),h.observable=function(t){function n(){return arguments.length>0?(n.isDifferent(i,arguments[0])&&(n.valueWillMutate(),i=arguments[0],e&&(n._latestValue=i),n.valueHasMutated()),this):(h.dependencyDetection.registerDependency(n),i)}var i=t;return h.subscribable.call(n),h.utils.setPrototypeOfOrExtend(n,h.observable.fn),e&&(n._latestValue=i),n.peek=function(){return i},n.valueHasMutated=function(){n.notifySubscribers(i)},n.valueWillMutate=function(){n.notifySubscribers(i,"beforeChange")},h.exportProperty(n,"peek",n.peek),h.exportProperty(n,"valueHasMutated",n.valueHasMutated),h.exportProperty(n,"valueWillMutate",n.valueWillMutate),n},h.observable.fn={equalityComparer:r};var b=h.observable.protoProperty="__ko_proto__";h.observable.fn[b]=h.observable,h.utils.canSetPrototype&&h.utils.setPrototypeOf(h.observable.fn,h.subscribable.fn),h.hasPrototype=function(e,n){return null!==e&&e!==t&&e[b]!==t&&(e[b]===n||h.hasPrototype(e[b],n))},h.isObservable=function(e){return h.hasPrototype(e,h.observable)},h.isWriteableObservable=function(e){return"function"==typeof e&&e[b]===h.observable||!("function"!=typeof e||e[b]!==h.dependentObservable||!e.hasWriteFunction)},h.exportSymbol("observable",h.observable),h.exportSymbol("isObservable",h.isObservable),h.exportSymbol("isWriteableObservable",h.isWriteableObservable),h.observableArray=function(e){if(e=e||[],"object"!=typeof e||!("length"in e))throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");var t=h.observable(e);return h.utils.setPrototypeOfOrExtend(t,h.observableArray.fn),t.extend({trackArrayChanges:!0})},h.observableArray.fn={remove:function(e){for(var t=this.peek(),n=[],i="function"!=typeof e||h.isObservable(e)?function(t){return t===e}:e,o=0;o<t.length;o++){var r=t[o];i(r)&&(0===n.length&&this.valueWillMutate(),n.push(r),t.splice(o,1),o--)}return n.length&&this.valueHasMutated(),n},removeAll:function(e){if(e===t){var n=this.peek(),i=n.slice(0);return this.valueWillMutate(),n.splice(0,n.length),this.valueHasMutated(),i}return e?this.remove(function(t){return h.utils.arrayIndexOf(e,t)>=0}):[]},destroy:function(e){var t=this.peek(),n="function"!=typeof e||h.isObservable(e)?function(t){return t===e}:e;this.valueWillMutate();for(var i=t.length-1;i>=0;i--){var o=t[i];n(o)&&(t[i]._destroy=!0)}this.valueHasMutated()},destroyAll:function(e){return e===t?this.destroy(function(){return!0}):e?this.destroy(function(t){return h.utils.arrayIndexOf(e,t)>=0}):[]},indexOf:function(e){var t=this();return h.utils.arrayIndexOf(t,e)},replace:function(e,t){var n=this.indexOf(e);n>=0&&(this.valueWillMutate(),this.peek()[n]=t,this.valueHasMutated())}},h.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(e){h.observableArray.fn[e]=function(){var t=this.peek();this.valueWillMutate(),this.cacheDiffForKnownOperation(t,e,arguments);var n=t[e].apply(t,arguments);return this.valueHasMutated(),n}}),h.utils.arrayForEach(["slice"],function(e){h.observableArray.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),h.utils.canSetPrototype&&h.utils.setPrototypeOf(h.observableArray.fn,h.observable.fn),h.exportSymbol("observableArray",h.observableArray);var y="arrayChange";h.extenders.trackArrayChanges=function(e){function t(){if(!i){i=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return n&&n!==m||++r,t.apply(this,arguments)};var a=[].concat(e.peek()||[]);o=null,e.subscribe(function(t){if(t=[].concat(t||[]),e.hasSubscriptionsForEvent(y)){var i=n(a,t);i.length&&e.notifySubscribers(i,y)}a=t,o=null,r=0})}}function n(e,t){return(!o||r>1)&&(o=h.utils.compareArrays(e,t,{sparse:!0})),o}if(!e.cacheDiffForKnownOperation){var i=!1,o=null,r=0,a=e.subscribe;e.subscribe=e.subscribe=function(e,n,i){return i===y&&t(),a.apply(this,arguments)},e.cacheDiffForKnownOperation=function(e,t,n){function a(e,t,n){return s[s.length]={status:e,value:t,index:n}}if(i&&!r){var s=[],l=e.length,c=n.length,u=0;switch(t){case"push":u=l;case"unshift":for(var d=0;d<c;d++)a("added",n[d],u+d);break;case"pop":u=l-1;case"shift":l&&a("deleted",e[u],u);break;case"splice":for(var p=Math.min(Math.max(0,n[0]<0?l+n[0]:n[0]),l),f=1===c?l:Math.min(p+(n[1]||0),l),g=p+c-2,m=Math.max(f,g),v=[],b=[],d=p,y=2;d<m;++d,++y)d<f&&b.push(a("deleted",e[d],d)),d<g&&v.push(a("added",n[y],d));h.utils.findMovesInArrayComparison(b,v);break;default:return}o=s}}}},h.computed=h.dependentObservable=function(t,n,i){function o(e,t){C[t]||(C[t]=e.subscribe(a),++k)}function r(){m=!0,h.utils.objectForEach(C,function(e,t){t.dispose()}),C={},k=0,p=!1}function a(){var e=l.throttleEvaluation;e&&e>=0?(clearTimeout(D),D=setTimeout(s,e)):l._evalRateLimited?l._evalRateLimited():s()}function s(){if(!f&&!m){if(x&&x()){if(!g)return void _()}else g=!1;f=!0;try{var t=C,i=k;h.dependencyDetection.begin({callback:function(e,n){m||(i&&t[n]?(C[n]=t[n],++k,delete t[n],--i):o(e,n))},computed:l,isInitial:!k}),C={},k=0;try{var r=n?v.call(n):v()}finally{h.dependencyDetection.end(),i&&h.utils.objectForEach(t,function(e,t){t.dispose()}),p=!1}l.isDifferent(d,r)&&(l.notifySubscribers(d,"beforeChange"),d=r,e&&(l._latestValue=d),l._evalRateLimited&&!l.throttleEvaluation||l.notifySubscribers(d))}finally{f=!1}k||_()}}function l(){if(arguments.length>0){if("function"!=typeof b)throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return b.apply(n,arguments),this}return p&&s(),h.dependencyDetection.registerDependency(l),d}function c(){return p&&!k&&s(),d}function u(){return p||k>0}var d,p=!0,f=!1,g=!1,m=!1,v=t;if(v&&"object"==typeof v?(i=v,v=i.read):(i=i||{},v||(v=i.read)),"function"!=typeof v)throw new Error("Pass a function that returns the value of the ko.computed");var b=i.write,y=i.disposeWhenNodeIsRemoved||i.disposeWhenNodeIsRemoved||null,w=i.disposeWhen||i.disposeWhen,x=w,_=r,C={},k=0,D=null;n||(n=i.owner),h.subscribable.call(l),h.utils.setPrototypeOfOrExtend(l,h.dependentObservable.fn),l.peek=c,l.getDependenciesCount=function(){return k},l.hasWriteFunction="function"==typeof i.write,l.dispose=function(){_()},l.isActive=u;var S=l.limit;return l.limit=function(e){S.call(l,e),l._evalRateLimited=function(){l._rateLimitedBeforeChange(d),p=!0,l._rateLimitedChange(l)}},h.exportProperty(l,"peek",l.peek),h.exportProperty(l,"dispose",l.dispose),h.exportProperty(l,"isActive",l.isActive),h.exportProperty(l,"getDependenciesCount",l.getDependenciesCount),y&&(g=!0,y.nodeType&&(x=function(){return!h.utils.domNodeIsAttachedToDocument(y)||w&&w()})),i.deferEvaluation!==!0&&s(),y&&u()&&y.nodeType&&(_=function(){h.utils.domNodeDisposal.removeDisposeCallback(y,_),r()},h.utils.domNodeDisposal.addDisposeCallback(y,_)),l},h.isComputed=function(e){return h.hasPrototype(e,h.dependentObservable)};var w=h.observable.protoProperty;h.dependentObservable[w]=h.observable,h.dependentObservable.fn={equalityComparer:r},h.dependentObservable.fn[w]=h.dependentObservable,h.utils.canSetPrototype&&h.utils.setPrototypeOf(h.dependentObservable.fn,h.subscribable.fn),h.exportSymbol("dependentObservable",h.dependentObservable),h.exportSymbol("computed",h.dependentObservable),h.exportSymbol("isComputed",h.isComputed),function(){function e(o,r,a){a=a||new i,o=r(o);var s=!("object"!=typeof o||null===o||o===t||o instanceof Date||o instanceof String||o instanceof Number||o instanceof Boolean);if(!s)return o;var l=o instanceof Array?[]:{};return a.save(o,l),n(o,function(n){var i=r(o[n]);switch(typeof i){case"boolean":case"number":case"string":case"function":l[n]=i;break;case"object":case"undefined":var s=a.get(i);l[n]=s!==t?s:e(i,r,a)}}),l}function n(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(var i in e)t(i)}function i(){this.keys=[],this.values=[]}var o=10;h.toJS=function(t){if(0==arguments.length)throw new Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;h.isObservable(e)&&t<o;t++)e=e();return e})},h.toJSON=function(e,t,n){var i=h.toJS(e);return h.utils.stringifyJson(i,t,n)},i.prototype={constructor:i,save:function(e,t){var n=h.utils.arrayIndexOf(this.keys,e);
n>=0?this.values[n]=t:(this.keys.push(e),this.values.push(t))},get:function(e){var n=h.utils.arrayIndexOf(this.keys,e);return n>=0?this.values[n]:t}}}(),h.exportSymbol("toJS",h.toJS),h.exportSymbol("toJSON",h.toJSON),function(){var e="__ko__hasDomDataOptionValue__";h.selectExtensions={readValue:function(n){switch(h.utils.tagNameLower(n)){case"option":return n[e]===!0?h.utils.domData.get(n,h.bindingHandlers.options.optionValueDomDataKey):h.utils.ieVersion<=7?n.getAttributeNode("value")&&n.getAttributeNode("value").specified?n.value:n.text:n.value;case"select":return n.selectedIndex>=0?h.selectExtensions.readValue(n.options[n.selectedIndex]):t;default:return n.value}},writeValue:function(n,i,o){switch(h.utils.tagNameLower(n)){case"option":switch(typeof i){case"string":h.utils.domData.set(n,h.bindingHandlers.options.optionValueDomDataKey,t),e in n&&delete n[e],n.value=i;break;default:h.utils.domData.set(n,h.bindingHandlers.options.optionValueDomDataKey,i),n[e]=!0,n.value="number"==typeof i?i:""}break;case"select":""!==i&&null!==i||(i=t);for(var r,a=-1,s=0,l=n.options.length;s<l;++s)if(r=h.selectExtensions.readValue(n.options[s]),r==i||""==r&&i===t){a=s;break}(o||a>=0||i===t&&n.size>1)&&(n.selectedIndex=a);break;default:null!==i&&i!==t||(i=""),n.value=i}}}}(),h.exportSymbol("selectExtensions",h.selectExtensions),h.exportSymbol("selectExtensions.readValue",h.selectExtensions.readValue),h.exportSymbol("selectExtensions.writeValue",h.selectExtensions.writeValue),h.expressionRewriting=function(){function e(e){if(h.utils.arrayIndexOf(i,e)>=0)return!1;var t=e.match(o);return null!==t&&(t[1]?"Object("+t[1]+")"+t[2]:e)}function t(e){var t=h.utils.stringTrim(e);123===t.charCodeAt(0)&&(t=t.slice(1,-1));var n,i,o=[],r=t.match(d),a=0;if(r){r.push(",");for(var s,l=0;s=r[l];++l){var c=s.charCodeAt(0);if(44===c){if(a<=0){n&&o.push(i?{key:n,value:i.join("")}:{unknown:n}),n=i=a=0;continue}}else if(58===c){if(!i)continue}else if(47===c&&l&&s.length>1){var u=r[l-1].match(p);u&&!f[u[0]]&&(t=t.substr(t.indexOf(s)+1),r=t.match(d),r.push(","),l=-1,s="/")}else if(40===c||123===c||91===c)++a;else if(41===c||125===c||93===c)--a;else if(!n&&!i){n=34===c||39===c?s.slice(1,-1):s;continue}i?i.push(s):i=[s]}}return o}function n(n,i){function o(t,n){function i(e){return!e||!e.preprocess||(n=e.preprocess(n,t,o))}var l;i(h.getBindingHandler(t))&&(g[t]&&(l=e(n))&&a.push("'"+t+"':function(_z){"+l+"=_z}"),s&&(n="function(){return "+n+" }"),r.push("'"+t+"':"+n))}i=i||{};var r=[],a=[],s=i.valueAccessors,l="string"==typeof n?t(n):n;return h.utils.arrayForEach(l,function(e){o(e.key||e.unknown,e.value)}),a.length&&o("_ko_property_writers","{"+a.join(",")+" }"),r.join(",")}var i=["true","false","null","undefined"],o=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r='"(?:[^"\\\\]|\\\\.)*"',a="'(?:[^'\\\\]|\\\\.)*'",s="/(?:[^/\\\\]|\\\\.)*/w*",l=",\"'{}()/:[\\]",c="[^\\s:,/][^"+l+"]*[^\\s"+l+"]",u="[^\\s]",d=RegExp(r+"|"+a+"|"+s+"|"+c+"|"+u,"g"),p=/[\])"'A-Za-z0-9_$]+$/,f={"in":1,"return":1,"typeof":1},g={};return{bindingRewriteValidators:[],twoWayBindings:g,parseObjectLiteral:t,preProcessBindings:n,keyValueArrayContainsKey:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},writeValueToProperty:function(e,t,n,i,o){if(e&&h.isObservable(e))!h.isWriteableObservable(e)||o&&e.peek()===i||e(i);else{var r=t.get("_ko_property_writers");r&&r[n]&&r[n](i)}}}}(),h.exportSymbol("expressionRewriting",h.expressionRewriting),h.exportSymbol("expressionRewriting.bindingRewriteValidators",h.expressionRewriting.bindingRewriteValidators),h.exportSymbol("expressionRewriting.parseObjectLiteral",h.expressionRewriting.parseObjectLiteral),h.exportSymbol("expressionRewriting.preProcessBindings",h.expressionRewriting.preProcessBindings),h.exportSymbol("expressionRewriting._twoWayBindings",h.expressionRewriting.twoWayBindings),h.exportSymbol("jsonExpressionRewriting",h.expressionRewriting),h.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",h.expressionRewriting.preProcessBindings),function(){function e(e){return 8==e.nodeType&&s.test(a?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&l.test(a?e.text:e.nodeValue)}function n(n,i){for(var o=n,r=1,a=[];o=o.nextSibling;){if(t(o)&&(r--,0===r))return a;a.push(o),e(o)&&r++}if(!i)throw new Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function o(e,t){var i=n(e,t);return i?i.length>0?i[i.length-1].nextSibling:e.nextSibling:null}function r(n){var i=n.firstChild,r=null;if(i)do if(r)r.push(i);else if(e(i)){var a=o(i,!0);a?i=a:r=[i]}else t(i)&&(r=[i]);while(i=i.nextSibling);return r}var a=i&&"<!--test-->"===i.createComment("test").text,s=a?/^<!--\s*ko(?:\s+([\s\S]+))?\s*-->$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,l=a?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/,c={ul:!0,ol:!0};h.virtualElements={allowedBindings:{},childNodes:function(t){return e(t)?n(t):t.childNodes},emptyNode:function(t){if(e(t))for(var n=h.virtualElements.childNodes(t),i=0,o=n.length;i<o;i++)h.removeNode(n[i]);else h.utils.emptyDomNode(t)},setDomNodeChildren:function(t,n){if(e(t)){h.virtualElements.emptyNode(t);for(var i=t.nextSibling,o=0,r=n.length;o<r;o++)i.parentNode.insertBefore(n[o],i)}else h.utils.setDomNodeChildren(t,n)},prepend:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},insertAfter:function(t,n,i){i?e(t)?t.parentNode.insertBefore(n,i.nextSibling):i.nextSibling?t.insertBefore(n,i.nextSibling):t.appendChild(n):h.virtualElements.prepend(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=o(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},hasBindingValue:e,virtualNodeBindingValue:function(e){var t=(a?e.text:e.nodeValue).match(s);return t?t[1]:null},normaliseVirtualElementDomStructure:function(e){if(c[h.utils.tagNameLower(e)]){var t=e.firstChild;if(t)do if(1===t.nodeType){var n=r(t);if(n)for(var i=t.nextSibling,o=0;o<n.length;o++)i?e.insertBefore(n[o],i):e.appendChild(n[o])}while(t=t.nextSibling)}}}}(),h.exportSymbol("virtualElements",h.virtualElements),h.exportSymbol("virtualElements.allowedBindings",h.virtualElements.allowedBindings),h.exportSymbol("virtualElements.emptyNode",h.virtualElements.emptyNode),h.exportSymbol("virtualElements.insertAfter",h.virtualElements.insertAfter),h.exportSymbol("virtualElements.prepend",h.virtualElements.prepend),h.exportSymbol("virtualElements.setDomNodeChildren",h.virtualElements.setDomNodeChildren),function(){function e(e,n,i){var o=e+(i&&i.valueAccessors||"");return n[o]||(n[o]=t(e,i))}function t(e,t){var n=h.expressionRewriting.preProcessBindings(e,t),i="with($context){with($data||{}){return{"+n+"}}}";return new Function("$context","$element",i)}var n="data-bind";h.bindingProvider=function(){this.bindingCache={}},h.utils.extend(h.bindingProvider.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute(n);case 8:return h.virtualElements.hasBindingValue(e);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e):null},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null},getBindingsString:function(e,t){switch(e.nodeType){case 1:return e.getAttribute(n);case 8:return h.virtualElements.virtualNodeBindingValue(e);default:return null}},parseBindingsString:function(t,n,i,o){try{var r=e(t,this.bindingCache,o);return r(n,i)}catch(a){throw a.message="Unable to parse bindings.\nBindings value: "+t+"\nMessage: "+a.message,a}}}),h.bindingProvider.instance=new h.bindingProvider}(),h.exportSymbol("bindingProvider",h.bindingProvider),function(){function e(e){return function(){return e}}function i(e){return e()}function o(e){return h.utils.objectMap(h.dependencyDetection.ignore(e),function(t,n){return function(){return e()[n]}})}function r(t,n,i){return"function"==typeof t?o(t.bind(null,n,i)):h.utils.objectMap(t,e)}function a(e,t){return o(this.getBindings.bind(this,e,t))}function l(e){var t=h.virtualElements.allowedBindings[e];if(!t)throw new Error("The binding '"+e+"' cannot be used with virtual elements")}function c(e,t,n){var i,o=h.virtualElements.firstChild(t),r=h.bindingProvider.instance,a=r.preprocessNode;if(a){for(;i=o;)o=h.virtualElements.nextSibling(i),a.call(r,i);o=h.virtualElements.firstChild(t)}for(;i=o;)o=h.virtualElements.nextSibling(i),u(e,i,n)}function u(e,t,n){var i=!0,o=1===t.nodeType;o&&h.virtualElements.normaliseVirtualElementDomStructure(t);var r=o&&n||h.bindingProvider.instance.nodeHasBindings(t);r&&(i=p(t,null,e,n).shouldBindDescendants),i&&!g[h.utils.tagNameLower(t)]&&c(e,t,!o)}function d(e){var t=[],n={},i=[];return h.utils.objectForEach(e,function o(r){if(!n[r]){var a=h.getBindingHandler(r);a&&(a.after&&(i.push(r),h.utils.arrayForEach(a.after,function(t){if(e[t]){if(h.utils.arrayIndexOf(i,t)!==-1)throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));o(t)}}),i.length--),t.push({key:r,handler:a})),n[r]=!0}}),t}function p(e,n,o,r){function s(){return h.utils.objectMap(g?g():u,i)}var c=h.utils.domData.get(e,m);if(!n){if(c)throw Error("You cannot apply bindings multiple times to the same element.");h.utils.domData.set(e,m,!0)}!c&&r&&h.storedBindingContextForNode(e,o);var u;if(n&&"function"!=typeof n)u=n;else{var p=h.bindingProvider.instance,f=p.getBindingAccessors||a,g=h.dependentObservable(function(){return u=n?n(o,e):f.call(p,e,o),u&&o._subscribable&&o._subscribable(),u},null,{disposeWhenNodeIsRemoved:e});u&&g.isActive()||(g=null)}var v;if(u){var b=g?function(e){return function(){return i(g()[e])}}:function(e){return u[e]};s.get=function(e){return u[e]&&i(b(e))},s.has=function(e){return e in u};var y=d(u);h.utils.arrayForEach(y,function(n){var i=n.handler.init,r=n.handler.update,a=n.key;8===e.nodeType&&l(a);try{"function"==typeof i&&h.dependencyDetection.ignore(function(){var n=i(e,b(a),s,o.$data,o);if(n&&n.controlsDescendantBindings){if(v!==t)throw new Error("Multiple bindings ("+v+" and "+a+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");v=a}}),"function"==typeof r&&h.dependentObservable(function(){r(e,b(a),s,o.$data,o)},null,{disposeWhenNodeIsRemoved:e})}catch(c){throw c.message='Unable to process binding "'+a+": "+u[a]+'"\nMessage: '+c.message,c}})}return{shouldBindDescendants:v===t}}function f(e){return e&&e instanceof h.bindingContext?e:new h.bindingContext(e)}h.bindingHandlers={};var g={script:!0};h.getBindingHandler=function(e){return h.bindingHandlers[e]},h.bindingContext=function(e,n,i,o){function r(){var t=c?e():e,r=h.utils.unwrapObservable(t);return n?(n._subscribable&&n._subscribable(),h.utils.extend(l,n),u&&(l._subscribable=u)):(l.$parents=[],l.$root=r,l.ko=h),l.$rawData=t,l.$data=r,i&&(l[i]=r),o&&o(l,n,r),l.$data}function a(){return s&&!h.utils.anyDomNodeIsAttachedToDocument(s)}var s,l=this,c="function"==typeof e&&!h.isObservable(e),u=h.dependentObservable(r,null,{disposeWhen:a,disposeWhenNodeIsRemoved:!0});u.isActive()&&(l._subscribable=u,u.equalityComparer=null,s=[],u._addNode=function(e){s.push(e),h.utils.domNodeDisposal.addDisposeCallback(e,function(e){h.utils.arrayRemoveItem(s,e),s.length||(u.dispose(),l._subscribable=u=t)})})},h.bindingContext.prototype.createChildContext=function(e,t,n){return new h.bindingContext(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},h.bindingContext.prototype.extend=function(e){return new h.bindingContext(this._subscribable||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,h.utils.extend(t,"function"==typeof e?e():e)})};var m=h.utils.domData.nextKey(),v=h.utils.domData.nextKey();h.storedBindingContextForNode=function(e,t){return 2!=arguments.length?h.utils.domData.get(e,v):(h.utils.domData.set(e,v,t),void(t._subscribable&&t._subscribable._addNode(e)))},h.applyBindingAccessorsToNode=function(e,t,n){return 1===e.nodeType&&h.virtualElements.normaliseVirtualElementDomStructure(e),p(e,t,f(n),!0)},h.applyBindingsToNode=function(e,t,n){var i=f(n);return h.applyBindingAccessorsToNode(e,r(t,i,e),i)},h.applyBindingsToDescendants=function(e,t){1!==t.nodeType&&8!==t.nodeType||c(f(e),t,!0)},h.applyBindings=function(e,t){if(!s&&n.jQuery&&(s=n.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||n.document.body,u(f(e),t,!0)},h.contextFor=function(e){switch(e.nodeType){case 1:case 8:var n=h.storedBindingContextForNode(e);if(n)return n;if(e.parentNode)return h.contextFor(e.parentNode)}return t},h.dataFor=function(e){var n=h.contextFor(e);return n?n.$data:t},h.exportSymbol("bindingHandlers",h.bindingHandlers),h.exportSymbol("applyBindings",h.applyBindings),h.exportSymbol("applyBindingsToDescendants",h.applyBindingsToDescendants),h.exportSymbol("applyBindingAccessorsToNode",h.applyBindingAccessorsToNode),h.exportSymbol("applyBindingsToNode",h.applyBindingsToNode),h.exportSymbol("contextFor",h.contextFor),h.exportSymbol("dataFor",h.dataFor)}();var x={"class":"className","for":"htmlFor"};h.bindingHandlers.attr={update:function(e,n,i){var o=h.utils.unwrapObservable(n())||{};h.utils.objectForEach(o,function(n,i){i=h.utils.unwrapObservable(i);var o=i===!1||null===i||i===t;o&&e.removeAttribute(n),h.utils.ieVersion<=8&&n in x?(n=x[n],o?e.removeAttribute(n):e[n]=i):o||e.setAttribute(n,i.toString()),"name"===n&&h.utils.setElementName(e,o?"":i.toString())})}},function(){h.bindingHandlers.checked={after:["value","attr"],init:function(e,n,i){function o(){return i.has("checkedValue")?h.utils.unwrapObservable(i.get("checkedValue")):e.value}function r(){var t=e.checked,r=d?o():t;if(!h.computedContext.isInitial()&&(!l||t)){var a=h.dependencyDetection.ignore(n);c?u!==r?(t&&(h.utils.addOrRemoveItem(a,r,!0),h.utils.addOrRemoveItem(a,u,!1)),u=r):h.utils.addOrRemoveItem(a,r,t):h.expressionRewriting.writeValueToProperty(a,i,"checked",r,!0)}}function a(){var t=h.utils.unwrapObservable(n());c?e.checked=h.utils.arrayIndexOf(t,o())>=0:s?e.checked=t:e.checked=o()===t}var s="checkbox"==e.type,l="radio"==e.type;if(s||l){var c=s&&h.utils.unwrapObservable(n())instanceof Array,u=c?o():t,d=l||c;l&&!e.name&&h.bindingHandlers.uniqueName.init(e,function(){return!0}),h.computed(r,null,{disposeWhenNodeIsRemoved:e}),h.utils.registerEventHandler(e,"click",r),h.computed(a,null,{disposeWhenNodeIsRemoved:e})}}},h.expressionRewriting.twoWayBindings.checked=!0,h.bindingHandlers.checkedValue={update:function(e,t){e.value=h.utils.unwrapObservable(t())}}}();var _="__ko__cssValue";h.bindingHandlers.css={update:function(e,t){var n=h.utils.unwrapObservable(t());"object"==typeof n?h.utils.objectForEach(n,function(t,n){n=h.utils.unwrapObservable(n),h.utils.toggleDomNodeCssClass(e,t,n)}):(n=String(n||""),h.utils.toggleDomNodeCssClass(e,e[_],!1),e[_]=n,h.utils.toggleDomNodeCssClass(e,n,!0))}},h.bindingHandlers.enable={update:function(e,t){var n=h.utils.unwrapObservable(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},h.bindingHandlers.disable={update:function(e,t){h.bindingHandlers.enable.update(e,function(){return!h.utils.unwrapObservable(t())})}},h.bindingHandlers.event={init:function(e,t,n,i,o){var r=t()||{};h.utils.objectForEach(r,function(r){"string"==typeof r&&h.utils.registerEventHandler(e,r,function(e){var a,s=t()[r];if(s){try{var l=h.utils.makeArray(arguments);i=o.$data,l.unshift(i),a=s.apply(i,l)}finally{a!==!0&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}var c=n.get(r+"Bubble")!==!1;c||(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},h.bindingHandlers.foreach={makeTemplateValueAccessor:function(e){return function(){var t=e(),n=h.utils.peekObservable(t);return n&&"number"!=typeof n.length?(h.utils.unwrapObservable(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:h.nativeTemplateEngine.instance}):{foreach:t,templateEngine:h.nativeTemplateEngine.instance}}},init:function(e,t,n,i,o){return h.bindingHandlers.template.init(e,h.bindingHandlers.foreach.makeTemplateValueAccessor(t))},update:function(e,t,n,i,o){return h.bindingHandlers.template.update(e,h.bindingHandlers.foreach.makeTemplateValueAccessor(t),n,i,o)}},h.expressionRewriting.bindingRewriteValidators.foreach=!1,h.virtualElements.allowedBindings.foreach=!0;var C="__ko_hasfocusUpdating",k="__ko_hasfocusLastValue";h.bindingHandlers.hasfocus={init:function(e,t,n){var i=function(i){e[C]=!0;var o=e.ownerDocument;if("activeElement"in o){var r;try{r=o.activeElement}catch(a){r=o.body}i=r===e}var s=t();h.expressionRewriting.writeValueToProperty(s,n,"hasfocus",i,!0),e[k]=i,e[C]=!1},o=i.bind(null,!0),r=i.bind(null,!1);h.utils.registerEventHandler(e,"focus",o),h.utils.registerEventHandler(e,"focusin",o),h.utils.registerEventHandler(e,"blur",r),h.utils.registerEventHandler(e,"focusout",r)},update:function(e,t){var n=!!h.utils.unwrapObservable(t());e[C]||e[k]===n||(n?e.focus():e.blur(),h.dependencyDetection.ignore(h.utils.triggerEvent,null,[e,n?"focusin":"focusout"]))}},h.expressionRewriting.twoWayBindings.hasfocus=!0,h.bindingHandlers.hasFocus=h.bindingHandlers.hasfocus,h.expressionRewriting.twoWayBindings.hasFocus=!0,h.bindingHandlers.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){h.utils.setHtml(e,t())}},f("if"),f("ifnot",!1,!0),f("with",!0,!1,function(e,t){return e.createChildContext(t)});var D={};h.bindingHandlers.options={init:function(e){if("select"!==h.utils.tagNameLower(e))throw new Error("options binding applies only to SELECT elements");for(;e.length>0;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,n,i){function o(){return h.utils.arrayFilter(e.options,function(e){return e.selected})}function r(e,t,n){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:n}function a(n,o,a){a.length&&(u=a[0].selected?[h.selectExtensions.readValue(a[0])]:[],v=!0);var s=e.ownerDocument.createElement("option");if(n===D)h.utils.setTextContent(s,i.get("optionsCaption")),h.selectExtensions.writeValue(s,t);else{var l=r(n,i.get("optionsValue"),n);h.selectExtensions.writeValue(s,h.utils.unwrapObservable(l));var c=r(n,i.get("optionsText"),l);h.utils.setTextContent(s,c)}return[s]}function s(t,n){if(u.length){var i=h.utils.arrayIndexOf(u,h.selectExtensions.readValue(n[0]))>=0;h.utils.setOptionNodeSelectionState(n[0],i),v&&!i&&h.dependencyDetection.ignore(h.utils.triggerEvent,null,[e,"change"])}}var l,c,u,d=0==e.length,p=!d&&e.multiple?e.scrollTop:null,f=h.utils.unwrapObservable(n()),g=i.get("optionsIncludeDestroyed"),m={};u=e.multiple?h.utils.arrayMap(o(),h.selectExtensions.readValue):e.selectedIndex>=0?[h.selectExtensions.readValue(e.options[e.selectedIndex])]:[],f&&("undefined"==typeof f.length&&(f=[f]),c=h.utils.arrayFilter(f,function(e){return g||e===t||null===e||!h.utils.unwrapObservable(e._destroy)}),i.has("optionsCaption")&&(l=h.utils.unwrapObservable(i.get("optionsCaption")),null!==l&&l!==t&&c.unshift(D)));var v=!1;m.beforeRemove=function(t){e.removeChild(t)};var b=s;i.has("optionsAfterRender")&&(b=function(e,n){s(e,n),h.dependencyDetection.ignore(i.get("optionsAfterRender"),null,[n[0],e!==D?e:t])}),h.utils.setDomNodeChildrenFromArrayMapping(e,c,a,m,b),h.dependencyDetection.ignore(function(){if(i.get("valueAllowUnset")&&i.has("value"))h.selectExtensions.writeValue(e,h.utils.unwrapObservable(i.get("value")),!0);else{var t;t=e.multiple?u.length&&o().length<u.length:u.length&&e.selectedIndex>=0?h.selectExtensions.readValue(e.options[e.selectedIndex])!==u[0]:u.length||e.selectedIndex>=0,t&&h.utils.triggerEvent(e,"change")}}),h.utils.ensureSelectElementIsRenderedCorrectly(e),p&&Math.abs(p-e.scrollTop)>20&&(e.scrollTop=p)}},h.bindingHandlers.options.optionValueDomDataKey=h.utils.domData.nextKey(),h.bindingHandlers.selectedOptions={after:["options","foreach"],init:function(e,t,n){h.utils.registerEventHandler(e,"change",function(){var i=t(),o=[];h.utils.arrayForEach(e.getElementsByTagName("option"),function(e){e.selected&&o.push(h.selectExtensions.readValue(e))}),h.expressionRewriting.writeValueToProperty(i,n,"selectedOptions",o)})},update:function(e,t){if("select"!=h.utils.tagNameLower(e))throw new Error("values binding applies only to SELECT elements");var n=h.utils.unwrapObservable(t());n&&"number"==typeof n.length&&h.utils.arrayForEach(e.getElementsByTagName("option"),function(e){var t=h.utils.arrayIndexOf(n,h.selectExtensions.readValue(e))>=0;h.utils.setOptionNodeSelectionState(e,t)})}},h.expressionRewriting.twoWayBindings.selectedOptions=!0,h.bindingHandlers.style={update:function(e,t){var n=h.utils.unwrapObservable(t()||{});h.utils.objectForEach(n,function(t,n){n=h.utils.unwrapObservable(n),e.style[t]=n||""})}},h.bindingHandlers.submit={init:function(e,t,n,i,o){if("function"!=typeof t())throw new Error("The value for a submit binding must be a function");h.utils.registerEventHandler(e,"submit",function(n){var i,r=t();try{i=r.call(o.$data,e)}finally{i!==!0&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},h.bindingHandlers.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){h.utils.setTextContent(e,t())}},h.virtualElements.allowedBindings.text=!0,h.bindingHandlers.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++h.bindingHandlers.uniqueName.currentIndex;h.utils.setElementName(e,n)}}},h.bindingHandlers.uniqueName.currentIndex=0,h.bindingHandlers.value={after:["options","foreach"],init:function(e,t,n){var i=["change"],o=n.get("valueUpdate"),r=!1;o&&("string"==typeof o&&(o=[o]),h.utils.arrayPushAll(i,o),i=h.utils.arrayGetDistinctValues(i));var a=function(){r=!1;var i=t(),o=h.selectExtensions.readValue(e);h.expressionRewriting.writeValueToProperty(i,n,"value",o)},s=h.utils.ieVersion&&"input"==e.tagName.toLowerCase()&&"text"==e.type&&"off"!=e.autocomplete&&(!e.form||"off"!=e.form.autocomplete);s&&h.utils.arrayIndexOf(i,"propertychange")==-1&&(h.utils.registerEventHandler(e,"propertychange",function(){r=!0}),h.utils.registerEventHandler(e,"focus",function(){r=!1}),h.utils.registerEventHandler(e,"blur",function(){r&&a()})),h.utils.arrayForEach(i,function(t){var n=a;h.utils.stringStartsWith(t,"after")&&(n=function(){setTimeout(a,0)},t=t.substring("after".length)),h.utils.registerEventHandler(e,t,n)})},update:function(e,t,n){var i=h.utils.unwrapObservable(t()),o=h.selectExtensions.readValue(e),r=i!==o;if(r)if("select"===h.utils.tagNameLower(e)){var a=n.get("valueAllowUnset"),s=function(){h.selectExtensions.writeValue(e,i,a)};s(),a||i===h.selectExtensions.readValue(e)?setTimeout(s,0):h.dependencyDetection.ignore(h.utils.triggerEvent,null,[e,"change"])}else h.selectExtensions.writeValue(e,i)}},h.expressionRewriting.twoWayBindings.value=!0,h.bindingHandlers.visible={update:function(e,t){var n=h.utils.unwrapObservable(t()),i=!("none"==e.style.display);n&&!i?e.style.display="":!n&&i&&(e.style.display="none")}},p("click"),h.templateEngine=function(){},h.templateEngine.prototype.renderTemplateSource=function(e,t,n){throw new Error("Override renderTemplateSource")},h.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(e){throw new Error("Override createJavaScriptEvaluatorBlock")},h.templateEngine.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||i;var n=t.getElementById(e);if(!n)throw new Error("Cannot find template with ID "+e);return new h.templateSources.domElement(n)}if(1==e.nodeType||8==e.nodeType)return new h.templateSources.anonymousTemplate(e);throw new Error("Unknown template type: "+e)},h.templateEngine.prototype.renderTemplate=function(e,t,n,i){var o=this.makeTemplateSource(e,i);return this.renderTemplateSource(o,t,n)},h.templateEngine.prototype.isTemplateRewritten=function(e,t){return this.allowTemplateRewriting===!1||this.makeTemplateSource(e,t).data("isRewritten")},h.templateEngine.prototype.rewriteTemplate=function(e,t,n){var i=this.makeTemplateSource(e,n),o=t(i.text());i.text(o),i.data("isRewritten",!0)},h.exportSymbol("templateEngine",h.templateEngine),h.templateRewriting=function(){function e(e){for(var t=h.expressionRewriting.bindingRewriteValidators,n=0;n<e.length;n++){var i=e[n].key;if(t.hasOwnProperty(i)){var o=t[i];if("function"==typeof o){var r=o(e[n].value);if(r)throw new Error(r)}else if(!o)throw new Error("This template engine does not support the '"+i+"' binding within its templates")}}}function t(t,n,i,o){var r=h.expressionRewriting.parseObjectLiteral(t);e(r);var a=h.expressionRewriting.preProcessBindings(r,{valueAccessors:!0}),s="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+a+" } })()},'"+i.toLowerCase()+"')";return o.createJavaScriptEvaluatorBlock(s)+n}var n=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,i=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;return{ensureTemplateIsRewritten:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return h.templateRewriting.memoizeBindingAttributeSyntax(e,t)},n)},memoizeBindingAttributeSyntax:function(e,o){return e.replace(n,function(){return t(arguments[4],arguments[1],arguments[2],o)}).replace(i,function(){return t(arguments[1],"<!-- ko -->","#comment",o)})},applyMemoizedBindingsToNextSibling:function(e,t){return h.memoization.memoize(function(n,i){var o=n.nextSibling;o&&o.nodeName.toLowerCase()===t&&h.applyBindingAccessorsToNode(o,e,i)})}}}(),h.exportSymbol("__tr_ambtns",h.templateRewriting.applyMemoizedBindingsToNextSibling),function(){h.templateSources={},h.templateSources.domElement=function(e){this.domElement=e},h.templateSources.domElement.prototype.text=function(){var e=h.utils.tagNameLower(this.domElement),t="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.domElement[t];var n=arguments[0];"innerHTML"===t?h.utils.setHtml(this.domElement,n):this.domElement[t]=n};var e=h.utils.domData.nextKey()+"_";h.templateSources.domElement.prototype.data=function(t){return 1===arguments.length?h.utils.domData.get(this.domElement,e+t):void h.utils.domData.set(this.domElement,e+t,arguments[1])};var n=h.utils.domData.nextKey();h.templateSources.anonymousTemplate=function(e){this.domElement=e},h.templateSources.anonymousTemplate.prototype=new h.templateSources.domElement,h.templateSources.anonymousTemplate.prototype.constructor=h.templateSources.anonymousTemplate,h.templateSources.anonymousTemplate.prototype.text=function(){if(0==arguments.length){var e=h.utils.domData.get(this.domElement,n)||{};return e.textData===t&&e.containerData&&(e.textData=e.containerData.innerHTML),e.textData}var i=arguments[0];h.utils.domData.set(this.domElement,n,{textData:i})},h.templateSources.domElement.prototype.nodes=function(){if(0==arguments.length){var e=h.utils.domData.get(this.domElement,n)||{};return e.containerData}var t=arguments[0];h.utils.domData.set(this.domElement,n,{containerData:t})},h.exportSymbol("templateSources",h.templateSources),h.exportSymbol("templateSources.domElement",h.templateSources.domElement),h.exportSymbol("templateSources.anonymousTemplate",h.templateSources.anonymousTemplate)}(),function(){function e(e,t,n){for(var i,o=e,r=h.virtualElements.nextSibling(t);o&&(i=o)!==r;)o=h.virtualElements.nextSibling(i),n(i,o)}function n(t,n){if(t.length){var i=t[0],o=t[t.length-1],r=i.parentNode,a=h.bindingProvider.instance,s=a.preprocessNode;if(s){if(e(i,o,function(e,t){var n=e.previousSibling,r=s.call(a,e);r&&(e===i&&(i=r[0]||t),e===o&&(o=r[r.length-1]||n))}),t.length=0,!i)return;i===o?t.push(i):(t.push(i,o),h.utils.fixUpContinuousNodeArray(t,r))}e(i,o,function(e){1!==e.nodeType&&8!==e.nodeType||h.applyBindings(n,e)}),e(i,o,function(e){1!==e.nodeType&&8!==e.nodeType||h.memoization.unmemoizeDomNodeAndDescendants(e,[n])}),h.utils.fixUpContinuousNodeArray(t,r)}}function i(e){return e.nodeType?e:e.length>0?e[0]:null}function o(e,t,o,r,s){s=s||{};var l=e&&i(e),c=l&&l.ownerDocument,u=s.templateEngine||a;h.templateRewriting.ensureTemplateIsRewritten(o,u,c);var d=u.renderTemplate(o,r,s,c);if("number"!=typeof d.length||d.length>0&&"number"!=typeof d[0].nodeType)throw new Error("Template engine must return an array of DOM nodes");var p=!1;switch(t){case"replaceChildren":h.virtualElements.setDomNodeChildren(e,d),p=!0;break;case"replaceNode":h.utils.replaceDomNodes(e,d),p=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+t)}return p&&(n(d,r),s.afterRender&&h.dependencyDetection.ignore(s.afterRender,null,[d,r.$data])),d}function r(e,n){var i=h.utils.domData.get(e,s);i&&"function"==typeof i.dispose&&i.dispose(),h.utils.domData.set(e,s,n&&n.isActive()?n:t)}var a;h.setTemplateEngine=function(e){if(e!=t&&!(e instanceof h.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");a=e},h.renderTemplate=function(e,n,r,s,l){if(r=r||{},(r.templateEngine||a)==t)throw new Error("Set a template engine before calling renderTemplate");if(l=l||"replaceChildren",s){var c=i(s),u=function(){return!c||!h.utils.domNodeIsAttachedToDocument(c)},d=c&&"replaceNode"==l?c.parentNode:c;return h.dependentObservable(function(){var t=n&&n instanceof h.bindingContext?n:new h.bindingContext(h.utils.unwrapObservable(n)),a=h.isObservable(e)?e():"function"==typeof e?e(t.$data,t):e,u=o(s,l,a,t,r);"replaceNode"==l&&(s=u,c=i(s))},null,{disposeWhen:u,disposeWhenNodeIsRemoved:d})}return h.memoization.memoize(function(t){h.renderTemplate(e,n,r,t,"replaceNode")})},h.renderTemplateForEach=function(e,i,r,a,s){var l,c=function(t,n){l=s.createChildContext(t,r.as,function(e){e.$index=n});var i="function"==typeof e?e(t,l):e;return o(null,"ignoreTargetNode",i,l,r)},u=function(e,t,i){n(t,l),r.afterRender&&r.afterRender(t,e)};return h.dependentObservable(function(){var e=h.utils.unwrapObservable(i)||[];"undefined"==typeof e.length&&(e=[e]);var n=h.utils.arrayFilter(e,function(e){return r.includeDestroyed||e===t||null===e||!h.utils.unwrapObservable(e._destroy)});h.dependencyDetection.ignore(h.utils.setDomNodeChildrenFromArrayMapping,null,[a,n,c,r,u])},null,{disposeWhenNodeIsRemoved:a})};var s=h.utils.domData.nextKey();h.bindingHandlers.template={init:function(e,t){var n=h.utils.unwrapObservable(t());if("string"==typeof n||n.name)h.virtualElements.emptyNode(e);else{var i=h.virtualElements.childNodes(e),o=h.utils.moveCleanedNodesToContainerElement(i);new h.templateSources.anonymousTemplate(e).nodes(o)}return{controlsDescendantBindings:!0}},update:function(e,t,n,i,o){var a,s,l=t(),c=h.utils.unwrapObservable(l),u=!0,d=null;if("string"==typeof c?(s=l,c={}):(s=c.name,"if"in c&&(u=h.utils.unwrapObservable(c["if"])),u&&"ifnot"in c&&(u=!h.utils.unwrapObservable(c.ifnot)),a=h.utils.unwrapObservable(c.data)),"foreach"in c){var p=u&&c.foreach||[];d=h.renderTemplateForEach(s||e,p,c,e,o)}else if(u){var f="data"in c?o.createChildContext(a,c.as):o;d=h.renderTemplate(s||e,f,c,e)}else h.virtualElements.emptyNode(e);r(e,d)}},h.expressionRewriting.bindingRewriteValidators.template=function(e){var t=h.expressionRewriting.parseObjectLiteral(e);return 1==t.length&&t[0].unknown?null:h.expressionRewriting.keyValueArrayContainsKey(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},h.virtualElements.allowedBindings.template=!0}(),h.exportSymbol("setTemplateEngine",h.setTemplateEngine),h.exportSymbol("renderTemplate",h.renderTemplate),h.utils.findMovesInArrayComparison=function(e,t,n){if(e.length&&t.length){var i,o,r,a,s;for(i=o=0;(!n||i<n)&&(a=e[o]);++o){for(r=0;s=t[r];++r)if(a.value===s.value){a.moved=s.index,s.moved=a.index,t.splice(r,1),i=r=0;break}i+=r}}},h.utils.compareArrays=function(){function e(e,o,r){return r="boolean"==typeof r?{dontLimitMoves:r
}:r||{},e=e||[],o=o||[],e.length<=o.length?t(e,o,n,i,r):t(o,e,i,n,r)}function t(e,t,n,i,o){var r,a,s,l,c,u,d=Math.min,p=Math.max,f=[],g=e.length,m=t.length,v=m-g||1,b=g+m+1;for(r=0;r<=g;r++)for(l=s,f.push(s=[]),c=d(m,r+v),u=p(0,r-1),a=u;a<=c;a++)if(a)if(r)if(e[r-1]===t[a-1])s[a]=l[a-1];else{var y=l[a]||b,w=s[a-1]||b;s[a]=d(y,w)+1}else s[a]=a+1;else s[a]=r+1;var x,_=[],C=[],k=[];for(r=g,a=m;r||a;)x=f[r][a]-1,a&&x===f[r][a-1]?C.push(_[_.length]={status:n,value:t[--a],index:a}):r&&x===f[r-1][a]?k.push(_[_.length]={status:i,value:e[--r],index:r}):(--a,--r,o.sparse||_.push({status:"retained",value:t[a]}));return h.utils.findMovesInArrayComparison(C,k,10*g),_.reverse()}var n="added",i="deleted";return e}(),h.exportSymbol("utils.compareArrays",h.utils.compareArrays),function(){function e(e,n,i,o,r){var a=[],s=h.dependentObservable(function(){var t=n(i,r,h.utils.fixUpContinuousNodeArray(a,e))||[];a.length>0&&(h.utils.replaceDomNodes(a,t),o&&h.dependencyDetection.ignore(o,null,[i,t,r])),a.length=0,h.utils.arrayPushAll(a,t)},null,{disposeWhenNodeIsRemoved:e,disposeWhen:function(){return!h.utils.anyDomNodeIsAttachedToDocument(a)}});return{mappedNodes:a,dependentObservable:s.isActive()?s:t}}var n=h.utils.domData.nextKey();h.utils.setDomNodeChildrenFromArrayMapping=function(i,o,r,a,s){function l(e,t){u=g[t],w!==t&&(k[e]=u),u.indexObservable(w++),h.utils.fixUpContinuousNodeArray(u.mappedNodes,i),b.push(u),_.push(u)}function c(e,t){if(e)for(var n=0,i=t.length;n<i;n++)t[n]&&h.utils.arrayForEach(t[n].mappedNodes,function(i){e(i,n,t[n].arrayEntry)})}o=o||[],a=a||{};for(var u,d,p,f=h.utils.domData.get(i,n)===t,g=h.utils.domData.get(i,n)||[],m=h.utils.arrayMap(g,function(e){return e.arrayEntry}),v=h.utils.compareArrays(m,o,a.dontLimitMoves),b=[],y=0,w=0,x=[],_=[],C=[],k=[],D=[],S=0;d=v[S];S++)switch(p=d.moved,d.status){case"deleted":p===t&&(u=g[y],u.dependentObservable&&u.dependentObservable.dispose(),x.push.apply(x,h.utils.fixUpContinuousNodeArray(u.mappedNodes,i)),a.beforeRemove&&(C[S]=u,_.push(u))),y++;break;case"retained":l(S,y++);break;case"added":p!==t?l(S,p):(u={arrayEntry:d.value,indexObservable:h.observable(w++)},b.push(u),_.push(u),f||(D[S]=u))}c(a.beforeMove,k),h.utils.arrayForEach(x,a.beforeRemove?h.cleanNode:h.removeNode);for(var T,E,S=0,M=h.virtualElements.firstChild(i);u=_[S];S++){u.mappedNodes||h.utils.extend(u,e(i,r,u.arrayEntry,s,u.indexObservable));for(var O=0;E=u.mappedNodes[O];M=E.nextSibling,T=E,O++)E!==M&&h.virtualElements.insertAfter(i,E,T);!u.initialized&&s&&(s(u.arrayEntry,u.mappedNodes,u.indexObservable),u.initialized=!0)}c(a.beforeRemove,C),c(a.afterMove,k),c(a.afterAdd,D),h.utils.domData.set(i,n,b)}}(),h.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",h.utils.setDomNodeChildrenFromArrayMapping),h.nativeTemplateEngine=function(){this.allowTemplateRewriting=!1},h.nativeTemplateEngine.prototype=new h.templateEngine,h.nativeTemplateEngine.prototype.constructor=h.nativeTemplateEngine,h.nativeTemplateEngine.prototype.renderTemplateSource=function(e,t,n){var i=!(h.utils.ieVersion<9),o=i?e.nodes:null,r=o?e.nodes():null;if(r)return h.utils.makeArray(r.cloneNode(!0).childNodes);var a=e.text();return h.utils.parseHtmlFragment(a)},h.nativeTemplateEngine.instance=new h.nativeTemplateEngine,h.setTemplateEngine(h.nativeTemplateEngine.instance),h.exportSymbol("nativeTemplateEngine",h.nativeTemplateEngine),function(){h.jqueryTmplTemplateEngine=function(){function e(){if(n<2)throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")}function t(e,t,n){return s.tmpl(e,t,n)}var n=this.jQueryTmplVersion=function(){if(!s||!s.tmpl)return 0;try{if(s.tmpl.tag.tmpl.open.toString().indexOf("__")>=0)return 2}catch(e){}return 1}();this.renderTemplateSource=function(n,o,r){r=r||{},e();var a=n.data("precompiled");if(!a){var l=n.text()||"";l="{{ko_with $item.koBindingContext}}"+l+"{{/ko_with}}",a=s.template(null,l),n.data("precompiled",a)}var c=[o.$data],u=s.extend({koBindingContext:o},r.templateOptions),d=t(a,c,u);return d.appendTo(i.createElement("div")),s.fragments={},d},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){i.write("<script type='text/html' id='"+e+"'>"+t+"</script>")},n>0&&(s.tmpl.tag.ko_code={open:"__.push($1 || '');"},s.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},h.jqueryTmplTemplateEngine.prototype=new h.templateEngine,h.jqueryTmplTemplateEngine.prototype.constructor=h.jqueryTmplTemplateEngine;var e=new h.jqueryTmplTemplateEngine;e.jQueryTmplVersion>0&&h.setTemplateEngine(e),h.exportSymbol("jqueryTmplTemplateEngine",h.jqueryTmplTemplateEngine)}()})}()}(),r("reservio/lang",["jquery"],function(e){return{months:["january","february","march","april","may","june","july","august","september","october","november","december"],days:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],getMonths:function(){if("undefined"==typeof lang)return null;for(var e=[],t=0;t<12;t++)e.push(lang["time-"+this.months[t]]);return e},getMonthsForm1:function(){if("undefined"==typeof lang)return null;for(var e=[],t=0;t<12;t++)e.push(lang["time-1-"+this.months[t]]);return e},getMonthsShort:function(){if("undefined"==typeof lang)return null;for(var e=[],t=0;t<12;t++)e.push(lang["time-"+this.months[t]].substr(0,3));return e},getDays:function(){if("undefined"==typeof lang)return null;for(var e=[],t=0;t<7;t++)e.push(lang["time-"+this.days[t]]);return e},getDaysShort:function(){if("undefined"==typeof lang)return null;for(var e=[],t=0;t<7;t++)e.push(lang["time-1-"+this.days[t]].substr(0,3));return e},get:function(e){return"undefined"==typeof lang?"":"object"==typeof lang[e]?"undefined"!=typeof _reservio.category&&"undefined"!=typeof lang[e][_reservio.category]?lang[e][_reservio.category]:lang[e]["default"]:"undefined"!=typeof lang[e]?lang[e]:""},getByCount:function(t,n){if("undefined"==typeof lang[t])return"";var i="";return e.each(lang[t],function(e,t){return!(e>n)&&void(i=t)}),i},getDuration:function(t){var n=this,i=[],o={years:31536e3,days:86400,hours:3600,minutes:60,seconds:1};return e.each(o,function(e,o){var r=Math.floor(t/o);r>0&&i.push(r+" "+n.getByCount("time-duration-"+e,r)),t%=o}),i.slice(0,2).join(" ")}}}),r("reservio/utils",["jquery","reservio/lang"],function(e,t){var n;return{init:function(){return n=this,Date.prototype.format=function(e){return n.date.formatDate(this,e)},n},getProperty:function(t,n){if(t&&"object"==e.type(t)&&n){for(var i=n.split("."),o=t[i[0]],r=1;r<i.length;r++)o=o[i[r]];return o}return t},enableFormProcessingState:function(t){var n=e(t),i=n.parents("form");i.find("input, select, textarea, button").attr("disabled","disabled"),n.button("loading")},disableFormProcessingState:function(t){var n=e(t),i=n.parents("form");i.find("input, select, textarea, button").removeAttr("disabled"),n.button("reset")},cookie:{set:function(e,t,n){var i=new Date;i.setDate(i.getDate()+n);var o=escape(t)+(null==n?"":"; expires="+i.toUTCString());document.cookie=e+"="+o},get:function(e){var t,n,i,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(n=o[t].substr(0,o[t].indexOf("=")),i=o[t].substr(o[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,""),n==e)return unescape(i);return null}},sdiak:"ÁÂÄĄáâäąČčĆćÇçĈĉĎĐďđÉÉĚËĒĖĘéěëēėęĜĝĞğĠġĢģĤĥĦħÍÎíîĨĩĪīĬĭĮįİıĴĵĶķĸĹĺĻļĿŀŁłĹĽĺľŇŃŅŊŋņňńŉÓÖÔŐØŌōóöőôøŘřŔŕŖŗŠšŚśŜŝŞşŢţŤťŦŧŨũŪūŬŭŮůŰűÚÜúüűŲųŴŵÝYŶŷýyŽžŹźŻżß",bdiak:"AAAAaaaaCcCcCcCcDDddEEEEEEEeeeeeeGgGgGgGgHhHhIIiiIiIiIiIiIiJjKkkLlLlLlLlLLllNNNNnnnnnOOOOOOooooooRrRrRrSsSsSsSsTtTtTtUuUuUuUuUuUUuuuUuWwYYYyyyZzZzZzs",removeDiak:function(e){for(var t="",i=0;i<e.length;i++)t+=n.sdiak.indexOf(e.charAt(i))!=-1?n.bdiak.charAt(n.sdiak.indexOf(e.charAt(i))):e.charAt(i);return t},normalizeString:function(e){return n.removeDiak(e.toLowerCase())},undef:function(e){return"undefined"==typeof e},boolToInt:function(e){return e?1:0},hexToRgb:function(e){return{r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)}},rgbToHex:function(e){var t=1==e.r.toString(16).length?"0"+e.r.toString(16):e.r.toString(16),n=1==e.g.toString(16).length?"0"+e.g.toString(16):e.g.toString(16),i=1==e.b.toString(16).length?"0"+e.b.toString(16):e.b.toString(16);return"#"+t+n+i},arrayFirst:function(t,n){var i=null;return e.each(t,function(e,t){if(n(t,e))return i=t,!1}),i},linearInterpolation:function(e,t,i){var e=n.hexToRgb(e),t=n.hexToRgb(t);return n.rgbToHex({r:parseInt(e.r*i+t.r*(1-i)),g:parseInt(e.g*i+t.g*(1-i)),b:parseInt(e.b*i+t.b*(1-i))})},getFbPhoto:function(e){return e?"https://graph.facebook.com/"+e+"/picture":"https://static.reservio.com/img/profile.png"},getFbPhotoUrl:function(t,i,o){var r;if(0!=t&&null!=t)r=e(e("#profile-photo").html().trim()),r.attr("src",n.getFbPhoto(t));else{r=e(e("#profile-no-photo").html().trim());var a=n.encodeHTML(o).trim().split(" ");if(a.length>1)r.text((a[0][0]+a[a.length-1][0]).toUpperCase());else{var o=a[0];o.length>0&&(o=o[0].toUpperCase()+o.substr(1,1),r.text(o))}r.addClass("c"+i%9)}return r},shadeColor:function(e,t){var n=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16);n=parseInt(n*(100+t)/100),i=parseInt(i*(100+t)/100),o=parseInt(o*(100+t)/100),n=n<255?n:255,i=i<255?i:255,o=o<255?o:255;var r=1==n.toString(16).length?"0"+n.toString(16):n.toString(16),a=1==i.toString(16).length?"0"+i.toString(16):i.toString(16),s=1==o.toString(16).length?"0"+o.toString(16):o.toString(16);return"#"+r+a+s},colorById:[],currenciesByCode:{usd:"$",czk:"Kč",eur:"€",gbp:"£",aud:"$",nzd:"$",brl:"R$",cad:"$",hrk:"kn",dkk:"kr",huf:"ft",isk:"kr",jpy:"¥",pln:"zł",rub:"руб",sek:"kr",chf:"Fr",nok:"kr",inr:"₨",vnd:"₫",zar:"R",clp:"Ch$",sgd:"S$",hkd:"HK$"},formatCurrency:function(e,t){e=e.toLowerCase();var i=n.currenciesByCode[e];return void 0===i?t+" "+e.toUpperCase():["usd","brl","ars","cad","nzd","aud","uyu","bob","vef","pen","mxn","chf","gbp"].indexOf(e)>=0?i+t:t+" "+i},notify:function(e,t){(new Hydra.action).notify({type:e,data:t})},nl2br:function(e,t){var n=t||"undefined"==typeof t?"<br />":"<br>";return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+n+"$2")},encodeHTML:function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):""},leadingZeros:function(e,t){for(var n=""+e;n.length<t;)n="0"+n;return n},is_string:function(e){return"string"==typeof e},is_number:function(e){return!isNaN(e-0)},formToObject:function(t){var n={};return e.each(e(t).serializeArray(),function(){"undefined"!=typeof this.name&&(n[this.name]=this.value)}),n},selectText:function(e){var t,n,i=document;i.body.createTextRange?(t=i.body.createTextRange(),t.moveToElementText(e),t.select()):window.getSelection&&(n=window.getSelection(),t=i.createRange(),t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t))},Currencies:{usd:"US dollar ($)",czk:"Česká koruna (Kč)",eur:"Euro (€)",gbp:"Brittish pound (£)",aud:"Australian dollar ($)",nzd:"New Zealand dollar ($)",brl:"Brazilian real (R$)",cad:"Canadian dollar ($)",hrk:"Croatian kuna (kn)",dkk:"Danish krone (kr)",huf:"Hungarian forint (ft)",isk:"Icelandic króna (kr)",jpy:"Japanese yen (¥)",pln:"Złoty (zł)",rub:"Russian ruble (руб)",sek:"Swedish krona (kr)",chf:"Schweizer Franken (Fr)",nok:"Norwegian krone (kr)",inr:"Indian rupee (₨)",vnd:"Vietnamese dong (₫)",zar:"South African rand (R)",clp:"Pesos Chilenos (Ch$)",sgd:"Singapore dollar (S$)",hkd:"Hong Kong dollar (HK$)"},validators:{time:function(e,t){return t=t||"24","12"==t?/^(1[012]|[1-9]):[0-5][0-9](\\s)?(am|pm)$/i.test(e):/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/i.test(e)},email:function(e){return n.is_string(e)&&(""==e||/^([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.+-]+\.[a-zA-Z]{2,8})*$/i.test(e))},phone:function(e,t){return t=t||"en",n.is_string(e)&&(""==e||/^\d{7,}$/.test(e.replace(/[\s()+\-\.]|ext/gi,"")))},url:function(e){return n.is_string(e)&&(""==e||/^(ftp:\/\/|http:\/\/|https:\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!-\/]))?$/i.test(e))}},date:{second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:31536e6,defaults:{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},encode:function(e){return this.formatDate(e,"yyyy-MM-dd HH:mm:ss")},decode:function(e){var t=e.split(/\D/);return new Date((+t[0]),(--t[1]),(+t[2]),(+t[3]),(+t[4]),(+t[5]))},encodeDate:function(e){return this.formatDate(e,"yyyy-MM-dd")},decodeDate:function(e){var t=e.split(/\D/);return new Date((+t[0]),(--t[1]),(+t[2]))},getDateObject:function(e){return void 0!==e.getTime?e:e==parseInt(e)?new Date(1e3*parseInt(e)):new Date(e)},convertTimezone:function(e,t){var n=(new Date).getTimezoneOffset(),i=e.getTime()+6e4*n;return console.log((e.getTime()-i-t*this.second)/this.hour),new Date(i+t*this.second)},formatDuration:function(e,i){if(i=i||"standard",null===e)return"";if("undefined"==typeof e.getTime){e=e||0;var o=parseInt(e%60);e/=60;var r=parseInt(e%60);e/=60;var a=parseInt(e%60);e/=60}else var o=e.getSeconds(),r=e.getMinutes(),a=e.getHours();if("short"==i){return a>=2?a+" "+t.get("time-hoursShort"):(r+=60*a,r>=2?r+" "+t.get("time-minutesShort"):(o+=60*r,o+" "+t.get("time-secondsShort")))}if("standard"==i)return n.leadingZeros(a,2)+":"+n.leadingZeros(r,2);if(24==a)return 12==i?"12:00 am":"24:00";var s=new Date(1,1,2e3,a,r,o),l="H:mm";return 12==i&&(l="h:mm tt"),s.format(l)},timeToSeconds:function(e){var t=e.match(/([0-9]{2}):([0-9]{2})\s*(am|pm)?$/i);return 3600*t[1]+60*t[2]},durationToSeconds:function(e){if(e){var t=e.match(/([0-9]{1,2})(([\,\.\:\s]([0-9]{1,2})))?\s*(am|pm)?/i);if(t){var n=+t[1],i=+t[4]||0,o=t[5]||"am";return t[5]&&12==n&&(n=0),"pm"==o&&(n+=12),3600*n+60*i}}return null},repairTime:function(e,t){t=t||24,e=e.toString();var n=e.match(/([0-9]{1,2})(([\,\.\:\s]([0-9]{1,2})))?\s*(am|pm)?/i);if(n)var i=+n[1],o=+n[4]||0,r=n[5];r&&(i="pm"==r?12==i?i:i+12:12==i?0:i);var a="H:mm",s=new Date;return 12==t&&(a="h:mm tt"),24==i?12==t?"12:00 am":"24:00":(s.setHours(i,o,0,0),s.format(a))},getDatePattern:function(e){switch(e){case"mdy":return"MM/dd/yyyy";case"ymd":return"yyyy.M.d.";case"dmy":default:return"d.M.yyyy"}},getTimePattern:function(e,t){return t=t||!1,12==e?t?"h{:mm} tt":"h:mm tt":"H:mm"},getDateTimePattern:function(e,t){return n.date.getDatePattern(e)+", "+n.date.getTimePattern(t)},getTimeRangePattern:function(e){return n.date.getTimePattern(e)+"{ - "+n.date.getTimePattern(e)+"}"},formatTime:function(e,t){return t=t||24,void 0===e.getTime&&(e=new Date(1e3*parseInt(e))),n.date.formatDate(e,n.date.getTimePattern(t))},formatters:{dur:function(e){return n.date.formatDuration(e)},DUR:function(e){return n.date.formatDuration(e,"short")},s:function(e){return e.getSeconds()},ss:function(e){return n.leadingZeros(e.getSeconds(),2)},m:function(e){return e.getMinutes()},mm:function(e){return n.leadingZeros(e.getMinutes(),2)},h:function(e){return e.getHours()%12||12},hh:function(e){return n.leadingZeros(e.getHours()%12||12,2)},H:function(e){return e.getHours()},HH:function(e){return n.leadingZeros(e.getHours(),2)},d:function(e){return e.getDate()},dd:function(e){return n.leadingZeros(e.getDate(),2)},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return n.leadingZeros(e.getMonth()+1,2)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},mmmm:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return(e.getFullYear()+"").substring(2)},yyyy:function(e){return e.getFullYear()},t:function(e){return e.getHours()<12?"a":"p"},tt:function(e){return e.getHours()<12?"am":"pm"},T:function(e){return e.getHours()<12?"A":"P"},TT:function(e){return e.getHours()<12?"AM":"PM"},u:function(e){return n.formatDate(e,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(e){var t=e.getDate();return t>10&&t<20?"th":["st","nd","rd"][t%10-1]||"th"}},formatDates:function(e,i,o,r){r="undefined"!=typeof t?r||{dayNamesShort:t.getDaysShort()||n.date.defaults.dayNamesShort,dayNames:t.getDays()||n.date.defaults.dayNames,monthNames:t.getMonths()||n.date.defaults.monthNames,monthNamesForm1:t.getMonthsForm1()||n.date.defaults.monthNames,monthNamesShort:t.getMonthsShort()||n.date.defaults.monthNamesShort}:r||n.date.defaults;var a,s,l,c,u=e,d=i,p=o.length,f="";for(a=0;a<p;a++)if(s=o.charAt(a),"'"==s){for(l=a+1;l<p;l++)if("'"==o.charAt(l)){u&&(f+=l==a+1?"'":o.substring(a+1,l),a=l);break}}else if("("==s){for(l=a+1;l<p;l++)if(")"==o.charAt(l)){var h=n.date.formatDate(u,o.substring(a+1,l),r);parseInt(h.replace(/\D/,""),10)&&(f+=h),a=l;break}}else if("["==s){for(l=a+1;l<p;l++)if("]"==o.charAt(l)){var g=o.substring(a+1,l),h=n.date.formatDate(u,g,r);h!=n.date.formatDate(d,g,r)&&(f+=h),a=l;break}}else if("{"==s)u=i,d=e;else if("}"==s)u=e,d=i;else{for(l=p;l>a;l--)if(c=n.date.formatters[o.substring(a,l)]){u&&(f+=c(u,r)),a=l-1;break}l==a&&u&&(f+=s)}return f},formatDate:function(e,t,n){return null==e?"":"r"===t?new Date(e.getTime()):this.formatDates(e,null,t,n)},timeRange:function(e,t,n){for(var i=[],o=e;o<t;o+=n)i.push(o);return i},equalDate:function(e,t){return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},create:function(e){var t=e.match(/(\d+)-(\d+)-(\d+)\s+(\d+):(\d+):(\d+)/);return new Date((+t[1]),+t[2]-1,(+t[3]),(+t[4]),(+t[5]),100*+t[6])},getTimezones:function(){return e.map(_reservio.timezones,function(e,t){return{code:t,text:e}})}}}.init()}),String.prototype.format=function(e){var t=this,n=t.match(/\[[^\[\]]*\{([\w]+)\}[^\[\]]*\]/g);if(n)for(var i=0;i<n.length;i++){var o=n[i],r=o.match(/{(\w+)}/);t="undefined"!=typeof e[r[1]]&&e[r[1]]?t.replace(o,o.substring(1,o.length-1)):t.replace(o,"")}for(key in e){var a=e[key];null!==a&&(t=t.replace("{!"+key+"}",a.toString()),t=t.replace("{"+key+"}",a.toString().escapeHtml()))}return t},String.prototype.escapeHtml=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},String.prototype.toSeconds=function(){var e=this.split(":");return 60*parseInt(e[0],10)*60+60*parseInt(e[1],10)},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},Date.prototype.getWeekStart=function(e){e=void 0!==e?e:_reservio.weekStart;var t=new Date(this.getTime());if(0==e){var n=this.getDay(),i=this.getDate()-n+(0==n?-6:1);t.setDate(i)}else{var n=this.getDay()||7;1!==n&&t.setHours(-24*(n-1))}return t},Date.prototype.getTimeS=function(){return parseInt(this.getTime()/1e3)},Date.prototype.clearTime=function(){this.setHours(0,0,0,0)},Date.prototype.getDuration=function(){return 60*this.getHours()*60+60*this.getMinutes()+this.getSeconds()},function(e){var t="placeholder"in document.createElement("input"),n=["-moz-box-sizing","-webkit-box-sizing","box-sizing","padding-top","padding-right","padding-bottom","padding-left","margin-top","margin-right","margin-bottom","margin-left","border-top-width","border-right-width","border-bottom-width","border-left-width","line-height","font-size","font-family","width","height","top","left","right","bottom"],i=function(t,i){var o,r,a,s,l,c,u,d,p=e(t);try{if(u=p[0].getAttributeNode("placeholder"),!u)return;if(r=p[0].getAttribute("placeholder"),!r||!r.length)return;p[0].setAttribute("placeholder",""),p.data("placeholder",r)}catch(f){return}for(a={},o=0;o<n.length;o++)a[n[o]]=p.css(n[o]);s=parseInt(p.css("z-index"),10),!isNaN(s)&&s||(s=1),d=e("<span>").addClass("placeholder").html(r),d.css(a),d.css({cursor:p.css("cursor")||"text",display:"block",position:"absolute",overflow:"hidden","z-index":s+1,background:"none","border-top-style":"solid","border-right-style":"solid","border-bottom-style":"solid","border-left-style":"solid","border-top-color":"transparent","border-right-color":"transparent","border-bottom-color":"transparent","border-left-color":"transparent"}),d.insertBefore(p),c=p.offset().top-d.offset().top,l=parseInt(d.css("margin-top")),isNaN(l)&&(l=0),d.css("margin-top",l+c),d.on("mousedown",function(){p.is(":enabled")&&window.setTimeout(function(){p.trigger("focus")},0)}),p.on("focus.placeholder",function(){d.hide()}),p.on("blur.placeholder",function(){d.toggle(!e.trim(p.val()).length)}),p[0].onpropertychange=function(){"value"===event.propertyName&&p.trigger("focus.placeholder")},p.trigger("blur.placeholder")};e.fn.placeholder=function(e){var n=this;return e=e||{},t&&!e.force?this:(window.setTimeout(function(){n.each(function(){var t=this.tagName.toLowerCase();"input"!==t&&"textarea"!==t||i(this,e)})},0),this)}}(jQuery),r("placeholder",["jquery"],function(){}),r("ko",["knockout","reservio/utils","reservio/lang","placeholder"],function(e,t,n){function i(t){function n(e,n){n=n||!1;var i=!1;return $.each(t.validators,function(o,r){if((n||r.realtime)&&!r.fnc(e))return i=!0,t.errorMessage(r.message),!1}),t.hasError(i),!i}"undefined"==typeof t.validators&&(t.validators={},t.hasError=e.observable(),t.errorMessage=e.observable(),t.addValidator=function(e,n,i,o){t.validators[e]={fnc:n,message:i,realtime:o}},"function"==typeof t.temp?(t.temp.subscribe(n),t.isValid=function(){return n(t.temp(),!0)},n(t.temp())):(t.subscribe(n),t.isValid=function(){return n(t(),!0)},n(t())))}e.observableArray.fn.map=function(t,n){var i=e.utils.arrayMap(t,function(e){return new n(e)});return this(i),this},e.observable.fn.focusable=function(t){return void 0===this.focused&&(this.focused=e.observable(t)),this};var o=function(t,n,i,o){return o=o||!1,"undefined"==typeof this.validators&&(this.validators={},this.errors=[],this.hasError=e.observable(),this.errorMessage=e.observable(),this.isValid=function(t){var n=this;t=t||!1;var i=!1;return this.errors=[],$.each(this.validators,function(o,r){if((t||r.realtime)&&!r.fnc.call(n,e.utils.unwrapObservable(n)))return i=!0,n.errorMessage(r.message),n.errors.push(o),!1}),this.hasError(i),!i}.bind(this),this.subscribe(function(e){this.isValid()},this),this.focusable(),this.isValid()),this.validators[t]={fnc:n,message:i,realtime:o},this};e.observable.fn.addValidator=o,e.observableArray.fn.addValidator=o,e.observable.fn.minLength=function(e,t,n){return n=n||!1,t=t||"Minimal length is "+e,this.addValidator("minLength",function(t){return t.length>=e},t,n),this},e.observable.fn.maxLength=function(e,t){},e.observable.fn.minValue=function(e,t,n){return n=n||!1,t=t||"Minimal value is "+e,this.addValidator("minValue",function(t){return+t>=+e},t,n),this},e.observable.fn.maxValue=function(e,t,n){return n=n||!1,t=t||"Maximal value is "+e,this.addValidator("maxValue",function(t){return+t<=+e},t,n),this},e.observable.fn.required=function(e,t){return t=t||!1,e=e||"This field is required",this.addValidator("required",function(e){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,"")),""!=e&&null!=e},e,t),this},e.observable.fn.email=function(e,i){return i=i||!1,e=e||n.get("error-email-format"),this.addValidator("email",function(e){return!e||t.validators.email(e)},e,i),this},e.observable.fn.phone=function(e,i){return i=i||!1,e=e||n.get("error-phone-format"),this.addValidator("phone",function(e){return!e||t.validators.phone(e)},e,i),this},e.observable.fn.url=function(e,i){return i=i||!1,e=e||n.get("error-url-format"),this.addValidator("url",function(e){return!e||t.validators.url(e)},e,i),this},e.observable.fn.duration=function(n,i){return this.formatted=e.computed({read:function(){return this()?t.date.formatDuration(this(),_reservio.timeFormat):t.date.formatDuration(0,_reservio.timeFormat)},write:function(e){this(t.date.durationToSeconds(t.date.repairTime(e,_reservio.timeFormat)))},owner:this}),this},e.observable.fn.decimal=function(t){return this.formatted=e.computed({read:this,write:function(e){e=parseFloat(e.toString().replace(/[^\.,\d]/g,"").replace(",",".")),console.log(e),isNaN(e)&&(e=0),e=e.toFixed(2),"00"==e.slice(-2)&&(e=e.slice(0,-3)),this(e),this.notifySubscribers(e)},owner:this}),this.formatted(this()),this};var r=function(n,i){return this.options=n,this.selectedOption=e.computed({read:function(){var n=this;return i?e.utils.arrayFirst(this.options,function(e){return n()==t.getProperty(e,i)}):this()},write:function(e){this(i?t.getProperty(e,i):e)},owner:this}),this};e.observable.fn.setOptions=r,e.computed.fn.setOptions=r,e.form=function(t,n,i){function o(t,n,i){this.data={},this.dataBackup=null,this.formName=i,t.call(this),this.init(),e.utils.extend(this,n)}return o.prototype.init=function(){for(var t in this.data)"undefined"!==this.data[t].changed&&(this.data[t].changed=e.observable(!1),this.data[t].subscribe(function(e){this.changed(!0)},this.data[t]))},o.prototype.backup=function(){this.reset(),this.dataBackup=e.utils.unwrapVar(this.toJS())},o.prototype.restore=function(){this.update(this.dataBackup),this.reset()},o.prototype.reset=function(){for(var e in this.data)this.data[e].changed(!1)},o.prototype.toJS=function(){return e.toJS(this.data)},o.prototype.isValid=function(){var e=!0;for(var t in this.data)"function"==typeof this.data[t].isValid&&(e&=this.data[t].isValid());return e},o.prototype.changed=function(){for(var e in this.data)if(this.data[e].changed())return!0;return!1},o.prototype.update=function(e){var t=this;$.each(e,function(e,n){t.data[e](n),t.data[e].changed(!1)})},o.prototype.getErrors=function(){var e={};for(var t in this.data)this.data[t].errors&&this.data[t].errors.length>0&&(e[t]=this.data[t].errors);return e},new o(t,n,i)},e.bindingHandlers.selectedOption={update:function(n,i,o){var r=e.utils.unwrapObservable(i()),a=e.utils.unwrapObservable(o()),s=a.selectedProp||"",l=a.displayProp||"",c=e.utils.arrayFirst(i().options,function(e){return t.getProperty(e,s)==r});$(n).text(c?t.getProperty(c,l):"")}},e.timeObservableNew=function(t,i,o){var r=e.observable(t||(new Date).getTimeS());return i=i||n.get("time-date"),o=o||n.get("time-time"),r.date=e.computed({read:function(){return this.getMoment().format(i)},write:function(e){var t=moment(e,i),n=this.getMoment();n.year(t.year()).month(t.month()).date(t.date()),this(n.unix())},owner:r}),r.time=e.computed({read:function(){return this.getMoment().format(o)},write:function(e){var t=moment(e,o),n=this.getMoment();n.hour(t.hour()).minute(t.minute()).second(t.second()),this(n.unix())},owner:r}),r.getMoment=function(){return moment(this(),"X")}.bind(r),r},e.bindingHandlers.processingForm={update:function(n,i){var o=e.utils.unwrapObservable(i()),r=$(n),a=t.is_string(o)?r.find(o):r.find('[type="submit"], .submit');o?($(n).find('input, select, textarea, [type="submit"]').attr("disabled","disabled"),a.button("loading")):($(n).find('input, select, textarea, [type="submit"]').removeAttr("disabled"),a.button("reset"))}},e.bindingHandlers.valueKeep={init:function(t,n,i,o){var r=t.getAttribute("value");e.bindingHandlers.value.init(t,n,i,o),n()(r)},update:e.bindingHandlers.value.update},e.bindingHandlers.colorPicker={colors:[{id:0,hex:"#1263bb"},{id:1,hex:"#169bbf"},{id:2,hex:"#18c286"},{id:3,hex:"#54c219"},{id:4,hex:"#c3a619"},{id:5,hex:"#bc5413"},{id:6,hex:"#b70e0e"},{id:7,hex:"#b80f77"},{id:8,hex:"#960fb8"}],init:function(t,n,i,o){var r=$(t),a=n(),s=i();r.addClass("colorPicker").on("click","li",function(){var t=e.bindingHandlers.colorPicker.colors[$(this).index()];a(t.id),a.notifySubscribers(t.id),"function"==typeof s.colorPickerClick&&s.colorPickerClick(t.id)}).append($.map(e.bindingHandlers.colorPicker.colors,function(e){var t=$("<li>").addClass("colorPicker-item");return e.hex?t.css({background:e.hex}):t.addClass("colorPicker-noColor"),t}))},update:function(t,n,i,o){var r=($(t),n()());$.each(e.bindingHandlers.colorPicker.colors,function(e,n){if(n.id==r)return $(t).find("li").removeClass("selected").eq(e).addClass("selected"),!1})}},e.bindingHandlers.selected={update:function(t,n,i,o){var r="selected";1==e.utils.unwrapObservable(n())?$(t).addClass(r):$(t).removeClass(r)}},e.protectedObservable=function(t){var n=e.observable(t),i=e.observable(t),o=e.computed({read:function(){return n()},write:function(e){i(e)}});return o.commit=function(){i()!==n()&&n(i())},o.reset=function(){n.valueHasMutated(),i(n())},o.isValid=function(){return!0},o.temp=i,o},e.protectedObservableArray=function(t,n){var i=e.observableArray(t),o=e.observableArray(e.toJS(t));return i.commit=function(){o(e.toJS(i()))},i.reset=function(){var t=o();i(n?e.utils.arrayMap(t||[],function(e){return n(e)}):e.toJS(t))},i},e.bindingHandlers.lang={init:function(e,t,n,i){},update:function(e,t,i,o){var r=t(),a=i().langParams||{};$(e).html(n.get(r).format(a))}},e.bindingHandlers.foreachWithSelected={init:function(t,n,i,o){var r=n(),a=function(){return function(){r.afterRender=function(e,t){t===r.selected()&&$(e).addClass("selected"),$(e).click(function(){r.selected(t)})}}};e.bindingHandlers.foreach.init(t,a,i,o)},update:function(t,n,i,o){e.bindingHandlers.foreach.update(t,n,i,o)}},e.bindingHandlers.buttonClick={init:function(e,t,n,i){var o=t();$(e).click(function(e){var t=$(this).attr("disabled");"undefined"!=typeof t&&t!==!1||o.call(i,i,e)})}},e.bindingHandlers.indicator={update:function(t,n){var i=e.utils.unwrapObservable(n()),o=100*i.count()/i.limit();o>100&&(o=100);var r="red";r=o<50?"grey":o<75?"orange":"red",o<.1?$(t).css("border-width",0):$(t).css("border-width",1),$(t).removeClass("red grey orange").addClass(r).width(o+"%")}},e.bindingHandlers.colorClassByPercent={update:function(t,n){var i=e.utils.unwrapObservable(n()),o="red";o=i<50?"grey":i<75?"orange":"red",$(t).removeClass("red grey orange").addClass(o)}},e.historyObservable=function(t){var n=e.observable(t),i=e.observable(t);return i.save=function(){n(i())},i.revert=function(){i(n())},i},e.bindingHandlers.slideVisible={init:function(e,t,n){},update:function(t,n){var i=e.utils.unwrapObservable(n());i?$(t).slideDown():$(t).hide()}},e.bindingHandlers.slideIn={init:function(t,n){var i=e.utils.unwrapObservable(n());$(t).toggle(i)},update:function(t,n){var i=e.utils.unwrapObservable(n());i?$(t).slideDown():$(t).slideUp()}},e.bindingHandlers.profilePicture={init:function(e,t,n){},update:function(n,i){var o=e.utils.unwrapObservable(i()),r=e.utils.unwrapVar(o.name),a=e.utils.unwrapVar(o.fb_id),s=e.utils.unwrapVar(o.id);$(n).html(t.getFbPhotoUrl(a,s,r))}},e.bindingHandlers.datePicker={init:function(n,i,o){var r=i(),a=o(),s=e.utils.unwrapObservable(a.value)||"";if(void 0===s.getTime){var l=s.match(/^(\d{1,4})[.\/-](\d{1,2})[.\/-](\d{1,4})\.?$/);l?"mdy"==_reservio.dateFormat?r.selectedDate=new Date((+l[3]),+l[1]-1,(+l[2])):"ymd"==_reservio.dateFormat?r.selectedDate=new Date((+l[1]),+l[2]-1,(+l[3])):r.selectedDate=new Date((+l[3]),+l[2]-1,(+l[1])):r.selectedDate=new Date}else r.selectedDate=s;$(n).val(e.utils.unwrapObservable(a.value)),r.dayClick=function(e){if(r.append)a.value(new Date(e.getTime()));else{var i=t.date.formatDate(e,t.date.getDatePattern(_reservio.dateFormat));$(n).is("input")&&$(n).val(i).trigger("change")}},$(n).datePicker(r)},update:function(t,n,i){var o=n(),r=e.utils.unwrapObservable(i().value);if(o.append)$(t).data("datePicker").setDate(new Date(r.getTime()));else{var a=$(t).val().match(/^(\d{1,2})[.\/-](\d{1,2})[.\/-](\d{4})$/);a?"mdy"==_reservio.dateFormat?$(t).data("datePicker").setDate(new Date((+a[3]),+a[1]-1,(+a[2]))):$(t).data("datePicker").setDate(new Date((+a[3]),+a[2]-1,(+a[1]))):$(t).data("datePicker").setDate(new Date)}}},e.bindingHandlers.timePicker={init:function(n,i,o){var r=i(),a=o(),s=a.selectboxOptions||{};s.valueProp="time",s.textProp="text";for(var l=[],c=new Date,u=0;u<1440;u+=s.interval)c.setHours(u/60,u%60,0,0),l.push({time:c.format(12==_reservio.timeFormat?"h:mm tt":"H:mm"),text:c.format(12==_reservio.timeFormat?"h:mm tt":"H:mm")});l.push({time:12==_reservio.timeFormat?"12:00 am":"24:00",text:12==_reservio.timeFormat?"12:00 am":"24:00"});var d=e.computed({
read:r,write:function(e){var n=(r(),t.date.repairTime(e,_reservio.timeFormat));r(n)},owner:r});d.setOptions(l,"time"),a.selectboxOptions=s,e.bindingHandlers.value.init(n,function(){return d},o),e.bindingHandlers.selectbox.init(n,function(){return d},function(){return a})},update:function(t,n,i){var o=n()();e.bindingHandlers.selectbox.update(t,function(){return o},i)}},e.bindingHandlers.durationPicker={init:function(n,i,o){var r=i(),a=o(),s=a.selectboxOptions;s.valueProp="duration",s.textProp="text";for(var l=[],c=5;c<=720;)l.push({duration:t.date.formatDuration(60*c),text:t.date.formatDuration(60*c,"short")}),c+=c<15?5:c<120?15:60;var u=e.computed({read:r,write:function(e){var n=r(),i=t.date.durationToSeconds(t.date.repairTime(e));i!==n?r(i):e!==n&&r.notifySubscribers(i)},owner:r});u.setOptions(l,"duration"),a.selectboxOptions=s,e.bindingHandlers.value.init(n,function(){return u},o),e.bindingHandlers.selectbox.init(n,function(){return u},function(){return a})},update:function(n,i,o){var r=t.date.formatDuration(i()());e.bindingHandlers.selectbox.update(n,function(){return r},function(){return{selectboxOptions:{}}})}},e.bindingHandlers.selectbox={init:function(n,i,o){var r=i(),a=o().selectboxOptions||{};a.items=function(){return console.log(r.options),r.options},a.textProp&&(a.onRender||(a.onRender=function(n,i){n.text(t.getProperty(e.utils.unwrapVar(i),a.textProp))})),a.onSelect||(a.onSelect=function(i,o){var s=e.utils.unwrapObservable(t.getProperty(o,a.valueProp)),l=e.utils.unwrapObservable(t.getProperty(o,a.textProp));$(n).val(l),r(s)}),"undefined"!=typeof o().appendTo&&(a.appendTo=o().appendTo),$(n).selectBox(a)},update:function(n,i,o){var r=i(),a=o().selectboxOptions||{};a.textProp?r.selectedOption()?$(n).val(e.utils.unwrapObservable(t.getProperty(r.selectedOption(),a.textProp))):$(n).val(a.defaultText||"Select..."):$(n).val(r)}},e.bindingHandlers.href={update:function(t,n,i){$(t).attr("href",e.utils.unwrapObservable(n()))}},e.bindingHandlers.checkBox={init:function(n,i,o){var r=i();r.type="checkbox",r.items=e.utils.unwrapVar(r.items),r.itemTemplate='<li><input type="checkbox" class="value" /> <span class="text"></span></li>',r.indexByValue=function(e,t){return-1},r.onRender=function(n,i){n.find(".text").text(e.utils.unwrapObservable(t.getProperty(i,r.textProp))),n.find("input").attr("checked",null!=e.utils.arrayFirst(r.selected(),function(e){return e==t.getProperty(i,r.valueProp)}))},r.onSelect=function(e,n,i){r.selected.remove(function(e){return e==t.getProperty(n,r.valueProp)}),i&&r.selected.push(t.getProperty(n,r.valueProp))},"undefined"!=typeof o().appendTo&&(r.appendTo=o().appendTo),$(n).selectBox(r)}},e.bindingHandlers.locationSearch={init:function(e,t,n,i,o){var r=t(),a=n(),s=new google.maps.places.AutocompleteService;r.items=function(e,t){s.getQueryPredictions({input:e},function(e){t(e?e.slice(0,5):[])})},r.onSelect=r.onSelect.bind(o.$data),r.type="search",r.onFetch=function(e){return e},r.onRender=function(e,t){e.text(t.description)},r.cls="google-places",r.timeout=50,r.maxHeight=250,"undefined"!=typeof a.appendTo&&(r.appendTo=a.appendTo),$(e).selectBox(r)}},e.bindingHandlers.searchbox={init:function(n,i,o){var r=i(),a=o();if(r.textProp&&!$.isArray(r.selected())){var s=r.selected();s?$(n).val(t.getProperty(e.utils.unwrapVar(r.selected()),r.textProp)):r.defaultText?$(n).val(r.defaultText):$(n).val("Select..."),r.onRender||(r.onRender=function(n,i){n.text(t.getProperty(e.utils.unwrapVar(i),r.textProp))}),r.onSelect||(r.onSelect=function(e,t){r.selected(t)})}"undefined"!=typeof a.appendTo&&(r.appendTo=a.appendTo),$(n).selectBox(r)}},e.bindingHandlers.formatDuration={update:function(n,i,o,r){var a=i(),s=(o(),e.utils.unwrapObservable(a));$(n).text(t.date.formatDuration(s,_reservio.timeFormat))}},e.bindingHandlers.formatDate={update:function(n,i,o,r){var a=e.utils.unwrapObservable(i()),s=o(),l=s.dateFormat||_reservio.dateFormat,c=$(n);c.is("input")?$(n).val(t.date.formatDate(a,t.date.getDatePattern(l))):$(n).text(t.date.formatDate(a,t.date.getDatePattern(l)))}},e.bindingHandlers.formatDateTime={update:function(n,i,o){var r=e.utils.unwrapObservable(i()),a=o(),s=a.dateFormat||_reservio.dateFormat,l=a.timeFormat||_reservio.timeFormat;$(n).text(t.date.formatDate(r,t.date.getDatePattern(s)+", "+t.date.getTimePattern(l)))}},e.bindingHandlers.formatTime={update:function(n,i,o){var r=e.utils.unwrapObservable(i()),a=o(),s=a.timeFormat||_reservio.timeFormat;$(n).text(t.date.formatDate(r,t.date.getDatePattern(s)))}},e.bindingHandlers.formatDateRange={update:function(n,i,o,r){var a=i(),s=(o(),e.utils.unwrapObservable(a.from)),l=e.utils.unwrapObservable(a.to)||new Date;t.is_string(s)&&(s=new Date(1e3*parseInt(s))),t.is_string(l)&&(l=new Date(1e3*parseInt(l)));var c=a.pattern||"(HH:mm )MM/dd/yyyy - {(HH:mm )MM/dd/yyyy}";$(n).html(t.date.formatDates(s,l,c))}},e.bindingHandlers.openingHour={init:function(n,i,o,r){function a(e,n){var i=$($(this).find(".ui-slider-handle").get(0)),o=$($(this).find(".ui-slider-handle").get(1));i.html('<div class="value min">'+t.date.formatDuration(e,_reservio.timeFormat)+"</div>"),o.html('<div class="value max">'+t.date.formatDuration(n,_reservio.timeFormat)+"</div>"),e==n&&(i.html('<div class="value min"></div>'),o.html('<div class="value max">'+u+"</div>"))}function s(e){return $(e.handle).find("div").hasClass("min")?"start":$(e.handle).find("div").hasClass("max")?"end":void 0}var l=$(n),c=i();c.onChange=c.onChange||function(){},c.onStop=c.onStop||function(){};var u=c.noBreakText||"No break",d=$("<div></div>").addClass("slider day"),p=$("<div></div>").addClass("slider break");l.append(d),l.append(p),d.slider({range:!0,step:900,min:0,max:86400,slide:function(e,t){var n=t.values,i=p.slider("values");return(0==c.breaks()||!(i[0]<n[0]+1800||i[1]>n[1]-1800))&&(!(n[0]>=n[1]-1800)&&(c.start(n[0]),c.end(n[1]),a.call(this,n[0],n[1]),void c.onChange.call(c,s(t))))},change:function(e,t){a.call(this,t.values[0],t.values[1])},stop:function(e,t){var n=t.values;c.start(n[0]),c.end(n[1])}}),p.slider({range:!0,step:900,min:0,max:86400,slide:function(e,t){var n=t.values,i=d.slider("values");return(0==c.breaks()||!(n[0]<i[0]+1800||n[1]>i[1]-1800))&&(c.breakStart(n[0]),c.breakEnd(n[1]),a.call(this,n[0],n[1]),void 0)},change:function(e,t){a.call(this,t.values[0],t.values[1])}});var f=function(e,t,n){n=n||0,e=+e,t=+t;var i=(t+e)/2;return i-=3600-i%3600,i+60*n};d.slider("values",[c.start(),c.end()]),p.slider("values",[c.breakStart()||f(c.start(),c.end()),c.breakEnd()||f(c.start(),c.end())]),0==c.breaks()&&p.hide();var h=c.breaks.subscribe(function(e){if(0==e)p.hide(),c.breakStart(null),c.breakEnd(null);else{var t,n,i=d.slider("values");t=41400,t+1800<i[0]&&(t=i[0]+3600),n=t+1800,c.breakStart(t),c.breakEnd(n),p.slider("values",[t,n]),p.show()}});0==c.opened()&&(d.addClass("closed"),p.addClass("closed"));var g=c.opened.subscribe(function(e){0==e?(d.addClass("closed"),p.addClass("closed")):(c.start()&&c.end()?d.slider("values",[c.start(),c.end()]):(d.slider("values",[28800,64800]),c.start(28800),c.end(64800)),0==c.breaks()?(c.breakStart(null),c.breakEnd(null)):c.breakStart()&&c.breakEnd()?p.slider("values",[c.breakStart(),c.breakEnd()]):(p.slider("values",[43200,46800]),c.breakStart(43200),c.breakEnd(46800)),d.removeClass("closed"),p.removeClass("closed"))});e.utils.domNodeDisposal.addDisposeCallback(n,function(){d.slider("destroy"),p.slider("destroy"),h.dispose(),g.dispose()})}},e.bindingHandlers.loading={init:function(e){var t=$(e),n=t.css("position");if(0==t.children(".loader").length){var i=$('<div class="loader"><div class="progress"></div></div>');t.append(i)}"relative"!=n&&"absolute"!=n&&"static"!=n&&t.css("position","relative")},update:function(t,n){var i=e.utils.unwrapObservable(n()),o=$(t),r=o.children(".loader");i?r.show():r.fadeOut("fast")}},e.observableArray.fn.indexOfFnc=function(e){var t=-1;return $.each(this(),function(n,i){if(e(i))return t=n,!1}),t},e.observableArray.fn.pushUnique=function(t){var n=null!=e.utils.arrayFirst(this(),function(e){return t===e});n||this.push(t)},e.observableArray.fn.unshiftUnique=function(e){},e.observable.fn.isValid=function(){return!0},e.bindingHandlers.defaultText={update:function(e,t,n){var i=t(),o=n();"undefined"!=typeof o.text&&!o.text()||"undefined"!=typeof o.truncate&&!o.truncate()||"undefined"!=typeof o.nl2br&&!o.nl2br()?$(e).html(i).addClass("default-text"):$(e).removeClass("default-text")}},e.bindingHandlers.truncate={update:function(n,i,o,r,a){var s=t.encodeHTML(e.utils.unwrapObservable(i())),l=o().truncateLength||32,c=o().truncateRows||500,u=o().seeMoreFnc;if(s){var d=!1;if(s.length>l){var p=s.substr(0,l);s=p.substr(0,Math.min(p.length,p.lastIndexOf(" "))),d=!0}s.split("\n").length>c&&(s=s.split("\n").slice(0,c).join("\n"),d=!0),d&&u&&(s=u(s,r,a)),$(n).html(s)}}},e.bindingHandlers.fadeVisible={init:function(t,n){var i=n();$(t).toggle(e.utils.unwrapObservable(i))},update:function(t,n){var i=n();e.utils.unwrapObservable(i)?$(t).fadeIn():$(t).fadeOut()}},e.extenders.logChange=function(e,t){return e.subscribe(function(e){console.log(t+": "+e)}),e},e.extenders.validatorRequired=function(e,t){return t.message=t.message||"This field is required",t.realtime=t.realtime||!1,i(e),e.addValidator("required",function(e){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,"")),""!=e},t.message,t.realtime),e},e.extenders.validatorCustom=function(e,t){return t.message=t.message||"",t.realtime=t.realtime||!1,i(e),e.addValidator("custom",function(e){return t.validator(e)},t.message,t.realtime),e},e.extenders.validatorTime=function(e,n){return n.message=n.message||"Wrong time format.",n.rangeMessage=n.rangeMessage||"Time must be in range.",n.realtime=n.realtime||!1,n.from="undefined"!=typeof n.from?n.from:null,n.to="undefined"!=typeof n.from?n.to:null,i(e),e.addValidator("time",function(e){return t.validators.time(e)},n.message,n.realtime),(n.from||n.to)&&e.addValidator("timeRange",function(e){return!(null!==n.from&&t.date.durationToSeconds(e)<n.from)&&!(null!==n.to&&t.date.durationToSeconds(e)>n.to)},n.rangeMessage,n.realtime),e},e.extenders.cropText=function(t,n){return t.showCropped=e.observable(!0),t.showMore=function(){t.showCropped(!1)},t.showLess=function(){t.showCropped(!0)},t.cropped=e.computed(function(){if(t.showCropped()){var e=this().substring(0,n),i=this().split("\n");return i.length>3?i.slice(0,3).join("\n")+"...":this().length>n?e+"...":this()}return this()},void 0!==t.temp?t.temp:t),t};var a=e.bindingHandlers.value.init,s=e.bindingHandlers.value.update;return e.bindingHandlers.value={init:function(t,n,i,o,r){var s=n(),l=i();if(void 0!==l.limit){var c=$('<span class="character-counter"></span>');$(t).attr("maxlength",l.limit).data("charCounter",c).after(c);var u=e.utils.unwrapObservable(s);u.length>=l.limit&&s(u.substring(0,l.limit))}a(t,n,i,o,r)},update:function(t,i,o,r,a){var l=i(),c=o();if(void 0!==c.limit){var u=e.utils.unwrapObservable(l),d=c.limit-u.length;d<=0&&(d=0,l(u.substring(0,c.limit))),$(t).data("charCounter").text(n.get("basic-charactersLeft").format({count:d}))}s(t,i,o,r,a),$(t).placeholder()}},e.extenders.validatorEmail=function(e,t){var n=/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i;return t.message=t.message||"E-mail address is not valid.",t.realtime=t.realtime||!1,i(e),e.addValidator("email",function(e){return""==e||n.test(e)},t.message,t.realtime),e},e.extenders.validatorPhone=function(e,n){return n.message=n.message||"Phone number is not valid.",n.realtime=n.realtime||!1,i(e),e.addValidator("phone",function(e){return!e||t.validators.phone(e)},n.message,n.realtime),e},e.bindingHandlers.typeahead={init:function(e,t){var n=t();$(e).typeahead(n)}},e.bindingHandlers.currency={update:function(n,i){var o=i(),r=e.utils.unwrapObservable(o);$(n).text(t.currenciesByCode[r])}},e.bindingHandlers.errorTooltip={init:function(t,n,i){var o=n(),r=i(),a=r.errorPlacement||"right";$(t).tooltip({title:o.errorMessage,trigger:"manual",container:r.appendTo,cls:"error",placement:a});var s=function(n){0==n?($(t).tooltip("hide"),$(t).removeClass("error")):($(t).tooltip("show"),$(t).addClass("error"),$(t).tooltip("placement",a),"undefined"!=typeof r&&$(t).data("tooltip").$tip.width(r.tooltipWidth+"px"),$(t).data("tooltip").$tip.find(".tooltip-inner").text(e.utils.unwrapObservable(o.errorMessage)))},l=o.hasError.subscribe(s);s(o.hasError()),e.utils.domNodeDisposal.addDisposeCallback(t,function(){$(t).tooltip("hide"),o.hasError.unsubscribeFrom(l)})}},e.bindingHandlers.tooltip={init:function(t,n,i){var o=n(),r=i(),a=r.placement||"right";$(t).tooltip({title:o,container:r.appendTo,placement:a,trigger:"hover"}),e.utils.domNodeDisposal.addDisposeCallback(t,function(){$(t).tooltip("hide"),o&&o.hasError&&o.hasError.unsubscribeFrom(sub)})}},e.numericObservable=function(t,n,i){n=n||!1,i=i||!1;var o=e.simpleObservable(t),r=e.computed({read:function(){return o.temp()},write:function(e){var t=parseFloat(e);t=isNaN(t)?"0":t,!n&&t<0&&(t="0"),i&&(t=parseInt(t)),o.temp(t),t!==e&&o.temp.notifySubscribers()}});return r.actual=o,r.changed=e.observable(!1),r.subscribe(function(){this.changed(!0)},r),r},e.extenders.required=function(t,n){function i(e){return t.hasError(!e),t.validationMessage(e?"":n||"This field is required"),!t.hasError()}return t.hasError=e.observable(),t.validationMessage=e.observable(),t.isValid=function(){return i("undefined"!=typeof t.temp?t.temp():t())},t},e.observableArray.fn.sortByProperty=function(e){this.sort(function(t,n){return t[e]==n[e]?0:t[e]<n[e]?-1:1})},e.observableArray.fn.concat=function(e,t){var n=this();this.valueWillMutate();var i=Array.prototype[t?"unshift":"push"][Array.isArray(e)?"apply":"call"](n,e);return this.valueHasMutated(),i},e.bindingHandlers.stopBinding={init:function(){return{controlsDescendantBindings:!0}}},e.bindingHandlers.nl2br={update:function(n,i){return $(n).html(t.nl2br(t.encodeHTML(e.utils.unwrapObservable(i()))))}},e.virtualElements.allowedBindings.stopBinding=!0,e.bindingHandlers.scroll={init:function(e,t,n,i){var o=$(e),r=t(),a=(n(),null),s=200,l=function(e){clearTimeout(a),a=setTimeout(function(){var t=o.scrollTop(),n=o.innerHeight(),a=o[0].scrollHeight;t+n>=a&&r.call(i,"bottom",e),0==t&&r.call(i,"top",e)},s)};o.off("scroll",l).on("scroll",l)}},e.loadable=function(t,n){var i=e.observable(n);return i.loading=e.observable(!1),i.load=function(e){return e=e||function(){},i.loading(!0),t.call(i,function(){e(),i.loading(!1)})},i.reset=function(){i.loading(!1)},i},e.loadableObservableArray=function(t,n){var i=e.observableArray(n||[]);return i.load=t,i},e.loadableArray=function(t,n){var i=e.observableArray(n||[]);return i.loading=e.observable(!1),i.load=function(e){return e=e||function(){},i.loading(!0),t.call(i,function(){i.loading(!1),e()})},i.reset=function(){i.loading(!1)},i},e.onDemandObservable=function(t,n,i){var o=e.observable(n),r=!1,a=e.computed({read:function(){return r||a.loaded()||t.call(i),o()},write:function(e){r=!0,o(e),a.loaded(!0),r=!1},deferEvaluation:!0});return a.loaded=e.observable(),a.refresh=function(){a.loaded(!1)},a},e.fireOnChange=function(e){var t=e,n=[];this.subscribe=function(e){n.push(e.subscribe(t))},this.dispose=function(){for(var e=0;e<n.length;e++)n[e].dispose();n=[]},this.fire=function(){t()}},e.simpleObservableArray=function(t,n){var i=e.observableArray(t),o=e.observableArray(e.toJS(t));return i.commit=function(){return o(e.toJS(i())),i},i.reset=function(){var t=o();return i(n?e.utils.arrayMap(t||[],function(e){return n(e)}):e.toJS(t)),i},i.changed=e.observable(!1),o.subscribe(function(){i.changed(!0)}),i},e.simpleObservable=function(t){var n=e.observable(t),o=e.observable(t),r=e.computed({read:function(){return n()},write:function(e){o(e)}});return o.subscribe(function(e){r.changed(!0)}),r.commit=function(){return o()!==n()&&(r.changed(!1),n(o())),r},r.reset=function(){return n.valueHasMutated(),o(n()),r.changed(!1),r},r.temp=o,r.changed=e.observable(!1),i(r),r},e.timeObservable=function(n,i,o){function r(){return a.temp()||a.temp(new Date),a.temp()}n=n?new Date(n.getTime()):null;var a=e.simpleObservable(n);return a.temp(n?new Date(n.getTime()):null),a.changed(!1),a.datePattern=t.date.getDatePattern(_reservio.dateFormat),a.timePattern=t.date.getTimePattern(_reservio.timeFormat),a.date=e.computed({read:function(){return null===a.temp()?"":t.date.formatDate(a.temp(),a.datePattern)},write:function(e){var t=e.match(/^(\d{1,4})[.\/-](\d{1,2})[.\/-](\d{1,4})\.?$/),n=r();t?"mdy"==_reservio.dateFormat?n.setFullYear(+t[3],+t[1]-1,+t[2]):"ymd"==_reservio.dateFormat?n.setFullYear(+t[1],+t[2]-1,+t[3]):"ymd"==_reservio.dateFormat?n.setFullYear(+t[1],+t[2]-1,+t[3]):n.setFullYear(+t[3],+t[2]-1,+t[1]):n.setTime((new Date).getTime()),a.temp(n)}}),a.time=e.computed({read:function(){return null===a.temp()?null:t.date.formatDate(a.temp(),a.timePattern)},write:function(e){var n=new Date("1/1/2000 "+t.date.repairTime(e,_reservio.timeFormat)),i=r();isNaN(n)&&(n=new Date(i.getTime())),i.setHours(n.getHours(),n.getMinutes(),0,0),a.temp(new Date(i.getTime()))}}),a.time.kokot=!0,a.timeS=e.computed({read:function(){return null===a.temp()?null:t.date.durationToSeconds(a.time())},write:function(e){a.time(t.date.formatDuration(e))}}),a},e.utils.unwrapVar=function(t){return"undefined"==typeof t?null:JSON.parse(e.toJSON(t))},e.utils.findById=function(t,n){return e.utils.arrayFirst(t,function(t){return"undefined"!=typeof t.data?e.utils.unwrapObservable(t.data.id)==n:t.id==n})},e}),!function(e){"function"==typeof o&&"object"==typeof exports&&"object"==typeof module?e(o("knockout"),exports):"function"==typeof r&&r.amd?r("postbox",["knockout","exports"],e):e(ko,ko.postbox={})}(function(e,t,n){var i,o;e.subscribable.call(t),t.topicCache={},t.cache={},t.notify=function(e){var n=Array.prototype.slice.call(arguments,1);t.cache[e]&&$.each(t.cache[e],function(){this.apply($,n)})},t.listen=function(e,n){return t.cache[e]||(t.cache[e]=[]),t.cache[e].push(n),[e,n]},t.stopListen=function(e){var n=e[0];t.cache[n]&&$.each(t.cache[n],function(i){this==e[1]&&t.cache[n].splice(i,1)})},t.publish=function(n,i){n&&(t.topicCache[n]={value:i,serialized:e.toJSON(i)},t.notifySubscribers(i,n))},o=t.subscribe,t.subscribe=function(e,n,i){if(e)return o.call(t,n,i,e)},t.defaultComparer=function(t,n){return n&&t===n.value&&e.toJSON(t)===n.serialized},e.subscribable.fn.publishOn=function(e,n,o){var r;return e&&("function"==typeof n?o=n:r=n,o=o||t.defaultComparer,i.call(this,e,"publishOn"),this.postboxSubs[e].publishOn=this.subscribe(function(n){o.call(this,n,t.topicCache[e])||t.publish(e,n)},this),r||t.publish(e,this())),this},i=function(e,t){var n=this.postboxSubs=this.postboxSubs||{};n[e]=n[e]||{},n[e][t]&&n[e][t].dispose()},e.subscribable.fn.stopPublishingOn=function(e){return i.call(this,e,"publishOn"),this},e.subscribable.fn.subscribeTo=function(o,r,a){var s,l,c,u=this;return"function"==typeof r?a=r:s=r,o&&e.isWriteableObservable(this)&&(i.call(this,o,"subscribeTo"),c=function(e){u(a?a.call(u,e):e)},this.postboxSubs[o].subscribeTo=t.subscribe(o,c),s&&(l=t.topicCache[o],l!==n&&c(l.value))),this},e.subscribable.fn.unsubscribeFrom=function(e){return i.call(this,e,"subscribeTo"),this},e.subscribable.fn.syncWith=function(e,t,n,i){return this.subscribeTo(e,t).publishOn(e,n,i),this}}),r("reservio/ajax",["jquery","postbox"],function(e,t){var n,i={timeout:6e4,dataType:"json"},o=[];e(window).bind("beforeunload",function(){n&&n.abort()});var r=function(e,t,n){return"undefined"==typeof e.status||(e&&e.status&&(e.status.auth||(window.location.href=_reservio.logoutUrl),e.status.redirect&&(window.location.href=e.status.redirect,e.status.redirect.indexOf("#")>=0&&window.location.reload())),!!e.status.success)},a=function(n,i,o){if(0==n.readyState||0==n.status)return!0;if("undefined"!=typeof o&&"undefined"!=typeof o.data.messages){console.log(o.data.messages);var r=e("body").modal({template:"modal-error-message-tpl",viewModel:{messages:o.data.messages,closeClicked:function(){r.modal("hide")}},onHide:function(){e(".btn").button("reset")}});r.modal("show")}else t.publish("showInformation",{type:"error",text:"Something went wrong!"});return!0},s=function(t,o,s,l,c){return c=c||{},n=e.ajax({url:t,type:"POST",dataType:i.dataType,data:o,timeout:c.timeout||i.timeout,beforeSend:function(e){"undefined"!=typeof _reservio&&e.setRequestHeader("token",_reservio.token)},success:function(e,t,n){r(e,t,n)?"function"==typeof s&&s.call(this,e,t,n):"function"==typeof l?l.call(this,e,t,n):a(t,n,e)},error:function(e,t){"function"==typeof l?l.call(this,{},e,t):a(e,t)}})},l=function(t,o,s){return n=e.ajax({url:t,type:"DELETE",dataType:i.dataType,data:{},timeout:i.timeout,beforeSend:function(e){"undefined"!=typeof _reservio&&e.setRequestHeader("token",_reservio.token)},success:function(e,t,n){r(e,t,n)?"function"==typeof o&&o.call(this,e,t,n):"function"==typeof s?s.call(this,e,t,n):a(t,n,e)},error:function(e,t){"function"==typeof s?s.call(this,{},e,t):a(e,t)}})},c=function(t,o,s,l){return n=e.ajax({url:t,type:"PUT",dataType:i.dataType,data:o,timeout:i.timeout,beforeSend:function(e){"undefined"!=typeof _reservio&&e.setRequestHeader("token",_reservio.token)},success:function(e,t,n){r(e,t,n)?"function"==typeof s&&s.call(this,e,t,n):"function"==typeof l?l.call(this,e,t,n):a(t,n,e)},error:function(e,t){"function"==typeof l?l.call(this,{},e,t):a(e,t)}})},u=function(t,o,s,l){return n=e.ajax({url:t,type:"GET",dataType:i.dataType,data:o,timeout:i.timeout,beforeSend:function(e){"undefined"!=typeof _reservio&&e.setRequestHeader("token",_reservio.token)},success:function(e,t,n){r(e,t,n)?"function"==typeof s&&s.call(this,e,t,n):"function"==typeof l?l.call(this,e,t,n):a(t,n,e)},error:function(e,t){a(e,t)&&"function"==typeof l&&l.call(this,e,t)}})},d=function(t,o,s,l,c){return n=e.ajax({url:t,type:"GET",dataType:"html",data:o,timeout:i.timeout,beforeSend:function(e){e.setRequestHeader("token",_reservio.token)},success:function(e,t,n){r(e,t,n)?(s.append(e),"function"==typeof l&&l.call(this,e,t,n)):"function"==typeof c?c.call(this,e,t,n):a(t,n,e)},error:function(e,t){a(e,t)&&"function"==typeof c&&c.call(this,e,t)}})},p=function(){o.length>0&&h(),o=[]},f=function(e,t,n,i){o.push({resource:e,params:t||{},onSuccess:n,onError:i})},h=function(){var t=e.map(o,function(e){return{name:e.resource,params:e.params}});return s("/api/",{resources:t},function(e){o=[]})};return{post:s,get:u,put:c,"delete":l,load:d,createBatch:p,addRequest:f,runBatch:h}}),r("reservio/data",["jquery","ko","reservio/utils","reservio/ajax","reservio/lang"],function(e,t,n,i,o){function r(e){}function a(e){this.entity="ResourceNew",this.formName="resourceForm",this.saving=t.observable(!1),this.data={},this.data.id=t.observable(),this.data.name=t.observable(),this.data.email=t.observable(),this.data.description=t.observable(),this.data.services=t.observableArray(),this.data.icalUrl="",this.data.syncEnabled=t.observable(),this.data.hasOpeningHours=t.observable(),this.data.openingHours=t.observableArray(),this.data.notificationsEnabled=t.observable(),this.data.googleCalendarId=t.observable(),this.data.googleCalendarName=t.observable(),this.data.accesses={canLogin:t.observable(!1),canAccessAllCalendars:t.observable(!1),canAccessClients:t.observable(!1),canAccessSettings:t.observable(!1),canAccessStatistics:t.observable(!1),canAccessPromote:t.observable(!1)},this.update(e)}function s(e){this.entity="ServiceNew",this.formName="serviceForm",this.saving=t.observable(!1),this.data={},this.data.id=t.observable(),this.data.name=t.observable(),this.data.duration=t.observable(),this.data.cost=t.observable(),this.data.capacity=t.observable(),this.data.color=t.observable(),this.data.description=t.observable(),this.data.resources=t.observableArray(),this.data.visible=t.observable(),this.data.questionEnabled=t.observable(),this.data.questionText=t.observable(),this.data.position=t.observable(),this.update(e)}function l(e){this.entity="EventNew",this.saving=t.observable(!1),this.data={},this.data.id=t.observable(),this.data.title=t.observable(),this.data.start=t.observable(),this.data.end=t.observable(),this.data.allDay=t.observable(),this.data.service=t.observable(),this.data.resource=t.observable(),this.data.capacity=t.observable(),this.data.capacity.occupancy=t.computed(this.computeOcuppancy,this),this.data.bookings=t.observableArray(),this.data.created=t.observable(),this.update(e)}function c(e){this.entity="BookingNew",this.saving=t.observable(!1),this.data={id:t.observable(),client:t.observable(),state:t.observable(),stateChangedOn:t.observable(),created:t.observable(),via:t.observable()},this.states={Approved:1,Rejected:2},this.update(e)}function u(e){this.entity="Day",this.data={name:t.observable(),opened:t.observable(),start:t.observable().duration(),breakStart:t.observable().duration(),breakEnd:t.observable().duration(),end:t.observable().duration()},this.update(e)}var d={account:{mapFromObject:function(e){return e.informations.settings=e.settings,e.informations.plan=e.plan,e.informations.opening_hours=e.opening_hours,new p.Account(e.informations)}},resource:{mapFromObject:function(e){return new p.Resource(e)},mapFromArray:function(t){var n=this;return e.map(t,function(e){return n.mapFromObject(e)})}},service:{mapFromObject:function(e){return new p.Service(e)},mapFromArray:function(t){var n=this;return e.map(t,function(e){return n.mapFromObject(e)})}}},p={};p.Account=function(e){e=e||{},this.id=t.observable(e.id||null),this.hash=t.observable(e.hash||null),this.identifier=t.observable(e.identifier||null),this.createdAt=moment(e.created_at),this.categoryId=t.observable(e.category||null),this.category=t.observable(e.category_code||null),this.name=t.simpleObservable(e.name).extend({validatorRequired:{message:o.get("error-businessName-required"),realtime:!0}}),this.email=t.simpleObservable(e.email).extend({validatorRequired:{message:o.get("error-email-required"),realtime:!0},validatorEmail:{message:o.get("error-email-format"),realtime:!0}}),this.description=t.simpleObservable(e.description),this.slogan=t.simpleObservable(e.slogan),this.phone=t.simpleObservable(e.phone).extend({validatorPhone:{message:"error-phone-format",realtime:!0}}),this.street=t.simpleObservable(e.street).extend({validatorRequired:{message:o.get("error-street-required"),realtime:!0}}),this.city=t.simpleObservable(e.city).extend({validatorRequired:{message:o.get("error-city-required"),realtime:!0}}),this.country=t.simpleObservable(e.country),this.state=t.simpleObservable(e.state),this.minipageUrl=e.minipageUrl,this.bookingUrl=e.bookingUrl,this.sms_balance=t.observable(e.sms_balance),this.website_url=t.simpleObservable(e.website_url),this.website_name=t.simpleObservable(e.website_name),this.facebook_url=t.simpleObservable(e.facebook_url),this.facebook_name=t.simpleObservable(e.facebook_name),this.google_analytics_id=t.simpleObservable(e.google_analytics_id),this.fbPage={id:e.fb_page_id,name:e.fb_page_name,url:e.fb_page_url},this.settings=new function(e){var i=this;e=e||{},this.removeBranding=t.simpleObservable(1==e.remove_branding),this.publishingNetwork=t.simpleObservable(1==e.publishing_network),this.manualConfirmation=t.simpleObservable(1==e.reservations_manual_confirmation),this.reservationsSlotSize=t.simpleObservable(e.reservations_slot_size),this.reservationsInAdvance=t.simpleObservable(e.reservations_in_advance),this.reservationsLaterThan=t.simpleObservable(e.reservations_later_than).extend({validatorCustom:{validator:function(e){return i.reservationsInAdvance.temp().time<i.reservationsLaterThan.temp().time},message:"error-reservation-range",realtime:!0}}),this.reservationsMaxCount=t.simpleObservable(e.reservations_max_count),this.reservationsCancel=t.simpleObservable(e.reservations_cancel),this.reservationsReminder=t.simpleObservable(1==e.reservations_reminder),this.reservationsPermitted=t.simpleObservable(e.reservations_permitted),this.message_booking_confirmed_business=t.protectedObservable(+e.message_booking_confirmed_business),this.message_booking_confirmed_client=t.protectedObservable(+e.message_booking_confirmed_client),this.message_booking_canceled_business=t.protectedObservable(+e.message_booking_canceled_business),this.message_booking_canceled_client=t.protectedObservable(+e.message_booking_canceled_client),this.message_booking_awaiting_business=t.protectedObservable(+e.message_booking_awaiting_business),this.message_booking_awaiting_client=t.protectedObservable(+e.message_booking_awaiting_client),this.message_booking_reminder_client=t.protectedObservable(+e.message_booking_reminder_client),this.message_client_created_business=t.protectedObservable(+e.message_client_created_business),this.message_client_created_client=t.protectedObservable(+e.message_client_created_client),this.message_client_confirmed_client=t.protectedObservable(+e.message_client_confirmed_client),this.message_client_rejected_client=t.protectedObservable(+e.message_client_rejected_client),this.message_newsletters_business=t.protectedObservable(+e.message_newsletters_business),this.language=t.simpleObservable(e.language),this.frontend_language=t.simpleObservable(e.frontend_language),this.currency=t.simpleObservable(e.currency),this.timezone=t.simpleObservable(e.timezone),this.timezoneOffset=t.simpleObservable(e.timezone_offset),this.dateFormat=t.simpleObservable(e.date_format),this.timeFormat=t.simpleObservable(e.time_format),this.weekStart=t.simpleObservable(e.week_start),n.timezoneOffset=this.timezoneOffset()}(e.settings),this.plan=new function(e){e=e||{},this.code=e.code,this.name=e.name,this.expire=e.expire?n.date.decodeDate(e.expire):null,this.bookingsLimit=e.bookings_limit,this.activityHistoryLimit=e.activity_history_limit,this.clientsLimit=e.clients_limit,this.bookings=e.bookings,this.clients=e.clients,this.isTrial=e.is_trial}(e.plan),this.openingHours=t.observableArray(e.opening_hours)},r.prototype.init=function(){for(var e in this.data)this.data[e].changed=t.observable(!1),this.data[e].subscribe(function(){this.changed(!0)},this)},r.prototype.clone=function(){return new p[this.entity](t.toJS(this.data))},r.prototype.toJS=function(){return t.toJS(this.data)},r.prototype.isValid=function(){var e=!0;for(var t in this.data)"function"==typeof this.data[t].isValid&&(e&=this.data[t].isValid());return e},r.prototype.getErrors=function(){var e={};for(var t in this.data)this.data[t].errors&&this.data[t].errors.length>0&&(e[t]=this.data[t].errors);return e},r.prototype.changed=function(){for(var e in this.data)if(this.data[e].changed())return!0;return!1},r.prototype.isNew=function(){return null==this.data.id()},r.prototype.ajaxSave=function(e,t,n,o){n=n||function(){},o=o||function(){};var r=this;return this.saving(!0),i.post(e,{data:t},function(e){null===t.id&&r.data.id(e.data.id),r.saving(!1),n.call(r,e)},function(e){r.saving(!1),o.call(r,e)})},r.prototype.ajaxDestroy=function(e,t,n,o){n=n||function(){},o=o||function(){};var r=this;return this.saving(!0),i.post(e,{id:t},function(e){r.saving(!1),n.call(r,e)},function(e){r.saving(!1),o.call(r,e)})},a.prototype=new r,a.prototype.constructor=a,a.prototype.update=function(t){t=t||{},this.data.id(t.id||null),this.data.name(t.name||""),this.data.email(t.email||""),this.data.description(t.description||""),this.data.services(t.services||[]),this.data.icalUrl=t.icalUrl||"",this.data.syncEnabled(1==t.syncEnabled||!1),this.data.hasOpeningHours(t.hasOpeningHours||!1),this.data.openingHours(e.map(t.openingHours||[],function(e){return new p.OpeningHours(e)})),this.data.notificationsEnabled(1==t.notificationsEnabled||!1),this.data.googleCalendarId(t.googleCalendarId||null),this.data.googleCalendarName(t.googleCalendarName||""),t.accesses&&(this.data.accesses.canLogin(void 0!==t.accesses.canLogin&&t.accesses.canLogin),this.data.accesses.canAccessAllCalendars(void 0!==t.accesses.canAccessAllCalendars&&t.accesses.canAccessAllCalendars),this.data.accesses.canAccessClients(void 0!==t.accesses.canAccessClients&&t.accesses.canAccessClients),this.data.accesses.canAccessSettings(void 0!==t.accesses.canAccessSettings&&t.accesses.canAccessSettings),
this.data.accesses.canAccessStatistics(void 0!==t.accesses.canAccessStatistics&&t.accesses.canAccessStatistics),this.data.accesses.canAccessPromote(void 0!==t.accesses.canAccessPromote&&t.accesses.canAccessPromote))},a.prototype.save=function(t,n){var i=this.isNew(),o=this.toJS();return delete o.icalUrl,delete o.syncEnabled,o.openingHours=o.openingHours.length?o.openingHours:null,this.ajaxSave(this.data.id()>0?"/resources/update/":"/resources/create/",o,function(n){i&&g.push(this),void 0!==n.data.openingHours&&this.data.openingHours(e.map(n.data.openingHours||[],function(e){return new p.OpeningHours(e)})),this.setServicesResources(),t.call(this,n)},n)},a.prototype.destroy=function(t,n){return this.ajaxDestroy("/resources/destroy/",this.data.id(),function(n){var i=this;g.destroy(this),e.each(m(),function(e,t){t.data.resources.remove(i.data.id())}),t.call(this,n)},n)},a.prototype.setServicesResources=function(){var t=this;e.each(m(),function(e,n){if(n.data.id()){var i=t.data.services.indexOf(n.data.id())>=0?"pushUnique":"remove";n.data.resources[i](t.data.id())}})},a.prototype.changeSyncState=function(e,t,n){t=t||function(){};var i=this.toJS();return this.ajaxSave("/resources/update/",{id:i.id,syncEnabled:e?1:0},function(n){this.data.syncEnabled(e),t.call(this,n)},n)},p.ResourceNew=a,s.prototype=new r,s.prototype.constructor=s,s.prototype.update=function(e){e=e||{},this.data.id(e.id||null),this.data.name(e.name||""),this.data.duration(e.duration||900),this.data.cost(e.cost||0),this.data.capacity(e.capacity||1),this.data.color(e.color||0),this.data.description(e.description||""),this.data.resources(e.resources||[]),this.data.visible(void 0===e.visible||1==e.visible),this.data.questionEnabled(void 0===e.questionEnabled||1==e.questionEnabled),this.data.questionText(e.questionText||""),this.data.position(e.position||0)},s.prototype.save=function(e,t){var n=this.isNew();return this.ajaxSave(this.data.id()>0?"/services/update/":"/services/create/",this.toJS(),function(t){n&&m.push(this),this.setResourcesServices(),e.call(this,t)},t)},s.prototype.destroy=function(t,n){return this.ajaxDestroy("/services/destroy/",this.data.id(),function(n){var i=this;m.destroy(this),e.each(g(),function(e,t){t.data.services.remove(i.data.id())}),t.call(this,n)},n)},s.prototype.setResourcesServices=function(){var t=this;e.each(g(),function(e,n){if(n.data.id()){var i=t.data.resources.indexOf(n.data.id())>=0?"pushUnique":"remove";n.data.services[i](t.data.id())}})},p.ServiceNew=s,l.prototype=new r,l.prototype.constructor=l,l.prototype.update=function(e){e=e||{},this.data.id(e.id||null),this.data.title(e.title||""),this.data.start(e.start||moment().unix()),this.data.end=e.end||moment().add("hours",1),this.data.allDay=t.observable(e.allDay||!1),this.data.serviceId=t.observable(e.serviceId||null),this.data.service=t.computed(this.computeService),this.data.resourceId=t.observable(e.resourceId||null),this.data.resource=t.computed(this.computeResource),this.data.capacity=t.observable(e.capacity||1),this.data.bookings=t.observableArray(),this.data.created=t.observable()},l.prototype.save=function(e,t){var n=this.toJS();return n.resource_id,this.ajaxSave(this.data.id()>0?"/events/update/":"/events/create/",n,function(t){e.call(this,t)},t)},l.prototype.destroy=function(e,t){return this.ajaxDestroy("/events/destroy/",this.data.id(),function(t){e.call(this,t)},t)},l.prototype.computeOcuppancy=function(){return this.data.bookings().length},l.prototype.computeService=function(){return!0},l.prototype.computeResource=function(){return!0},p.EventNew=l,c.prototype=new r,c.prototype.constructor=c,c.prototype.update=function(e){e=e||{},this.data.id(e.id||null),this.data.start(e.start||moment().unix()),this.data.end=e.end||moment().add("hours",1),this.data.allDay=t.observable(e.allDay||!1),this.data.serviceId=t.observable(e.serviceId||null),this.data.service=t.computed(this.computeService),this.data.resourceId=t.observable(e.resourceId||null),this.data.resource=t.computed(this.computeResource),this.data.capacity=t.observable(e.capacity||1),this.data.bookings=t.observableArray(),this.data.created=t.observable()},c.prototype.save=function(e,t){return this.ajaxSave(this.data.id()>0?"/events/update/":"/events/create/",this.toJS(),function(t){e.call(this,t)},t)},u.prototype=new r,u.prototype.constructor=u,u.prototype.update=function(e){e=e||{},this.data.name(e.name),this.data.opened(e.opened),this.data.start(e.start),this.data.breakStart(e.breakStart),this.data.breakEnd(e.breakEnd),this.data.end(e.end)},p.Day=u,p.OpeningHours=function(n){n=n||{};var i=this;this.days=t.observableArray(n.days||[]).addValidator("validator",function(e){return e.length>0},o.get("openingHours-noDaysSelectedError")),this.days.formatted=t.computed(function(){var t=this.days(),n=o.getDaysShort(),i="en"==_reservio.language?0:1,r=e.map(t,function(e){return n[e]});t=t.slice();var a=e.map(t,function(e,n){return(t[n]-i+7)%7}).sort();if("en"!=_reservio.language&&0==t[0]){var s=r.shift();r.push(s)}return a.length>1&&a[a.length-1]-a[0]==a.length-1?7==r.length?o.get("openingHours-everyDay"):r[0]+" - "+r[r.length-1]:r.join(", ")},this),this.start=t.observable(void 0===n.start?32400:n.start).duration(),this.end=t.observable(n.end||64800).duration().addValidator("validator",function(){return+i.start()<+i.end()},o.get("openingHours-rangeError"))},p.Note=function(e){var n=this;this.type="note",e=e||{},this.id=t.observable(e.id||null),this.created=t.observable(new Date(1e3*(e.created||(new Date).getTime()))),this.clientId=t.observable(e.clientId||null),this.text=t.simpleObservable(e.text).extend({validatorRequired:{message:"",realtime:!0}}),this.isValid=function(){return this.text.isValid()},this.commit=function(e,t){if(e=e||function(){},t=t||function(){},this.isValid()){this.text.commit();var o={id:n.id(),text:n.text(),client_id:n.clientId()};o.id>0?i.post("/notes/update/",{note:o},function(t){e(!0)},function(t){e(!1)}):i.post("/notes/create/",{note:o},function(t){var i=t.data;n.id(i.id).created(new Date(1e3*i.created)).text(i.text),n.text.commit(),e(!0)},function(t){e(!1)})}else t()},this.cancel=function(){this.text.reset()},this.destroy=function(e){e=e||function(){},i.post("/notes/destroy/",{id:n.id()},function(t){e(!0)},function(t){e(!1)})}};var r=function(){};r.prototype.setData=function(n){var i=this;n=n||{},e.each(n,function(e,n){t.isObservable(i[e])?i[e](n):i[e]=n})},r.prototype.getData=function(){var n=this,i={};return e.each(this.__proto__.fields,function(){i[this]=t.utils.unwrapObservable(n[this])}),i};var f=function(e){e=e||{},this.id=t.observable(),this.clientCouponId=t.observable(),this.title=t.observable(),this.description=t.observable(),this.type=t.observable(),this.services_coupons=t.observableArray(),this.visits=t.observable(),this.credit=t.observable(),this.cost=t.observable(),this.expire_on=t.observable(),this.expire_after=t.observable(),this.expire_after_units=t.observable(),this.type.setOptions([{value:0,text:o.get("coupon-type-time")},{value:1,text:o.get("coupon-type-visits")},{value:2,text:o.get("coupon-type-credit")}],"value"),this.expire_after_units.setOptions([{value:"d",text:o.getByCount("time-duration-days",1)},{value:"m",text:o.getByCount("time-duration-months",1)},{value:"y",text:o.getByCount("time-duration-years",1)}],"value"),this.setData({id:void 0!==e.id?e.id:null,clientCouponId:void 0!==e.clientCouponId?e.clientCouponId:null,title:void 0!==e.title?e.title:"",description:void 0!==e.description?e.description:"",type:void 0!==e.type?e.type:null,services_coupons:void 0!==e.services_coupons?e.services_coupons:[],visits:void 0!==e.visits?e.visits:10,credit:void 0!==e.credit?e.credit:1e3,cost:void 0!==e.cost?e.cost:"",expire_on:void 0!==e.expire_on?e.expire_on:new Date,expire_after:void 0!==e.expire_after?e.expire_after:1,expire_after_units:void 0!==e.expire_after_units?e.expire_after_units:"m"}),this.summaryText=t.computed(this.computeSummaryText,this)};e.extend(f.prototype,r.prototype),f.prototype.fields=["id","title","description","type","services_coupons","visits","credit","cost","expire_after","expire_after_units"],f.prototype.computeSummaryText=function(){var e={d:"days",m:"months",y:"years"};switch(this.type()){case 0:return this.expire_after()+" "+o.getByCount("time-duration-"+e[this.expire_after_units()],this.expire_after());case 1:return o.getByCount("coupon-summary-visits",+this.visits()).format({amount:this.visits()});case 2:return o.get("coupon-summary-credit").format({amount:this.credit()+n.currenciesByCode[h().settings.currency()]})}},f.getUsageText=function(e){switch(+e.coupon.type){case 0:return o.get("coupon-usage-expires-on")+" "+e.expire_on.format(n.date.getDatePattern(_reservio.dateFormat));case 1:return o.getByCount("coupon-usage-visits",+e.visits).format({amount:e.visits});case 2:return o.get("coupon-usage-credit").format({amount:e.credit+n.currenciesByCode[h().settings.currency()]})}},p.Coupon=f;var h=t.loadable(function(e){return i.get("/account/",{request:["informations","settings","plan","opening_hours"]},function(t){h(d.account.mapFromObject(t.data.account)),e()})},{}),g=t.loadableArray(function(e){return i.get("/resources/",{},function(t){g.map(t.data.resources,p.ResourceNew),e()})});g.find=function(e){return t.utils.arrayFirst(g(),function(t){return t.data.id()==e})},g.insert=function(e){g().push(e)},g.destroy=function(e){for(var t=0;t<g().length;t++){var n=g()[t];n.data.id()===e.data.id()&&g().splice(t,1)}};var m=t.loadableArray(function(e){return i.get("/services/",{},function(t){m.map(t.data.services,p.ServiceNew),e()})});m.find=function(e){return t.utils.arrayFirst(m(),function(t){return t.data.id()==e})},m.insert=function(e){m().push(e)},m.destroy=function(e){for(var t=0;t<m().length;t++){var n=m()[t];n.data.id()===e.data.id()&&m().splice(t,1)}};var v=t.loadableArray(function(e){return i.get("/api/internal/coupons/",{},function(t){v.map(t.data,p.Coupon),e()})});return v.find=function(t,n){return i.get("/api/internal/coupons/"+t+"/",{},function(t){t.data.services_coupons=e.map(t.data.services_coupons,function(e){return e.service_id}),n(new p.Coupon(t.data))})},{account:h,resources:g,services:m,coupons:v,mappers:d,entities:p}}),r("reservio/analytics",["jquery","ko"],function(e,t){var n=function(){this.counters={}};return t.utils.extend(n.prototype,{trackEvent:function(e,t,n,i){"undefined"!=typeof ga&&ga("send","event",e,t,n,i)},trackEventWithCounter:function(e,t,n,i){var o=this.increment(e,t);this.trackEvent(e,t+"-"+o,n,i)},trackSocial:function(e,t,n){"undefined"!=typeof ga&&ga("send","social",{socialNetwork:e,socialAction:t,socialTarget:n})},trackTime:function(e,t,n){"undefined"!=typeof ga&&ga("send","timing",e,t,n)},trackFormErrors:function(t){var n=this,i=t.getErrors();e.each(i,function(i,o){e.each(o,function(e,o){n.trackEventWithCounter(t.formName,i+"-"+o)})})},increment:function(e,t){var n=e+t;return this.counters[n]||(this.counters[n]=0),++this.counters[n]}}),new n}),r("reservio/acl",["jquery","ko","reservio/lang","reservio/analytics","reservio/data"],function(e,t,n,i,o){function r(r){function a(e){var i=this;this.count=t.observable(0),this.limit=t.observable(0),this.usageInPercents=t.computed(function(){return this.limit()>0?this.count()/this.limit():0},this),this.isOverLimit=function(e){var t=0!=this.limit()&&this.count()>=this.limit();return"undefined"==typeof e&&(e=!0),t&&e&&this.showModal(),t},this.showModal=function(){var t=i.count()/i.limit(),o=t<.5?0:t<1?1:2,r="modal-upgrade-"+e+"-"+o+"-",a=s.showUpgradeModal(n.get(r+"title").format({limit:i.limit()}),n.get(r+"text").format({limit:i.limit()}),e+"-"+o+".png",e);a()}}var s=this;this.colorClassByPercent=function(){return this.limitInPercents()<50?"grey":this.limitInPercents()<75?"orange":"red"},this.showUpgradeModal=function(t,n,o,a){return function(){r.log("upgradeModal",t),i.trackEventWithCounter("upgradeModalShown",a);var s=e("body").modal({template:"modal-upgrade-tpl",viewModel:{title:t,text:n,image:"//static."+_reservio.host+"/desktop/img/"+o,goToUpgradeClicked:function(){s.modal("hide"),window.location.href="/upgrade/plans/"}},cls:"upgrade"});s.modal("show")}},this.bookings=new a("bookings"),this.bookings.isEventInRange=function(e){var t=new Date((new Date).getTime()-2592e6);return t.setHours(0,0,0,0),e>=t},this.bookings.isBookingInRange=function(e,t){var n=new Date((new Date).getTime()-2592e6);return n.setHours(0,0,0,0),e>=n&&t>new Date},this.clients=new a("clients"),this.activateTrialFeature=function(t,n,a){if(t=t||"unknown",n=n||"pro",a=a||function(){},o.account().plan.isTrial){var s=!1,l=e("#second-modals").modal({template:"modal-trialPremiumFeature-tpl",viewModel:{requiredPackage:n,image:"//static."+_reservio.host+"/desktop/img/",goToUpgradeClicked:function(){console.log("upgradeClicked"),s=!0,l.modal("hide"),s=!1;var e=3;"starter"==n?e=1:"standard"==n&&(e=2);var o="/upgrade/order/?plan="+e;"function"!=typeof ga&&(window.location.href=o),i.trackEventWithCounter("trial","modalUpgradeClicked",t,{hitCallback:function(){window.location.href=o}})},continueUsingClicked:function(){i.trackEventWithCounter("trial","modalContinueClicked",t),s=!0,a(!0),l.modal("hide"),s=!1}},onHide:function(){s||(i.trackEventWithCounter("trial","modalCloseClicked",t),a(!0))},cls:"modal-trial"});l.modal("show"),r.log("trialModalShown",t),i.trackEventWithCounter("trial","modalShown",t)}else a(!0)}}return r}),r("reservio/modules/tutorial",["ko","jquery","postbox","reservio/utils","reservio/lang","reservio/data","reservio/analytics"],function(e,t,n,i,o,r,a){var s=function(){};e.utils.extend(s.prototype,{enabled:!1,tutorials:{},init:function(e){this.addTutorial(new d(e.start)),this.addTutorial(new f(e.clientNote)),this.addTutorial(new p(e.createBooking)),this.addTutorial(new h(e.newBooking))},start:function(){this.enabled=!0,t.each(this.tutorials,function(e,t){var n=t.getActualStep();n&&n.isSubstep&&t.showPreviousStep(!0,!0)})},addTutorial:function(e){n.notify("popover.disable","tutorial."+e.name),this.tutorials[e.name]=e},check:function(){var e=null,n=!1;this.enabled&&t.each(this.tutorials,function(t,i){e=i.getActualStep(),e&&(e.canShow()&&!n?(e.show(),n=!0):e.hide())})},getTutorial:function(e){return this.tutorials[e]}});var l=new s,c=function(){this.showTimeout=null,this.showNextOnClose=!0,this.showTimeoutDuration=800,this.shown=!1};c.prototype={name:"",element:null,placement:"bottom",appendTo:".popover-holder",runOn:"#/",title:"",text:"",isSubstep:!1,onTooltipClicked:function(e){e.stopPropagation(),this.showNextStep(!0,!0)},canShow:function(){return window.location.href.indexOf(this.runOn)>=0},show:function(){var e,i=this,o=25;this.accomplished||!this.canShow()||i.shown||!function r(){o--,e=t(i.element),e.length>0?(clearTimeout(i.showTimeout),i.tutorial.getActualStep()!==i&&n.notify("popover.hide","tutorial."+i.tutorial.name),i.shown=!0,i.showTimeout=setTimeout(function(){e=t(i.element),e.length>0&&n.notify("popover.show","tutorial."+i.tutorial.name,{$element:e,template:"tutorial-popover-tpl",viewModel:i.createViewModel(),placement:i.placement,cls:"tutorial "+i.cls,appendTo:i.appendTo,afterShow:function(e){e.addClass("shown"),e.bind("click",function(e){e.stopPropagation(),i.onTooltipClicked.call(i,e)})}}),e=null},i.showTimeoutDuration)):o>0&&setTimeout(r,200)}()},hide:function(){clearTimeout(this.showTimeout),n.notify("popover.hide","tutorial."+this.tutorial.name),this.shown=!1},showNextStep:function(e,t){this.tutorial.isActualStep(e)&&this.tutorial.showNextStep(e,t)},showPreviousStep:function(e,t){this.tutorial.isActualStep(e)&&this.tutorial.showPreviousStep(e,t)},createViewModel:function(){var e=this;return{skipStepClicked:function(t,n){n.stopPropagation(),a.trackEvent("tutorial",e.name+"SkipClicked"),e.showNextOnClose?e.showNextStep(!0,!0):e.hide()},title:this.title,text:this.text}}};var u=function(){};e.utils.extend(u.prototype,{init:function(e,t){this.name=e,this.steps=[],this.actualStepIndex=t},addStep:function(e){e.tutorial=this,e.title=o.get("tutorial-"+e.name+"-title"),e.text=o.get("tutorial-"+e.name+"-text"),this.steps.push(e)},getActualStep:function(){return this.actualStepIndex>=0?this.steps[this.actualStepIndex]:null},showNextStep:function(e,t){if(this.isActualStep(e)){if(t=t||!1,this.hideActualStep(),this.actualStepIndex++,this.actualStepIndex>=this.steps.length)this.actualStepIndex=-1;else{var n;for(this.actualStepIndex;this.actualStepIndex<this.steps.length;this.actualStepIndex++){if(n=this.getActualStep(),!t){n.show();break}if(!n.isSubstep){n.show();break}}}i.cookie.set("tutorial_"+this.name,this.actualStepIndex,7)}},showPreviousStep:function(e,t){if(this.isActualStep(e))if(t=t||!1,this.actualStepIndex-1<0);else{this.hideActualStep(),this.actualStepIndex--;var n;for(this.actualStepIndex;this.actualStepIndex>=0;this.actualStepIndex--){if(n=this.getActualStep(),!t){n.show();break}if(!n.isSubstep){n.show();break}}}},showActualStep:function(){var e=this.getActualStep();e&&e.show()},hideActualStep:function(){var e=this.getActualStep();e&&e.hide()},isAccomplished:function(){return this.actualStepIndex<0},isActualStep:function(e){var t=this.getActualStep();return!!t&&(e===!0||t.name===e)}});var d=function(e){if(this.init("start",e),"appointment"==_reservio.categoryType){var n=new c;n.name="clickToCreateEventButton",n.element="#calendar-create-event",n.runOn="#/calendar",n.placement="right-bottom",n.showTimeoutDuration=5e3,this.addStep(n),n=new c,n.name="createEventPopover",n.element=".popover.by-button #frm-booked-client",n.runOn="#/calendar",n.placement="right-bottom",n.isSubstep=!0,n.showNextOnClose=!1,n.showTimeoutDuration=1e3,n.onTooltipClicked=function(e){this.tutorial.hideActualStep(!0,!0)},this.addStep(n),n=new c,n.name="createdEvent",n.element=".fc-event-added",n.runOn="#/calendar",n.placement="right",n.isSubstep=!0,n.onTooltipClicked=function(e){this.tutorial.showNextStep()},this.addStep(n),n=new c,n.name="goToPromote",n.element="ul.menu > li:nth-child(4)",n.runOn="#/",n.placement="bottom",n.onTooltipClicked=function(e){window.location.hash="#/promote/overview"},this.addStep(n)}else if("group"==_reservio.categoryType){var n=new c;n.name="clickToCreateEventButtonGroup",n.element="#calendar-create-event",n.runOn="#/calendar",n.placement="right-bottom",n.showTimeoutDuration=5e3,this.addStep(n),n=new c,n.name="createEventPopoverGroup",n.element="#frm-event-name",n.runOn="#/calendar",n.appendTo=".modal-window",n.placement="right-bottom",n.isSubstep=!0,n.showTimeoutDuration=1e3,n.showNextOnClose=!1,n.onTooltipClicked=function(e){this.tutorial.hideActualStep(!0,!0),t("#frm-event-name").focus()},this.addStep(n),n=new c,n.name="goToPromote",n.element="ul.menu > li:nth-child(4)",n.runOn="#/",n.placement="bottom",n.onTooltipClicked=function(e){window.location.hash="#/promote/overview"},this.addStep(n)}};d.prototype=new u,d.prototype.constructor=d;var p=function(e){this.init("createBooking",e);var t=new c;t.name="createdEventGroup",t.element="#new-booking-client-name",t.runOn="#/calendar",t.placement="bottom",t.appendTo=".modal-window",t.showNextOnClose=!1,t.onTooltipClicked=function(e){this.tutorial.showNextStep(!0,!0)},this.addStep(t)};p.prototype=new u,p.prototype.constructor=p;var f=function(e){this.init("clientNote",e);var t=new c;t.name="clientNote",t.element="#client-note-visible",t.runOn="#/clients/detail",t.placement="bottom",t.appendTo=".canvas",this.addStep(t)};f.prototype=new u,f.prototype.constructor=f;var h=function(e){this.init("newBooking",e);var t=new c;t.name="newBooking",t.element=".calendar-notifications .btn",t.runOn="#/calendar",t.placement=function(){return{side:"bottom",offset:-100}},this.addStep(t);var t=new c;t.name="confirmBooking",t.element=".popover .btn.confirm",t.runOn="#/calendar",t.placement="bottom",this.addStep(t)};return h.prototype=new u,h.prototype.constructor=h,l}),function(e){function t(e,t){return function(n){return u(e.call(this,n),t)}}function n(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function i(){}function a(e){l(this,e)}function s(e){var t=this._data={},n=e.years||e.year||e.y||0,i=e.months||e.month||e.M||0,o=e.weeks||e.week||e.w||0,r=e.days||e.day||e.d||0,a=e.hours||e.hour||e.h||0,s=e.minutes||e.minute||e.m||0,l=e.seconds||e.second||e.s||0,u=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=u+1e3*l+6e4*s+36e5*a,this._days=r+7*o,this._months=i+12*n,t.milliseconds=u%1e3,l+=c(u/1e3),t.seconds=l%60,s+=c(l/60),t.minutes=s%60,a+=c(s/60),t.hours=a%24,r+=c(a/24),r+=7*o,t.days=r%30,i+=c(r/30),t.months=i%12,n+=c(i/12),t.years=n}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function c(e){return e<0?Math.ceil(e):Math.floor(e)}function u(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function d(e,t,n){var i,o=t._milliseconds,r=t._days,a=t._months;o&&e._d.setTime(+e+o*n),r&&e.date(e.date()+r*n),a&&(i=e.date(),e.date(1).month(e.month()+a*n).date(Math.min(i,e.daysInMonth())))}function p(e){return"[object Array]"===Object.prototype.toString.call(e)}function f(e,t){var n,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),r=0;for(n=0;n<i;n++)~~e[n]!==~~t[n]&&r++;return r+o}function h(e,t){return t.abbr=e,z[e]||(z[e]=new i),z[e].set(t),z[e]}function g(e){return e?(!z[e]&&F&&o("./lang/"+e),z[e]):P.fn._lang}function m(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function v(e){var t,n,i=e.match(j);for(t=0,n=i.length;t<n;t++)ae[i[t]]?i[t]=ae[i[t]]:i[t]=m(i[t]);return function(o){var r="";for(t=0;t<n;t++)r+="function"==typeof i[t].call?i[t].call(o,e):i[t];return r}}function b(e,t){function n(t){return e.lang().longDateFormat(t)||t}for(var i=5;i--&&B.test(t);)t=t.replace(B,n);return ie[t]||(ie[t]=v(t)),ie[t](e)}function y(e){switch(e){case"DDDD":return q;case"YYYY":return V;case"YYYYY":return U;case"S":case"SS":case"SSS":case"DDD":return $;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return Y;case"X":return K;case"Z":case"ZZ":return J;case"T":return X;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return W;default:return new RegExp(e.replace("\\",""))}}function w(e,t,n){var i,o=n._a;switch(e){case"M":case"MM":o[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":i=g(n._l).monthsParse(t),null!=i?o[1]=i:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(o[2]=~~t);break;case"YY":o[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":o[0]=~~t;break;case"a":case"A":n._isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":o[3]=~~t;break;case"m":case"mm":o[4]=~~t;break;case"s":case"ss":o[5]=~~t;break;case"S":case"SS":case"SSS":o[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,i=(t+"").match(ee),i&&i[1]&&(n._tzh=~~i[1]),i&&i[2]&&(n._tzm=~~i[2]),i&&"+"===i[0]&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}null==t&&(n._isValid=!1)}function x(e){var t,n,i=[];if(!e._d){for(t=0;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];i[3]+=e._tzh||0,i[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(i[0],i[1],i[2]),n.setUTCHours(i[3],i[4],i[5],i[6])):(n.setFullYear(i[0],i[1],i[2]),n.setHours(i[3],i[4],i[5],i[6])),e._d=n}}function _(e){var t,n,i=e._f.match(j),o=e._i;for(e._a=[],t=0;t<i.length;t++)n=(y(i[t]).exec(o)||[])[0],n&&(o=o.slice(o.indexOf(n)+n.length)),ae[i[t]]&&w(i[t],n,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),x(e)}function C(e){for(var t,n,i,o,r=99;e._f.length;){if(t=l({},e),t._f=e._f.pop(),_(t),n=new a(t),n.isValid()){i=n;break}o=f(t._a,n.toArray()),o<r&&(r=o,i=n)}l(e,i)}function k(e){var t,n=e._i;if(G.exec(n)){for(e._f="YYYY-MM-DDT",t=0;t<4;t++)if(Q[t][1].exec(n)){e._f+=Q[t][0];break}J.exec(n)&&(e._f+=" Z"),_(e)}else e._d=new Date(n)}function D(t){var n=t._i,i=L.exec(n);n===e?t._d=new Date:i?t._d=new Date((+i[1])):"string"==typeof n?k(t):p(n)?(t._a=n.slice(0),x(t)):t._d=n instanceof Date?new Date((+n)):new Date(n)}function S(e,t,n,i,o){return o.relativeTime(t||1,!!n,e,i)}function T(e,t,n){var i=I(Math.abs(e)/1e3),o=I(i/60),r=I(o/60),a=I(r/24),s=I(a/365),l=i<45&&["s",i]||1===o&&["m"]||o<45&&["mm",o]||1===r&&["h"]||r<22&&["hh",r]||1===a&&["d"]||a<=25&&["dd",a]||a<=45&&["M"]||a<345&&["MM",I(a/30)]||1===s&&["y"]||["yy",s];return l[2]=t,l[3]=e>0,l[4]=n,S.apply({},l)}function E(e,t,n){var i=n-t,o=n-e.day();return o>i&&(o-=7),o<i-7&&(o+=7),Math.ceil(P(e).add("d",o).dayOfYear()/7)}function M(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=g().preparse(t)),P.isMoment(t)?(e=l({},t),e._d=new Date((+t._d))):n?p(n)?C(e):_(e):D(e),new a(e))}function O(e,t){P.fn[e]=P.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}function H(e){P.duration.fn[e]=function(){return this._data[e]}}function N(e,t){P.duration.fn["as"+e]=function(){return+this/t}}for(var P,A,R="2.0.0",I=Math.round,z={},F="undefined"!=typeof module&&module.exports,L=/^\/?Date\((\-?\d+)/i,j=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,B=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,W=/\d\d?/,$=/\d{1,3}/,q=/\d{3}/,V=/\d{1,4}/,U=/[+\-]?\d{1,6}/,Y=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,J=/Z|[\+\-]\d\d:?\d\d/i,X=/T/i,K=/[\+\-]?\d+(\.\d{1,3})?/,G=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,Z="YYYY-MM-DDTHH:mm:ssZ",Q=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ee=/([\+\-]|\d\d)/gi,te="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),ne={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},ie={},oe="DDD w W M D d".split(" "),re="M D H h m s w W".split(" "),ae={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return u(this.year()%100,2)},YYYY:function(){return u(this.year(),4)},YYYYY:function(){return u(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return u(~~(this.milliseconds()/10),2)},SSS:function(){return u(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+u(~~(e/60),2)+":"+u(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+u(~~(10*e/6),4)},X:function(){return this.unix()}};oe.length;)A=oe.pop(),ae[A+"o"]=n(ae[A]);for(;re.length;)A=re.pop(),ae[A+A]=t(ae[A],2);for(ae.DDDD=t(ae.DDD,3),i.prototype={set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(n=P([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var o=this._relativeTime[n];return"function"==typeof o?o(e,t,n,i):o.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return E(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},P=function(e,t,n){return M({_i:e,_f:t,_l:n,_isUTC:!1})},P.utc=function(e,t,n){return M({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},P.unix=function(e){return P(1e3*e)},P.duration=function(e,t){var n,i=P.isDuration(e),o="number"==typeof e,r=i?e._data:o?{}:e;return o&&(t?r[t]=e:r.milliseconds=e),n=new s(r),i&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},P.version=R,P.defaultFormat=Z,P.lang=function(e,t){return e?(t?h(e,t):z[e]||g(e),void(P.duration.fn._lang=P.fn._lang=g(e))):P.fn._lang._abbr},P.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),g(e)},P.isMoment=function(e){return e instanceof a},P.isDuration=function(e){return e instanceof s},P.fn=a.prototype={clone:function(){return P(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return P.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!f(this._a,(this._isUTC?P.utc(this._a):P(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var t=b(this,e||P.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?P.duration(+t,e):P.duration(e,t),d(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?P.duration(+t,e):P.duration(e,t),d(this,n,-1),this},diff:function(e,t,n){var i,o,r=this._isUTC?P(e).utc():P(e).local(),a=6e4*(this.zone()-r.zone());return t&&(t=t.replace(/s$/,"")),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+r.daysInMonth()),o=12*(this.year()-r.year())+(this.month()-r.month()),o+=(this-P(this).startOf("month")-(r-P(r).startOf("month")))/i,"year"===t&&(o/=12)):(i=this-r-a,o="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?i/864e5:"week"===t?i/6048e5:i),n?o:c(o)},from:function(e,t){return P.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(P(),e)},calendar:function(){var e=this.diff(P().startOf("day"),"days",!0),t=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this));
},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<P([this.year()]).zone()||this.zone()<P([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e=e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+P(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+P(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+P(e).startOf(t)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return P.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=I((P(this).startOf("day")-P(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},isoWeek:function(e){var t=E(this,1,4);return null==e?t:this.add("d",7*(e-t))},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},lang:function(t){return t===e?this._lang:(this._lang=g(t),this)}},A=0;A<te.length;A++)O(te[A].toLowerCase().replace(/s$/,""),te[A]);O("year","FullYear"),P.fn.days=P.fn.day,P.fn.weeks=P.fn.week,P.fn.isoWeeks=P.fn.isoWeek,P.duration.fn=s.prototype={weeks:function(){return c(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,n=T(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:P.fn.lang};for(A in ne)ne.hasOwnProperty(A)&&(N(A,ne[A]),H(A.toLowerCase()));N("Weeks",6048e5),P.lang("en",{ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),F&&(module.exports=P),"undefined"==typeof ender&&(this.moment=P),"function"==typeof r&&r.amd&&r("moment",[],function(){return P})}.call(this);var a={version:"0.8.4",map:function(e){return a.routes.defined.hasOwnProperty(e)?a.routes.defined[e]:new a.core.route(e)},root:function(e){a.routes.root=e},rescue:function(e){a.routes.rescue=e},history:{initial:{},pushState:function(e,t,n){a.history.supported?a.dispatch(n)&&history.pushState(e,t,n):a.history.fallback&&(window.location.hash="#"+n)},popState:function(e){var t=!a.history.initial.popped&&location.href==a.history.initial.URL;a.history.initial.popped=!0,t||a.dispatch(document.location.pathname)},listen:function(e){if(a.history.supported=!(!window.history||!window.history.pushState),a.history.fallback=e,a.history.supported)a.history.initial.popped="state"in window.history,a.history.initial.URL=location.href,window.onpopstate=a.history.popState;else if(a.history.fallback){for(route in a.routes.defined)"#"!=route.charAt(0)&&(a.routes.defined["#"+route]=a.routes.defined[route],a.routes.defined["#"+route].path="#"+route);a.listen()}}},match:function(e,t){var n,i,o,r,s,l={},c=null;for(c in a.routes.defined)if(null!==c&&void 0!==c)for(c=a.routes.defined[c],n=c.partition(),r=0;r<n.length;r++){if(i=n[r],s=e,i.search(/:/)>0)for(o=0;o<i.split("/").length;o++)o<s.split("/").length&&":"===i.split("/")[o].charAt(0)&&(l[i.split("/")[o].replace(/:/,"")]=s.split("/")[o],s=s.replace(s.split("/")[o],i.split("/")[o]));if(i===s)return t&&(c.params=l),c}return null},dispatch:function(e){var t,n;if(a.routes.current!==e){if(a.routes.previous=a.routes.current,a.routes.current=e,n=a.match(e,!0),a.routes.previous&&(t=a.match(a.routes.previous),null!==t&&null!==t.do_exit&&t.do_exit()),null!==n)return n.run(),!0;null!==a.routes.rescue&&a.routes.rescue()}},listen:function(){var e=function(){a.dispatch(location.hash)};""===location.hash&&null!==a.routes.root&&(location.hash=a.routes.root),"onhashchange"in window&&(!document.documentMode||document.documentMode>=8)?window.onhashchange=e:setInterval(e,50),""!==location.hash&&a.dispatch(location.hash)},core:{route:function(e){this.path=e,this.action=null,this.do_enter=[],this.do_exit=null,this.params={},a.routes.defined[e]=this}},routes:{current:null,root:null,rescue:null,previous:null,defined:{}}};a.core.route.prototype={to:function(e){return this.action=e,this},enter:function(e){return e instanceof Array?this.do_enter=this.do_enter.concat(e):this.do_enter.push(e),this},exit:function(e){return this.do_exit=e,this},partition:function(){for(var e,t,n=[],i=[],o=/\(([^}]+?)\)/g;e=o.exec(this.path);)n.push(e[1]);for(i.push(this.path.split("(")[0]),t=0;t<n.length;t++)i.push(i[i.length-1]+n[t]);return i},run:function(){var e,t,n=!1;if(a.routes.defined[this.path].hasOwnProperty("do_enter")&&a.routes.defined[this.path].do_enter.length>0)for(e=0;e<a.routes.defined[this.path].do_enter.length;e++)if(t=a.routes.defined[this.path].do_enter[e].apply(this,[]),t===!1){n=!0;break}n||a.routes.defined[this.path].action()}},r("path",function(){}),r("reservio/app",["jquery","ko","reservio/utils","postbox","reservio/data","reservio/acl","reservio/lang","reservio/ajax","reservio/modules/tutorial","reservio/analytics","moment","path"],function(e,t,n,i,r,s,l,c,u,d){function p(e,n){var o=this;this.hashParamsChangedSubscription=null,this.hashParamsChanged=function(){o.loading(!1)},this.destroy=function(){},this.afterRender=function(){o.loading(!1),i.notify("viewLoaded")},this.scroll=function(e){},this.viewModel=new e(this,n),this.viewModel.view=this,this.pageDestroy=function(){o.destroy.call(this)},this.pageAfterRender=function(e){o.afterRender.call(this,e)},this.loading=t.observable(!0)}function f(e){this.settings=e.settings,this.hashParameters=null,this.loading=t.observable(!0),this.pages={},this.currentPage=t.observable(null),this.layout=t.computed(function(){return this.currentPage()?this.currentPage().layout:"fixed"},this),this.pages=e.pages,this.registerPageRoutes(this),this.clientsFilter=t.observable(""),this.intercomPageviewTimeout=null}moment.fn.startOfWeek=function(){return this.subtract("days",r.account().settings.weekStart()).startOf("week").add("days",r.account().settings.weekStart())},moment.fn.endOfWeek=function(){return this.endOf("week").add("days",r.account().settings.weekStart())},f.prototype.isParentPage=function(e,t){return"undefined"==typeof t&&(t=this.currentPage()),null!==t&&null!==e&&(n.is_string(e)&&(e=this.findPage(e)),e.name==t.name||"undefined"!=typeof t.parent&&this.isParentPage(e,t.parent))},f.prototype.findPage=function(e,t){if("undefined"==typeof t&&(t={name:"",pages:this.pages}),t.name==e)return t;if("undefined"!=typeof t.pages&&t.pages.length>0){for(var n=null,i=0;null==n&&i<t.pages.length;i++)n=this.findPage(e,t.pages[i]);return n}return null},f.prototype.setPageViewModel=function(e,t){this.currentPage()!=e?(this.currentPage()&&(i.stopListen(this.currentPage().view.hashParamsChangedSubscription),this.currentPage().view.pageDestroy()),e.view=new p(t,this),e.view.hashParamsChangedSubscription=i.listen("hashParamsChanged",e.view.hashParamsChanged),this.currentPage(e)):i.notify("hashParamsChanged",this.hashParameters)},f.prototype.hashChanged=function(e,t){var n=this;this.hashParameters=e;var i=window.location.hash.substr(1);return"undefined"!=typeof this.hashParameters.id&&"add"!=this.hashParameters.id&&(i=i.substr(0,i.indexOf(this.hashParameters.id))),_reservio.production&&ga("send","pageview",i),this.intercomPageviewTimeout&&clearTimeout(this.intercomPageviewTimeout),this.intercomPageviewTimeout=setTimeout(function(){Intercom("update")},5e3),this.currentPage()&&this.currentPage().view.loading(!0),(0!==t.name.indexOf("business")&&0!==t.name.indexOf("promote")||_reservio.userRole.can_manage)&&(0!==t.name.indexOf("client")||_reservio.userRole.can_manage_clients)?void o(["reservio/pages/"+t.name],function(e){n.log("pageView",window.location.href),n.setPageViewModel(t,e)}):void(window.location.hash="#/calendar/agendaWeek/today/0/0/0/0")},f.prototype.registerPageRoutes=function(e,t){var n=this;t=t||this.settings.defaultLayout,jQuery.each(e.pages,function(i,o){o.parent=e,o.layout=o.layout||t,o.hash&&a.map(o.hash).to(function(){n.hashChanged.call(n,this.params,o)}).enter(function(){}),o.pages&&n.registerPageRoutes(o,o.layout)})},f.prototype.runModule=function(e,t){o(["reservio/modules/"+e],function(e){"function"==typeof t&&t(new e(self))})},f.prototype.run=function(){a.listen(),t.applyBindings(this)},f.prototype.init=function(){var t=this;i.listen("viewLoaded",function(){i.notify("hashParamsChanged",t.hashParameters),u.check()}),i.listen("pageTitle",function(t){var n=e("head title"),i=n.text().match(/^(\(\d*\))?[^-]+(\-.+)/);i?document.title=(i[1]?i[1]:"")+" "+t+" "+i[2]:document.title=""}),a.root(this.settings.defaultHash),a.rescue(function(){window.location.hash=t.settings.defaultHash||""}),this.runReservio()};var h=[],g=null;f.prototype.log=function(e,t){if("pageView"!=e){var i=this;g?h.push({time:n.date.encode(new Date),type:e||"",url:window.location.href,value:t?JSON.stringify(t):""}):g=setTimeout(function(){h.length>0&&(c.post("/log-interaction/",{logs:h}),h=[]),g=null,i.log(e,t)},2e4)}},f.prototype.exportClientsCsvClicked=function(){var e=this;d.trackEventWithCounter("clients","csvExportClicked"),this.acl.activateTrialFeature("exportClientsCsv","starter",function(){"free"==r.account().plan.code?e.acl.showUpgradeModal(l.get("modal-upgrade-exportClients-title"),l.get("modal-upgrade-exportClients-text"),"exportClients.png","exportClients")():window.open("/exporter/clients/?format=csv","reservio-clients-csv")})},f.prototype.exportClientsPdfClicked=function(){var e=this;d.trackEventWithCounter("clients","pdfExportClicked"),this.acl.activateTrialFeature("exportClientsPdf","starter",function(){"free"==r.account().plan.code?e.acl.showUpgradeModal(l.get("modal-upgrade-exportClients-title"),l.get("modal-upgrade-exportClients-text"),"exportClients.png","exportClients")():window.open("/exporter/clients/?format=pdf","reservio-clients-pdf")})},f.prototype.importClientsClicked=function(t){var n=e("body").modal({template:"modal-import-clients-tpl",viewModel:{message:t,cancelClicked:function(){n.modal("hide")}},onShow:function(){e("#import-file").change(function(){var t=e("input[type=file]").val().split("\\").pop();e("#name-file").show(),e("#name-file").text(t)})}});n.modal("show")},f.prototype.clearClientsFilter=function(){m.clientsFilter(""),e("#clients-filter").focus()},f.prototype.clientsFilterSubmitted=function(){"#/clients"!==window.location.hash&&(window.location.hash="#/clients")},f.prototype.menuClicked=function(e,t){return e.clearClientsFilter(),!0},f.prototype.menuUpgradeClicked=function(){return d.trackEventWithCounter("app","menuUpgradeClicked"),!0},f.prototype.runReservio=function(){var n=this;this.acl=new s(this),this.data=r,this.lang=l,this._reservio=_reservio,this.log(),this.runModule("popover-new",function(){}),this.runModule("informationBar",function(n){t.applyBindings(n,e("#notification-canvas")[0])}),this.runModule("notificationsChecker",function(){}),this.supportClicked=function(){n.log("supportClicked"),d.trackEventWithCounter("app","supportClicked"),Intercom("showNewMessage")},e.when(r.account.load(),r.resources.load(),r.services.load()).then(function(){if(r.coupons.load(),n.acl.bookings.limit(r.account().plan.bookingsLimit),n.acl.bookings.count(r.account().plan.bookings),n.acl.clients.count(r.account().plan.clients),n.acl.clients.limit(r.account().plan.clientsLimit),_reservio.category=r.account().category(),u.init(_reservio.lastAchievedTutorialSteps),n.run(),n.loading(!1),_reservio.showWelcomeModal){var t=e("body").modal({template:_reservio.noCategory?"modal-welcome-noCategory-tpl":"modal-welcome-tpl",viewModel:{closeClicked:function(e,n){n.stopPropagation(),t.modal("hide")},bookingLinkClicked:function(){return n.log("welcomeBookingLinkClicked"),d.trackEventWithCounter("app","welcomeLinkClicked"),!0}},cls:"welcome",onHide:function(){e.get("/account/welcome-closed/",function(){}),u.start(),u.check()}});t.modal("show")}else u.start(),u.check();if(_reservio.showTrialExpiringModal){var o=!1,t=e("#second-modals").modal({template:"modal-trialExpiring-tpl",viewModel:{image:"//static."+_reservio.host+"/desktop/img/",goToUpgradeClicked:function(){t.modal("hide");var e="/upgrade/order/?plan=3";"function"!=typeof ga&&(window.location.href=e),d.trackEventWithCounter("trialExpiring","modalUpgradeClicked","pro",{hitCallback:function(){window.location.href=e}})},continueUsingClicked:function(){d.trackEventWithCounter("trialExpiring","modalContinueClicked","pro"),t.modal("hide")}},onHide:function(){o||d.trackEventWithCounter("trialExpiring","modalCloseClicked","pro")},cls:"modal-trial"});t.modal("show")}n.runModule("modal",function(){_reservio.message&&("csvImportError"==_reservio.message.type?n.importClientsClicked(_reservio.message):i.notify("modal.show","message",{template:"modal-message-tpl",viewModel:{message:_reservio.message,closeClicked:function(){i.notify("modal.hide","message")}}}))}),n.acl.bookings.isOverLimit()})};var m=new f({pages:[{name:"calendar",layout:"full",hash:"#/calendar/:view/:time/:resource_id/:service_id/:event_id/:contact_id",pages:[]},{name:"clients",layout:"clients",pages:[{name:"clients",hash:"#/clients",pages:[]},{name:"clientsDetail",hash:"#/clients/:action/:id",pages:[]}]},{name:"business",layout:"fixed",pages:[{name:"businessDashboard",hash:"#/business/dashboard",pages:[]},{name:"businessStatistics",layout:"full-fixed",hash:"#/business/statistics",pages:[]},{name:"businessDetails",hash:"#/business/details",pages:[]},{name:"businessResources",hash:"#/business/resources",pages:[{name:"businessResourcesForm",hash:"#/business/resources/form/:id",pages:[]}]},{name:"businessServices",hash:"#/business/services",pages:[{name:"businessServicesForm",hash:"#/business/services/form/:id",pages:[]}]},{name:"businessHolidays",hash:"#/business/holidays",pages:[{name:"businessHolidaysForm",hash:"#/business/holidays/form/:id",pages:[]}]},{name:"businessCoupons",hash:"#/business/coupons",pages:[{name:"businessCouponsForm",hash:"#/business/coupons/form/:id",pages:[]}]},{name:"businessSettings",hash:"#/business/settings",pages:[]},{name:"businessOrders",hash:"#/business/orders",pages:[]}]},{name:"promote",layout:"full-fixed",pages:[{name:"promoteOverview",hash:"#/promote/overview",pages:[]},{name:"promoteIntegration",hash:"#/promote/integration",pages:[]},{name:"promoteFacebook",hash:"#/promote/facebook",pages:[]}]},{name:"synchronization",layout:"full-fixed",hash:"#/synchronization(/:id)"}],settings:{defaultHash:"#/calendar/agendaWeek/today/0/0/0/0"}});return e(document).ready(function(){e(".header .menu li.dropdown > a").click(function(t){t.preventDefault(),t.stopPropagation(),e(this).toggleClass("active"),e(this).parent().find("ul").toggle()}),e(document).click(function(){e(".header .menu li.dropdown > a").removeClass("active"),e(".header .menu li.dropdown ul").hide()})}),m}),function(e,t){function n(t,n){var o,r,a,s=t.nodeName.toLowerCase();return"area"===s?(o=t.parentNode,r=o.name,!(!t.href||!r||"map"!==o.nodeName.toLowerCase())&&(a=e("img[usemap=#"+r+"]")[0],!!a&&i(a))):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.10.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"==typeof t?this.each(function(){var i=this;setTimeout(function(){e(i).focus(),n&&n.call(i)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,o,r=e(this[0]);r.length&&r[0]!==document;){if(i=r.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(o=parseInt(r.css("zIndex"),10),!isNaN(o)&&0!==o))return o;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),o=isNaN(i);return(o||i>=0)&&n(t,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function o(t,n,i,o){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?s["inner"+i].call(this):this.each(function(){e(this).css(a,o(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){e(this).css(a,o(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var o,r=e.ui[t].prototype;for(o in i)r.plugins[o]=r.plugins[o]||[],r.plugins[o].push([n,i[o]])},call:function(e,t,n){var i,o=e.plugins[t];if(o&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<o.length;i++)e.options[o[i][0]]&&o[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",o=!1;return t[i]>0||(t[i]=1,o=t[i]>0,t[i]=0,o)}}))}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,o=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(r){}o(t)},e.widget=function(t,n,i){var o,r,a,s,l={},c=t.split(".")[0];t=t.split(".")[1],o=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[c]=e[c]||{},r=e[c][t],a=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},o=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,r=this._superApply;return this._super=e,this._superApply=o,t=i.apply(this,arguments),this._super=n,this._superApply=r,t}}()):void(l[t]=i)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:r?s.widgetEventPrefix:t},l,{constructor:a,namespace:c,widgetName:t,widgetFullName:o}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete r._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(n){for(var o,r,a=i.call(arguments,1),s=0,l=a.length;s<l;s++)for(o in a[s])r=a[s][o],a[s].hasOwnProperty(o)&&r!==t&&(e.isPlainObject(r)?n[o]=e.isPlainObject(n[o])?e.widget.extend({},n[o],r):e.widget.extend({},r):n[o]=r);return n},e.widget.bridge=function(n,o){var r=o.prototype.widgetFullName||n;e.fn[n]=function(a){var s="string"==typeof a,l=i.call(arguments,1),c=this;return a=!s&&l.length?e.widget.extend.apply(null,[a].concat(l)):a,s?this.each(function(){var i,o=e.data(this,r);return o?e.isFunction(o[a])&&"_"!==a.charAt(0)?(i=o[a].apply(o,l),i!==o&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+a+"'")}):this.each(function(){var t=e.data(this,r);t?t.option(a||{})._init():e.data(this,r,new o(a,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var o,r,a,s=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(s={},o=n.split("."),n=o.shift(),o.length){for(r=s[n]=e.widget.extend({},this.options[n]),a=0;a<o.length-1;a++)r[o[a]]=r[o[a]]||{},r=r[o[a]];if(n=o.pop(),i===t)return r[n]===t?null:r[n];r[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];s[n]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var o,r=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=o=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),e.each(i,function(i,a){function s(){if(t||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?r[a]:a).apply(r,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+r.eventNamespace,u=l[2];u?o.delegate(u,c,s):n.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var o,r,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(o in r)o in n||(n[o]=r[o]);return this.element.trigger(n,i),!(e.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,o,r){"string"==typeof o&&(o={effect:o});var a,s=o?o===!0||"number"==typeof o?n:o.effect||n:t;o=o||{},"number"==typeof o&&(o={duration:o}),a=!e.isEmptyObject(o),o.complete=r,o.delay&&i.delay(o.delay),a&&e.effects&&e.effects.effect[s]?i[t](o):s!==t&&i[s]?i[s](o.duration,o.easing,r):i.queue(function(n){e(this)[t](),r&&r.call(i[0]),n()})}})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!n){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,o=1===t.which,r=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&e(t.target).closest(this.options.cancel).length;return!(o&&!r&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0))}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return!(this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0))},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n,i=this,o=!1,r=!1;for(e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),n=this.element[0];n&&(n=n.parentNode);)n===document&&(o=!0);return!(!o&&"original"===this.options.helper)&&("invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1)},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),
e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length;return e(this.options.handle,this.element).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,o=this.options;if("parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=["document"===o.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"===o.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"===o.containment?0:e(window).scrollLeft())+e("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"===o.containment?0:e(window).scrollTop())+(e("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||o.containment.constructor===Array)o.containment.constructor===Array&&(this.containment=o.containment);else{if(n=e(o.containment),i=n[0],!i)return;t="hidden"!==e(i).css("overflow"),this.containment=[(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0),(parseInt(e(i).css("borderTopWidth"),10)||0)+(parseInt(e(i).css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(o[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:o.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:o.scrollLeft())*i}},_generatePosition:function(t){var n,i,o,r,a=this.options,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName),c=t.pageX,u=t.pageY;return this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(c=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(u=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(c=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(u=n[3]+this.offset.click.top)),a.grid&&(o=a.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,u=n?o-this.offset.click.top>=n[1]||o-this.offset.click.top>n[3]?o:o-this.offset.click.top>=n[1]?o-a.grid[1]:o+a.grid[1]:o,r=a.grid[0]?this.originalPageX+Math.round((c-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,c=n?r-this.offset.click.left>=n[0]||r-this.offset.click.left>n[2]?r:r-this.offset.click.left>=n[0]?r-a.grid[0]:r+a.grid[0]:r)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:c-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("ui-draggable"),o=i.options,r=e.extend({},n,{item:i.element});i.sortables=[],e(o.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n){var i=e(this).data("ui-draggable"),o=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,o))})},drag:function(t,n){var i=e(this).data("ui-draggable"),o=this;e.each(i.sortables,function(){var r=!1,a=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(a.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(o).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),o=e(this).data("ui-draggable").options;i.css("opacity")&&(o._opacity=i.css("opacity")),i.css("opacity",o.opacity)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),i=n.options,o=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=o=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=o=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=o=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=o=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?o=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(o=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?o=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(o=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){var i,o,r,a,s,l,c,u,d,p,f=e(this).data("ui-draggable"),h=f.options,g=h.snapTolerance,m=n.offset.left,v=m+f.helperProportions.width,b=n.offset.top,y=b+f.helperProportions.height;for(d=f.snapElements.length-1;d>=0;d--)s=f.snapElements[d].left,l=s+f.snapElements[d].width,c=f.snapElements[d].top,u=c+f.snapElements[d].height,s-g<m&&m<l+g&&c-g<b&&b<u+g||s-g<m&&m<l+g&&c-g<y&&y<u+g||s-g<v&&v<l+g&&c-g<b&&b<u+g||s-g<v&&v<l+g&&c-g<y&&y<u+g?("inner"!==h.snapMode&&(i=Math.abs(c-y)<=g,o=Math.abs(u-b)<=g,r=Math.abs(s-v)<=g,a=Math.abs(l-m)<=g,i&&(n.position.top=f._convertPositionTo("relative",{top:c-f.helperProportions.height,left:0}).top-f.margins.top),o&&(n.position.top=f._convertPositionTo("relative",{top:u,left:0}).top-f.margins.top),r&&(n.position.left=f._convertPositionTo("relative",{top:0,left:s-f.helperProportions.width}).left-f.margins.left),a&&(n.position.left=f._convertPositionTo("relative",{top:0,left:l}).left-f.margins.left)),p=i||o||r||a,"outer"!==h.snapMode&&(i=Math.abs(c-b)<=g,o=Math.abs(u-y)<=g,r=Math.abs(s-m)<=g,a=Math.abs(l-v)<=g,i&&(n.position.top=f._convertPositionTo("relative",{top:c,left:0}).top-f.margins.top),o&&(n.position.top=f._convertPositionTo("relative",{top:u-f.helperProportions.height,left:0}).top-f.margins.top),r&&(n.position.left=f._convertPositionTo("relative",{top:0,left:s}).left-f.margins.left),a&&(n.position.left=f._convertPositionTo("relative",{top:0,left:l-f.helperProportions.width}).left-f.margins.left)),!f.snapElements[d].snapping&&(i||o||r||a||p)&&f.options.snap.snap&&f.options.snap.snap.call(f.element,t,e.extend(f._uiHash(),{snapItem:f.snapElements[d].item})),f.snapElements[d].snapping=i||o||r||a||p):(f.snapElements[d].snapping&&f.options.snap.release&&f.options.snap.release.call(f.element,t,e.extend(f._uiHash(),{snapItem:f.snapElements[d].item})),f.snapElements[d].snapping=!1)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=e(this).data("ui-draggable").options,i=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});i.length&&(t=parseInt(i[0].style.zIndex,10)||0,e(i).each(function(e){this.style.zIndex=t+e}),this[0].style.zIndex=t+i.length)}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),o=e(this).data("ui-draggable").options;i.css("zIndex")&&(o._zIndex=i.css("zIndex")),i.css("zIndex",o.zIndex)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery),function(e,t){function n(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,n,i,o,r,a=this,s=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!s.aspectRatio,aspectRatio:s.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:s.helper||s.ghost||s.animate?s.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=s.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},n=0;n<t.length;n++)i=e.trim(t[n]),r="ui-resizable-"+i,o=e("<div class='ui-resizable-handle "+r+"'></div>"),o.css({zIndex:s.zIndex}),"se"===i&&o.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(o);this._renderAxis=function(t){var n,i,o,r;t=t||this.element;for(n in this.handles)this.handles[n].constructor===String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(i=e(this.handles[n],this.element),r=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth(),o=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(o,r),this._proportionallyResize()),e(this.handles[n]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=o&&o[1]?o[1]:"se")}),s.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){s.disabled||(e(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){s.disabled||a.resizing||(e(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,i,o=!1;for(n in this.handles)i=e(this.handles[n])[0],(i===t.target||e.contains(i,t.target))&&(o=!0);return!this.options.disabled&&o},_mouseStart:function(t){var i,o,r,a=this.options,s=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:s.top,left:s.left}),this._renderProxy(),i=n(this.helper.css("left")),o=n(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,o+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:o},this.size=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:i,top:o},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===r?this.axis+"-resize":r),l.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,i=this.helper,o={},r=this.originalMousePosition,a=this.axis,s=this.position.top,l=this.position.left,c=this.size.width,u=this.size.height,d=t.pageX-r.left||0,p=t.pageY-r.top||0,f=this._change[a];return!!f&&(n=f.apply(this,[t,d,p]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==s&&(o.top=this.position.top+"px"),this.position.left!==l&&(o.left=this.position.left+"px"),this.size.width!==c&&(o.width=this.size.width+"px"),this.size.height!==u&&(o.height=this.size.height+"px"),i.css(o),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(o)||this._trigger("resize",t,this.ui()),!1)},_mouseStop:function(t){this.resizing=!1;var n,i,o,r,a,s,l,c=this.options,u=this;return this._helper&&(n=this._proportionallyResizeElements,i=n.length&&/textarea/i.test(n[0].nodeName),o=i&&e.ui.hasScroll(n[0],"left")?0:u.sizeDiff.height,r=i?0:u.sizeDiff.width,a={width:u.helper.width()-r,height:u.helper.height()-o},s=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,l=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(e.extend(a,{top:l,left:s})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,o,r,a,s=this.options;a={minWidth:i(s.minWidth)?s.minWidth:0,maxWidth:i(s.maxWidth)?s.maxWidth:1/0,minHeight:i(s.minHeight)?s.minHeight:0,maxHeight:i(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,o=a.minWidth/this.aspectRatio,n=a.maxHeight*this.aspectRatio,r=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),o>a.minHeight&&(a.minHeight=o),n<a.maxWidth&&(a.maxWidth=n),r<a.maxHeight&&(a.maxHeight=r)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,o=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===o&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===o&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,o=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=i(e.width)&&t.minWidth&&t.minWidth>e.width,s=i(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,u=/sw|nw|w/.test(n),d=/nw|ne|n/.test(n);return a&&(e.width=t.minWidth),s&&(e.height=t.minHeight),o&&(e.width=t.maxWidth),r&&(e.height=t.maxHeight),a&&u&&(e.left=l-t.minWidth),o&&u&&(e.left=l-t.maxWidth),s&&d&&(e.top=c-t.minHeight),r&&d&&(e.top=c-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,n,i,o,r=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(o=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],n=[o.css("borderTopWidth"),o.css("borderRightWidth"),o.css("borderBottomWidth"),o.css("borderLeftWidth")],i=[o.css("paddingTop"),o.css("paddingRight"),o.css("paddingBottom"),o.css("paddingLeft")],t=0;t<n.length;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(i[t],10)||0);o.css({height:r.height()-this.borderDif[0]-this.borderDif[2]||0,width:r.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,i=this.originalPosition;return{left:i.left+t,width:n.width-t}},n:function(e,t,n){var i=this.originalSize,o=this.originalPosition;return{top:o.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},sw:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,i]))},ne:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},nw:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,i]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("ui-resizable"),i=n.options,o=n._proportionallyResizeElements,r=o.length&&/textarea/i.test(o[0].nodeName),a=r&&e.ui.hasScroll(o[0],"left")?0:n.sizeDiff.height,s=r?0:n.sizeDiff.width,l={width:n.size.width-s,height:n.size.height-a},c=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,u=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(l,u&&c?{top:u,left:c}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};o&&o.length&&e(o[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,o,r,a,s,l,c=e(this).data("ui-resizable"),u=c.options,d=c.element,p=u.containment,f=p instanceof e?p.get(0):/parent/.test(p)?d.parent().get(0):p;f&&(c.containerElement=e(f),/document/.test(p)||p===document?(c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(f),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,o){i[e]=n(t.css("padding"+o))}),c.containerOffset=t.offset(),c.containerPosition=t.position(),c.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},o=c.containerOffset,r=c.containerSize.height,a=c.containerSize.width,s=e.ui.hasScroll(f,"left")?f.scrollWidth:a,l=e.ui.hasScroll(f)?f.scrollHeight:r,c.parentData={element:f,left:o.left,top:o.top,width:s,height:l}))},resize:function(t){var n,i,o,r,a=e(this).data("ui-resizable"),s=a.options,l=a.containerOffset,c=a.position,u=a._aspectRatio||t.shiftKey,d={top:0,left:0},p=a.containerElement;p[0]!==document&&/static/.test(p.css("position"))&&(d=l),c.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-d.left),u&&(a.size.height=a.size.width/a.aspectRatio),a.position.left=s.helper?l.left:0),c.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),u&&(a.size.width=a.size.height*a.aspectRatio),a.position.top=a._helper?l.top:0),a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top,n=Math.abs((a._helper?a.offset.left-d.left:a.offset.left-d.left)+a.sizeDiff.width),i=Math.abs((a._helper?a.offset.top-d.top:a.offset.top-l.top)+a.sizeDiff.height),o=a.containerElement.get(0)===a.element.parent().get(0),r=/relative|absolute/.test(a.containerElement.css("position")),o&&r&&(n-=a.parentData.left),n+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-n,u&&(a.size.height=a.size.width/a.aspectRatio)),i+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-i,u&&(a.size.width=a.size.height*a.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),n=t.options,i=t.containerOffset,o=t.containerPosition,r=t.containerElement,a=e(t.helper),s=a.offset(),l=a.outerWidth()-t.sizeDiff.width,c=a.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(r.css("position"))&&e(this).css({left:s.left-o.left-i.left,width:l,height:c}),t._helper&&!n.animate&&/static/.test(r.css("position"))&&e(this).css({left:s.left-o.left-i.left,width:l,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,i=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof n.alsoResize||n.alsoResize.parentNode?i(n.alsoResize):n.alsoResize.length?(n.alsoResize=n.alsoResize[0],i(n.alsoResize)):e.each(n.alsoResize,function(e){i(e)})},resize:function(t,n){var i=e(this).data("ui-resizable"),o=i.options,r=i.originalSize,a=i.originalPosition,s={height:i.size.height-r.height||0,width:i.size.width-r.width||0,top:i.position.top-a.top||0,left:i.position.left-a.left||0},l=function(t,i){e(t).each(function(){var t=e(this),o=e(this).data("ui-resizable-alsoresize"),r={},a=i&&i.length?i:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var n=(o[t]||0)+(s[t]||0);n&&n>=0&&(r[t]=n||null)}),t.css(r)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?l(o.alsoResize):e.each(o.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),n=t.options,i=t.size,o=t.originalSize,r=t.originalPosition,a=t.axis,s="number"==typeof n.grid?[n.grid,n.grid]:n.grid,l=s[0]||1,c=s[1]||1,u=Math.round((i.width-o.width)/l)*l,d=Math.round((i.height-o.height)/c)*c,p=o.width+u,f=o.height+d,h=n.maxWidth&&n.maxWidth<p,g=n.maxHeight&&n.maxHeight<f,m=n.minWidth&&n.minWidth>p,v=n.minHeight&&n.minHeight>f;n.grid=s,m&&(p+=l),v&&(f+=c),h&&(p-=l),g&&(f-=c),/^(se|s|e)$/.test(a)?(t.size.width=p,t.size.height=f):/^(ne)$/.test(a)?(t.size.width=p,t.size.height=f,t.position.top=r.top-d):/^(sw)$/.test(a)?(t.size.width=p,t.size.height=f,t.position.left=r.left-u):(t.size.width=p,t.size.height=f,t.position.top=r.top-d,t.position.left=r.left-u)}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){var t,n,i=this.options,o=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",a=[];
for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this.range=e([]),i.range&&(i.range===!0&&(i.values?i.values.length&&2!==i.values.length?i.values=[i.values[0],i.values[0]]:e.isArray(i.values)&&(i.values=i.values.slice(0)):i.values=[this._valueMin(),this._valueMin()]),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===i.range||"max"===i.range?" ui-slider-range-"+i.range:""))),n=i.values&&i.values.length||1,t=o.length;t<n;t++)a.push(r);this.handles=o.add(e(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){i.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){i.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._setOption("disabled",i.disabled),this._on(this.handles,this._handleEvents),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,i,o,r,a,s,l,c,u=this,d=this.options;return!d.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),o=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(i-u.values(t));(o>n||o===n&&(t===u._lastChangedValue||u.values(t)===d.min))&&(o=n,r=e(this),a=t)}),s=this._start(t,a),s!==!1&&(this._mouseSliding=!0,this._handleIndex=a,r.addClass("ui-state-active").focus(),l=r.offset(),c=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-r.width()/2,top:t.pageY-l.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,a,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,o,r;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=n/t,i>1&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),o=this._valueMax()-this._valueMin(),r=this._valueMin()+i*o,this._trimAlignValue(r)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var i,o,r;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>i||1===t&&n<i)&&(n=i),n!==this.values(t)&&(o=this.values(),o[t]=n,r=this._trigger("slide",e,{handle:this.handles[t],value:n,values:o}),i=this.values(t?0:1),r!==!1&&this.values(t,n,!0))):n!==this.value()&&(r=this._trigger("slide",e,{handle:this.handles[t],value:n}),r!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,n){var i,o,r;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,o=arguments[0],r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(o[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,n){var i,o=0;switch(e.isArray(this.options.values)&&(o=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0)):this.handles.prop("disabled",!1);break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;i<o;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,i,o,r,a=this.options.range,s=this.options,l=this,c=!this._animateOff&&s.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](u,s.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:s.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:s.animate}))),t=n}):(i=this.value(),o=this._valueMin(),r=this._valueMax(),n=r!==o?(i-o)/(r-o)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](u,s.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},s.animate),"max"===a&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:s.animate}),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},s.animate),"max"===a&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:s.animate}))},_handleEvents:{keydown:function(t){var i,o,r,a,s=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,s),i===!1))return}switch(a=this.options.step,o=r=this.options.values&&this.options.values.length?this.values(s):this.value(),t.keyCode){case e.ui.keyCode.HOME:r=this._valueMin();break;case e.ui.keyCode.END:r=this._valueMax();break;case e.ui.keyCode.PAGE_UP:r=this._trimAlignValue(o+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(o-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(o===this._valueMax())return;r=this._trimAlignValue(o+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(o===this._valueMin())return;r=this._trimAlignValue(o-a)}this._slide(t,s,r)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),r("jquery-ui",["jquery"],function(){}),function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n),this.loadingText=this.$element.data("loading-text")||this.options.loadingText,this.timer=null};t.prototype.loading=function(){var t="disabled",n=this.$element,i=n.is("input")?"val":"text";n.data("reset-text",n[i]()),n[i](this.loadingText),n.addClass(t).attr(t,t),e("#page-disabler").addClass("active")},t.prototype.reset=function(){var t="disabled",n=this.$element,i=n.is("input")?"val":"html";e("#page-disabler").removeClass("active"),clearTimeout(this.timer),this.timer=null,this.$element.find(".progress").remove(),n.data("reset-text")&&n[i](n.data("reset-text")),n.removeClass(t).removeAttr(t)},e.fn.button=function(n){var i=Array.prototype.slice.call(arguments,0);return this.each(function(){var o=e(this),r=o.data("button"),a="object"==typeof n&&n;r||o.data("button",r=new t(this,a)),"string"==typeof n&&r[n].apply(r,i.slice(1))})},e.fn.button.defaults={loadingText:"Saving",resizeBy:13},e.fn.button.Constructor=t}(jQuery),r("libs/buttons",["jquery"],function(){}),r("libs/datePicker",["jquery","reservio/utils"],function(e,t){e.datePicker=function(n,i){function o(e,t){return!(!e||!t)&&(e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate())}function r(t){return $e=e(d.parents(i.appendTo+", body")[0]),$e}var a,s,l,c,u=this,d=e(n),p={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],firstDay:1,type:"day",append:!0,appendTo:"body",selectedDate:new Date,align:"right",dayClick:function(n){e(this).val(t.date.formatDate(n,"MM/dd/yyyy")).trigger("change")},dayDblClick:function(e){},dateRange:[null,null]},f=!1,h=[];u.settings={},u.init=function(){if(u.settings=e.extend({},p,i),u.settings.dateRange[0]||(u.settings.dateRange[0]=new Date(0)),u.settings.dateRange[1]||(u.settings.dateRange[1]=new Date((new Date).getTime()+63072e8)),u.settings.selectedDate=new Date(u.settings.selectedDate.getTime()),l=new Date(u.settings.selectedDate.getTime()),d=e(n),u.settings.append)a=e('<div class="datepicker"></div>'),d.append(a);else{s=d,a=e('<div class="datepicker-window datepicker" style="display: none;"></div>'),$appendToElement=r(i.appendTo);var t=$appendToElement.css("position");$appendToElement.is("body")||"absolute"==t||"relative"==t||$appendToElement.css("position","relative"),$appendToElement.append(a),d.keydown(T),C()}g(),m(u.settings.selectedDate),y(u.settings.selectedDate)};var g=function(){a.empty();var t=e("<div>");t.addClass("top"),c=e("<span>").addClass("month"),t.append(c),t.append(e("<a>").addClass("prev").html('<i class="icon icon-arrow-left"></i>').click(w)),t.append(e("<a>").addClass("next").html('<i class="icon icon-arrow-right"></i>').click(x)),a.append(t);for(var n=e("<div>").addClass("body"),i=e("<div>").addClass("days"),o=u.settings.firstDay;o<7+u.settings.firstDay;o++)i.append(e("<span>").text(u.settings.dayNames[o%7]));n.append(i);for(var r,s,l=e("<div>").addClass("weeks"),d=0;d<6;d++){r=e("<div>").addClass("week");for(var p=0;p<7;p++)s=e("<a>"),s.click(v).dblclick(b),r.append(s),h[7*d+p]=s;l.append(r)}n.append(l),a.append(n)},m=function(t){a.removeClass("week day"),a.find(".active").removeClass("active"),a.find(".today").removeClass("today"),a.addClass(u.settings.type);var n=u.settings.monthNames[t.getMonth()];c.text(n.charAt(0).toUpperCase()+n.slice(1)+" "+t.getFullYear());var i=new Date(t.getTime());i.setDate(1),0==u.settings.firstDay?i.setDate(i.getDate()-i.getDay()):(i.getDay()>1||0==i.getDay())&&(i.setDate(-1),i.setDate(i.getDate()-i.getDay()+1));for(var r,s=new Date(i.getTime()),l=moment(s).hours(5).minutes(0).seconds(0).milliseconds(0),d=0;d<42;d++)r=h[d],r.removeClass("different-month"),r.addClass("disabled"),r.css({color:""}),l.month()!=t.getMonth()&&r.addClass("different-month"),o(l.toDate(),new Date)&&r.addClass("today"),r.text(l.date()).attr("href","#").data("time",1e3*l.unix()),l.add(1,"days");s=new Date(s.getTime()),N(function(t){if(t){var n=0;e.each(t,function(e,t){r=h[n],(!u.settings.dateRange[0]||s>=u.settings.dateRange[0])&&(!u.settings.dateRange[1]||s<=u.settings.dateRange[1])&&t&&r.removeClass("disabled"),s.setDate(s.getDate()+1),n++})}else for(var i=0,o=0;o<6;o++)for(var n=0;n<7;n++)r=h[i],(!u.settings.dateRange[0]||s>=u.settings.dateRange[0])&&(!u.settings.dateRange[1]||s<=u.settings.dateRange[1])&&r.removeClass("disabled"),s.setDate(s.getDate()+1),i++})},v=function(t){if(t.preventDefault(),!e(this).hasClass("disabled")){var n=new Date(e(this).data("time"));"function"==typeof u.settings.dayClick&&u.settings.dayClick.call(d,n),M(n),E()}},b=function(t){if(t.preventDefault(),!e(this).hasClass("disabled")){var n=new Date(e(this).data("time"));"function"==typeof u.settings.dayDblClick&&u.settings.dayDblClick.call(d,n)}},y=function(e){if(u.settings.selectedDate.getMonth()==l.getMonth()){var t;a.find(".active").removeClass("active");for(var n=0;n<42;n++)t=new Date(h[n].data("time")),o(t,e)&&(h[n].addClass("active"),h[n].parent().addClass("active"))}H()},w=function(t){return t.preventDefault(),!e(this).find("i").hasClass("disabled")&&(l.setMonth(l.getMonth()-1),m(l),y(l),void H())},x=function(t){return t.preventDefault(),!e(this).find("i").hasClass("disabled")&&(l.setMonth(l.getMonth()+1),m(l),y(l),void H())},_=function(t){0==a.has(e(t.target)).length&&t.target!==s[0]&&E()},C=function(){s.attr("autocomplete","off"),s.bind("focus",k).bind("click",D),a.mousedown(function(e){f=!0}),s.mousedown(function(e){f=!0})},k=function(e){f||(e.stopPropagation(),u.settings.selectedDate=new Date(Date.parse(d.val())),S())},D=function(e){a.is(":hidden")?(u.settings.selectedDate=new Date(Date.parse(d.val())),S()):E()},S=function(){if(!u.settings.append){var t;t="left"==u.settings.align?s.offset().left-$appendToElement.offset().left:s.offset().left-$appendToElement.offset().left+s.outerWidth()-a.outerWidth(),s.offset().top-$appendToElement.offset().top+s.outerHeight()+a.height()<$appendToElement.height()+50?a.css({top:s.offset().top-$appendToElement.offset().top+s.outerHeight()+"px",left:t+"px"}):a.css({top:s.offset().top-$appendToElement.offset().top-a.height()-3+"px",left:t+"px"}),a.show(),e(document).bind("click",_)}},T=function(e){switch(e.keyCode){case 9:E()}},E=function(){u.settings.append||(e(document).unbind("click",_),a.hide(),f=!1)},M=function(e){isNaN(e.valueOf())&&(e=new Date),l.getMonth()==e.getMonth()||m(e),u.settings.selectedDate=e,l=new Date(e.getTime()),y(e)},O=function(e,t){var n=a.find("."+e+" i");t?n.addClass("disabled"):n.removeClass("disabled")},H=function(){var e=2592e6;if(null!=u.settings.dateRange[0]){var t=new Date(l.getFullYear(),l.getMonth()+1,0);t.getTime()-e<u.settings.dateRange[0].getTime()?O("prev",!0):O("prev",!1)}if(null!=u.settings.dateRange[1]){var t=new Date(l.getFullYear(),l.getMonth(),1);t.getTime()+e>u.settings.dateRange[1].getTime()?O("next",!0):O("next",!1)}},N=function(t){if(i.availability){var n=new Date(l.getTime());n.setDate(1),0==u.settings.firstDay?n.setDate(n.getDate()-n.getDay()):(n.getDay()>1||0==n.getDay())&&(n.setDate(-1),n.setDate(n.getDate()-n.getDay()+1));var o=new Date(n.getTime()+35424e5);i.availability(n,o,function(n){var i=0;e.each(n,function(t,n){var o=e(".weeks a").eq(i);o.hasClass("disabled")||(n?o.removeClass("disabled"):o.addClass("disabled")),i++}),t(n)})}else t(!1)};return u.init(),{setType:function(e){"undefined"!=typeof e&&(u.settings.type=e,m(l),y(l))},setDate:M,getDate:function(){return u.settings.selectedDate}}},e.fn.datePicker=function(t){return this.each(function(){if(void 0==e(this).data("datePicker")){var n=new e.datePicker(this,t);e(this).data("datePicker",n)}})}}),r("libs/fullcalendar",["jquery","reservio/utils","jquery-ui"],function(e,t){!function(e,n){function o(t){e.extend(!0,Te,t)}function r(t,i,o,r){function f(e){Me=e,le(Me,He),ue(Me)}function h(e){He=e,le(Me,He)}function g(){return Me}function v(e){_e=e,ge.renderAvailability&&ge.renderAvailability(xe)}function b(){return _e}function y(e){fe?(N(),H(),q(),M(e)):x()}function x(){he=i.theme?"ui":"fc",t.addClass("fc"),i.isRTL&&t.addClass("fc-rtl"),i.theme&&t.addClass("ui-widget"),fe=e("<div class='fc-content' style='position:relative'></div>").prependTo(t),de=new a(re,i),pe=de.render(),pe&&t.prepend(pe),E(i.defaultView),e(window).resize(A),T()||_()}function _(){setTimeout(function(){!ge.start&&T()&&M()},0)}function C(){e(window).unbind("resize",A),de.destroy(),fe.remove(),t.removeClass("fc fc-rtl ui-widget")}function S(){return 0!==Ce.offsetWidth}function T(){return 0!==e("body")[0].offsetWidth}function E(t){if(!ge||t!=ge.name){Se++,Y();var n,i=ge;i?((i.beforeHide||V)(),$(fe,fe.height()),i.element.hide().removeClass("active-view")):$(fe,1),fe.css("overflow","hidden"),ge=ke[t],ge?ge.element.show().addClass("active-view"):ge=ke[t]=new Oe[t](n=be=e("<div class='fc-view fc-view-"+t+" active-view' style='position:absolute'/>").appendTo(fe),re),i&&de.deactivateButton(i.name),de.activateButton(t),ge.setResources&&ge.setResources(ce),ue(Me),M(),fe.css("overflow",""),i&&$(fe,1),n||(ge.afterShow||V)(),Se--}}function M(e,i){if(i=i||!1,S()){Se++,Y(),ve===n&&N();var o=!1;!ge.start||i||e||Te<ge.start||Te>=ge.end?(ge.render(Te,e||0),P(!0),o=!0):ge.sizeDirty?(ge.clearEvents(),P(),o=!0):ge.eventsDirty&&(ge.clearEvents(),o=!0),ge.sizeDirty=!1,ge.eventsDirty=!1,R(o),me=t.outerWidth(),de.updateTitle(ge.title);var r=new Date;r>=ge.start&&r<ge.end?de.disableButton("today"):de.enableButton("today"),Se--,we(ge.start,ge.end,Me),ge.trigger("viewDisplay",Ce)}}function O(){H(),S()&&(N(),P(),ge.clearEvents(),ge.renderEvents(Ee),ge.renderAvailability(xe),ge.sizeDirty=!1)}function H(){e.each(ke,function(e,t){t.sizeDirty=!0})}function N(){ve=i.contentHeight?i.contentHeight:i.height?i.height-(pe?pe.height():0)-L(fe):Math.round(fe.width()/Math.max(i.aspectRatio,.5))}function P(e){Se++,ge.setHeight(ve,e),be&&(be.css("position","relative"),be=null),ge.setWidth(fe.width(),e),Se--}function A(e){if(!Se)if(ge.start){var n=++De;setTimeout(function(){n==De&&!Se&&S()&&me!=(me=t.outerWidth())&&(Se++,O(),ge.trigger("windowResize",Ce),Se--)},200)}else _()}function R(e){!i.lazyFetching||ae(ge.visStart,ge.visEnd)?I():e&&W()}function I(){se(ge.visStart,ge.visEnd)}function z(e){Ee=e,W()}function F(e){ce=e,"resourceDay"==ge.name&&(ge.setResources(ce),M(0,!0))}function j(e){xe=e,ge.renderAvailability&&ge.renderAvailability(xe)}function B(e){W(e)}function W(e){q(),S()&&(ge.clearEvents(),ge.renderEvents(Ee,e),ge.eventsDirty=!1)}function q(){e.each(ke,function(e,t){t.eventsDirty=!0})}function U(e,t,i){ge.select(e,t,i===n||i)}function Y(){ge&&ge.unselect()}function J(){M(-1)}function X(){M(1)}function K(){u(Te,-1),M()}function G(){u(Te,1),M()}function Z(){Te=new Date,M()}function Q(e,t,n){e instanceof Date?Te=m(e):w(Te,e,t,n),M()}function ee(e,t,i){e!==n&&u(Te,e),t!==n&&d(Te,t),i!==n&&p(Te,i),M()}function te(){return m(Te)}function ne(){return ge}function ie(e,t){return t===n?i[e]:("height"!=e&&"contentHeight"!=e&&"aspectRatio"!=e||(i[e]=t,O()),"selectable"==e&&(i[e]=t),void("disableDragging"==e&&(i[e]=t)))}function oe(e,t){if(i[e])return i[e].apply(t||Ce,Array.prototype.slice.call(arguments,2))}var re=this;re.options=i,re.render=y,re.destroy=C,re.refetchEvents=I,re.reportEvents=z,re.reportResources=F,re.reportAvailability=j,re.reportEventChange=B,re.rerenderEvents=W,re.changeView=E,re.select=U,re.unselect=Y,re.prev=J,re.next=X,re.prevYear=K,re.nextYear=G,re.today=Z,re.gotoDate=Q,re.incrementDate=ee,re.formatDate=function(e,t){return k(e,t,i)},re.formatDates=function(e,t,n){return D(e,t,n,i)},re.getDate=te,re.getView=ne,re.option=ie,re.trigger=oe,re.setSelectedResource=f,re.setSelectedService=h,re.getSelectedResource=g,re.getSelectedAvailability=b,re.displayResourcesAvailability=v,s.call(re,i,o);var ae=re.isFetchNeeded,se=re.fetchEvents,le=re.filterEvents;c.call(re,i);var ce,ue=re.filterResources;l.call(re,i);var de,pe,fe,he,ge,me,ve,be,ye,we=re.fetchAvailability,xe=null,_e=0,Ce=t[0],ke={},De=0,Se=0,Te=new Date,Ee=[],Me=null,He=null;w(Te,i.year,i.month,i.date),i.droppable&&e(document).bind("dragstart",function(t,n){var o=t.target,r=e(o);if(!r.parents(".fc").length){var a=i.dropAccept;(e.isFunction(a)?a.call(o,r):r.is(a))&&(ye=o,ge.dragStart(ye,t,n))}}).bind("dragstop",function(e,t){ye&&(ge.dragStop(ye,e,t),ye=null)})}function a(t,n){function i(){d=n.theme?"ui":"fc";n.header}function o(){p.remove()}function r(e){p.find("h2").html(e)}function a(e){p.find("span.fc-button-"+e).addClass(d+"-state-active")}function s(e){p.find("span.fc-button-"+e).removeClass(d+"-state-active")}function l(e){p.find("span.fc-button-"+e).addClass(d+"-state-disabled")}function c(e){p.find("span.fc-button-"+e).removeClass(d+"-state-disabled")}var u=this;u.render=i,u.destroy=o,u.updateTitle=r,u.activateButton=a,u.deactivateButton=s,u.disableButton=l,u.enableButton=c;var d,p=e([])}function s(t,i){function o(e,t){if(null==e&&(e=0),null==t&&(t=0),R=t,I=e,0==e&&0==t)return M(z);var n,i,o=z.length,r=[];for(n=0;n<o;n++)i=z[n],0==i.type||1==i.type||3==i.type?e&&(e!=-1||i.resource_id)&&i.resource_id!=e||t&&i.service_id!=t||r.push(i):2==i.type&&i.resources.indexOf(e?e.toString():null)!=-1&&r.push(i);M(r)}function r(e,t){return!D||e<D||t>S}function a(e,t){D=e,S=t,z=[];var n=++N,i=H.length;P=i;for(var r=0;r<i;r++)s(H[r],n);o(I,R)}function s(e,t){l(e,function(n){if(t==N){if(n){for(var i=0;i<n.length;i++)n[i].source=e,y(n[i]);z=z.concat(n)}P--,P||M(z)}})}function l(n,i){var o,r,a=Me.sourceFetchers;for(o=0;o<a.length;o++){if(r=a[o](n,D,S,i),r===!0)return;if("object"==typeof r)return void l(r,i)}var s=n.events;if(s)e.isFunction(s)?(v(),s(m(D),m(S),function(e){i(e),b()})):e.isArray(s)?i(s):i();else{var c=n.url;if(c){var u=n.success,d=n.error,p=n.complete,f=e.extend({},n.data||{}),h=ie(n.startParam,t.startParam),g=ie(n.endParam,t.endParam);h&&(f[h]=Math.round(+D/1e3)),g&&(f[g]=Math.round(+S/1e3)),v(),e.ajax(e.extend({},He,n,{data:f,success:function(t){t=t.events||[];var n=ne(u,this,arguments);e.isArray(n)&&(t=n),i(t)},error:function(){ne(d,this,arguments),i()},complete:function(){ne(p,this,arguments),b()}}))}else i()}}function c(e){e=u(e),e&&(P++,s(e,N))}function u(t){if(e.isFunction(t)||e.isArray(t)?t={events:t}:"string"==typeof t&&(t={url:t}),"object"==typeof t)return w(t),H.push(t),t}function d(t){H=e.grep(H,function(e){return!_(e,t)}),z=e.grep(z,function(e){return!_(e.source,t)}),M(z)}function p(e){var t,n,i=z.length,r=E().defaultEventEnd,a=e.start-e._start,s=e.end?e.end-(e._end||r(e)):0;for(t=0;t<i;t++)n=z[t],n._id==e._id&&n!=e&&(n.start=new Date(+n.start+a),e.end?n.end?n.end=new Date(+n.end+s):n.end=new Date(+r(n)+s):n.end=null,n.title=e.title,n.url=e.url,n.allDay=e.allDay,n.className=e.className,n.editable=e.editable,n.color=e.color,n.backgroudColor=e.backgroudColor,n.borderColor=e.borderColor,n.textColor=e.textColor,n.unconfirmed=e.unconfirmed,n.canceled=e.canceled,y(n));y(e),o(I,R)}function f(e,t){y(e),e.source||(t&&(O.events.push(e),e.source=O),z.push(e)),o(I,R)}function h(t){if(t){if(!e.isFunction(t)){var n=t+"";t=function(e){return e._id==n}}z=e.grep(z,t,!0);for(var i=0;i<H.length;i++)e.isArray(H[i].events)&&(H[i].events=e.grep(H[i].events,t,!0))}else{z=[];for(var i=0;i<H.length;i++)e.isArray(H[i].events)&&(H[i].events=[])}o(I,R)}function g(t){return e.isFunction(t)?e.grep(z,t):t?(t+="",e.grep(z,function(e){return e._id==t})):z}function v(){A++||T("loading",null,!0)}function b(){--A||T("loading",null,!1)}function y(i){var o=i.source||{},r=ie(o.ignoreTimezone,t.ignoreTimezone);if(i._id=i._id||(i.id===n?"_fc"+Ne++:i.id+""),i.date&&(i.start||(i.start=i.date),delete i.date),i._start=m(i.start=x(i.start,r)),i.end=x(i.end,r),i.end&&i.end<=i.start&&(i.end=null),i._end=i.end?m(i.end):null,i.allDay===n&&(i.allDay=ie(o.allDayDefault,t.allDayDefault)),i.className?"string"==typeof i.className&&(i.className=i.className.split(/\s+/)):i.className=[],i.resource_id){var a=t.resources;e.each(a,function(e,t){t.data.id===i.resource_id&&(i.resource=t)})}}function w(e){e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[];for(var t=Me.sourceNormalizers,n=0;n<t.length;n++)t[n](e)}function _(e,t){return e&&t&&C(e)==C(t)}function C(e){return("object"==typeof e?e.events||e.url:"")||e}var k=this;k.isFetchNeeded=r,k.fetchEvents=a,k.addEventSource=c,k.removeEventSource=d,k.updateEvent=p,k.renderEvent=f,k.removeEvents=h,k.clientEvents=g,k.normalizeEvent=y,k.filterEvents=o;for(var D,S,T=k.trigger,E=k.getView,M=k.reportEvents,O={events:[]},H=[O],N=0,P=0,A=0,R=0,I=0,z=[],F=0;F<i.length;F++)u(i[F])}function l(e){function t(t,n,r){e.availability(t,n,r,function(e){i=e,o(i)})}var n=this;n.fetchAvailability=t;var i=[],o=n.reportAvailability}function c(t){function i(e){if(c){if(0==e||null==e)return u=null,p(c);var t,n,i=c.length,o=[];for(t=0;t<i;t++)n=c[t],n.data.id==e&&o.push(n);u!=e&&p(o),u=e}}function o(t){var n={};if(e.isFunction(t))n={resources:t},d.push(n);else if("string"==typeof t)n={url:t},d.push(n);else if("object"==typeof t)for(var i=0;i<t.length;i++){var o=t[i];s(o),n={resources:o},d.push(n)}}function r(e){if(e="undefined"==typeof e||e,c!=n&&e)return c;c=[];for(var t=d.length,i=0;i<t;i++){var o=a(d[i]);c=c.concat(o)}return c}function a(t){var n=t.resources;if(n){if(e.isFunction(n))return n()}else{var i=t.url;i&&e.ajax({url:i,dataType:"json",cache:!1,success:function(e){e=e||[],n=e},error:function(){alert("ajax error")},async:!1})}return n}function s(e){e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[];for(var t=Me.sourceNormalizers,n=0;n<t.length;n++)t[n](e)}var l=this;l.fetchResources=r,l.filterResources=i;var c,u=null,d=[],p=l.reportResources;o(t.resources)}function u(e,t,n){return e.setFullYear(e.getFullYear()+t),n||g(e),e}function d(e,t,n){if(+e){var i=e.getMonth()+t,o=m(e);for(o.setDate(1),o.setMonth(i),e.setMonth(i),n||g(e);e.getMonth()!=o.getMonth();)e.setDate(e.getDate()+(e<o?1:-1))}return e}function p(e,t,n){if(+e){var i=e.getDate()+t,o=m(e);o.setHours(9),o.setDate(i),e.setDate(i),n||g(e),f(e,o)}return e}function f(e,t){if(+e)for(;e.getDate()!=t.getDate();)e.setTime(+e+(e<t?1:-1)*Re)}function h(e,t){return e.setMinutes(e.getMinutes()+t),e}function g(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function m(e,t){return t?g(new Date((+e))):new Date((+e))}function v(){var e,t=0;do e=new Date(1970,(t++),1);while(e.getHours());return e}function b(e,t,n){for(t=t||1;!e.getDay()||n&&1==e.getDay()||!n&&6==e.getDay();)p(e,t);return e}function y(e,t){return Math.round((m(e,!0)-m(t,!0))/Ae)}function w(e,t,i,o){t!==n&&t!=e.getFullYear()&&(e.setDate(1),e.setMonth(0),e.setFullYear(t)),i!==n&&i!=e.getMonth()&&(e.setDate(1),e.setMonth(i)),o!==n&&e.setDate(o)}function x(e,t){return"object"==typeof e?e:"number"==typeof e?new Date(1e3*e):"string"==typeof e?e.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(e)):(t===n&&(t=!0),_(e,t)||(e?new Date(e):null)):null}function _(e,t){var n=e.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var i=new Date(n[1],0,1);if(t||!n[13]){var o=new Date(n[1],0,1,9,0);n[3]&&(i.setMonth(n[3]-1),o.setMonth(n[3]-1)),n[5]&&(i.setDate(n[5]),o.setDate(n[5])),f(i,o),n[7]&&i.setHours(n[7]),n[8]&&i.setMinutes(n[8]),n[10]&&i.setSeconds(n[10]),n[12]&&i.setMilliseconds(1e3*Number("0."+n[12])),f(i,o)}else if(i.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),i.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var r=60*Number(n[16])+(n[18]?Number(n[18]):0);r*="-"==n[15]?1:-1,i=new Date(+i+60*r*1e3)}return i}function C(e){if("number"==typeof e)return 60*e;if("object"==typeof e)return 60*e.getHours()+e.getMinutes();var t=e.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(t){var n=parseInt(t[1],10);return t[3]&&(n%=12,"p"==t[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(t[2]?parseInt(t[2],10):0)}}function k(e,t,n){return D(e,null,t,n)}function D(e,t,n,i){i=i||Te;var o,r,a,s,l=e,c=t,u=n.length,d="";for(o=0;o<u;o++)if(r=n.charAt(o),"'"==r){for(a=o+1;a<u;a++)if("'"==n.charAt(a)){l&&(d+=a==o+1?"'":n.substring(o+1,a),o=a);break}}else if("("==r){for(a=o+1;a<u;a++)if(")"==n.charAt(a)){var p=k(l,n.substring(o+1,a),i);parseInt(p.replace(/\D/,""),10)&&(d+=p),o=a;break}}else if("["==r){for(a=o+1;a<u;a++)if("]"==n.charAt(a)){var f=n.substring(o+1,a),p=k(l,f,i);p!=k(c,f,i)&&(d+=p),o=a;break}}else if("{"==r)l=t,c=e;else if("}"==r)l=e,c=t;else{for(a=u;a>o;a--)if(s=ze[n.substring(o,a)]){l&&(d+=s(l,i)),o=a-1;break}a==o&&l&&(d+=r)}return d}function S(e){return e.end?T(e.end,e.allDay):p(m(e.start),1)}function T(e,t){return e=m(e),t||e.getHours()||e.getMinutes()?p(e,1):g(e)}function E(e,t){return 100*(t.msLength-e.msLength)+(e.event.start-t.event.start)}function M(e,t){return e.end>t.start&&e.start<t.end}function O(e,t,n,i){var o,r,a,s,l,c,u,d,p=[],f=e.length;for(o=0;o<f;o++)r=e[o],a=r.start,s=t[o],s>n&&a<i&&(a<n?(l=m(n),u=!1):(l=a,u=!0),s>i?(c=m(i),d=!1):(c=s,d=!0),p.push({event:r,start:l,end:c,isStart:u,isEnd:d,msLength:c-l}));return p.sort(E)}function H(e){var t,n,i,o,r,a=[],s=e.length;for(t=0;t<s;t++){for(n=e[t],i=0;;){if(o=!1,a[i])for(r=0;r<a[i].length;r++)if(M(a[i][r],n)){o=!0;break}if(!o)break;i++}a[i]?a[i].push(n):a[i]=[n]}return a}function N(t,i,o){t.unbind("mouseover").mouseover(function(t){for(var r,a,s,l=t.target;l!=this;)r=l,l=l.parentNode;(a=r._fci)!==n&&(r._fci=n,s=i[a],o(s.event,s.element,s),e(t.target).trigger(t)),t.stopPropagation()})}function P(t,n,i){for(var o,r=0;r<t.length;r++)o=e(t[r]),o.width(Math.max(0,n-R(o,i)))}function A(t,n,i){for(var o,r=0;r<t.length;r++)o=e(t[r]),o.height(Math.max(0,n-L(o,i)))}function R(e,t){return I(e)+F(e)+(t?z(e):0)}function I(t){return(parseFloat(e.css(t[0],"paddingLeft",!0))||0)+(parseFloat(e.css(t[0],"paddingRight",!0))||0)}function z(t){return(parseFloat(e.css(t[0],"marginLeft",!0))||0)+(parseFloat(e.css(t[0],"marginRight",!0))||0)}function F(t){return(parseFloat(e.css(t[0],"borderLeftWidth",!0))||0)+(parseFloat(e.css(t[0],"borderRightWidth",!0))||0)}function L(e,t){return j(e)+W(e)+(t?B(e):0)}function j(t){return(parseFloat(e.css(t[0],"paddingTop",!0))||0)+(parseFloat(e.css(t[0],"paddingBottom",!0))||0)}function B(t){return(parseFloat(e.css(t[0],"marginTop",!0))||0)+(parseFloat(e.css(t[0],"marginBottom",!0))||0)}function W(t){return(parseFloat(e.css(t[0],"borderTopWidth",!0))||0)+(parseFloat(e.css(t[0],"borderBottomWidth",!0))||0)}function $(e,t){t="number"==typeof t?t+"px":t,e.each(function(e,n){n.style.cssText+=";min-height:"+t+";_height:"+t})}function q(t){var n={};return e.each(t,function(t,i){
if(n[t]=[],i.length>0){var o=0;e.each(i.sort(function(e,t){return e.start>t.start}),function(e,i){n[t].push({start:o,end:i.start}),o=i.end}),n[t].push({start:o,end:86400})}else n[t].push({start:0,end:86400})}),n}function V(){}function U(e,t){return e-t}function Y(e){return Math.max.apply(Math,e)}function J(e){return(e<10?"0":"")+e}function X(e,t){if(e[t]!==n)return e[t];for(var i,o=t.split(/(?=[A-Z])/),r=o.length-1;r>=0;r--)if(i=e[o[r].toLowerCase()],i!==n)return i;return e[""]}function K(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function G(e){return e.id+"/"+e.className+"/"+e.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/gi,"")}function Z(e){e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function Q(e){e.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function ee(e,t){e.each(function(e,n){n.className=n.className.replace(/^fc-\w*/,"fc-"+Pe[t])})}function te(e,t){var n=e.source||{},i=e.color,o=n.color,r=t("eventColor"),a=e.backgroundColor||i||n.backgroundColor||o||t("eventBackgroundColor")||r,s=e.borderColor||i||n.borderColor||o||t("eventBorderColor")||r,l=e.textColor||n.textColor||t("eventTextColor"),c=[];return a&&c.push("background-color:"+a),s&&c.push("border-color:"+s),l&&c.push("color:"+l),c.join(";")}function ne(t,n,i){if(e.isFunction(t)&&(t=[t]),t){var o,r;for(o=0;o<t.length;o++)r=t[o].apply(n,i)||r;return r}}function ie(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==n)return arguments[e]}function oe(e,t){function n(e,t){t&&p(e,7*t);var n=p(m(e),-((e.getDay()-o("firstDay")+7)%7)),s=p(m(n),7),l=m(n),c=m(s),u=o("weekends");u||(b(l),b(c,-1,!0)),i.title=a(l,p(m(c),-1),o("titleFormat")),i.start=n,i.end=s,i.visStart=l,i.visEnd=c,r(1,1,u?7:5,!1)}var i=this;i.render=n,ae.call(i,e,t,"basicWeek");var o=i.opt,r=i.renderBasic,a=t.formatDates}function re(e,t){function n(e,t){t&&(p(e,t),o("weekends")||b(e,t<0?-1:1)),i.title=a(e,o("titleFormat")),i.start=i.visStart=m(e,!0),i.end=i.visEnd=p(m(i.start),1),r(1,1,1,!1)}var i=this;i.render=n,ae.call(i,e,t,"basicDay");var o=i.opt,r=i.renderBasic,a=t.formatDate}function ae(t,n,i){function o(e,t,n,i){X=t,K=n,r();var o=!F;o?a(e,i):fe(),s(o)}function r(){ie=de("isRTL"),ie?(oe=-1,re=K-1):(oe=1,re=0),ae=de("firstDay"),le=de("weekends")?0:1,ce=de("theme")?"ui":"fc",ue=de("columnFormat")}function a(n,i){var o,r,a,s,l=ce+"-widget-header",c=ce+"-widget-content";for(o="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>",r=0;r<K;r++)o+="<th class='fc- "+l+"'/>";for(o+="</tr></thead><tbody>",r=0;r<n;r++){for(o+="<tr class='fc-week"+r+"'>",a=0;a<K;a++)o+="<td class='fc- "+c+" fc-day"+(r*K+a)+"'><div>"+(i?"<div class='fc-day-number'/>":"")+"<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";o+="</tr>"}o+="</tbody></table>",s=e(o).appendTo(t),I=s.find("thead"),z=I.find("th"),F=s.find("tbody"),j=F.find("tr"),B=F.find("td"),W=B.filter(":first-child"),q=j.eq(0).find("div.fc-day-content div"),Q(I.add(I.find("tr"))),Q(j),j.eq(0).addClass("fc-first"),u(B),V=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(t)}function s(t){var n,i,o,r=t||1==X,a=R.start.getMonth(),s=g(new Date);r&&z.each(function(t,o){n=e(o),i=O(t),n.html(ve(i,ue)),ee(n,i)}),B.each(function(t,o){n=e(o),i=O(t),i.getMonth()==a?n.removeClass("fc-other-month"):n.addClass("fc-other-month"),+i==+s?n.addClass(ce+"-state-highlight fc-today"):n.removeClass(ce+"-state-highlight fc-today"),n.find("div.fc-day-number").text(i.getDate()),r&&ee(n,i)}),j.each(function(t,n){o=e(n),t<X?(o.show(),t==X-1?o.addClass("fc-last"):o.removeClass("fc-last")):o.hide()})}function l(t){Y=t;var n,i,o,r=Y-I.height();"variable"==de("weekMode")?n=i=Math.floor(r/(1==X?2:6)):(n=Math.floor(r/X),i=r-n*(X-1)),W.each(function(t,r){t<X&&(o=e(r),$(o.find("> div"),(t==X-1?i:n)-L(o)))})}function c(e){U=e,ne.clear(),J=Math.floor(U/K),P(z.slice(0,-1),J)}function u(e){e.click(d).mousedown(me)}function d(e){if(!de("selectable")){var t=parseInt(this.className.match(/fc\-day(\d+)/)[1]),n=O(t);pe("dayClick",this,n,!0,e)}}function f(e,t,n){n&&G.build();for(var i=m(R.visStart),o=p(m(i),K),r=0;r<X;r++){var a=new Date(Math.max(i,e)),s=new Date(Math.min(o,t));if(a<s){var l,c;ie?(l=y(s,i)*oe+re+1,c=y(a,i)*oe+re+1):(l=y(a,i),c=y(s,i)),u(h(r,l,r,c-1))}p(i,7),p(o,7)}}function h(e,n,i,o){var r=G.rect(e,n,i,o,t);return he(r,t)}function v(e,t){return m(e)}function b(e,t,n){f(e,p(m(t),1),!0)}function w(){ge()}function x(e,t,n){var i=T(e),o=B[i.row*K+i.col];pe("dayClick",o,e,t,n)}function _(e,t,n){te.start(function(e){ge(),e&&h(e.row,e.col,e.row,e.col)},t)}function C(e,t,n){var i=te.stop();if(ge(),i){var o=E(i);pe("drop",e,o,!0,t,n)}}function k(e){return m(e.start)}function D(e){return ne.left(e)}function S(e){return ne.right(e)}function T(e){return{row:Math.floor(y(e,R.visStart)/7),col:H(e.getDay())}}function E(e){return M(e.row,e.col)}function M(e,t){return p(m(R.visStart),7*e+t*oe+re)}function O(e){return M(Math.floor(e/K),e%K)}function H(e){return(e-Math.max(ae,le)+K)%K*oe+re}function N(e){return j.eq(e)}function A(e){return{left:0,right:U}}var R=this;R.renderBasic=o,R.setHeight=l,R.setWidth=c,R.renderDayOverlay=f,R.defaultSelectionEnd=v,R.renderSelection=b,R.clearSelection=w,R.reportDayClick=x,R.dragStart=_,R.dragStop=C,R.defaultEventEnd=k,R.getHoverListener=function(){return te},R.colContentLeft=D,R.colContentRight=S,R.dayOfWeekCol=H,R.dateCell=T,R.cellDate=E,R.cellIsAllDay=function(){return!0},R.allDayRow=N,R.allDayBounds=A,R.getRowCnt=function(){return X},R.getColCnt=function(){return K},R.getColWidth=function(){return J},R.getDaySegmentContainer=function(){return V},ye.call(R,t,n,i),_e.call(R),xe.call(R),se.call(R);var I,z,F,j,B,W,q,V,U,Y,J,X,K,G,te,ne,ie,oe,re,ae,le,ce,ue,de=R.opt,pe=R.trigger,fe=R.clearEvents,he=R.renderOverlay,ge=R.clearOverlays,me=R.daySelectionMousedown,ve=n.formatDate;Z(t.addClass("fc-grid")),G=new Ce(function(t,n){var i,o,r;z.each(function(t,a){i=e(a),o=i.offset().left,t&&(r[1]=o),r=[o],n[t]=r}),r[1]=o+i.outerWidth(),j.each(function(n,a){n<X&&(i=e(a),o=i.offset().top,n&&(r[1]=o),r=[o],t[n]=r)}),r[1]=o+i.outerHeight()}),te=new ke(G),ne=new Se(function(e){return q.eq(e)})}function se(){function t(e,t){d(e),D(i(e),t)}function n(){f(),y().empty()}function i(t){var n,i,o,r,s,l,c=C(),u=k(),d=m(a.visStart),f=p(m(d),u),h=e.map(t,S),g=[];for(n=0;n<c;n++){for(i=H(O(t,h,d,f)),o=0;o<i.length;o++)for(r=i[o],s=0;s<r.length;s++)l=r[s],l.row=n,l.level=o,g.push(l);p(d,7),p(f,7)}return g}function o(e,t,n){c(e)&&r(e,t),n.isEnd&&u(e)&&T(e,t,n),h(e,t)}function r(e,t){var n,i=w();t.draggable({zIndex:9,delay:50,opacity:s("dragOpacity"),revertDuration:s("dragRevertDuration"),start:function(o,r){l("eventDragStart",t,e,o,r),v(e,t),i.start(function(i,o,r,a){t.draggable("option","revert",!i||!r&&!a),_(),i?(n=7*r+a*(s("isRTL")?-1:1),x(p(m(e.start),n),p(S(e),n))):n=0},o,"drag")},stop:function(o,r){i.stop(),_(),l("eventDragStop",t,e,o,r),n?b(this,e,n,0,e.allDay,o,r):(t.css("filter",""),g(e,t))}})}var a=this;a.renderEvents=t,a.compileDaySegs=i,a.clearEvents=n,a.bindDaySeg=o,we.call(a);var s=a.opt,l=a.trigger,c=a.isEventDraggable,u=a.isEventResizable,d=a.reportEvents,f=a.reportEventClear,h=a.eventElementHandlers,g=a.showEvents,v=a.hideEvents,b=a.eventDrop,y=a.getDaySegmentContainer,w=a.getHoverListener,x=a.renderDayOverlay,_=a.clearOverlays,C=a.getRowCnt,k=a.getColCnt,D=a.renderDaySegs,T=a.resizableDayEvent}function le(e,t){function n(e,t){t&&(p(e,t),o("weekends")||b(e,t<0?-1:1));var n=m(e,!0),s=p(m(n),1);i.title=a(e,o("titleFormat")),i.start=i.visStart=n,i.end=i.visEnd=s,r()}var i=this;i.render=n,ce.call(i,e,t,"resourceDay");var o=i.opt,r=i.renderResource,a=t.formatDate}function ce(t,i,o){function r(){We=resources.length,s(),!ae||ht?l():rt(),c(),ht=!1}function a(e){resources=e,ht=!0}function s(){Ye=it("theme")?"ui":"fc",Xe=it("weekends")?0:1,Je=it("firstDay"),(Ke=it("isRTL"))?(Ge=-1,Ze=We-1):(Ge=1,Ze=0),Qe=C(it("minTime")),et=C(it("maxTime")),tt=it("columnFormat")}function l(){var n,i,o,r,a,s=Ye+"-widget-header",l=Ye+"-widget-content",c=it("slotMinutes")%15==0;for(t.empty(),n="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr><th class='fc-agenda-axis "+s+"'>&nbsp;</th>",i=0;i<We;i++)n+="<th class='fc- fc-col"+i+" "+s+"'/>";for(n+="<th class='fc-agenda-gutter "+s+"'>&nbsp;</th></tr></thead><tbody><tr><th class='fc-agenda-axis "+s+"'>&nbsp;</th>",i=0;i<We;i++)n+="<td class='fc- fc-col"+i+" "+l+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";for(n+="<td class='fc-agenda-gutter "+l+"'>&nbsp;</td></tr></tbody></table>",ae=e(n).appendTo(t),se=ae.find("thead"),le=se.find("th").slice(1,-1),ce=ae.find("tbody"),de=ce.find("td").slice(0,-1),pe=de.find("div.fc-day-content div"),fe=de.eq(0),he=fe.find("> div"),Q(se.add(se.find("tr"))),Q(ce.add(ce.find("tr"))),He=se.find("th:first"),Ne=ae.find(".fc-agenda-gutter"),ge=e("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(t),it("allDaySlot")?(me=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(ge),n="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+s+" fc-agenda-axis'>"+it("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+s+" fc-agenda-gutter'>&nbsp;</th></tr></table>",be=e(n).appendTo(ge),we=be.find("tr"),_(we.find("td")),He=He.add(be.find("th:first")),Ne=Ne.add(be.find("th.fc-agenda-gutter")),ge.append("<div class='fc-agenda-divider "+s+"'><div class='fc-agenda-divider-inner'/></div>")):me=e([]),De=e("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").addClass("overflow-content").appendTo(ge),Te=e("<div style='position:relative;width:100%;overflow:hidden'/>").addClass("popover-holder").appendTo(De),Ee=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(Te),nt=e('<div class="editable"></div>'),e(Ee).append(nt),ve=e("<div style='position:absolute;z-index:0;top:0;left:0'/>").appendTo(Te),n="<table class='fc-agenda-slots' style='width:100%; z-index: 2; position: relative;' cellspacing='0'><tbody>",o=v(),r=h(m(o),et),h(o,Qe),$e=0,i=0;o<r;i++){var u="";i%2==1&&(u=" fc-widget-content-even"),a=o.getMinutes(),n+="<tr class='fc-slot"+i+" "+(a?"fc-minor":"")+"'><th class='fc-agenda-axis "+s+"'>"+(c&&a?"&nbsp;":dt(o,it("axisFormat")))+"</th><td class='"+l+u+"'><div style='position:relative'>&nbsp;</div></td></tr>",h(o,it("slotMinutes")),$e++}n+="</tbody></table>",Me=e(n).appendTo(Te),Oe=Me.find("div:first"),k(Me.find("td")),He=He.add(Me.find("th:first"))}function c(){var e,t,n,i,o=g(new Date);for(ve.empty(),e=0;e<resources.length;e++)null!=pt&&pt!=resources[e].id||(i=R(e),t=le.eq(e),t.text(resources[e].data.name),+i==+o?t.addClass(Ye+"-state-highlight fc-today"):t.removeClass(Ye+"-state-highlight fc-today"),t.attr("id",resources[e].id),n=de.eq(e),+i==+o?n.addClass(Ye+"-state-highlight fc-today"):n.removeClass(Ye+"-state-highlight fc-today"),ee(t.add(n),i))}function u(t,i){t===n&&(t=Ie),Ie=t,ft={};var o=ce.position().top,r=De.position().top,a=Math.min(t-o,Me.height()+r+1);he.height(a-L(fe)),ge.css("top",o),De.height(a-r-1),je=Oe.height()+1,i&&b(),nt.height(e(Te).height())}function d(t){if(ve.empty(),t)for(var n=0;n<resources.length;n++)null!=pt&&pt!=resources[n].data.id||e.each(q(t[pt?+pt:+resources[n].data.id]),function(t,i){var t=new Date((+t));oe(t.getDay());t>=re.visStart&&t<re.visEnd&&e.each(i,function(t,i){ve.append(e("<div>").addClass("fc-closed").addClass("fc-col"+n).css({height:(i.end*je-i.start*je)/900+"px",top:i.start*je/900+"px",width:Fe+"px",left:M(n)+"px"}))})})}function f(t){Re=t,Ue.clear(),ze=0,P(He.width("").each(function(t,n){ze=Math.max(ze,e(n).outerWidth())}),ze);var n=De[0].clientWidth;Le=De.width()-n,Le?(P(Ne,Le),Ne.show().prev().removeClass("fc-last")):Ne.hide().prev().addClass("fc-last");var i=Te.find(".fc-select-helper");P(i,Fe-5),Fe=Math.floor((n-ze)/We),P(ve.find("div"),Fe),P(le.slice(0,-1),Fe);for(var o=0;o<resources.length;o++)if(Ae&&resources[o].id==Ae.resource.data.id){var r=M(o)-3;i.css({left:r+"px"})}var a=ae.find(".fc-agenda-axis").outerWidth();nt.width(e(Te).width()-a).css({left:a})}function b(){function e(){De.scrollTop(i)}var t=v(),n=new Date(m(t).getTime()+1e3*parseInt(it("startTime"),10)-60*it("slotMinutes")*1e3),i=j(t,n)+1;e(),setTimeout(e,0)}function w(){Be=De.scrollTop()}function x(){De.scrollTop(Be)}function _(e){e.click(D).mousedown(K)}function k(e){e.click(D).mousedown(G)}function D(e){if(!it("selectable")){var t=Math.min(We-1,Math.floor((e.pageX-ae.offset().left-ze)/Fe)),n=R(t),i=this.parentNode.className.match(/fc-slot(\d+)/);if(i){var o=parseInt(i[1])*it("slotMinutes"),r=Math.floor(o/60);n.setHours(r),n.setMinutes(o%60+Qe),ot("dayClick",de[t],n,!1,e)}else ot("dayClick",de[t],n,!0,e)}}function S(e,t,n,i){n&&qe.build();var o,r;o=F(i),r=o+1,_(T(0,o,0,r-1))}function T(e,t,n,i){var o=qe.rect(e,t,n,i,ge);return at(o,ge)}function E(e,t){for(var n=m(re.visStart),i=p(m(n),1),o=0;o<We;o++){var r=new Date(Math.max(n,e)),a=new Date(Math.min(i,t));if(r<a){var s=o*Ge+Ze,l=qe.rect(0,s,0,s,Te),c=j(n,r),u=j(n,a);l.top=c,l.height=u-c,k(at(l,Te))}p(n,1),p(i,1)}}function M(e){return Ue.left(e)}function O(e){return Ue.right(e)}function H(e){return{row:Math.floor(y(e,re.visStart)/7),col:z(e.getDay())}}function N(e){var t=R(e.col),n=e.row;return it("allDaySlot")&&n--,n>=0&&h(t,Qe+n*it("slotMinutes")),t}function R(e){return m(re.visStart)}function I(e){return it("allDaySlot")&&!e.row}function z(e){return 0}function F(e){for(var t=0;t<resources.length;t++)if(e.data.id===resources[t].data.id)return t;return-1}function j(e,t){if(e=m(e,!0),t<h(m(e),Qe))return 0;if(t>=h(m(e),et))return Me.height();var i=it("slotMinutes"),o=60*t.getHours()+t.getMinutes()-Qe,r=Math.floor(o/i),a=ft[r];return a===n&&(a=ft[r]=Me.find("tr:eq("+r+") td div")[0].offsetTop),Math.max(0,Math.round(a-1+je*(o%i/i)))}function B(){return{left:ze,right:Re-Le}}function W(e){return we}function $(e){var t=m(e.start);return e.allDay?t:h(t,it("defaultEventMinutes"))}function V(e,t){return t?m(e):h(m(e),it("slotMinutes"))}function Y(e,t,n,i){n?it("allDaySlot")&&S(e,p(m(t),1),!0,i):J(e,t,i)}function J(t,n,i){var o=it("selectHelper");if(Ae={start:t,end:n,resource:i},qe.build(),o){var r=F(i);if(r>=0&&r<We){var a=qe.rect(0,r,0,r,Te),s=j(t,t),l=j(t,n);if(l>s){if(a.top=s+1,a.height=l-s-4,r>0?(a.left+=1,a.width-=5):(a.left+=0,a.width-=4),e.isFunction(o)){var c=o(t,n);c&&(a.position="absolute",a.zIndex=8,Pe=e(c).css(a).appendTo(Te))}else a.isStart=!0,a.isEnd=!0,Pe=e(ut({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},a)),Pe.css("opacity",it("dragOpacity"));Pe&&(k(Pe),Te.append(Pe),P(Pe,a.width,!0),A(Pe,a.height+3,!0))}}}else E(t,n)}function X(){st(),Pe&&(Pe.remove(),Pe=null)}function K(t){var n=re.cellDate,i=re.cellIsAllDay,o=re.getHoverListener();if(1==t.which&&it("selectable")){ct(t);var r,a;o.start(function(e,t){X(),e&&i(e)?(a=resources[e.col],r=[n(t),n(e)].sort(U),Y(r[0],r[1],!0,a)):r=null},t),e(document).one("mouseup",function(e){o.stop(),r&&a&&lt(r[0],r[1],!0,e,a.data.id)})}}function G(t){if(1==t.which&&it("selectable")){ct(t);var n,i;Ve.start(function(e,t){if(X(),e&&e.col==t.col&&!I(e)){i=resources[e.col];var o=N(t),r=N(e);n=[o,h(m(o),it("slotMinutes")),r,h(m(r),it("slotMinutes"))].sort(U),J(n[0],n[3],i)}else n=null},t),e(document).one("mouseup",function(e){Ve.stop(),n&&i&&lt(n[0],n[3],!1,e,i.data.id)})}}function te(e,t,n){ot("dayClick",de[z(e.getDay())],e,t,n)}function ne(e,t,n){Ve.start(function(e){if(st(),e)if(I(e))T(e.row,e.col,e.row,e.col);else{var t=N(e),n=h(m(t),it("defaultEventMinutes"));E(t,n)}},t)}function ie(e,t,n){var i=Ve.stop();st(),i&&ot("drop",e,N(i),I(i),t,n)}function oe(e){return p(m(re.visStart),e*Ge+Ze)}var re=this;re.renderResource=r,re.setWidth=f,re.setHeight=u,re.beforeHide=w,re.afterShow=x,re.defaultEventEnd=$,re.timePosition=j,re.dayOfWeekCol=z,re.dateCell=H,re.cellDate=N,re.cellIsAllDay=I,re.allDayRow=W,re.allDayBounds=B,re.getHoverListener=function(){return Ve},re.colContentLeft=M,re.colContentRight=O,re.getDaySegmentContainer=function(){return me},re.getSlotSegmentContainer=function(){return Ee},re.getMinMinute=function(){return Qe},re.getMaxMinute=function(){return et},re.getBodyContent=function(){return Te},re.getRowCnt=function(){return 1},re.getColCnt=function(){return We},re.getColWidth=function(){return Fe},re.getSlotHeight=function(){return je},re.defaultSelectionEnd=V,re.renderDayOverlay=S,re.renderSelection=Y,re.renderAvailability=d,re.clearSelection=X,re.reportDayClick=te,re.dragStart=ne,re.dragStop=ie,re.resourceCol=F,re.resources=i.fetchResources(),re.availability=i.options.availability,re.setResources=a,ye.call(re,t,i,o),_e.call(re),xe.call(re),ue.call(re);var ae,se,le,ce,de,pe,fe,he,ge,me,ve,be,we,De,Te,Ee,Me,Oe,He,Ne,Pe,Ae,Re,Ie,ze,Fe,Le,je,Be,We,$e,qe,Ve,Ue,Ye,Je,Xe,Ke,Ge,Ze,Qe,et,tt,nt,it=re.opt,ot=re.trigger,rt=re.clearEvents,at=re.renderOverlay,st=re.clearOverlays,lt=re.reportSelection,ct=re.unselect,ut=re.slotSegHtml,dt=i.formatDate,pt=re.resourceFilter,ft={},ht=!0;Z(t.addClass("fc-agenda")),qe=new Ce(function(t,n){function i(e){return Math.max(l,Math.min(c,e))}var o,r,a;le.each(function(t,i){o=e(i),r=o.offset().left,t&&(a[1]=r),a=[r],n[t]=a}),a[1]=r+o.outerWidth(),it("allDaySlot")&&(o=we,r=o.offset().top,t[0]=[r,r+o.outerHeight()]);for(var s=Te.offset().top,l=De.offset().top,c=l+De.outerHeight(),u=0;u<$e;u++)t.push([i(s+je*u),i(s+je*(u+1))])}),Ve=new ke(qe),Ue=new Se(function(e){return pe.eq(e)})}function ue(){function t(e,t){T(e);var n,i=e.length,a=[],s=[];for(n=0;n<i;n++)e[n].allDay&&2!=e[n].type?a.push(e[n]):s.push(e[n]);x("allDaySlot")&&(V(o(a),t,ce),P()),l(r(s),t),x("currentTimeIndicator")&&(window.clearInterval(w),w=window.setInterval(f,3e4),f())}function i(){E(),I().empty(),z().find(".fc-event").remove()}function o(t){var n,i,o,r,a=H(O(t,e.map(t,S),y.visStart,y.visEnd)),s=a.length,l=[];for(n=0;n<s;n++)for(i=a[n],o=0;o<i.length;o++)r=i[o],r.row=0,r.level=n,l.push(r);return l}function r(t){var n,i,o,r,l,c,u=Y(),d=B(),p=j(),f=h(m(y.visStart),d),g=[];for(n=0;n<u;n++){if(se.getSelectedResource())var v=a(e.grep(ce,function(e){return e.data.id==se.getSelectedResource()})[0],t);else var v=a(ce[n],t);for(i=H(O(v,e.map(v,s),f,h(m(f),p-d))),be(i),o=0;o<i.length;o++)for(r=i[o],l=0;l<r.length;l++)c=r[l],c.col=n,c.level=o,g.push(c)}return g}function a(e,t){for(var n=[],i=0;i<t.length;i++)0==t[i].type||1==t[i].type||3==t[i].type?(e.data.id==-1&&!t[i].resource_id||t[i].resource_id===e.data.id)&&n.push(t[i]):2==t[i].type&&e.data.id&&t[i].resources.indexOf(e.data.id.toString())!=-1&&n.push(t[i]);return n}function s(e){return e.end?m(e.end):h(m(e.start),x("defaultEventMinutes"))}function l(t,i){var o,r,a,s,l,u,p,f,h,g,m,v,b,y,w,C,k,D,S,T,E,M,O=t.length,H="",P={},A={},I=z(),F=Y();for((T=x("isRTL"))?(E=-1,M=F-1):(E=1,M=0),o=0;o<O;o++)r=t[o],a=r.event,s=W(r.start,r.start),l=W(r.start,r.end),u=r.col,p=r.level,f=r.forward||0,h=$(u*E+M),g=q(u*E+M)-h+11,g=Math.min(g,.9*g),m=p?g/(p+f+1):f?2*(g/(f+1)-6):g,v=h+g/(p+f+1)*p*E+(T?g-m:0),r.top=s+1,r.left=v-2,r.outerWidth=m,r.outerHeight=l-s-1,H+=c(a,r);for(I.append(e(H)),b=I.children(".fc-event"),o=0;o<O;o++)r=t[o],a=r.event,y=e(b[o]),w=_("eventRender",a,a,y),w===!1?y.remove():(w&&w!==!0&&(y.remove(),y=e(w).css({position:"absolute",top:r.top,left:r.left}).appendTo(I)),r.element=y,a._id===i?d(a,y,r):y[0]._fci=o,Q(a,y));for(N(I,t,d),o=0;o<O;o++)r=t[o],(y=r.element)&&(k=P[C=r.key=G(y[0])],r.vsides=k===n?P[C]=L(y,!0):k,k=A[C],r.hsides=k===n?A[C]=R(y,!0):k,D=y.find("div.fc-event-content"),D.length&&(r.contentTop=D[0].offsetTop));for(o=0;o<O;o++)if(r=t[o],y=r.element){y[0].style.width=Math.max(0,r.outerWidth-r.hsides)+"px",S=Math.max(0,r.outerHeight-r.vsides),y[0].style.height=S+"px",a=r.event,r.contentTop!==n&&S-r.contentTop<10&&(y.find("div.fc-event-time").text(a.title),y.find("div.fc-event-title").remove());var j=(a.end.getTime()-a.start.getTime())/6e4;j<x("slotMinutes")?(y.addClass("fc-event-smallslot"),y[0].style.height="10px"):j==x("slotMinutes")?y.addClass("fc-event-1slot"):j<=2*x("slotMinutes")&&y.addClass("fc-event-2slot"),_("eventAfterRender",a,a,y)}}function c(e,t){var n="<",i=e.url,o=te(e,x),r=o?" style='"+o+"'":"",a=["fc-event","fc-event-skin","fc-event-vert"];return C(e)&&a.push("fc-event-draggable"),t.isStart&&a.push("fc-corner-top"),t.isEnd&&a.push("fc-corner-bottom"),a=a.concat(e.className),e.source&&(a=a.concat(e.source.className||[])),n+=i?"a href='"+K(e.url)+"'":"div",n+=" class='"+a.join(" ")+"' style='position:absolute;top:"+t.top+"px;left:"+t.left+"px;"+o+"'><div class='fc-event-inner fc-event-skin'"+r+"><div class='fc-event-head fc-event-skin'"+r+"><div class='fc-event-time'>"+K(le(e.start,e.end,x("timeFormat")))+"</div></div><div class='fc-event-content'><div class='fc-event-title'>"+K(e.title)+"</div></div><div class='fc-event-bg'></div></div>",t.isEnd&&k(e)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(i?"a":"div")+">"}function u(e,t,n){C(e)&&g(e,t,n.isStart),n.isEnd&&k(e)&&U(e,t,n),M(e,t)}function d(e,t,n){var i=t.find("div.fc-event-time");C(e)&&v(e,t,i),n.isEnd&&k(e)&&b(e,t,i),M(e,t)}function f(){}function g(e,t,n){function i(){s||(t.width(o).height("").draggable("option","grid",null),s=!0)}var o,r,a,s=!0,l=x("isRTL")?-1:1,c=F(),u=J(),d=X(),f=B();t.draggable({zIndex:9,opacity:x("dragOpacity","month"),revertDuration:x("dragRevertDuration"),start:function(f,h){_("eventDragStart",t,e,f,h),ne(e,t),o=t.width(),c.start(function(o,c,f,h){ae(),o?(r=!1,a=h*l,o.row?n?s&&(t.width(u-10),A(t,d*Math.round((e.end?(e.end-e.start)/Ie:x("defaultEventMinutes"))/x("slotMinutes"))),t.draggable("option","grid",[u,1]),s=!1):r=!0:(re(p(m(e.start),a),p(S(e),a),!0,ce[o.col]),i()),r=r||s&&!a):(i(),r=!0),t.draggable("option","revert",r)},f,"drag")},stop:function(n,o){var l=c.stop();if(ae(),e.resource_id=ce[l.col].data.id,e.resource_name=ce[l.col].data.name,_("eventDragStop",t,e,n,o),r)i(),t.css("filter",""),ee(e,t);else{var u=0;s||(u=Math.round((t.offset().top-Z().offset().top)/d)*x("slotMinutes")+f-(60*e.start.getHours()+e.start.getMinutes())),a=0,ie(this,e,a,u,s,n,o)}}})}function v(e,t,n){function i(t){var i,o=h(m(e.start),t);e.end&&(i=h(m(e.end),t)),n.text(le(o,i,x("timeFormat")))}function o(){c&&(n.css("display",""),t.draggable("option","grid",[g,v]),c=!1)}var r,a,s,l,c=!1,u=x("isRTL")?-1:1,d=F(),f=Y(),g=J(),v=X();t.draggable({zIndex:9,scroll:!1,grid:[g,v],axis:1==f&&"y",opacity:x("dragOpacity"),revertDuration:x("dragRevertDuration"),start:function(i,f){_("eventDragStart",t,e,i,f),ne(e,t),r=t.position(),s=l=0,d.start(function(i,r,s,l){t.draggable("option","revert",!i),ae(),i&&(a=l*u,x("allDaySlot")&&!i.row?(c||(c=!0,n.hide(),t.draggable("option","grid",null)),re(p(m(e.start),a),p(S(e),a),!0,ce[i.col])):o())},i,"drag")},drag:function(e,t){s=Math.round((t.position.top-r.top)/v)*x("slotMinutes"),s!=l&&(c||i(s),l=s)},stop:function(n,i){var l=d.stop();ae(),_("eventDragStop",t,e,n,i),l&&(a||s||c)?(e.resource_id=ce[l.col].data.id,e.resource_name=ce[l.col].data.name,a=0,ie(this,e,a,c?0:s,c,n,i)):(o(),t.css("filter",""),t.css(r),ee(e,t))}})}function b(e,t,n){var i,o,r=X();t.resizable({handles:{s:"div.ui-resizable-s"},grid:r,start:function(n,r){i=o=0,ne(e,t),t.css("z-index",9),_("eventResizeStart",this,e,n,r)},resize:function(a,s){i=Math.round((Math.max(r,t.height())-s.originalSize.height)/r),i!=o&&(n.text(le(e.start,i||e.end?h(D(e),x("slotMinutes")*i):null,x("timeFormat"))),o=i),_("eventResizeActual",this,e.end.getTime()/1e3+x("slotMinutes")*i*60-e.start.getTime()/1e3)},stop:function(n,o){_("eventResizeStop",this,e,n,o),i?oe(this,e,0,x("slotMinutes")*i,n,o):(t.css("z-index",8),ee(e,t))}})}var y=this;y.renderEvents=t,y.compileDaySegs=o,y.clearEvents=i,y.slotSegHtml=c,y.bindDaySeg=u,we.call(y);var w,x=y.opt,_=y.trigger,C=y.isEventDraggable,k=y.isEventResizable,D=y.eventEnd,T=y.reportEvents,E=y.reportEventClear,M=y.eventElementHandlers,P=y.setHeight,I=y.getDaySegmentContainer,z=y.getSlotSegmentContainer,F=y.getHoverListener,j=y.getMaxMinute,B=y.getMinMinute,W=y.timePosition,$=y.colContentLeft,q=y.colContentRight,V=y.renderDaySegs,U=y.resizableDayEvent,Y=y.getColCnt,J=y.getColWidth,X=y.getSlotHeight,Z=y.getBodyContent,Q=y.reportEventElement,ee=y.showEvents,ne=y.hideEvents,ie=y.eventDrop,oe=y.eventResize,re=y.renderDayOverlay,ae=y.clearOverlays,se=y.calendar,le=(se.formatDate,se.formatDates),ce=(y.resourceCol,y.resources)}function de(e,t){function n(e,t){t&&(p(e,t),o("weekends")||b(e,t<0?-1:1));var n=m(e,!0),s=p(m(n),1);i.title=a(e,o("titleFormat")),i.start=i.visStart=n,i.end=i.visEnd=s,r()}var i=this;i.render=n,pe.call(i,e,t,"listDay");var o=i.opt,r=i.renderList,a=t.formatDate}function pe(t,i,o){function r(e){ve=e,a(),G?U():s()}function a(){Ee=q("theme")?"ui":"fc",Oe=q("weekends")?0:1,Me=q("firstDay"),(He=q("isRTL"))?(Ne=-1,Pe=ve-1):(Ne=1,Pe=0),Ae=C(q("minTime")),Re=C(q("maxTime")),Ie=q("columnFormat")}function s(){G=e('<div class="popover-holder fc-list-agenda-events-list"></div>'),t.append('<hr class="dark" style="margin-bottom: 0;">'),$.append(G),$.appendTo(t)}function l(){}function c(e,t){$.parent().height(e-2),t&&d()}function u(e){$.width(e)}function d(){function e(){$.scrollTop(t)}var t=0;e(),setTimeout(e,0)}function f(){me=$.scrollTop()}function g(){$.scrollTop(me)}function v(e,t,n){n&&we.build();var i,o,r=m(W.visStart);He?(i=y(t,r)*Ne+Pe+1,o=y(e,r)*Ne+Pe+1):(i=y(e,r),o=y(t,r)),i=Math.max(0,i),o=Math.min(ve,o),i<o&&dayBind(b(0,i,0,o-1))}function b(e,t,n,i){var o=we.rect(e,t,n,i,ne);return Y(o,ne)}function w(e,t){for(var n=m(W.visStart),i=p(m(n),1),o=0;o<ve;o++){var r=new Date(Math.max(n,e)),a=new Date(Math.min(i,t));if(r<a){var s=o*Ne+Pe,l=we.rect(0,s,0,s,ae),c=M(n,r),u=M(n,a);l.top=c,l.height=u-c,slotBind(Y(l,ae))}p(n,1),p(i,1)}}function x(e){return Te.left(e)}function _(e){return Te.right(e)}function k(e){return{row:Math.floor(y(e,W.visStart)/7),col:E(e.getDay())}}function D(e){var t=S(e.col),n=e.row;return q("allDaySlot")&&n--,n>=0&&h(t,Ae+n*q("slotMinutes")),t}function S(e){return p(m(W.visStart),e*Ne+Pe)}function T(e){return q("allDaySlot")&&!e.row}function E(e){return(e-Math.max(Me,Oe)+ve)%ve*Ne+Pe}function M(e,t){if(e=m(e,!0),t<h(m(e),Ae))return 0;if(t>=h(m(e),Re))return le.height();var i=q("slotMinutes"),o=60*t.getHours()+t.getMinutes()-Ae,r=Math.floor(o/i),a=ze[r];return a===n&&(a=ze[r]=le.find("tr:eq("+r+") td div")[0].offsetTop),Math.max(0,Math.round(a-1+ge*(o%i/i)))}function O(){return{left:de,right:ue-he}}function H(e){return oe}function N(e){var t=m(e.start);return e.allDay?t:h(t,q("defaultEventMinutes"))}function R(e,t){return t?m(e):h(m(e),q("slotMinutes"))}function I(e,t,n){n?q("allDaySlot")&&v(e,p(m(t),1),!0):z(e,t)}function z(t,n){var i=q("selectHelper");if(K={start:t,end:n},we.build(),i){var o=y(t,W.visStart)*Ne+Pe;if(o>=0&&o<ve){var r=we.rect(0,o,0,o,ae),a=M(t,t),s=M(t,n);if(s>a){if(r.top=a,r.height=s-a,e.isFunction(i)){var l=i(t,n);l&&(r.position="absolute",r.zIndex=8,ce=e(l).css(r).appendTo(ae))}else r.isStart=!0,r.isEnd=!0,ce=e(X({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},r)),ce.css("opacity",q("dragOpacity"));ce&&(slotBind(ce),ae.append(ce),P(ce,r.width,!0),A(ce,r.height,!0))}}}else w(t,n)}function F(){J(),ce&&(ce.remove(),ce=null),K=null}function L(e,t,n){V("dayClick",ee[E(e.getDay())],e,t,n)}function j(e,t,n){De.start(function(e){if(J(),e)if(T(e))b(e.row,e.col,e.row,e.col);else{var t=D(e),n=h(m(t),q("defaultEventMinutes"));w(t,n)}},t)}function B(e,t,n){var i=De.stop();J(),i&&V("drop",e,D(i),T(i),t,n)}var W=this;W.renderList=r,W.setWidth=u,W.setHeight=c,W.beforeHide=f,W.afterShow=g,W.defaultEventEnd=N,W.timePosition=M,W.dayOfWeekCol=E,W.dateCell=k,W.cellDate=D,W.cellIsAllDay=T,W.allDayRow=H,W.allDayBounds=O,W.getHoverListener=function(){return De},W.colContentLeft=x,W.colContentRight=_,W.getEventContainer=function(){return G},W.getSlotSegmentContainer=function(){return se},W.getAvailabilityContainer=function(){return ie},W.getMinMinute=function(){return Ae},W.getMaxMinute=function(){return Re},W.getBodyContent=function(){return ae},W.getRowCnt=function(){return 1},W.getColCnt=function(){return ve},W.getColWidth=function(){return pe},W.getSlotHeight=function(){return ge},W.defaultSelectionEnd=R,W.renderDayOverlay=v,W.renderSelection=I,W.clearSelection=F,W.reportDayClick=L,W.dragStart=j,W.dragStop=B,W.slotContainer=null,W.renderAvailability=l,W.availability=i.options.availability;var $=e('<div style="overflow-x: hidden; overflow-y: auto; position: relative;">');W.eventContainerScroller=$,ye.call(W,t,i,o),_e.call(W),xe.call(W),fe.call(W);var q=W.opt,V=W.trigger,U=W.clearEvents,Y=W.renderOverlay,J=W.clearOverlays,X=(W.reportSelection,W.unselect,W.daySelectionMousedown,W.slotSegHtml),K=(i.formatDate,W.selection);W.resources=i.fetchResources();var G,Q,ee,te,ne,ie,oe,re,ae,se,le,ce,ue,de,pe,he,ge,me,ve,be,we,De,Te,Ee,Me,Oe,He,Ne,Pe,Ae,Re,Ie,ze={};Z(t.addClass("fc-agenda")),we=new Ce(function(t,n){function i(e){return Math.max(l,Math.min(c,e))}var o,r,a;Q.each(function(t,i){o=e(i),r=o.offset().left,t&&(a[1]=r),a=[r],n[t]=a}),a[1]=r+o.outerWidth(),q("allDaySlot")&&(o=oe,r=o.offset().top,t[0]=[r,r+o.outerHeight()]);for(var s=ae.offset().top,l=re.offset().top,c=l+re.outerHeight(),u=0;u<be;u++)t.push([i(s+ge*u),i(s+ge*(u+1))])}),De=new ke(we),Te=new Se(function(e){return te.eq(e)})}function fe(){function n(n,i){var s,u,p=n.length,f=!1;for(n.sort(function(e,t){return e.start>t.start?1:e.start<t.start?-1:0}),s=0;s<p;s++)if(u=n[s],2==u.type&&u.start<o.visStart&&u.end>o.visEnd){for(var h=[],g=0;g<u.resources.length;g++){var m=t.arrayFirst(d,function(e){return e.id==u.resources[g]});m&&h.push(m.data.name)}var v='<p class="all-day-event"><i class="icon icon-busy"></i>'+K(h.join(", "))+' is busy all day. "'+K(u.title)+'"</p><hr class="dark" />',b=e(v);c(u,b),l().append(b),a("eventAfterRender",u,u,b),f=!0}for(s=0;s<p;s++)if(u=n[s],2==u.type){if(u.start<o.visStart&&u.end>o.visStart&&u.end<o.visEnd||u.end>o.visEnd&&u.start<o.visEnd&&u.start>o.visStart){for(var h=[],g=0;g<u.resources.length;g++){var m=t.arrayFirst(d,function(e){return e.id==u.resources[g]});m&&h.push(m.data.name)}var v='<p class="all-day-event"><i class="icon icon-busy"></i> 15:00 '+K(h.join(", "))+' is busy. "'+K(u.title)+'"</p><hr />',b=e(v);c(u,b),l().append(b),a("eventAfterRender",u,u,b),f=!0}}else if(u.start>=o.visStart&&u.start<o.visEnd&&(0==u.type||1==u.type)){var v='<div class="agenda-event">  <div class="time"></div>  <div class="block-story margin-left-70">      <div class="photo">';if("undefined"!=typeof u.bookings&&u.bookings.length>0){var y=u.bookings[0].contact,w=e("<div>").append(t.getFbPhotoUrl(y.fb_id,y.id,y.name).clone());v+="<div>"+w.html()+"</div>"}v+='</div>      <div class="story" style="margin-left:65px;">      <p class="title"><a href=""></a></p><p class="detail"></p><div class="note information-bar"></div>',v+="  </div>  </div></div><hr />";var b=e(v);c(u,b),l().append(b),a("eventAfterRender",u,u,b),f=!0}f||l().append('<p class="inactive">'+r("noEventsText")+"</p>")}function i(){s();var e=l();e&&e.empty()}var o=this;o.renderEvents=n,o.clearEvents=i,we.call(o);var r=o.opt,a=o.trigger,s=(o.isEventDraggable,o.isEventResizable,o.eventEnd,o.reportEvents,o.reportEventClear),l=(o.eventElementHandlers,o.setHeight,o.getEventContainer),c=(o.getSlotSegmentContainer,o.getHoverListener,o.getMaxMinute,o.getMinMinute,o.timePosition,o.colContentLeft,o.colContentRight,o.renderDaySegs,o.resizableDayEvent,o.getColCnt,o.getColWidth,o.getSlotHeight,o.getBodyContent,o.reportEventElement),u=(o.showEvents,o.hideEvents,o.eventDrop,o.eventResize,o.renderDayOverlay,o.clearOverlays,o.calendar),d=(u.formatDate,u.formatDates,o.resourceCol,o.eventContainerScroller,u.fetchResources())}function he(e,t){function n(e,t){t&&p(e,7*t);var n=p(m(e),-((e.getDay()-o("firstDay")+7)%7)),s=p(m(n),7),l=m(n),c=m(s),u=o("weekends");
u||(b(l),b(c,-1,!0)),i.title=a(l,p(m(c),-1),o("titleFormat")),i.start=n,i.end=s,i.visStart=l,i.visEnd=c,r(u?7:5)}var i=this;i.render=n,me.call(i,e,t,"agendaWeek");var o=i.opt,r=i.renderAgenda,a=t.formatDates}function ge(e,t){function n(e,t){t&&(p(e,t),o("weekends")||b(e,t<0?-1:1));var n=m(e,!0),s=p(m(n),1);i.title=a(e,o("titleFormat")),i.start=i.visStart=n,i.end=i.visEnd=s,r(1)}var i=this;i.render=n,me.call(i,e,t,"agendaDay");var o=i.opt,r=i.renderAgenda,a=t.formatDate}function me(t,o,r){function a(e){Le=e,s(),ie?nt():l(),c()}function s(){qe=et("theme")?"ui":"fc",Ue=et("weekends")?0:1,Ve=et("firstDay"),(Ye=et("isRTL"))?(Je=-1,Xe=Le-1):(Je=1,Xe=0),Ke=C(et("minTime")),Ge=C(et("maxTime")),Ze=et("columnFormat")}function l(){var n,i,o,r,a,s=qe+"-widget-header",l=qe+"-widget-content",c=et("slotMinutes")%15==0;for(n="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr><th class='fc-agenda-axis "+s+"'>&nbsp;</th>",i=0;i<Le;i++)n+="<th class='fc- fc-col"+i+" "+s+"'/>";for(n+="<th class='fc-agenda-gutter "+s+"'>&nbsp;</th></tr></thead><tbody><tr><th class='fc-agenda-axis "+s+"'>&nbsp;</th>",i=0;i<Le;i++)n+="<td class='fc- fc-col"+i+" "+l+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";for(n+="<td class='fc-agenda-gutter "+l+"'>&nbsp;</td></tr></tbody></table>",ie=e(n).appendTo(t),oe=ie.find("thead"),re=oe.find("th").slice(1,-1),ae=ie.find("tbody"),se=ae.find("td").slice(0,-1),le=se.find("div.fc-day-content div"),ce=se.eq(0),ue=ce.find("> div"),Q(oe.add(oe.find("tr"))),Q(ae.add(ae.find("tr"))),Ee=oe.find("th:first"),Me=ie.find(".fc-agenda-gutter"),de=e("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(t),et("allDaySlot")?(pe=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(de),n="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+s+" fc-agenda-axis'>"+et("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+s+" fc-agenda-gutter'>&nbsp;</th></tr></table>",he=e(n).appendTo(de),ge=he.find("tr"),_(ge.find("td")),Ee=Ee.add(he.find("th:first")),Me=Me.add(he.find("th.fc-agenda-gutter")),de.append("<div class='fc-agenda-divider "+s+"'><div class='fc-agenda-divider-inner'/></div>")):pe=e([]),me=e("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").addClass("overflow-content").appendTo(de),be=e("<div style='position:relative;width:100%;overflow:hidden'/>").addClass("popover-holder").addClass("slot-content").appendTo(me),we=e("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(be),Qe=e('<div class="editable"></div>'),e(we).append(Qe),fe=e("<div style='position:absolute;z-index:0;top:0;left:0'/>").appendTo(be),n="<table class='fc-agenda-slots' style='width:100%; z-index: 2; position: relative;' cellspacing='0'><tbody>",o=v(),r=h(m(o),Ge),h(o,Ke),je=0,i=0;o<r;i++){var u="";i%2==1&&(u=" fc-widget-content-even"),a=o.getMinutes(),n+="<tr class='fc-slot"+i+" "+(a?"fc-minor":"")+"'><th class='fc-agenda-axis "+s+"'>"+(c&&a?"&nbsp;":ct(o,et("axisFormat")))+"</th><td class='"+l+u+"'><div style='position:relative'>&nbsp;</div></td></tr>",h(o,et("slotMinutes")),je++}n+="</tbody></table>",De=e(n).appendTo(be),Te=De.find("div:first"),k(De.find("td")),Ee=Ee.add(De.find("th:first"))}function c(){var e,t,n,i,o=g(new Date);for(fe.empty(),e=0;e<Le;e++)i=R(e),t=re.eq(e),+i==+o?t.addClass(qe+"-state-highlight fc-today"):t.removeClass(qe+"-state-highlight fc-today"),t.html(ct(i,Ze)),n=se.eq(e),+i==+o?n.addClass(qe+"-state-highlight fc-today"):n.removeClass(qe+"-state-highlight fc-today"),ee(t.add(n),i)}function u(t,i){t===n&&(t=Pe),Pe=t,ut={};var o=ae.position().top,r=me.position().top,a=Math.min(t-o,De.height()+r+1);ue.height(a-L(ce)),de.css("top",o),me.height(a-r-1),ze=Te.height()+1,i&&b(),Qe.height(e(be).height())}function d(t){fe.empty(),t&&e.each(q(t[dt()||0]),function(t,n){var t=new Date((+t));R(t.getDay());t>=ne.start&&t<ne.end&&e.each(n,function(n,i){fe.append(e("<div>").addClass("fc-closed").addClass("fc-col"+(t.getDay()+7-Ve)%7).css({height:(i.end*ze-i.start*ze)/900+"px",top:i.start*ze/900+"px",width:Re+"px",left:M((t.getDay()+7-Ve)%7)+"px"}))})})}function f(t){Ne=t,$e.clear(),Ae=0,P(Ee.width("").each(function(t,n){Ae=Math.max(Ae,e(n).outerWidth())}),Ae);var n=g(new Date),o=me[0].clientWidth;Ie=me.width()-o,Ie?(P(Me,Ie),Me.show().prev().removeClass("fc-last")):Me.hide().prev().addClass("fc-last"),Re=Math.floor((o-Ae)/Le);var r=be.find(".fc-select-helper");if(P(r,Re-1),He){var a=M(He.start.getDay()-1)-3;r.css({left:a+"px"})}for(P(fe.find("div"),Re),P(re.slice(0,-1),Re+1),i=0;i<Le;i++){var s=R(i);if(Re<et("compactWidth")/Le?e(re[i]).html(ct(s,et("compactColumnFormat"))):e(re[i]).html(ct(s,et("columnFormat"))),n.getYear()==s.getYear()&&n.getMonth()==s.getMonth()&&n.getDate()==s.getDate()){var a=M(i)-2,l=fe.find(".fc-today-column");l.css({left:a+"px",top:"0px",height:be.height()})}}var c=ie.find(".fc-agenda-axis").outerWidth();Qe.width(e(be).width()-c).css({left:c})}function b(){function e(){me.scrollTop(i)}var t=v(),n=new Date(m(t).getTime()+1e3*parseInt(et("startTime"),10)-60*et("slotMinutes")*1e3),i=F(t,n)+1;e(),setTimeout(e,0)}function w(){Fe=me.scrollTop()}function x(){me.scrollTop(Fe)}function _(e){e.click(D).mousedown(st)}function k(e){e.click(D).mousedown(X)}function D(e){if(!et("selectable")){var t=Math.min(Le-1,Math.floor((e.pageX-ie.offset().left-Ae)/Re)),n=R(t),i=this.parentNode.className.match(/fc-slot(\d+)/);if(i){var o=parseInt(i[1])*et("slotMinutes"),r=Math.floor(o/60);n.setHours(r),n.setMinutes(o%60+Ke),tt("dayClick",se[t],n,!1,e)}else tt("dayClick",se[t],n,!0,e)}}function S(e,t,n){n&&Be.build();var i,o,r=m(ne.visStart);Ye?(i=y(t,r)*Je+Xe+1,o=y(e,r)*Je+Xe+1):(i=y(e,r),o=y(t,r)),i=Math.max(0,i),o=Math.min(Le,o),i<o&&_(T(0,i,0,o-1))}function T(e,t,n,i){var o=Be.rect(e,t,n,i,de);return it(o,de)}function E(e,t){for(var n=m(ne.visStart),i=p(m(n),1),o=0;o<Le;o++){var r=new Date(Math.max(n,e)),a=new Date(Math.min(i,t));if(r<a){var s=o*Je+Xe,l=Be.rect(0,s,0,s,be),c=F(n,r),u=F(n,a);l.top=c,l.height=u-c,k(it(l,be))}p(n,1),p(i,1)}}function M(e){return $e.left(e)}function O(e){return $e.right(e)}function H(e){return{row:Math.floor(y(e,ne.visStart)/7),col:z(e.getDay())}}function N(e){var t=R(e.col),n=e.row;return et("allDaySlot")&&n--,n>=0&&h(t,Ke+n*et("slotMinutes")),t}function R(e){return p(m(ne.visStart),e*Je+Xe)}function I(e){return et("allDaySlot")&&!e.row}function z(e){return(e-Math.max(Ve,Ue)+Le)%Le*Je+Xe}function F(e,t){if(e=m(e,!0),t<h(m(e),Ke))return 0;if(t>=h(m(e),Ge))return De.height();var i=et("slotMinutes"),o=60*t.getHours()+t.getMinutes()-Ke,r=Math.floor(o/i),a=ut[r];return a===n&&(a=ut[r]=De.find("tr:eq("+r+") td div")[0].offsetTop),Math.max(0,Math.round(a-1+ze*(o%i/i)))}function j(){return{left:Ae,right:Ne-Ie}}function B(e){return ge}function W(e){var t=m(e.start);return e.allDay?t:h(t,et("defaultEventMinutes"))}function $(e,t){return t?m(e):h(m(e),et("slotMinutes"))}function V(e,t,n){n?et("allDaySlot")&&S(e,p(m(t),1),!0):Y(e,t)}function Y(t,n){var i=et("selectHelper");if(He={start:t,end:n},Be.build(),i){var o=y(t,ne.visStart)*Je+Xe;if(o>=0&&o<Le){var r=Be.rect(0,o,0,o,be);0==o&&(r.left-=1,r.width+=1);var a=F(t,t),s=F(t,n);if(s>a){if(r.top=a+1,r.height=s-a-4,r.left+=1,r.width-=5,e.isFunction(i)){var l=i(t,n);l&&(r.position="absolute",r.zIndex=8,Oe=e(l).css(r).appendTo(be))}else r.isStart=!0,r.isEnd=!0,Oe=e(lt({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},r));Oe&&(k(Oe),be.append(Oe),P(Oe,r.width,!0),A(Oe,r.height+3,!0))}}}else E(t,n)}function J(){ot(),Oe&&(Oe.remove(),Oe=null)}function X(t){if(1==t.which&&et("selectable")){at(t);var n;We.start(function(e,t){if(J(),e&&e.col==t.col&&!I(e)){var i=N(t),o=N(e);n=[i,h(m(i),et("slotMinutes")),o,h(m(o),et("slotMinutes"))].sort(U),Y(n[0],n[3])}else n=null},t),e(document).one("mouseup",function(e){We.stop(),n&&(+n[0]==+n[1]&&K(n[0],!1,e),rt(n[0],n[3],!1,e))})}}function K(e,t,n){tt("dayClick",se[z(e.getDay())],e,t,n)}function G(e,t,n){We.start(function(e){if(ot(),e)if(I(e))T(e.row,e.col,e.row,e.col);else{var t=N(e),n=h(m(t),et("defaultEventMinutes"));E(t,n)}},t)}function te(e,t,n){var i=We.stop();ot(),i&&tt("drop",e,N(i),I(i),t,n)}var ne=this;ne.renderAgenda=a,ne.setWidth=f,ne.setHeight=u,ne.beforeHide=w,ne.afterShow=x,ne.defaultEventEnd=W,ne.timePosition=F,ne.dayOfWeekCol=z,ne.dateCell=H,ne.cellDate=N,ne.cellIsAllDay=I,ne.allDayRow=B,ne.allDayBounds=j,ne.getHoverListener=function(){return We},ne.colContentLeft=M,ne.colContentRight=O,ne.getDaySegmentContainer=function(){return pe},ne.getSlotSegmentContainer=function(){return we},ne.getAvailabilityContainer=function(){return fe},ne.getMinMinute=function(){return Ke},ne.getMaxMinute=function(){return Ge},ne.getBodyContent=function(){return be},ne.getRowCnt=function(){return 1},ne.getColCnt=function(){return Le},ne.getColWidth=function(){return Re},ne.getSlotHeight=function(){return ze},ne.defaultSelectionEnd=$,ne.renderDayOverlay=S,ne.renderSelection=V,ne.renderAvailability=d,ne.clearSelection=J,ne.reportDayClick=K,ne.dragStart=G,ne.dragStop=te,ne.slotContainer=null,ne.availability=o.options.availability,ye.call(ne,t,o,r),_e.call(ne),xe.call(ne),ve.call(ne);var ie,oe,re,ae,se,le,ce,ue,de,pe,fe,he,ge,me,be,we,De,Te,Ee,Me,Oe,He,Ne,Pe,Ae,Re,Ie,ze,Fe,Le,je,Be,We,$e,qe,Ve,Ue,Ye,Je,Xe,Ke,Ge,Ze,Qe,et=ne.opt,tt=ne.trigger,nt=ne.clearEvents,it=ne.renderOverlay,ot=ne.clearOverlays,rt=ne.reportSelection,at=ne.unselect,st=ne.daySelectionMousedown,lt=ne.slotSegHtml,ct=o.formatDate,ut={},dt=(o.getSelectedResource,o.getSelectedAvailability);o.fetchResources();t.addClass("fc-agenda"),Z(t),Be=new Ce(function(t,n){function i(e){return Math.max(l,Math.min(c,e))}var o,r,a;re.each(function(t,i){o=e(i),r=o.offset().left,t&&(a[1]=r),a=[r],n[t]=a}),a[1]=r+o.outerWidth(),et("allDaySlot")&&(o=ge,r=o.offset().top,t[0]=[r,r+o.outerHeight()]);for(var s=be.offset().top,l=me.offset().top,c=l+me.outerHeight(),u=0;u<je;u++)t.push([i(s+ze*u),i(s+ze*(u+1))])}),We=new ke(Be),$e=new Se(function(e){return le.eq(e)})}function ve(){function t(e,t){D(e);var n,i=e.length,a=[],l=[];for(n=0;n<i;n++)l.push(e[n]);w("allDaySlot")&&(q(o(a),t),M()),s(r(l),t),w("currentTimeIndicator")&&(window.clearInterval(y),y=window.setInterval(d,3e4),d())}function i(){T(),P().empty(),I().find(".fc-event").remove()}function o(t){var n,i,o,r,a=H(O(t,e.map(t,S),b.visStart,b.visEnd)),s=a.length,l=[];for(n=0;n<s;n++)for(i=a[n],o=0;o<i.length;o++)r=i[o],r.row=0,r.level=n,l.push(r);return l}function r(t){var n,i,o,r,s,l,c=U(),u=j(),d=F(),f=h(m(b.visStart),u),g=e.map(t,a),v=[];for(n=0;n<c;n++){for(i=H(O(t,g,f,h(m(f),d-u))),be(i),o=0;o<i.length;o++)for(r=i[o],s=0;s<r.length;s++)l=r[s],l.col=n,l.level=o,v.push(l);p(f,1,!0)}return v}function a(e){return e.end?m(e.end):h(m(e.start),w("defaultEventMinutes"))}function s(t,i){var o,r,a,s,c,d,p,f,h,g,m,v,b,y,_,C,k,D,S,T,E,M,O=t.length,H="",P={},A={},z=I(),F=U();for((T=w("isRTL"))?(E=-1,M=F-1):(E=1,M=0),o=0;o<O;o++)r=t[o],a=r.event,s=B(r.start,r.start)+1,c=B(r.start,r.end),d=r.col,p=r.level,f=r.forward||0,h=W(d*E),g=$(d*E+M)-h+2,g=Math.min(g-10,.95*g),p?(r.aligned=!0,m=g/(p+f+1)):m=f?2*(g/(f+1)-6):g,v=h+g/(p+f+1)*p*E+(T?g-m:0)-2,r.top=s,r.left=v,r.outerWidth=m,r.outerHeight=c-s,H+=l(a,r);for(z.append(e(H)),b=z.children(".fc-event"),o=0;o<O;o++)r=t[o],a=r.event,y=e(b[o]),_=x("eventRender",a,a,y),_===!1?y.remove():(_&&_!==!0&&(y.remove(),y=e(_).css({position:"absolute",top:r.top,left:r.left}).appendTo(z)),r.element=y,r.aligned&&y.addClass("fc-event-aligned"),a._id===i?u(a,y,r):y[0]._fci=o,Z(a,y));for(N(z,t,u),o=0;o<O;o++)r=t[o],(y=r.element)&&(k=P[C=r.key=G(y[0])],r.vsides=k===n?P[C]=L(y,!0):k,k=A[C],r.hsides=k===n?A[C]=R(y,!0):k,D=y.find("div.fc-event-content"),D.length&&(r.contentTop=D[0].offsetTop));for(o=0;o<O;o++)if(r=t[o],y=r.element){y[0].style.width=Math.max(0,r.outerWidth-r.hsides+3)+"px",y.find(".fc-event-inner")[0].style.width=Math.max(0,r.outerWidth-r.hsides)+"px",S=Math.max(0,r.outerHeight-r.vsides),y[0].style.height=S+"px",a=r.event,r.contentTop!==n&&S-r.contentTop<10&&(y.find("div.fc-event-time").text(a.title),y.find("div.fc-event-title").text(se(a.start,w("timeFormat"))+" - "+a.title));var j=(a.end.getTime()-a.start.getTime())/6e4;j<w("slotMinutes")?(y.addClass("fc-event-smallslot"),y[0].style.height="10px"):j==w("slotMinutes")?y.addClass("fc-event-1slot"):j<=2*w("slotMinutes")&&y.addClass("fc-event-2slot"),x("eventAfterRender",a,a,y)}}function l(e,t){var n="<",i=e.url,o=te(e,w),r=o?" style='"+o+"'":"",a=["fc-event","fc-event-skin","fc-event-vert"];return _(e)&&a.push("fc-event-draggable"),t.isStart&&a.push("fc-corner-top"),t.isEnd&&a.push("fc-corner-bottom"),a=a.concat(e.className),e.source&&(a=a.concat(e.source.className||[])),n+=i?"a href='"+K(e.url)+"'":"div",n+=" class='"+a.join(" ")+"' style='position:absolute;top:"+t.top+"px;left:"+t.left+"px;"+o+"'><div class='fc-event-inner fc-event-skin'"+r+"><div class='fc-event-head fc-event-skin'"+r+"><div class='fc-event-time'>"+K(le(e.start,e.end,w("timeFormat")))+"</div></div><div class='fc-event-content'><div class='fc-event-title'><p>"+K(e.title)+"</p>","undefined"!=typeof e.clients&&e.clients.length>0&&(n+="<p><i>"+K(e.clients[0].note)+"</i></p>"),n+="</div></div><div class='fc-event-bg'></div></div>",t.isEnd&&C(e)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(i?"a":"div")+">"}function c(e,t,n){_(e)&&f(e,t,n.isStart),n.isEnd&&C(e)&&V(e,t,n),E(e,t)}function u(e,t,n){var i=t.find("div.fc-event-time");_(e)&&g(e,t,i),n.isEnd&&C(e)&&v(e,t,i),E(e,t)}function d(){}function f(e,t,n){function i(){s||(t.width(o).height("").draggable("option","grid",null),s=!0)}var o,r,a,s=!0,l=w("isRTL")?-1:1,c=z(),u=Y(),d=J(),f=j();t.draggable({zIndex:9,revertDuration:w("dragRevertDuration"),start:function(f,h){x("eventDragStart",t,e,f,h),ee(e,t),o=t.width(),c.start(function(o,c,f,h){re(),o?(r=!1,a=h*l,o.row?n?s&&(t.width(u-10),A(t,d*Math.round((e.end?(e.end-e.start)/Ie:w("defaultEventMinutes"))/w("slotMinutes"))),t.draggable("option","grid",[u,1]),s=!1):r=!0:(oe(p(m(e.start),a),p(S(e),a)),i()),r=r||s&&!a):(i(),r=!0),t.draggable("option","revert",r)},f,"drag")},stop:function(n,o){if(c.stop(),re(),x("eventDragStop",t,e,n,o),r)i(),t.css("filter",""),Q(e,t);else{var l=0;s||(l=Math.round((t.offset().top-X().offset().top)/d)*w("slotMinutes")+f-(60*e.start.getHours()+e.start.getMinutes())),ne(this,e,a,l,s,n,o)}}})}function g(e,t,n){function i(t){var i,o=h(m(e.start),t);e.end&&(i=h(m(e.end),t)),n.text(le(o,i,w("timeFormat")))}function o(){c&&(n.css("display",""),t.draggable("option","grid",[g,v]),c=!1)}var r,a,s,l,c=!1,u=w("isRTL")?-1:1,d=z(),f=U(),g=Y(),v=J();t.draggable({zIndex:9,scroll:!1,grid:[g+1,v],axis:1==f&&"y",revertDuration:w("dragRevertDuration"),start:function(i,f){x("eventDragStart",t,e,i,f),ee(e,t),r=t.position(),s=l=0,d.start(function(i,r,s,l){t.draggable("option","revert",!i),re(),i&&(a=l*u,w("allDaySlot")&&!i.row?(c||(c=!0,n.hide(),t.draggable("option","grid",null)),oe(p(m(e.start),a),p(S(e),a))):o())},i,"drag")},drag:function(e,t){s=Math.round((t.position.top-r.top)/v)*w("slotMinutes"),s!=l&&(c||i(s),l=s)},stop:function(n,i){var l=d.stop();re(),x("eventDragStop",t,e,n,i),l&&(a||s||c)?ne(this,e,a,c?0:s,c,n,i):(o(),t.css("filter",""),t.css(r),Q(e,t))}})}function v(e,t,n){var i,o,r=J();t.resizable({handles:{s:"div.ui-resizable-s"},grid:r,start:function(n,r){i=o=0,ee(e,t),x("eventResizeStart",this,e,n,r)},resize:function(a,s){i=Math.round((Math.max(r,t.height())-s.originalSize.height)/r),i!=o&&(n.text(le(e.start,i||e.end?h(k(e),w("slotMinutes")*i):null,w("timeFormat"))),o=i),x("eventResizeActual",this,e.end.getTime()/1e3+w("slotMinutes")*i*60-e.start.getTime()/1e3)},stop:function(n,o){x("eventResizeStop",this,e,n,o),i?ie(this,e,0,w("slotMinutes")*i,n,o):Q(e,t)}})}var b=this;b.renderEvents=t,b.compileDaySegs=o,b.clearEvents=i,b.slotSegHtml=l,b.bindDaySeg=c,we.call(b);var y,w=b.opt,x=b.trigger,_=b.isEventDraggable,C=b.isEventResizable,k=b.eventEnd,D=b.reportEvents,T=b.reportEventClear,E=b.eventElementHandlers,M=b.setHeight,P=b.getDaySegmentContainer,I=b.getSlotSegmentContainer,z=b.getHoverListener,F=b.getMaxMinute,j=b.getMinMinute,B=b.timePosition,W=b.colContentLeft,$=b.colContentRight,q=b.renderDaySegs,V=b.resizableDayEvent,U=b.getColCnt,Y=b.getColWidth,J=b.getSlotHeight,X=b.getBodyContent,Z=b.reportEventElement,Q=b.showEvents,ee=b.hideEvents,ne=b.eventDrop,ie=b.eventResize,oe=b.renderDayOverlay,re=b.clearOverlays,ae=b.calendar,se=ae.formatDate,le=ae.formatDates}function be(e){var t,n,i,o,r,a;for(t=e.length-1;t>0;t--)for(o=e[t],n=0;n<o.length;n++)for(r=o[n],i=0;i<e[t-1].length;i++)a=e[t-1][i],M(r,a)&&(a.forward=Math.max(a.forward||0,(r.forward||0)+1))}function ye(e,t,i){function o(e,t){var n=N[e];return"object"==typeof n?X(n,t||i):n}function r(e,n){return t.trigger.apply(t,[e,n||D].concat(Array.prototype.slice.call(arguments,2),[D]))}function a(e){return l(e)&&!o("disableDragging")&&!e.disableDragging}function s(e){return l(e)&&!o("disableResizing")&&!e.disableResizing}function l(e){return ie(e.editable,(e.source||{}).editable,o("editable"))}function c(e){M={};var t,n,i=e.length;for(t=0;t<i;t++)n=e[t],M[n._id]?M[n._id].push(n):M[n._id]=[n]}function u(e){return e.end?m(e.end):S(e)}function d(e,t){O.push(t),H[e._id]?H[e._id].push(t):H[e._id]=[t]}function f(){O=[],H={}}function g(e,t){t.click(function(n){if(!t.hasClass("ui-draggable-dragging")&&!t.hasClass("ui-resizable-resizing"))return r("eventClick",this,e,n)}).hover(function(n){t.hasClass("ui-draggable-dragging")||r("eventMouseover",this,e,n)},function(n){t.hasClass("ui-draggable-dragging")||r("eventMouseout",this,e,n)})}function v(e,t){y(e,t,"show")}function b(e,t){y(e,t,"hide")}function y(e,t,n){var i,o=H[e._id],r=o.length;for(i=0;i<r;i++)t&&o[i][0]==t[0]||o[i][n]()}function w(e,t,n,i,o,a,s){var l=t.allDay,c=t._id;C(M[c],n,i,o),r("eventDrop",e,t,n,i,o,function(e,t){C(M[c],-e,-t,l),E(c)},a,s)}function x(e,t,n,i,o,a){var s=t._id;k(M[s],n,i),r("eventResize",e,t,n,i,function(){k(M[s],-n,-i),E(s)},o,a),E(s)}function _(e,n,i){C(e,n,i),t.removeEvents(e);var o,r,a=e.length;for(o=0;o<a;o++)r=e[o]}function C(e,t,i,o){i=i||0;for(var r,a=e.length,s=0;s<a;s++)r=e[s],o!==n&&(r.allDay=o),h(p(r.start,t,!0),i),r.end&&(r.end=h(p(r.end,t,!0),i)),T(r,N)}function k(e,t,n){n=n||0;for(var i,o=e.length,r=0;r<o;r++)i=e[r],i.end=h(p(u(i),t,!0),n),T(i,N)}var D=this;D.element=e,D.calendar=t,D.name=i,D.opt=o,D.trigger=r,D.isEventDraggable=a,D.isEventResizable=s,D.reportEvents=c,D.eventEnd=u,D.reportEventElement=d,D.reportEventClear=f,D.eventElementHandlers=g,D.showEvents=v,D.hideEvents=b,D.eventDrop=w,D.eventResize=x,D.calendar.eventsChanged=_;var S=D.defaultEventEnd,T=t.normalizeEvent,E=t.reportEventChange,M={},O=[],H={},N=t.options}function we(){function t(e,t,n){var i,p,g,m,v,b,y,w,x=L(),_=T(),C=E(),k=0,D=e.length;for(x[0].innerHTML=o(e,n),r(e,x.children()),a(e),s(e,x,t),l(e),c(e),u(e),i=d(),p=0;p<_;p++){for(g=0,m=[],v=0;v<C;v++)m[v]=0;for(;k<D&&(b=e[k]).row==p;){for(y=Y(m.slice(b.startCol,b.endCol)),b.top=y,y+=b.outerHeight,w=b.startCol;w<b.endCol;w++)m[w]=y;k++}i[p].height(Y(m))}h(e,f(i))}function i(t,n,i){var a,s,p,g=e("<div/>"),m=L(),v=t.length;for(g[0].innerHTML=o(t),a=g.children(),m.append(a),r(t,a),l(t),c(t),u(t),h(t,f(d())),a=[],s=0;s<v;s++)p=t[s].element,p&&(t[s].row===n&&p.css("top",i),a.push(p[0]));return e(a)}function o(e,t){var n,i,o,r,a,s,l,c,u,d,f,h,g,y=b("isRTL"),_=e.length,C=O(),k=C.left,D=C.right,S="",T=U(),M=b("weekends");for(n=0;n<_;n++){if(i=e[n],o=i.event,a=["fc-event","fc-event-skin","fc-event-hori"],w(o)&&a.push("fc-event-draggable"),y)if(i.isStart&&a.push("fc-corner-right"),i.isEnd&&a.push("fc-corner-left"),t)for(var N=0;N<t.length;N++)t[N].id===i.event.resource_id&&(s=N,l=N,c=H(s),u=P(l));else s=A(i.end.getDay()-1),l=A(i.start.getDay()),c=i.isEnd?H(s):k,u=i.isStart?P(l):D;else{if(i.isStart&&a.push("fc-corner-left"),i.isEnd&&a.push("fc-corner-right"),t)for(var N=0;N<t.length;N++)t[N].id===i.event.resource_id&&(s=N,l=N,c=H(s),u=P(l));else s=A(i.start.getDay()),l=A(i.end.getDay()-1),c=i.isStart?H(s):k,u=i.isEnd?P(l):D;if("resourceMonth"==T){if(s=i.start.getDate()-1,l=i.end.getDate()-2,!M){h=0,g=0;for(var N=0;N<=s;N++)f=p(m(v.visStart),N),0!=f.getDay()&&6!=f.getDay()||h++;for(s-=h,N=0;N<=l;N++)f=p(m(v.visStart),N),0!=f.getDay()&&6!=f.getDay()||g++;l-=g}l<0&&(l=E()-1)}else"resourceNextWeeks"==T?(s=z(i.start).col,l=z(i.end).col-1,M||(s=z(i.start).col,l=z(p(m(i.end),-1)).col)):"resourceDay"==T?(s=I(i.start),l=I(i.end)-1):(s=A(i.start.getDay()),l=A(i.end.getDay()-1))}a=a.concat(o.className),o.source&&(a=a.concat(o.source.className||[])),r=o.url,d=te(o,b),S+=r?"<a href='"+K(r)+"'":"<div",S+=" class='"+a.join(" ")+"' style='position:absolute;z-index:8;left:"+c+"px;"+d+"'><div class='fc-event-inner fc-event-skin'"+(d?" style='"+d+"'":"")+">",!o.allDay&&i.isStart&&(S+="<span class='fc-event-time'>"+K(W(o.start,o.end,b("timeFormat")))+"</span>"),S+="<span class='fc-event-title'>"+K(o.title)+"</span></div>",i.isEnd&&x(o)&&(S+="<div class='ui-resizable-handle ui-resizable-"+(y?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>"),S+="</"+(r?"a":"div")+">",i.left=c,i.outerWidth=u-c,i.startCol=s,i.endCol=l+1}return S}function r(t,n){var i,o,r,a,s,l=t.length;for(i=0;i<l;i++)o=t[i],r=o.event,a=e(n[i]),s=y("eventRender",r,r,a),s===!1?a.remove():(s&&s!==!0&&(s=e(s).css({position:"absolute",left:o.left}),a.replaceWith(s),a=s),o.element=a)}function a(e){var t,n,i,o=e.length;for(t=0;t<o;t++)n=e[t],i=n.element,i&&C(n.event,i)}function s(e,t,n){var i,o,r,a,s=e.length;for(i=0;i<s;i++)o=e[i],r=o.element,r&&(a=o.event,a._id===n?j(a,r,o):r[0]._fci=i);N(t,e,j)}function l(e){var t,i,o,r,a,s=e.length,l={};for(t=0;t<s;t++)i=e[t],o=i.element,o&&(r=i.key=G(o[0]),a=l[r],a===n&&(a=l[r]=R(o,!0)),i.hsides=a)}function c(e){var t,n,i,o=e.length;for(t=0;t<o;t++)n=e[t],i=n.element,i&&(i[0].style.width=Math.max(0,n.outerWidth-n.hsides)+"px")}function u(e){var t,i,o,r,a,s=e.length,l={};for(t=0;t<s;t++)i=e[t],o=i.element,o&&(r=i.key,a=l[r],a===n&&(a=l[r]=B(o)),i.outerHeight=o[0].offsetHeight+a)}function d(){var e,t=T(),n=[];for(e=0;e<t;e++)n[e]=M(e).find("td:first div.fc-day-content > div");return n}function f(e){var t,n=e.length,i=[];for(t=0;t<n;t++)i[t]=e[t].offsetTop;return i}function h(e,t){var n,i,o,r,a=e.length;for(n=0;n<a;n++)if(i=e[n],o=i.element){var s=parseInt(i.top)>0?parseInt(i.top):0;o[0].style.top=t[i.row]+s+"px",r=i.event,y("eventAfterRender",r,r,o)}}function g(t,n,o){var r=b("isRTL"),a=r?"w":"e",s=n.find("div.ui-resizable-"+a),l=!1;Z(n),n.mousedown(function(e){e.preventDefault()}).click(function(e){l&&(e.preventDefault(),e.stopImmediatePropagation())}),s.mousedown(function(s){function c(n){y("eventResizeStop",this,t,n),e("body").css("cursor",""),f.stop(),q(),u&&S(this,t,u,0,n),setTimeout(function(){l=!1},0)}if(1==s.which){l=!0;var u,d,f=v.getHoverListener(),h=T(),g=E(),b=r?-1:1,w=r?g-1:0,x=n.css("top"),C=e.extend({},t),M=z(t.start);V(),e("body").css("cursor",a+"-resize").one("mouseup",c),y("eventResizeStart",this,t,s),f.start(function(e,n){if(e){var s=Math.max(M.row,e.row),l=e.col;1==h&&(s=0),s==M.row&&(l=r?Math.min(M.col,l):Math.max(M.col,l)),u=7*s+l*b+w-(7*n.row+n.col*b+w);var c=p(_(t),u,!0);if(u){C.end=c;var f=d;d=i(F([C]),o.row,x),d.find("*").css("cursor",a+"-resize"),f&&f.remove(),D(t)}else d&&(k(t),d.remove(),d=null);q(),$(t.start,p(m(c),1))}},s)}})}var v=this;v.renderDaySegs=t,v.resizableDayEvent=g,v.renderTempDaySegs=i;var b=v.opt,y=v.trigger,w=v.isEventDraggable,x=v.isEventResizable,_=v.eventEnd,C=v.reportEventElement,k=v.showEvents,D=v.hideEvents,S=v.eventResize,T=v.getRowCnt,E=v.getColCnt,M=(v.getColWidth,v.allDayRow),O=v.allDayBounds,H=v.colContentLeft,P=v.colContentRight,A=v.dayOfWeekCol,I=v.timeOfDayCol,z=v.dateCell,F=v.compileDaySegs,L=v.getDaySegmentContainer,j=v.bindDaySeg,W=v.calendar.formatDates,$=v.renderDayOverlay,q=v.clearOverlays,V=v.clearSelection,U=v.getViewName}function xe(){function t(e,t,o){n(),t||(t=l(e,o)),c(e,t,o),i(e,t,o)}function n(e){p&&(p=!1,u(),s("unselect",null,e))}function i(e,t,n,i,o){p=!0,s("select",null,e,t,n,i,o)}function o(t){var o,s=r.cellDate,l=r.cellIsAllDay,p=r.getHoverListener(),f=r.reportDayClick,g=r.getResources,m=d();if(1==t.which&&a("selectable")){n(t);var v;p.start(function(e,t){u(),e&&l(e)?(v=[s(t),s(e)].sort(U),c(v[0],v[1],"resourceDay"!=m,e.row),o=e.row):v=null},t),e(document).one("mouseup",function(e){p.stop(),v&&(+v[0]==+v[1]&&f(v[0],"resourceDay"!=m,e),i(v[0],"resourceDay"==m?h(v[1],a("slotMinutes")):v[1],"resourceDay"!=m,e,g[o]))})}}var r=this;r.select=t,r.unselect=n,r.reportSelection=i,r.daySelectionMousedown=o;var a=r.opt,s=r.trigger,l=r.defaultSelectionEnd,c=r.renderSelection,u=r.clearSelection,d=r.getViewName,p=!1;a("selectable")&&a("unselectAuto")&&e(document).mousedown(function(t){var i=a("unselectCancel");i&&e(t.target).parents(i).length||n(t)})}function _e(){function t(t,n){var i=r.shift();return i||(i=e("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),i[0].parentNode!=n[0]&&i.appendTo(n),o.push(i.css(t).show()),i}function n(){for(var e;e=o.shift();)r.push(e.hide().unbind())}var i=this;i.renderOverlay=t,i.clearOverlays=n;var o=[],r=[]}function Ce(e){var t,n,i=this;i.build=function(){t=[],n=[],e(t,n)},i.cell=function(e,i){var o,r=t.length,a=n.length,s=-1,l=-1;for(o=0;o<r;o++)if(i>=t[o][0]&&i<t[o][1]){s=o;break}for(o=0;o<a;o++)if(e>=n[o][0]&&e<n[o][1]){l=o;break}return s>=0&&l>=0?{row:s,col:l}:null},i.rect=function(e,i,o,r,a){var s=a.offset();return{top:t[e][0]-s.top,left:n[i][0]-s.left,width:n[r][1]-n[i][0],height:t[o][1]-t[e][0]}}}function ke(t){function n(e){De(e);var n=t.cell(e.pageX,e.pageY);(!n!=!a||n&&(n.row!=a.row||n.col!=a.col))&&(n?(r||(r=n),o(n,r,n.row-r.row,n.col-r.col)):o(n,r),a=n)}var i,o,r,a,s=this;s.start=function(s,l,c){o=s,r=a=null,t.build(),n(l),i=c||"mousemove",e(document).bind(i,n)},s.stop=function(){return e(document).unbind(i,n),a}}function De(e){e.pageX===n&&(e.pageX=e.originalEvent.pageX,e.pageY=e.originalEvent.pageY)}function Se(e){function t(t){return o[t]=o[t]||e(t)}var i=this,o={},r={},a={};i.left=function(e){return r[e]=r[e]===n?t(e).position().left:r[e]},i.right=function(e){return a[e]=a[e]===n?i.left(e)+t(e).width():a[e]},i.clear=function(){o={},r={},a={}}}var Te={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMMM dS - {[MMMM] dS}, yyyy",day:"dddd, MMMM dS, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},compactColumnFormat:{month:"ddd '<strong>'d'</strong>'",week:"ddd '<strong>'d'</strong>'",day:"ddd '<strong>'d'</strong>'"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"&nbsp;&#9668;&nbsp;",next:"&nbsp;&#9658;&nbsp;",prevYear:"&nbsp;&lt;&lt;&nbsp;",nextYear:"&nbsp;&gt;&gt;&nbsp;",today:"today",month:"month",week:"week",day:"day",resourceDay:"resource",listDay:"list"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*",startTime:0},Ee={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"&nbsp;&#9658;&nbsp;",next:"&nbsp;&#9668;&nbsp;",prevYear:"&nbsp;&gt;&gt;&nbsp;",nextYear:"&nbsp;&lt;&lt;&nbsp;"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},Me=e.fullCalendar={version:"1.5.4"},Oe=Me.views={};e.fn.fullCalendar=function(t){if("string"==typeof t){var i,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e.data(this,"fullCalendar");if(r&&e.isFunction(r[t])){var a=r[t].apply(r,o);i===n&&(i=a),"destroy"==t&&e.removeData(this,"fullCalendar")}}),i!==n?i:this}var a=t.eventSources||[];return delete t.eventSources,t.events&&(a.push(t.events),delete t.events),t=e.extend(!0,{},Te,t.isRTL||t.isRTL===n&&Te.isRTL?Ee:{},t),this.each(function(n,i){var o=e(i),s=new r(o,t,a);o.data("fullCalendar",s),s.render()}),this},Me.sourceNormalizers=[],Me.sourceFetchers=[];var He={dataType:"json",cache:!1},Ne=1;Me.addDays=p,Me.cloneDate=m,Me.parseDate=x,Me.parseISO8601=_,Me.parseTime=C,Me.formatDate=k,Me.formatDates=D;var Pe=["sun","mon","tue","wed","thu","fri","sat"],Ae=864e5,Re=36e5,Ie=6e4,ze={s:function(e){return e.getSeconds()},ss:function(e){return J(e.getSeconds())},m:function(e){return e.getMinutes()},mm:function(e){return J(e.getMinutes())},h:function(e){return e.getHours()%12||12},hh:function(e){return J(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return J(e.getHours())},d:function(e){return e.getDate()},dd:function(e){return J(e.getDate())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return J(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return(e.getFullYear()+"").substring(2)},yyyy:function(e){return e.getFullYear()},t:function(e){return e.getHours()<12?"a":"p"},tt:function(e){return e.getHours()<12?"am":"pm"},T:function(e){return e.getHours()<12?"A":"P"},TT:function(e){return e.getHours()<12?"AM":"PM"},u:function(e){return k(e,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(e){var t=e.getDate();return t>10&&t<20?"th":["st","nd","rd"][t%10-1]||"th"}};Me.applyAll=ne,Oe.basicWeek=oe,Oe.basicDay=re,o({weekMode:"fixed"}),Oe.resourceDay=le,o({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24}),Oe.listDay=de,o({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{list:"h:mm{ - h:mm}"},dragOpacity:{list:.5},minTime:0,maxTime:24}),Oe.agendaWeek=he,Oe.agendaDay=ge,o({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})}(jQuery)}),function(e){function t(t,n){function i(){return g.addClass("scrollable"),n.alwaysVisible&&g.addClass("visible"),h.update(),l(),n.handleResize&&e(window).bind("resize",o),h}function o(e){h.update.call(h)}function r(){var e=C.toLowerCase();w.obj.css(_,k/b.ratio),v.obj.css(_,-k),S.start=w.obj.offset()[_],m.obj.css(e,g.height()),b.obj.css(e,g.height()),y.obj.css(e,g.height()),w.obj.css(e,w[n.axis]-2)}function a(t){var n=e(t.target).parents(".scrollable")[0];n&&n!=g[0]||u(t.originalEvent),t.stopPropagation(),t.preventDefault()}function s(e){var t=0;if(33==e.keyCode&&(t=-400),34==e.keyCode&&(t=400),38==e.keyCode&&(t=-50),40==e.keyCode&&(t=50),0!=t)return h.update(h.getTop()+t),!1}function l(){T?m.obj[0].ontouchstart=function(e){1===e.touches.length&&(c(e.touches[0]),e.stopPropagation())}:(w.obj.bind("mousedown",c),y.obj.bind("mouseup",d)),n.mainScroller?(e(document).bind("mousewheel DOMMouseScroll",a),e(document).bind("keydown",s)):n.scroll&&window.addEventListener?(g[0].addEventListener("DOMMouseScroll",u,!1),g[0].addEventListener("mousewheel",u,!1)):n.scroll&&(g[0].onmousewheel=u)}function c(t){n.alwaysVisible||g.addClass("visible"),e("body").addClass("noSelect");var i=parseInt(w.obj.css(_),10);S.start=x?t.pageX:t.pageY,D.start="auto"==i?0:i,T?(document.ontouchmove=function(e){e.preventDefault(),d(e.touches[0])},document.ontouchend=p):(e(document).bind("mousemove",d),e(document).bind("mouseup",p),w.obj.bind("mouseup",p))}function u(t){if(v.ratio<1){var i=t||window.event,o=i.wheelDelta?i.wheelDelta/120:-i.detail/3;k-=o*n.wheel,
k=Math.min(v[n.axis]-m[n.axis],Math.max(0,k)),w.obj.css(_,k/b.ratio),v.obj.css(_,-k),(n.lockscroll||k!==v[n.axis]-m[n.axis]&&0!==k)&&(i=e.event.fix(i),i.preventDefault()),f(k/b.ratio)}}function d(e){e.stopPropagation(),v.ratio<1&&(n.invertscroll&&T?D.now=Math.min(y[n.axis]-w[n.axis],Math.max(0,D.start+(S.start-(x?e.pageX:e.pageY)))):D.now=Math.min(y[n.axis]-w[n.axis],Math.max(0,D.start+((x?e.pageX:e.pageY)-S.start))),k=D.now*b.ratio,v.obj.css(_,-k),w.obj.css(_,D.now),f(D.now))}function p(t){t.stopPropagation(),n.alwaysVisible||g.removeClass("visible"),e("body").removeClass("noSelect"),e(document).unbind("mousemove",d),e(document).unbind("mouseup",p),w.obj.unbind("mouseup",p),document.ontouchmove=document.ontouchend=null}function f(e){e=parseInt(e);var t=parseInt(g.height()-e-w[n.axis]);t<=0?E||(E=!0,g.trigger("scrollbar",["bottom"])):parseInt(e)<=0?E||(E=!0,g.trigger("scrollbar",["top"])):E=!1}var h=this,g=e(t),m={obj:e(t).children(".viewport")},v={obj:m.obj.children(".overview")},b={obj:e(t).children(".scrollbar")},y={obj:b.obj.children(".track")},w={obj:y.obj.children(".thumb")},x="x"===n.axis,_=x?"left":"top",C=x?"Width":"Height",k=0,D={start:0,now:0},S={},T=!1,E=!1;return this.destroy=function(){n.handleResize&&e(window).unbind("resize",o),n.mainScroller&&(e(document).unbind("mousewheel",a),e(document).unbind("keydown",s))},this.getTop=function(){return k},this.update=function(e){"undefined"==typeof e&&(e=this.getTop()),m[n.axis]=g.height(),v[n.axis]=v.obj[0]["scroll"+C],v.ratio=m[n.axis]/v[n.axis],b.obj.toggleClass("disable",v.ratio>=1),y[n.axis]=g.height(),w[n.axis]=Math.min(y[n.axis],Math.max(0,"auto"===n.sizethumb?y[n.axis]*v.ratio:n.sizethumb)),b.ratio="auto"===n.sizethumb?v[n.axis]/y[n.axis]:(v[n.axis]-m[n.axis])/(y[n.axis]-w[n.axis]),e<0&&(e=0),e>v.obj.height()-g.height()&&(e=parseInt((g.height()-w[n.axis])*b.ratio)),k="relative"===e&&v.ratio<=1?Math.min(v[n.axis]-m[n.axis],Math.max(0,k)):0,k="bottom"===e&&v.ratio<=1?v[n.axis]-m[n.axis]:isNaN(parseInt(e,10))?k:parseInt(e,10),r(),f(k/b.ratio)},i()}e.tiny=e.tiny||{},e.tiny.scrollbar={options:{axis:"y",wheel:60,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1,mainScroller:!1,handleResize:!1,alwaysVisible:!0}},e.fn.scrollbar=function(n){var i=Array.prototype.slice.call(arguments,0);return this.each(function(){var o=e(this),r=o.data("scrollbar"),a="object"==typeof n&&n;r||(a=e.extend({},e.tiny.scrollbar.options,a),o.data("scrollbar",r=new t(this,a))),"string"==typeof n&&r[n].apply(r,i.slice(1))})}}(jQuery),r("libs/scrollbar",["jquery"],function(){}),r("libs/modal",["jquery","ko"],function(e,t){!function(e){var n=function(n,i){var o,r,a,s={width:600,height:"auto",content:"",cls:"",closeOnClickOut:!0,modalTemplate:'<div class="modal"><div class="modal-wrapper"><div class="modal-window"></div></div></div>',onRender:function(){},onShow:function(){},onHide:function(){}},l=e.extend({},s,i),c=e(n),u=function(){if(r=e(l.modalTemplate),c.append(r),r.addClass(l.cls),a=r.find(".modal-window"),l.viewModel&&l.template){var n="";"undefined"!=typeof l.viewModel.afterRender&&(n=", afterRender: afterRender"),a.html("<div data-bind=\"template: {name: '"+l.template+"'"+n+'}"></div>'),t.applyBindings(l.viewModel,a[0])}else a.html(l.content);a.append(e('<a href="#" class="close modal-close"><i class="icon icon-close"></i></a>')),o=a.find(".modal-close"),o.click(function(e){e.preventDefault(),e.stopPropagation(),f()}),""==l.cls&&"auto"!=l.width&&a.width(l.width),""==l.cls&&"auto"!=l.height,"function"==typeof l.onRender&&l.onRender.call(c,r),e(document).on("click",".modal-window",g)},d=function(){u(),e("body").addClass("modal-opened"),r.addClass("visible"),"function"==typeof l.onShow&&l.onShow.call(c,c)},p=!1,f=function(){p=!0,e("body").removeClass("modal-opened"),r.unbind("click",g),"function"==typeof l.onHide&&l.onHide.call(c,c),r.removeClass("visible"),r.remove(),c.removeData("modal")},h=function(){},g=function(t){0==e(t.target).closest(".modal-window").length&&l.closeOnClickOut&&f()};return{show:d,hide:f,recomputePosition:h}};e.fn.modal=function(t){var i=Array.prototype.slice.call(arguments,0);return this.each(function(){var o=e(this),r=o.data("modal"),a="object"==typeof t&&t;r||o.data("modal",r=new n(this,a)),"string"==typeof t&&r[t].apply(r,i.slice(1))})}}(jQuery)}),r("libs/popover",["jquery"],function(e){!function(e){var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,i){var o,r;this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.enabled=!0,"manual"!=this.options.trigger&&(o="hover"==this.options.trigger?"mouseenter":"focus",r="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(o,this.options.selector,e.proxy(this.enter,this)),this.$element.on(r,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);return n.options.delay&&n.options.delay.show?(clearTimeout(this.timeout),n.hoverState="in",void(this.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show))):n.show()},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),n.options.delay&&n.options.delay.hide?(n.hoverState="out",void(this.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide))):n.hide()},show:function(){var t;if(this.hasContent()&&this.enabled){t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),this.options.cls&&t.addClass(this.options.cls);var n=this.$element.parents(this.options.container);0==n.length&&(n=e("body")),"manual"==this.options.trigger?t.remove().hide().appendTo(n):(t.remove().appendTo(n),this.placement(this.options.placement))}},placement:function(t){var n=this.$element.parents(this.options.container);0==n.length&&(n=e("body"));var i,o={},r=this.tip(),a="function"==typeof t?t.call(this,r[0],this.$element[0]):t,s=/in/.test(a),l=this.getPosition(s),c=0;"object"==typeof a&&a&&(c=a.offset,a=a.side),r.show();var u=r.width(),d=r.height();switch(a){case"bottom":i={top:l.top+l.height-n.offset().top,left:l.left-n.offset().left+l.width/2-u/2+c},o={left:u/2-c};break;case"top":i={top:l.top-d-n.offset().top-18,left:l.left-n.offset().left+l.width/2-u/2+c},o={left:u/2-c};break;case"left":i={top:l.top-n.offset().top+l.height/2-d/2+c-6,left:l.left-u-n.offset().left-18},o={top:d/2-c+6};break;case"right":i={top:l.top-n.offset().top+l.height/2-d/2+c-6,left:l.left+l.width-n.offset().left},o={top:d/2-c+6};break;case"right-bottom":i={top:l.top-n.offset().top+l.height/2-30,left:l.left+l.width-n.offset().left+3};break;case"left-bottom":i={top:l.top-n.offset().top+l.height/2-30,left:l.left-u-n.offset().left-25}}i.top=parseInt(i.top),i.left=parseInt(i.left),r.find(".arrow2").css(o),r.css(i).addClass(a).addClass("in")},isHTML:function(e){return"string"!=typeof e||"<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(e)},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner").empty().append(t),e.removeClass("fade in top bottom left right right-bottom")},hide:function(){function t(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var n=this.tip();n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():n.remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},recalculateHeight:function(e){"undefined"==typeof e&&(e=!0);var t=this.$tip.find(".popover-inputs"),n=this.$tip.find(".form-actions"),i=t.outerHeight()+n.outerHeight();e?(this.$tip.find(".form-container").animate({height:i+"px"},200),this.$tip.find("form").animate({height:i+"px"},200),this.$tip.find(".popover-inner").animate({height:i-20+"px"},200)):(this.$tip.find(".form-container").height(i),this.$tip.find("form").height(i),this.$tip.find(".popover-inner").height(i-20))}},e.fn.tooltip=function(n){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var o=e(this),r=o.data("tooltip"),a="object"==typeof n&&n;if(r||o.data("tooltip",r=new t(this,a)),"string"==typeof n)return r[n].apply(r,i)})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={container:"body",animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="arrow2"><div class="arrow"></div></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",cls:"",delay:0}}(jQuery),!function(e){var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getContent();this.$tip=e,e.find(".popover-inner").empty().append(t),e.removeClass("fade top bottom left right-bottom right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=(this.$element,this.options);return e=t.content},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},showAlert:function(t,n,i){var o=this.tip(),r=this;this.alertElement&&0!=this.alertElement.length||(this.alertElement=e('<div class="popover-inner alert">'),this.alertElement.append(t),this.alertElement.height(e(".popover").height()),this.alertElement.css({top:0,left:"150px",position:"absolute"}),o.append(this.alertElement)),this.alertElement.empty().append(t),"undefined"!=typeof n&&n.apply(r.alertElement),this.alertElement.css({opacity:0}).animate({left:"-=150px",opacity:1},200,function(){"undefined"!=typeof i&&i.apply(r.alertElement)})},hideAlert:function(){var t=this;e(".popover form");this.alertElement.animate({left:"+=150px",opacity:0},200,function(){t.alertElement.remove(),t.alertElement=null})}}),e.fn.popover=function(n){var i,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e(this),a=r.data("popover"),s="object"==typeof n&&n;if(a||r.data("popover",a=new t(this,s)),"string"==typeof n){var l=a[n].apply(a,o);void 0===i&&(i=l)}}),i?i:this},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",content:"",cls:"",template:'<div class="popover"><div class="arrow2"><div class="arrow"></div></div><div class="popover-inner" style="overflow:visible;"></div></div>'})}(jQuery)}),function(e){var t=function(t,n){var i,o,r,a={type:"select",appendTo:"body",width:"auto",maxHeight:155,writable:!1,items:[],itemTemplate:"<li></li>",textProp:null,valueProp:null,limit:5,timeout:300,cls:"",indexByValue:function(t,n){var i=-1,o=s.valueProp||s.textProp;return e.each(n,function(e,n){var n=j(n,o);return"function"==typeof n&&(n=n()),t==n?(i=e,!1):n}),i},onSelect:function(e,t){l.val(j(t,s.textProp))},onRender:null,onBlur:function(){},onShow:function(){}},s=e.extend({},a,n),l=e(t),c=e('<div class="selectbox-input"><i class="icon icon-dropdown"></i></div>'),u=e('<div class="selectbox"><ul></ul></div>'),d=!0,p=[],f=function(){i=e(l.parents(s.appendTo+", body")[0]);var t=i.css("position");i.is("body")||"absolute"==t||"relative"==t||i.css("position","relative"),"select"==s.type?x():"checkbox"==s.type?_():"search"==s.type&&(s.writable=!0,C()),l.attr("autocomplete","off"),l.keydown(h),l.focus(function(e){o().length>0&&S()})},h=function(e){r&&(clearTimeout(r),r=null);var t=String.fromCharCode(e.which);switch(e.keyCode){case 9:T();break;case 13:case 27:y()&&(e.preventDefault(),b()),T();break;case 38:e.preventDefault(),v();break;case 40:e.preventDefault(),m();break;default:g(t)}},g=function(t){var n,i,o=null,r=u.find(".active").index(),a=t.match(/^[0-9a-zA-ZáčďéěíňóřšťůúýžÁČĎÉĚÍŇÓŘŠŤŮÚÝŽ]$/);if(t=t.toLowerCase(),a){var s=u.find("li"),l=s.length;e.each(s,function(a){if(i=e(this),n=i.text().toLowerCase(),n.length>0&&n[0]==t){if(null===o&&(console.log("firstIndex === null"),o=a),r==l-1)return console.log("index == listLength - 1"),u.find("li.active").removeClass("active"),e(u.find("li").get(o)).addClass("active"),w(o),!1;if(a>r)return console.log("i > index"),u.find("li.active").removeClass("active"),i.addClass("active"),w(a),!1}else if(null!==o)return console.log("firstIndex !== null"),u.find("li.active").removeClass("active"),e(u.find("li").get(o)).addClass("active"),w(o),!1})}},m=function(){var e=u.find("li.active"),t=e.next();t.length&&(e.removeClass("active"),t.addClass("active"))},v=function(){var e=u.find("li.active"),t=e.prev();t.length&&(e.removeClass("active"),t.addClass("active"))},b=function(){var e=u.find("li.active");e.length>0&&R(e,p[e.index()])},y=function(){return!u.hasClass("hidden")},w=function(e){var t=Math.min(u.find("ul").height(),s.maxHeight);u.scrollTop(+(u.find("li").eq(e)[0].offsetTop-t/2))},x=function(){o=function(){return"function"==typeof s.items?s.items():s.items},l.after(c),l.detach(),c.prepend(l),s.writable?l.addClass("selectbox-editable"):l.attr("readonly","readonly").addClass("selectbox-not-editable"),I(),c.mousedown(function(e){s.writable,E()}),u.addClass("hidden")},_=function(){o=function(){return s.items},l.after(c),l.detach(),c.prepend(l),s.writable?l.addClass("selectbox-editable"):(l.attr("readonly","readonly"),l.addClass("selectbox-not-editable")),I(),c.mousedown(function(){E()}),u.addClass("hidden"),D(),P()},C=function(){o=function(){return p},l.after(c),l.detach(),c.prepend(l),c.find("i").remove(),l.addClass("selectbox-editable"),l.keyup(z),u.addClass("hidden")},k=function(){u.remove()},D=function(){d&&(d=!1,u.find("ul").empty(),p=o(),s.checkAll&&p.length>1&&p.unshift({id:-1,allChecker:!0,text:s.checkAll}),u.find("ul").html(e.map(p,function(t){var n=e(s.itemTemplate);return"function"==typeof s.onRender?t.allChecker?(n.find(".text").text(t.text),n.find("input").prop("checked",H())):s.onRender.call(l.data("selectBox"),n,t):n.text(j(t,s.textProp)),n.click(function(e){R(n,t,e)}),"undefined"==typeof t.allChecker&&(t.allChecker=!1),"checkbox"==s.type,n}))),M()&&u.find("li:first input").prop("checked",H())},S=function(){if(!l.is(":disabled")){var e=0;D(),u.removeClass("hidden").addClass("visible"),""!=s.cls&&u.addClass(s.cls),i.append(u);var t=Math.min(u.find("ul").height(),s.maxHeight),n=u.height()>t,o=u.outerWidth()+(n?20:0)>l.outerWidth(),r="auto"==s.width?Math.max(l.outerWidth()-4,u.outerWidth()):s.width;o&&n&&(r+=20),u.height(t).outerWidth(r),".popover-inner"==s.appendTo||l.offset().top-i.offset().top+l.outerHeight()+t<i.height()?u.css({top:l.offset().top-i.offset().top+l.outerHeight()+"px",left:l.offset().left-i.offset().left+"px"}):u.css({top:l.offset().top-i.offset().top-t-5+"px",left:l.offset().left-i.offset().left+"px"}),"select"==s.type?(u.find("li").removeClass("active"),e=s.indexByValue(l.val(),p),e>=0?(u.find("li").eq(e).addClass("active"),u.scrollTop(+(u.find("li").eq(e)[0].offsetTop-t/2))):u.scrollTop(0)):"search"==s.type&&u.find("li").eq(0).addClass("active"),s.onShow(u);u.find("ul").height()/p.length;u.parents(".modal-window, body").bind("click",F)}},T=function(){u.parents(".modal-window, body").unbind("click",F),u.removeClass("visible").addClass("hidden"),u.detach(),"search"==s.type&&(p=[])},E=function(){u.parent().length>0?T():S()},M=function(){var t=!1;return e.each(p,function(e,n){if(n.allChecker)return t=!0,!1}),t},O=function(){var t=0;return e.each(p,function(e,n){!n.allChecker&&u.find("li").eq(e).find("input").prop("checked")&&t++}),t},H=function(){var e=p.length;return M()&&e--,O()==e},N=function(){return 0==O()},P=function(){var t;t=H()?s.checkAll:N()?s.nothingChecked:e.map(p,function(e,t){if(!e.allChecker&&u.find("li").eq(t).find("input").prop("checked"))return j(e,s.textProp)}).join(", "),l.val(t),l.attr("title",t)},A=function(t){e.each(p,function(e,n){u.find("li").eq(e).find("input").prop("checked",t),"function"!=typeof s.onSelect||n.allChecker||s.onSelect.call(this,u.find("li").eq(e+1),n,t)})},R=function(t,n,i){if(i&&i.stopPropagation(),"checkbox"==s.type){var o=t.find("input"),r=o.prop("checked");e(i.target).is("input")?n.allChecker?A(r):(o.prop("checked",r),"function"==typeof s.onSelect&&s.onSelect.call(this,t,n,r)):(n.allChecker?A(!0):(A(!1),o.prop("checked",!0),"function"==typeof s.onSelect&&s.onSelect.call(this,t,n,!0)),T()),P(),M()&&u.find("li:first input").prop("checked",H())}else s.onSelect.call(this,t,n),setTimeout(function(){T()},10)},I=function(){},z=function(t){switch(r&&(clearTimeout(r),r=null),t.keyCode){case 9:case 13:case 27:case 38:case 40:return}""!=l.val()?r=setTimeout(function(){""!=l.val()&&("function"==typeof s.items?s.items(l.val(),function(e){d=!0,p=s.onFetch(e),p.length>0?S():T()}):e.get(s.items,{query:l.val(),limit:s.limit},function(e){d=!0,p=s.onFetch(e),p.length>0?S():T()}))},s.timeout):(p=[],T())},F=function(t){t.target!==l[0]&&t.target!==c.find("i")[0]&&0==u.has(e(t.target)).length&&T()},L=function(){d=!0},j=function(e,t){if(!t)return e;for(var n=t.split("."),i=e[n[0]],o=1;o<n.length;o++)i=i[n[o]];return i};return f(),{show:S,hide:T,destroy:k,setListDirty:L}};e.fn.selectBox=function(n){var i=Array.prototype.slice.call(arguments,0);return this.each(function(){var o=e(this),r=o.data("selectBox"),a="object"==typeof n&&n;r||o.data("selectBox",r=new t(this,a)),"string"==typeof n&&r[n].apply(r,i.slice(1))})}}(jQuery),r("libs/selectBox",["jquery","libs/scrollbar"],function(){}),r("reservio/models",["jquery","ko","reservio/utils","reservio/ajax","reservio/lang","reservio/data","reservio/app"],function(e,t,n,i,o,r,a){var s;return{init:function(){return s=this},Currencies:{usd:"$",eur:"€",czk:"Kč"},Objects:{Contact:function(a){a=a||{};var l=this;l.id=t.observable(a.id||null),l.name=t.simpleObservable(a.name||"").extend({validatorRequired:{message:o.get("error-client-name-required"),realtime:!0}}),l.name.changed=t.observable(!1),l.name.subscribe(function(){l.name.changed(!0)}),l.email=t.simpleObservable(a.email||"").extend({validatorEmail:{message:o.get("error-email-format"),realtime:!0}}),l.phone=t.simpleObservable(a.phone||"").extend({validatorPhone:{message:o.get("error-phone-format"),realtime:!0}}),l.address=t.simpleObservable(a.address||""),l.gender=t.simpleObservable(a.gender||null),l.gender.temp.setOptions([{code:null,text:o.get("gender-notKnown")},{code:"m",text:o.get("gender-male")},{code:"f",text:o.get("gender-female")}],"code"),l.note=t.simpleObservable(a.note||""),l.birthday=t.timeObservable(a.birthday?n.date.decodeDate(a.birthday):""),l.fb_id=t.observable(a.fb_id||""),l.fb_username=t.observable(a.fb_username||""),l.isOverLimit=a.isOverLimit,l.clients_coupons=t.observableArray(e.map(a.clients_coupons||[],function(e){return e.expire_on=n.date.decodeDate(e.expire_on),e})),l.is_deleted=void 0!==a.is_deleted&&a.is_deleted,l.isValid=function(){var e=!0;return e&=l.name.isValid(),e&=l.email.isValid(),e&=l.phone.isValid()},l.commit=function(e,t){if(e=e||function(){},t=t||function(){},l.isValid()){l.name.commit(),l.email.commit(),l.phone.commit(),l.address.commit(),l.gender.commit(),l.note.commit(),l.birthday.commit();var i={id:l.id(),name:l.name(),email:l.email(),phone:l.phone(),address:l.address(),gender:l.gender(),note:l.note(),birthday:n.date.encodeDate(l.birthday())};i.id>0?s.Contacts.update(i,function(t){e(!0)},function(t){e(!1)}):s.Contacts.create(i,function(t){l.id(t.data.id),e(!0)},function(t){e(!1)})}else t()},l.cancel=function(){l.name.reset(),l.email.reset(),l.phone.reset(),l.address.reset(),l.gender.reset(),l.note.reset(),l.birthday.reset()},l.destroy=function(e){e=e||function(){},s.Contacts.destroy(l.id,function(t){e()})},l.activityPage=t.observable(1),l.lastDateLoaded=0,l.noMoreActivity=t.observable(null),l.history=t.loadableArray(function(t){l.noMoreActivity()?t():(l.history.loading(!0),i.get("/contacts/feed/",{id:l.id(),page:l.activityPage(),limit:25,lastDateLoaded:l.lastDateLoaded},function(i){var a=i.data.feed;l.lastDateLoaded=i.data.lastDateLoaded,l.history.push.apply(l.history,e.map(a,function(e){return"event"==e.type?(e.end=n.date.decode(e.end),e.start=n.date.decode(e.start),e.created=n.date.decode(e.created),0==e.via?e.viaLanguage="activity-via-reservio":1==e.via?e.viaLanguage="activity-via-button":2==e.via?e.viaLanguage="activity-via-minipage":3==e.via?e.viaLanguage="activity-via-facebook":4==e.via&&(e.viaLanguage="activity-via-booking"),e.client_fb_username=l.fb_username,e):"note"==e.type?new r.entities.Note(e):"coupon"==e.type?(e.created=n.date.decode(e.created),e):e})),a.length<25&&(l.history().length>0&&l.history().length>0||l.noMoreActivity(o.get("activity-noActivity"))),l.activityPage(l.activityPage()+1),t()}))}),l.getComparableProperty=function(e){return"note"==e.type?e.created():"event"==e.type?e.start:void 0},l.sortActivities=function(e,t){return l.getComparableProperty(e)>l.getComparableProperty(t)?-1:1},l.upcoming=t.loadableArray(function(t){l.upcoming.loading(!0),i.get("/contacts/feed/",{id:l.id(),type:"upcoming"},function(i){var o=i.data.feed;l.upcoming(e.map(o,function(e){if("event"==e.type)return e.end=n.date.decode(e.end),e.start=n.date.decode(e.start),e.created=n.date.decode(e.created),0==e.via?e.viaLanguage="activity-via-reservio":1==e.via?e.viaLanguage="activity-via-button":2==e.via?e.viaLanguage="activity-via-minipage":3==e.via?e.viaLanguage="activity-via-facebook":4==e.via&&(e.viaLanguage="activity-via-booking"),e.client_fb_username=l.fb_username,e})),t()})})},Booking:function(e){e=e||{};var n=this;n.id=e.id||null,n.created=t.timeObservable(e.created),n.count=t.simpleObservable(+e.count),n.state=t.simpleObservable("undefined"==typeof e.state?1:e.state),n.note=t.simpleObservable(e.note||"").extend({cropText:150}),n.client_name=e.client_name||"",n.contact=t.simpleObservable(e.contact||null),n.clients_coupon_id=e.clients_coupon_id||null,n.is_first_booking=void 0!==e.is_first_booking&&e.is_first_booking,n.isOverLimit=e.isOverLimit||!1},Event:function(i){i=i||{};var l=this;l.id=i.id||null,l.eventId=i.event_id,l.title=t.simpleObservable(i.title||"").extend({validatorRequired:{message:o.get("event/name/error"),realtime:!1}}),l.start=t.timeObservable(i.start),l.start.temp.subscribe(function(e){l.end.temp(new Date(e.getTime()+1e3*l.duration()))}),l.end=t.timeObservable(i.end),l.duration=t.computed({read:function(){return l.end.temp().getTimeS()-l.start.temp().getTimeS()},write:function(e){l.end.temp(new Date(l.start.temp().getTime()+1e3*e))}}),l.description=t.simpleObservable(i.description||""),l.color=t.simpleObservable(i.color||0),l.cost=t.numericObservable(i.cost?i.cost:""),l.resource=t.simpleObservable(i.resource||new r.entities.ResourceNew({name:o.get("basic-notAssigned")})),l.service=t.simpleObservable(i.service||new r.entities.ServiceNew({name:o.get("basic-notAssigned")})),l.bookingsChanged=t.observable(!1),l.bookings=t.observableArray(i.bookings||[]),l.capacity=t.simpleObservable(i.capacity||1),l.occupancy=t.computed(function(){var t=0;return e.each(this.bookings(),function(e,n){t+=+n.count()}),t},l),l.capacity.temp.minValue(1,o.get("error-event-capacity"),!0),l["private"]=t.simpleObservable(1==i["private"]),l.minipage_url=i.minipage_url||"",l.repeatType=t.simpleObservable(i.repeat_type||0),l.repeatIndex=t.simpleObservable(i.repeat_index),l.repeatInterval=t.simpleObservable(i.repeat_interval||1),l.repeatEndsType=t.simpleObservable(""+(i.repeat_ends_type||"2"));var c=i.repeat_options;c||2!=l.repeatType()&&0!=l.repeatType()||(c=1<<l.start().getDay()),l.repeatOptions=t.simpleObservable(c||0),l.repeatEndsOn=t.timeObservable(i.repeat_ends_on||new Date((new Date).getTime()+6048e5)),l.repeatEndsAfter=t.simpleObservable(i.repeat_ends_after||7),l.repeatType.setOptions([{id:0,name:o.get("repeat-type-0")},{id:1,name:o.get("repeat-type-1")},{id:2,name:o.get("repeat-type-2")},{id:3,name:o.get("repeat-type-3")}],"id"),l.repeatFormatted=t.computed(function(){var t=o.get("repeat-type-"+this.repeatType.temp()),i="";if(1==this.repeatEndsType.temp()){if(1==this.repeatEndsOn.temp())return o.get("repeat-once");i=o.get("repeat-until")+" "+n.date.formatDate(this.repeatEndsOn.temp(),n.date.getDatePattern(_reservio.datePattern))}else{if(1==this.repeatEndsAfter.temp())return o.get("repeat-once");i=this.repeatEndsAfter.temp()+" "+o.get("repeat-times")}if(2==this.repeatType.temp()){var r=function(e){for(var t=[],n=0,i=1;i<256;i*=2,n++)e&i&&t.push(n);return t},a=o.getDays();t=t+" "+o.get("repeat-on")+" "+e.map(r(this.repeatOptions.temp()),function(e){return a[e]}).join(", ")}else 1!=this.repeatInterval.temp()&&(t=o.get("repeat-every")+" "+this.repeatInterval.temp()+" "+o.getByCount("time-duration-"+["","days","weeks","months"][this.repeatType()],this.repeatInterval.temp()));return t+", "+i},l),l.changed=t.computed(function(){return l.title.changed()||l.start.changed()||l.end.changed()||l.resource.changed()||l.service.changed()||l.color.changed()||l.capacity.changed()||l.cost.changed()||l["private"].changed()||l.description.changed()||e.map(l.bookings(),function(e){if(e.note.changed()||e.contact().name.changed())return!0}).length>0}),l.repeatChanged=function(e){return e="undefined"!=typeof e&&e,l.repeatType.changed()||l.repeatInterval.changed()||l.repeatOptions.changed()||!e&&(l.repeatEndsType.changed()||l.repeatEndsOn.changed()||l.repeatEndsAfter.changed())},l.repeatEndChanged=function(){return!l.repeatType.changed()&&!l.repeatInterval.changed()&&!l.repeatOptions.changed()&&(l.repeatEndsType.changed()||l.repeatEndsOn.changed()||l.repeatEndsAfter.changed())},l.isValid=function(){var t=!0;return"appointment"==_reservio.categoryType?(t&=l.title.isValid()||l.bookings().length>0,e.each(l.bookings(),function(e,n){t&=n.contact.temp().isValid()})):"group"==_reservio.categoryType&&(t&=l.title.isValid(),t&=l.capacity.temp.isValid()),t},l.commit=function(i,o,r){if(i=i||function(){},o=o||function(){},r=r||{},l.isValid()){l.title.commit(),l.start.commit(),l.end.commit(),l.resource.commit(),l.service.commit(),l.title.commit(),l.capacity.commit(),l.description.commit(),0==l.repeatType.temp()&&(l.repeatInterval(0),l.repeatOptions(0),l.repeatEndsType(null),l.repeatEndsOn(null),l.repeatEndsAfter(null));var c={id:l.id,name:l.title(),start:n.date.encode(l.start.temp()),end:n.date.encode(l.end.temp()),capacity:l.capacity.temp(),color:l.color.temp(),"private":l["private"].temp()?1:0,cost:l.cost(),description:l.description(),repeat_type:l.repeatType.temp(),repeat_interval:l.repeatInterval.temp(),repeat_options:l.repeatOptions.temp(),repeat_ends_type:l.repeatEndsType.temp(),repeat_ends_after:l.repeatEndsAfter.temp(),repeat_ends_on:n.date.encode(l.repeatEndsOn.temp())};c=t.utils.extend(c,r),"appointment"==_reservio.categoryType&&(c.bookings=e.map(l.bookings(),function(e){e.contact.commit();var t=e.contact();return t.name.commit(),t.email.commit(),t.phone.commit(),{id:e.id,note:e.note.temp(),via:0,state:1,client:{id:t.id(),name:t.name(),email:t.email(),phone:t.phone()}}})),l.resource()&&(c.resource_id=l.resource().data.id,c.resource_name=l.resource().data.name),l.service()&&(c.service_id=l.service().data.id,c.service_name=l.service().data.name),c.id>0?s.Appointments.update(c,function(e){a.acl.bookings.count(e.data.bookings),e.data.eventName?i(!1,function(){l.commit(i,o,!0)},e.data.eventName):i(!0)},function(){i(!1)}):s.Appointments.create(c,function(e){a.acl.bookings.count(e.data.bookings),e.data.id?(l.id=e.data.id,l.bookings().length&&l.bookings()[0].contact().id(e.data.contact_id),i(!0)):i(!1,function(){l.commit(i,o,!0)},e.data.eventName)},function(){i(!1)})}else o()},l.cancel=function(){},l.destroy=function(e,t){t=t||function(){},s.Appointments.destroy({id:l.id,reason:e},function(e){a.acl.bookings.count(e.data.bookings),t(e.data)})}},Appointment:function(e){e=e||{};var i=this;i.id=e.id||null,i.title=t.observable(e.title||"").extend({validatorRequired:{message:"Please select client",realtime:!1}}),i.start=t.timeObservable(e.start||0),i.start.temp.subscribe(function(e){i.end.temp(e+n.date.durationToSeconds(i.duration()))}),i.end=t.timeObservable(e.end||0),i.duration=t.computed({read:function(){return n.date.formatDuration(i.end.temp()-i.start.temp())},write:function(e){i.end.temp(i.start.temp()+n.date.durationToSeconds(e))}}),i.resource=t.observable(e.resource||null),i.service=t.observable(e.service||null),i.note=t.observable(e.note||""),i.contact=t.observable(e.contact||null),i.isValid=function(){return i.title.isValid()},i.commit=function(e,t){if(e=e||function(){},t=t||function(){},i.isValid()){var n={id:i.id,name:i.title(),start:i.start.temp(),end:i.end.temp(),email:i.contact().email||"",phone:i.contact().phone||""};i.resource()&&(n.resource_id=i.resource().id,n.resource_name=i.resource().name),i.service()&&(n.service_id=i.service().id,n.service_name=i.service().name),n.id>0?s.Appointments.update(n,function(t){e(!0)},function(){e(!1)}):s.Appointments.create(n,function(t){i.id=t.id,e(!0)},function(){e(!1)})}else t()},i.cancel=function(){}},Day:function(e,n,i,o,r,a){var s=this;this.name=t.observable(e),this.opened=t.observable(1==n),this.start=t.observable(i||null).duration(),this.breakStart=t.observable(r||null).duration(),this.breakEnd=t.observable(a||null).duration(),this.end=t.observable(o||null).duration(),this.changed=t.observable(!1);var l=function(){s.changed(!0)};this.opened.subscribe(l),this.start.subscribe(l),this.breakStart.subscribe(l),this.breakEnd.subscribe(l),this.end.subscribe(l)},Resource:function(e,n,i,r){var a=this;this.id=t.observable("undefined"==typeof e?null:e),this.name=t.simpleObservable(n||"").extend({validatorRequired:{message:o.get("resource/name/error"),realtime:!0}}),this.description=t.simpleObservable(i||""),this.servicesIds=t.simpleObservableArray(r||[]).minLength(1,o.get("error-resource-services-required")),a.changed=t.computed(function(){return this.name.changed()||this.description.changed()||this.servicesIds.changed()},a),this.isValid=function(){return this.name.isValid()},this.commit=function(e,t){if(e=e||function(){},t=t||function(){},this.isValid()){this.name.commit(),this.description.commit(),this.servicesIds.remove(-1),this.servicesIds.commit();var n={id:this.id(),name:this.name(),description:this.description(),services:this.servicesIds()};n.id>0?s.Resources.update(n,function(t){e(!0)},function(t){e(!1)}):s.Resources.create(n,function(t){a.id=t.id,e(!0)},function(t){e(!1)})}else t()},this.cancel=function(){this.name.reset(),this.description.reset(),this.servicesIds.reset()},this.destroy=function(e){e=e||function(){},s.Resources.destroy(a.id(),function(t){e()})}},Service:function(e,i,r,a,l,c){var u=this;u.id=t.observable("undefined"==typeof e?null:e),u.name=t.simpleObservable(i||"").extend({validatorRequired:{message:o.get("service/name/error"),realtime:!0}}),u.description=t.simpleObservable(r||""),u.duration=t.simpleObservable(n.date.formatDuration(l||900)).extend({validatorTime:{message:o.get("resource/duration/error/format"),rangeMessage:o.get("resource/duration/error/range"),realtime:!0,from:300,to:86400}}),u.cost=t.numericObservable(c||0),u.resourcesIds=t.simpleObservableArray(a||[]),u.changed=t.computed(function(){return this.name.changed()||this.description.changed()||this.cost.changed()||this.resourcesIds.changed();
},u),u.isValid=function(){return u.name.isValid()&&u.duration.isValid()},u.commit=function(e,t){if(e=e||function(){},t=t||function(){},u.isValid()){u.name.commit(),u.description.commit(),u.resourcesIds.remove(-1),u.resourcesIds.commit(),u.duration.commit();var i={id:u.id(),name:u.name(),description:u.description(),resources:u.resourcesIds(),duration:n.date.durationToSeconds(u.duration()),cost:u.cost()};i.id>0?s.Services.update(i,function(t){e(!0)},function(t){e(!1)}):s.Services.create(i,function(t){u.id=t.id,e(!0)},function(t){e(!1)})}else t()},u.cancel=function(){u.name.reset(),u.description.reset(),u.resourcesIds.reset()},u.destroy=function(e){e=e||function(){},s.Services.destroy(u.id,function(t){e()})}},Holiday:function(e,i,r,a,l,c,u){var d=this;this.id=t.observable("undefined"==typeof e?null:e),this.name=t.protectedObservable(i||"").extend({validatorRequired:{message:o.get("error-holiday-name-required"),realtime:!0}});var p=new Date;p.setHours(9,0,0,0),this.start=t.timeObservable(r||new Date(p.getTime())),this.start.temp.subscribe(function(e){(n.date.equalDate(e,d.end.temp())&&e>=d.end.temp()||e>=d.end.temp())&&d.end(new Date(e.getTime()+1*n.date.hour))}),this.end=t.timeObservable(a||new Date(p.getTime()+36e6)),this.end.temp.subscribe(function(e){(n.date.equalDate(e,d.start.temp())&&e<=d.start.temp()||e<=d.start.temp())&&d.start(new Date(e.getTime()-1*n.date.hour))}),this.saving=t.observable(!1),this.resourcesIds=t.protectedObservableArray(l||[]).extend({validatorCustom:{message:o.get("error-service-resources-required"),realtime:!0,validator:function(e){return e.length>0}}}),this.allDay=t.protectedObservable("undefined"==typeof u||1==u),this.allDay.temp.subscribe(function(e){e&&(this.start().setHours(0,0,0,0),this.end().setHours(23,59,59,999))},this),this.isValid=function(){var e=!0;return e&=d.name.isValid(),e&=d.end.isValid(),e&=d.resourcesIds.isValid()},this.commit=function(e,t){if(e=e||function(){},t=t||function(){},this.isValid()){this.name.commit(),this.resourcesIds.remove(-1),this.resourcesIds.commit(),this.allDay.commit(),this.start.commit(),this.end.commit();var i={id:this.id(),name:this.name(),start:n.date.encode(this.start.temp()),end:n.date.encode(this.end.temp()),resources:this.resourcesIds(),all_day:1==this.allDay()?1:0};i.id>0?s.Holidays.update(i,function(t){e(!0)},function(){e(!1)}):s.Holidays.create(i,function(t){d.id=t.id,e(!0)},function(){e(!1)})}else t()},this.cancel=function(){this.name.reset(),this.resourcesIds.reset()},this.destroy=function(e){e=e||{},s.Holidays.destroy(this.id,function(t){e()})}},Client:function(i,o,r,a,s){var l=this;this.id=i,this.name=t.protectedObservable(o).extend({validatorRequired:{message:"Please enter a first name",realtime:!0}}),this.email=t.protectedObservable(r),this.phone=t.protectedObservable(a),this.fb_username=s,this.activityLoading=t.observable(!1),this.activityPage=t.observable(1),this.noMoreActivity=t.observable(null),this.activity=t.observableArray(),this.loadActivities=function(t){l.noMoreActivity()||l.activityLoading()||(l.activityLoading(!0),l.Contacts.getFeed(l.id,l.activityPage(),25,function(t){e.each(t,function(e,t){t.serviceResource="",t.service_id&&(t.serviceResource+=" for "+t.service_name),t.resource_id&&(t.serviceResource+=" by "+t.resource_name),t.start=n.date.decode(t.start),t.end=n.date.decode(t.end),console.log(t.created),t.created=n.date.decode(t.created),0==t.via?t.viaLanguage="story/appointment/created/reservio":1==t.via?t.viaLanguage="story/appointment/created/button":2==t.via?t.viaLanguage="story/appointment/created/widget":3==t.via?t.viaLanguage="story/appointment/created/facebook":4==t.via&&(t.viaLanguage="story/appointment/created/booking"),t.client_fb_username=l.fb_username,l.activity.push(t)}),t.length<25&&(l.activity().length>0?l.noMoreActivity("No more activity."):l.noMoreActivity("No activity.")),l.activityPage(l.activityPage()+1),l.activityLoading(!1),e(".paper.fixed .right-col .scroll-area").slimScroll("redraw")}))},l.isValid=function(){return l.name.isValid()&&(null!=l.bookings()[0].contact().id||l.email.isValid()&&l.phone.isValid())},l.commit=function(e){if(e=e||function(){},l.isValid()){l.name.commit(),l.email.commit(),l.phone.commit();var t={id:l.id,name:l.name(),email:l.email(),phone:l.phone()};t.id>0?l.Clients.edit(t,function(t){e()}):l.Clients.create(t,function(t){l.id=t.id,e()})}},l.cancel=function(){l.name.reset(),l.email.reset(),l.phone.reset()},l.destroy=function(e){e=e||function(){},l.Clients.del(l.id,function(t){e()})}}},Events:{getAll:function(e,t,n,o){return i.get("/ajax/events/",{start:e,end:t},n,o)},del:function(e,t,n){return i.post("/ajax/delete-event/",e,t,n)},create:function(e,t){return i.post("/ajax/create-event/",e,t,errorFunc)},edit:function(e,t){return i.post("/ajax/edit-event/",e,t,errorFunc)},isBooked:function(e,t){return i.post("/ajax/is-booked/",e,t,errorFunc)},getRequests:function(e,t,n){return i.post("/ajax/get-requests/",{last:e},t,n)},changeRange:function(e,t,n,o,r,a){return i.post("/ajax/range-event/",{id:e,start:t,end:n,resource_id:o,resource_name:r},a)},getStatus:function(e){for(var t={unknown:0,approved:0,declined:0},n=0;n<e.clients.length;n++){var i=e.clients[n];0==i.state&&(t.unknown+=1),1==i.state&&(t.approved+=1),2==i.state&&(t.declined+=1)}return t},approveRequest:function(e,t,n,o,r){return i.post("/appointments/confirm/",{id:e,resource_id:t,resource_name:n,message:o},r)},cancelRequest:function(e,t,n){return i.post("/appointments/reject/",{id:e,reason:t},n)}},Appointments:{getAll:function(e,t,n,o){return i.get("/appointments/",{start:e,end:t},function(e){n(e.data.appointments)},o)},create:function(e,t){return i.post("/appointments/create/",e,t)},update:function(e,t,n){return i.post("/appointments/update/",e,t,n)},destroy:function(e,t,n){return i.post("/appointments/destroy/",e,function(e){a.acl.bookings.count(e.data.bookings),t(e)},n)},getNew:function(e,t,n){return i.get("/appointments/requests/",{last:e},function(e){t(e.data.requests,e.data.bookings)},n)}},Contacts:{get:function(t,n,o){return i.get("/contacts/",t,function(t){t.data.clients=e.map(t.data.clients,function(e){return new s.Objects.Contact(e)}),n(t.data,t.state)},o)},create:function(e,t,n){return i.post("/contacts/create/",{contact:e},t,n)},update:function(e,t,n){return i.post("/contacts/update/",{contact:e},t,n)},destroy:function(e,t,n){return i.post("/contacts/destroy/",{id:e},t,n)},getFeed:function(e,t,n,o,r){return i.get("/contacts/feed/",{id:e,page:t,limit:n},function(e){o(e.data.feed)},r)}},Resources:{get:function(t,n,o){return i.get("/resources/",t,function(t){n(e.map(t.data.resources,function(e){return new s.Objects.Resource(e.id,e.name,e.description,e.services)}),t.state)},o)},create:function(e,t,n){return i.post("/resources/create/",{resource:e},t,n)},update:function(e,t,n){return i.post("/resources/update/",{resource:e},t,n)},destroy:function(e,t,n){return i.post("/resources/destroy/",{id:e},t,n)}},Services:{get:function(t,n,o){return i.get("/services/",t,function(t){n(e.map(t.data.services,function(e){return new s.Objects.Service(e.id,e.name,e.description,e.resources,e.duration,e.cost)}),t.state)},o)},create:function(e,t,n){return i.post("/services/create/",{service:e},t,n)},update:function(e,t,n){return i.post("/services/update/",{service:e},t,n)},destroy:function(e,t,n){return i.post("/services/destroy/",{id:e},t,n)}},Holidays:{get:function(t,n,o){return i.get("/holidays/",t,function(t){n(e.map(t.data.holidays,function(e){return new s.Objects.Holiday(e.id,e.name,new Date(e.start),new Date(e.end),e.resources,e.type,e.all_day)}),t.state)},o)},create:function(e,t,n){return i.post("/holidays/create/",{holiday:e},t,n)},update:function(e,t,n){return i.post("/holidays/update/",{holiday:e},t,n)},destroy:function(e,t,n){return i.post("/holidays/destroy/",{id:e},t,n)}},Account:{get:function(e,t,n){return i.get("/account/",{request:e},t,n)},update:function(e,t,n){return i.post("/account/update/",e,t,n)},getFeed:function(e,t,n,o){return i.get("/account/feed/",{page:e,limit:t},function(e){n(e.data.feed)},o)}}}.init()}),r("reservio/modules/informationBar",["jquery","ko","postbox"],function(e,t,n){return function(i){function o(e,t){this.type=t||"info",this.text=e}function r(t,n,i){s.messages.removeAll(),s.messages.push(new o(t,n)),e(l).hide().fadeIn(),i&&(clearTimeout(c),c=setTimeout(function(){a()},i))}function a(){clearTimeout(c),c=null,e(l).fadeOut(function(){s.messages.removeAll()})}i=i||{};var s=this,l=e("#notification-canvas"),c=null;this.messages=t.observableArray(),n.subscribe("showInformation",function(e){r(e.text||"",e.type||"success",e.timeout||2500)},this),n.subscribe("hideInformation",function(e){a()},this),e(document).click(function(e){a()})}}),r("reservio/modules/notificationsChecker",["jquery","ko","reservio/utils","reservio/models","postbox","reservio/app"],function(e,t,n,i,o,r){return function(n){var a=this,s={checkInterval:60},l={},c=0,u=null,d=t.observableArray().publishOn("notifications",!0);d.subscribe(function(t){var n=e("head title"),i=n.text();if(0==t.length||"("==i[0]){var o=i.indexOf(")",1);o>=0&&(i=i.substr(o+2))}if(t.length>0&&(i="("+t.length+") "+i),n.text(i),t.length>0){var r=e("#menu-calendar-notifications");r.fadeIn().text(t.length),r.parent().attr("title","You have {count} new reservation to approve.".format({count:t.length}))}else{var r=e("#menu-calendar-notifications");r.hide(),r.parent().removeAttr("title")}}),a.checkNewRequests=function(){i.Appointments.getNew(c,function(t,n){var i=[];r.acl.bookings.count(+n),e.each(t,function(e,t){for(var n=0;n<t.clients.length;n++){var o=t.clients[n];o.start=t.start,o.end=t.end,o.title=t.title,o.resource_name=t.resource_name,o.service_name=t.service_name,o.bookingsLimitReached=t.bookingsLimitReached,o.id>c&&(c=parseInt(o.id)),i.push(o)}}),d.push.apply(d,i)}),u=setTimeout(function(){a.checkNewRequests()},1e3*l.checkInterval)},o.listen("approveAppointment",function(e){e.after=e.after||function(){},i.Events.approveRequest(e.id,e.resourceId||null,e.resourceName||"",e.message||"",function(t){d.remove(function(t){return t.id==e.id}),e.after()})}),o.listen("rejectAppointment",function(e){e.after=e.after||function(){},d.remove(function(t){return t.id==e.id}),i.Events.cancelRequest(e.id,e.reason,function(t){d.remove(function(t){return t.id==e.id}),e.after()})}),l=e.extend(s,n),a.checkNewRequests()}}),r("reservio/modules/popover-new",["jquery","ko","postbox","libs/popover"],function(e,t,n){var i={},o={},r=function(e,n){var o=i[e];o||(n.afterShow=n.afterShow||function(){},n.afterHide=n.afterHide||function(){},n.$element.data("popover",null).popover({trigger:"manual",content:"<div data-bind=\"template: {'name': '"+n.template+"', afterRender: $root.afterRender}\"></div>",animation:!1,container:n.appendTo,cls:n.cls}),n.$element.popover("show"),n.$content=n.$element.popover("tip"),t.applyBindings(n.viewModel,n.$content[0]),n.$element.popover("placement",n.placement),n.afterShow(n.$content),i[e]=n)},a=function(e,t){t=void 0!==t&&t;var n=i[e];n&&(n.$content.remove(),n.afterHide(n.$content,t),delete i[e])},s=function(e){},l=function(e,t){i[e].$element.popover("showAlert",t.template,t.bindings,t.afterShow)},c=function(e){i[e].$element.popover("hideAlert")},u=function(e){o[e]=!1},d=function(e){o[e]=!0},p=function(e){return void 0!==o[e]&&o[e]},f=function(e){var t,n;for(t in i)n=i[t],e(t,i[t])},h=function(t){var n=e(t.target);0==n.closest(".modal").length&&f(function(e,t){p(e)||0!==t.$content.has(n).length||a(e,!0)})},g=function(e){27==e.keyCode&&f(function(e,t){p(e)||a(e,!0)})},m=function(){e(document).bind("click",h),e(document).bind("keyup",g)};return m(),n.listen("popover.show",r),n.listen("popover.hide",a),n.listen("popover.recalculateHeight",s),n.listen("popover.showAlert",l),n.listen("popover.hideAlert",c),n.listen("popover.enable",u),n.listen("popover.disable",d),function(){}}),r("reservio/modules/modal",["jquery","ko","postbox","libs/modal"],function(e,t,n){var i=e("body"),o={},r=function(t,n){if(n=n||{},e("#layouts").find("input, textarea").blur(),o[t])o[t].$element.show(),o[t].options.afterShow&&o[t].options.afterShow();else{n.onShow=n.afterShow||function(){},n.onHide=function(){o[t].$element.remove(),delete o[t],n.afterHide&&n.afterHide()};var r=e("<div></div>");i.append(r),r.modal(n).modal("show"),o[t]={$element:r,options:n}}},a=function(e){o[e]&&(o[e].$element.modal("hide").remove(),delete o[e])},s=function(t){e.each(o,function(e,t){a(e)})},l=function(e){};return n.listen("modal.show",r),n.listen("modal.hide",a),n.listen("modal.hideAndKeep",l),n.listen("modal.hideAll",s),function(){}}),r("reservio/modules/roster",["jquery","ko","reservio/utils","reservio/lang","reservio/data","reservio/ajax","postbox"],function(e,t,n,i,o,r,a){var s=function(e){this.resourceId=e,this.roster=t.observableArray([]),this.date=t.observable(new Date),this._r=n,this.lang=i,this.data=o,this.loading=t.observable(!1),this.date.subscribe(this.loadRoster.bind(this)),this.saveSlots=this.saveSlots.bind(this),this.editHours=this.editHours.bind(this),this.addHours=this.addHours.bind(this),this.removeHours=this.removeHours.bind(this)},l=function(e,t,n){var i=this;t=t||function(){},this.openingHours=e||new o.entities.OpeningHours,this.saveClicked=function(e,n){n.stopPropagation(),i.openingHours.end.isValid(!0)&&t(i.openingHours)},this.cancelClicked=function(e,t){t.stopPropagation(),a.notify("popover.hide","openingHours")},this.isAdding=void 0===n},c=function(){var t="bottom",n=e(this.$element.parents(".modal, body")[0]);this.$tip.show();var i=this.$tip.height();return this.$element.offset().top-n.offset().top+this.$element.outerHeight()+i>n.height()&&(t="top"),{side:t,offset:70}},u=function(t){var n=new s(t);e("body").modal({template:"modal-roster-tpl",cls:"roster-form",viewModel:n}).modal("show"),n.loadRoster()};return s.prototype=t.utils.extend(s.prototype,{loadRoster:function(){var t=this,i=this.date().getWeekStart(_reservio.weekStart),o=new Date(i.getTime()+5184e5);t.loading(!0),r.get("/account/availability/",{start:n.date.encodeDate(i),end:n.date.encodeDate(o),resourceId:this.resourceId},function(i){t.roster(e.map(i.data.availability[t.resourceId],function(e,t){return{date:n.date.decodeDate(t),slots:e}}).sort(function(e,t){return e.date>t.date})),t.loading(!1),e("body").modal("recomputePosition")})},saveSlots:function(t,o,s,l){var c=this;r.post("/account/set-availability/",{date:n.date.encodeDate(t),resourceId:this.resourceId,slots:o,checkForEvents:l},function(n){void 0!==n.data.error?(e("body > .modal").hide(),e("#second-modals").modal({template:"modal-rosterEventsWarning-tpl",viewModel:{saveClicked:function(n,i){i.stopPropagation(),c.saveSlots(t,o,s,!1),e("#second-modals").modal("hide"),e("body > .modal").show()},cancelClicked:function(t,n){n.stopPropagation(),e("#second-modals").modal("hide"),e("body > .modal").show()}}}).modal("show")):(a.publish("showInformation",{text:i.get("alert-changesSaved")}),a.notify("popover.hide","openingHours"),c.loadRoster(),s())})},addHours:function(t,n){var i=this;n.stopPropagation(),a.notify("popover.hide","openingHours"),a.notify("popover.show","openingHours",{$element:e(n.target),template:"popover-opening-hours-noDays-tpl",placement:c,appendTo:".modal-window",cls:"opening-hours opening-hours-noDays",viewModel:new l(new o.entities.OpeningHours,function(e){var n=t.slots.slice(0);n.push({start:e.start(),end:e.end()}),i.saveSlots(t.date,n,function(){},!0)})})},removeHours:function(e,t){var n=this;return function(i,o){o.stopPropagation(),a.notify("popover.hide","openingHours");var r=e.slots.slice();r.splice(t,1),n.saveSlots(e.date,r.length?r:"closed",function(){e.slots.splice(t,1)},!0)}},editHours:function(t,n){var i=this;return function(r,s){a.notify("popover.hide","openingHours"),s.stopPropagation();var u=new o.entities.OpeningHours({start:t.slots[n].start,end:t.slots[n].end});a.notify("popover.show","openingHours",{$element:e(s.target),template:"popover-opening-hours-noDays-tpl",placement:c,appendTo:".modal-window",cls:"opening-hours opening-hours-noDays",viewModel:new l(u,function(e){t.slots[n]={start:e.start(),end:e.end()},i.saveSlots(t.date,t.slots,function(){t.slots[n]={start:e.start(),end:e.end()}},!0)},(!1))})}},close:function(){e("body").modal("hide")}}),{show:u,close:close}}),r("reservio/pages/businessCoupons",["jquery","ko","reservio/utils","postbox","reservio/lang","reservio/data"],function(e,t,n,i,o,r){return function(e,n){i.notify("pageTitle","Coupons");var a={};return a.tpl=t.observable("business-coupons-tpl"),a.leftColTpl=t.observable("business-menu-tpl"),a.coupons=r.coupons,a.editCouponClicked=function(e){window.location.hash="#/business/coupons/form/"+e.id()},a.getServicesById=function(e){return r.services().length>0?t.utils.arrayMap(e,function(e){return t.utils.arrayFirst(r.services(),function(t){return t.data.id()==e.service_id})}):[]},a.formatServices=function(e){return e.length==r.services().length?o.get("basic-allServices"):0==e.length?o.get("basic-noServices"):t.utils.arrayMap(a.getServicesById(e),function(e){return e?" "+e.data.name():null})},e.destroy=function(){},e.afterRender=function(t){i.notify("viewLoaded"),r.coupons.load(function(){e.loading(!1)}),e.loading(!1)},e.scroll=function(e){},a}}),r("reservio/pages/businessCouponsForm",["jquery","ko","reservio/utils","postbox","reservio/lang","reservio/data","reservio/ajax"],function(e,t,n,i,o,r,a){return function(n,s){i.notify("pageTitle","Coupons");var l={};l.tpl=t.observable("business-coupons-form-tpl"),l.leftColTpl=t.observable("business-menu-tpl"),l.title=t.observable(""),l.original=t.observable(null),l.editing=t.observable(null);var c=function(e){e.title.required(o.get("error-resource-name-required"),!0),e.visits.addValidator("visits",function(t){return 1!=e.type||t>0},"Wrong value",!0),e.credit.addValidator("credit",function(t){return 2!=e.type||t>0},"Wrong value",!0),e.cost.addValidator("cost",function(e){return""==e||+e>0},"Wrong value",!0)};return l.services=e.map(r.services(),function(e){return{service_id:+e.data.id(),service_name:e.data.name()}}),l.saveCoupon=function(e){if(this.title.isValid()&&this.services_coupons.isValid()){var t=!this.id();a[t?"post":"put"]("/api/internal/coupons/",this.getData(),function(){window.location.hash="#/business/coupons",i.publish("showInformation",{text:o.get("alert-couponSaved")})})}},l.deleteCoupon=function(e){var n=this;i.notify("modal.show","deleteCoupon",{template:"modal-delete-tpl",viewModel:{title:o.get("modal-couponDelete-title"),text:o.get("modal-couponDelete-text"),item:{saving:t.observable(!1)},deleteClicked:function(e,t){a["delete"]("/api/internal/coupons/"+n.id()+"/",function(){i.notify("modal.hide","deleteCoupon"),window.location.hash="#/business/coupons"})},cancelClicked:function(){i.notify("modal.hide","deleteCoupon")}}})},l.cancel=function(){window.location.hash="#/business/coupons"},l.typeTpl=function(){return l.editing()?"business-coupons-form-"+l.editing().type()+"-tpl":""},n.destroy=function(){},n.afterRender=function(t){i.notify("viewLoaded"),n.loading(!1),e("#frm-coupon-name").focus()},n.scroll=function(e){},n.hashParamsChanged=function(t){if("add"==t.id){var n=new r.entities.Coupon({services_coupons:e.map(r.services(),function(e){return+e.data.id()}),type:1});c(n),l.editing(n),l.original(n),l.title(o.get("page-business-coupons-add-title")),s.acl.activateTrialFeature("createCoupon","standard",function(e){e||(window.location.hash="#/business/coupons")})}else r.coupons.find(+t.id,function(e){c(e),l.editing(e),l.original(e),l.title(o.get("page-business-coupons-edit-title"))})},l}}),r("reservio/pages/businessDashboard",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/lang","reservio/ajax","moment","reservio/data"],function(e,t,n,i,o,r,a,s,l){return function(c,u){i.notify("pageTitle",r.get("page-business-dashboard-title"));var d={};d.tpl=t.observable("business-dashboard-tpl"),d.leftColTpl=t.observable("business-menu-tpl"),d.data=l,d.statistics=t.loadable(function(e){var t=this;return o.Account.get(["statistics"],function(n){t(n.data.account.statistics),e()})},{appointments:{upcoming:0,last:0}}),d.bookingTpl=function(e){return e.bookingsLimitReached?"block-story-overLimit-tpl":"block-story-tpl"},d.activityLoading=t.observable(!1),d.activityPage=t.observable(1),d.noMoreActivity=t.observable(null),d.activity=t.observableArray(),d.loadActivities=function(){return d.noMoreActivity()||d.activityLoading()?null:(d.activityLoading(!0),o.Account.getFeed(d.activityPage(),25,function(t){e.each(t,function(e,t){t.historyLimitReached||t.bookingsLimitReached||(t.start=n.date.decode(t.start),t.end=n.date.decode(t.end),t.created=n.date.decode(t.created)),0==t.via?t.viaLanguage="activity-via-reservio":1==t.via?t.viaLanguage="activity-via-button":2==t.via?t.viaLanguage="activity-via-minipage":3==t.via?t.viaLanguage="activity-via-facebook":4==t.via&&(t.viaLanguage="activity-via-booking"),d.activity.push(t)}),t.length<25&&(d.activity().length>0?d.noMoreActivity(r.get("activity-noMoreActivity")):d.noMoreActivity(r.get("activity-noActivity"))),d.activityPage(d.activityPage()+1),d.activityLoading(!1)}))},d.upcomingLimitReached=t.computed(function(){return null!=t.utils.arrayFirst(d.activity(),function(e){return 1==e.upcomingLimitReached})}),d.historyLimitReached=t.computed(function(){return null!=t.utils.arrayFirst(d.activity(),function(e){return 1==e.historyLimitReached})}),d.displayedActivities=t.computed(function(){return t.utils.arrayFilter(d.activity(),function(e){return!e.upcomingLimitReached&&!e.historyLimitReached})});var p=function(e,t,n){e=s(e).startOf("day"),t=s(t).startOf("day");var i=s.duration(t.diff(e)),o=[];if(i.asDays()>10)for(e=e.startOfWeek().add("weeks",1),e=e.startOfWeek();e<=t;)o.push(e.clone().toDate()),e.add("weeks",1);else for(e=e.startOf("day"),e=e.startOf("day");e<=t;)o.push(e.clone().toDate()),e.add("days",1);return o};d.bookingsChart=null,d.bookingsChartOptions={legend:{position:"none"},chartArea:{left:0,width:"100%",top:20,height:120},animation:{duration:500,easing:"out"},bar:{groupWidth:"85%"},hAxis:{gridlines:{count:7,color:"transparent"},baselineColor:"transparent",textStyle:{color:"#777",fontSize:"11"},format:"EEE, d.M."},vAxis:{gridlines:{color:"transparent"},baseline:0,baselineColor:"#E2E2E2",format:"0",textStyle:{color:"#777",fontSize:"11"},minValue:0,maxValue:10},series:{0:{color:"#1263bb"}}},d.bookingsChartData=new google.visualization.DataTable,d.bookingsChartData.addColumn("date","Date"),d.bookingsChartData.addColumn("number",r.get("statistics-typeBookings")),d.bookingsChartData.addColumn({calc:"stringify",sourceColumn:1,type:"string",role:"annotation"}),d.showStatistics=function(){"free"==l.account().plan.code?(Intercom("trackEvent","Viewed Statistics"),u.acl.showUpgradeModal(r.get("modal-upgrade-statistics-title"),r.get("modal-upgrade-statistics-text"),"statistics.png","statistics")()):u.acl.activateTrialFeature("statistics","starter",function(e){e&&(window.location.hash="#/business/statistics")})},d.chromeExtensionInstall=function(){chrome.webstore.install("",function(){document.getElementById("dashboard-extension").style.display="none",u.log("installChromeExtension"),Intercom("trackEvent","Chrome Extension Installed"),n.cookie.set("chromeExtensionInstall")})},d.hideChromeExtensionInstall=function(){u.log("hideChromeExtension"),Intercom("trackEvent","Chrome Extension Uninstalled"),n.cookie.set("chromeExtensionInstall"),document.getElementById("dashboard-extension").style.display="none"};var f=s().startOf("day"),h=s().add("days",13).startOf("day"),g=function(t){if(t)d.bookingsChartData.removeRows(0,d.bookingsChartData.getNumberOfRows()),e.each(t,function(e,t){d.bookingsChartData.addRow([n.date.decodeDate(t.label),t.value.total,""+t.value.total])});else for(var i=s.duration(h.clone().diff(f)),o=0;o<=i.days();o++)d.bookingsChartData.addRow([f.clone().add("days",o).toDate(),0,"0"]);d.bookingsChartOptions.hAxis.ticks=p(f,h,7),d.bookingsChart.draw(d.bookingsChartData,d.bookingsChartOptions)};return c.destroy=function(){},c.afterRender=function(t){(document.getElementById("extension-is-installed")||n.cookie.get("chromeExtensionInstall"))&&e("#dashboard-extension").hide(),o.Account.get(["informations"],function(e){l.account().sms_balance(e.data.account.informations.sms_balance)}),e.when(d.loadActivities()).then(function(){i.notify("viewLoaded"),c.loading(!1),d.bookingsChart=new google.visualization.ColumnChart(e("#dashboard-statistics")[0]),e("#dashboard-statistics").click(function(){d.showStatistics()}),g(),a.get("/statistics/",{from:n.date.encodeDate(f.clone().toDate()),to:n.date.encodeDate(h.toDate()),group_by:"days"},function(e){g(e.data.bookings.by_days)})}).fail(function(){})},c.scroll=function(e){"bottom"==e&&d.loadActivities()},d}});var s=s||{};s.obj2string=function(e,t){var n,i=[];if("object"!=typeof e)return"";for(n in e)if(e.hasOwnProperty(n)){var o=t?t+"["+n+"]":n,r=e[n];i.push("object"==typeof r?s.obj2string(r,o):encodeURIComponent(o)+"="+encodeURIComponent(r))}return i.join("&")},s.extendObj=function(e,t){var n;if("object"!=typeof e||"object"!=typeof t)return!1;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},s.contains=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},s.removeItem=function(e,t){for(var n in e)if(e[n]==t){e.splice(n,1);break}},s.addEvent=function(e,t,n){"string"==typeof e&&(e=document.getElementById(e)),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},s.removeEvent=function(e,t,n){"string"==typeof e&&(e=document.getElementById(e)),e.attachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},s.newXHR=function(){if(void 0!==typeof XMLHttpRequest)return new window.XMLHttpRequest;if(window.ActiveXObject)try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){return!1}},s.parseJSON=function(e){if(!e||"string"!=typeof e)return!1;if(e=s.trim(e),window.JSON&&window.JSON.parse)try{return window.JSON.parse(e)}catch(t){return!1}return!(!e||!/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,"@").replace(/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))&&new Function("return "+e)()},s.getOffsetSum=function(e){for(var t=0,n=0;e;)t+=parseInt(e.offsetTop,10),n+=parseInt(e.offsetLeft,10),e=e.offsetParent;return{top:t,left:n}},s.getOffsetRect=function(e){e=e.getBoundingClientRect();var t=document.body,n=document.documentElement,i=e.left+(window.pageXOffset||n.scrollLeft||t.scrollLeft)-(n.clientLeft||t.clientLeft||0);return{top:Math.round(e.top+(window.pageYOffset||n.scrollTop||t.scrollTop)-(n.clientTop||t.clientTop||0)),left:Math.round(i)}},s.getOffset=function(e){return e.getBoundingClientRect?s.getOffsetRect(e):s.getOffsetSum(e)},s.getBox=function(e){var t,n;return n=s.getOffset(e),t=n.left,n=n.top,{left:t,right:t+e.offsetWidth,top:n,bottom:n+e.offsetHeight}},s.addStyles=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])},s.copyLayout=function(e,t){var n=s.getBox(e);s.addStyles(t,{position:"absolute",left:n.left+"px",top:n.top+"px",width:e.offsetWidth+"px",height:e.offsetHeight+"px"})},s.toElement=function(){var e=document.createElement("div");return function(t){return e.innerHTML=t,t=e.firstChild,e.removeChild(t),t}}(),s.getUID=function(){var e=0;return function(){return e++}}(),s.trim=function(e){return e.toString().replace(/^\s+/,"").replace(/\s+$/,"")},s.getFilename=function(e){return e.replace(/.*(\/|\\)/,"")},s.getExt=function(e){return-1!==e.indexOf(".")?e.replace(/.*[.]/,""):""},s.hasClass=function(e,t){return RegExp("(^| )"+t+"( |$)").test(e.className)},s.addClass=function(e,t){return!(!t||""===t)&&void(s.hasClass(e,t)||(e.className+=" "+t))},s.removeClass=function(e,t){e.className=e.className.replace(RegExp("(^| )"+t+"( |$)")," ").replace(/^\s+|\s+$/g,"")},s.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)},s.verifyElem=function(e){return"undefined"!=typeof jQuery&&e instanceof jQuery?e=e[0]:"string"==typeof e&&(/^#.*/.test(e)&&(e=e.slice(1)),e=document.getElementById(e)),!(!e||1!==e.nodeType)&&("A"==e.nodeName.toUpperCase()&&s.addEvent(e,"click",function(e){e&&e.preventDefault?e.preventDefault():window.event&&(window.event.returnValue=!1)}),e)},s.SimpleUpload=function(e){if(this._settings={button:"",url:"",progressUrl:!1,multiple:!1,maxUploads:3,queue:!0,checkProgressInterval:50,keyParamName:"APC_UPLOAD_PROGRESS",allowedExtensions:[],accept:"",maxSize:!1,name:"",data:{},autoSubmit:!0,multipart:!1,method:"POST",responseType:"",debug:!1,hoverClass:"",focusClass:"",disabledClass:"",onChange:function(e,t){},onSubmit:function(e,t){},onProgress:function(e){},onUpdateFileSize:function(e){},onComplete:function(e,t){},onExtError:function(e,t){},onSizeError:function(e,t){},onError:function(e,t,n){},startXHR:function(e,t){},endXHR:function(e){},startNonXHR:function(e){},endNonXHR:function(e){}},s.extendObj(this._settings,e),this._button=s.verifyElem(this._settings.button),!1===this._button)throw Error("Invalid button. Make sure the element you're passing exists.");!1===this._settings.multiple&&(this._settings.maxUploads=1),this._mouseOverButton=!1,this._file=this._size=this._ext=this._filename=this._input=null,this._queue=[],this._fileSizeBox=this._progressContainer=this._progressBar=null,this._activeUploads=0,this._doProgressUpdates=this._disabled=!1,this._activeProgressKeys=[],this._uploadProgressKey=null,this._maxUpdateFails=10,this._isXhrUploadSupported()?(this._XhrIsSupported=!0,this.log("XHR upload supported")):(this._XhrIsSupported=!1,this.log("XHR upload not supported, using iFrame method"),this._settings.progressUrl&&this._getUploadProgressKey()),this._createInput(),this.enable(),this.rerouteClicks(this._button)},s.SimpleUpload.prototype={log:function(e){this._settings.debug&&window.console&&console.log("[uploader] "+e)},setData:function(e){this._settings.data="object"==typeof e?e:{}},setProgressBar:function(e){this._progressBar=s.verifyElem(e)},setFileSizeBox:function(e){this._fileSizeBox=s.verifyElem(e)},setProgressContainer:function(e){this._progressContainer=s.verifyElem(e)},getQueueSize:function(){return this._queue.length},removeCurrent:function(){0<this._queue.length&&this._queue.splice(0,1),this._cycleQueue()},disable:function(){var e=this._button.nodeName.toUpperCase();s.addClass(this._button,this._settings.disabledClass),this._disabled=!0,"INPUT"!=e&&"BUTTON"!=e||this._button.setAttribute("disabled","disabled"),this._input&&this._input.parentNode&&(this._input.parentNode.style.visibility="hidden")},enable:function(){s.removeClass(this._button,this._settings.disabledClass),this._button.removeAttribute("disabled"),this._disabled=!1},_isXhrUploadSupported:function(){var e=document.createElement("input");return e.type="file","multiple"in e&&"undefined"!=typeof File&&"undefined"!=typeof(new XMLHttpRequest).upload},_createInput:function(){var e=this,t=document.createElement("div");if(this._input=document.createElement("input"),this._input.setAttribute("type","file"),this._input.setAttribute("name",this._settings.name),this._XhrIsSupported&&(this._input.setAttribute("multiple",!0),""!==this._settings.accept&&this._input.setAttribute("accept",this._settings.accept)),s.addStyles(t,{display:"block",cursor:"pointer",position:"absolute",overflow:"hidden",margin:0,padding:0,opacity:0,direction:"ltr",zIndex:2147483583}),s.addStyles(this._input,{position:"absolute",right:0,margin:0,padding:0,fontSize:"480px",fontFamily:"sans-serif",cursor:"pointer"}),"0"!==t.style.opacity){if("undefined"==typeof t.filters)throw Error("Opacity not supported by the browser");t.style.filter="alpha(opacity=0)"}s.addEvent(this._input,"change",function(){var t,n;if(e._input&&""!==e._input.value){if(e._XhrIsSupported){if(t=s.getFilename(e._input.files[0].name),n=s.getExt(t),!1===e._settings.onChange.call(e,t,n))return;for(t=e._input.files.length,e._settings.multiple||(t=1),n=0;n<t;n++)e._queue.push(e._input.files[n])}else{if(t=s.getFilename(e._input.value),n=s.getExt(t),!1===e._settings.onChange.call(e,t,n))return;
e._queue.push(e._input)}e._clearInput(),e._settings.autoSubmit&&e.submit()}}),s.addEvent(this._input,"mouseover",function(){!0===e._mouseOverButton&&s.addClass(e._button,e._settings.hoverClass)}),s.addEvent(this._input,"mouseout",function(){!0===e._mouseOverButton&&(s.removeClass(e._button,e._settings.hoverClass),s.removeClass(e._button,e._settings.focusClass),e._input.parentNode&&(e._input.parentNode.style.visibility="hidden"))}),s.addEvent(this._input,"focus",function(){!0===e._mouseOverButton&&s.addClass(e._button,e._settings.focusClass)}),s.addEvent(this._input,"blur",function(){!0===e._mouseOverButton&&s.removeClass(e._button,e._settings.focusClass)}),document.body.appendChild(t),t.appendChild(this._input)},_clearInput:function(){this._input&&(s.removeClass(this._button,this._settings.hoverClass),s.removeClass(this._button,this._settings.focusClass),s.remove(this._input.parentNode),this._input=null,this._createInput())},rerouteClicks:function(e){var t=this;e=s.verifyElem(e),s.addEvent(e,"mouseover",function(){t._disabled||(t._input||t._createInput(),t._mouseOverButton=e==t._button,s.copyLayout(e,t._input.parentNode),t._input.parentNode.style.visibility="visible")})},_createIframe:function(){var e=s.getUID(),t=s.toElement('<iframe src="javascript:false;" name="'+e+'" />');return document.body.appendChild(t),t.style.display="none",t.setAttribute("id",e),t},_createForm:function(e){var t=s.toElement('<form method="post" enctype="multipart/form-data"></form>');return document.body.appendChild(t),t.style.display="none",t.setAttribute("action",this._settings.url),t.setAttribute("target",e.name),t},_createHiddenInput:function(e,t){var n=document.createElement("input");return n.setAttribute("type","hidden"),n.setAttribute("name",e),n.setAttribute("value",t),n},_finish:function(e,t,n,i,o){this.log("server response: "+e),this._activeUploads--,"json"==this._settings.responseType.toLowerCase()&&(e=s.parseJSON(e)),!1===e?(this.log("bad server response"),this._settings.onError.call(this,t,"parseerror",e)):this._settings.onComplete.call(this,t,e),i&&(i.innerHTML=""),o&&s.remove(o),this._disabled&&this.enable(),this._cycleQueue()},_cycleQueue:function(){this._progressContainer=this._progressBar=this._fileSizeBox=this._ext=this._filename=this._file=this._size=null,0<this._queue.length&&this._settings.autoSubmit&&this.submit()},_uploadXhr:function(e){var t=this,n=this._settings,i=this._filename,o=Math.round(this._size/1024),r=this._fileSizeBox,a=this._progressBar,l=this._progressContainer;e=s.newXHR();var c={};!1===n.startXHR.call(this,i,o)?(this._disabled&&this.enable(),this._activeUploads--):(r&&(r.innerHTML=o+"K"),c[n.name]=i,s.extendObj(c,n.data),c=n.url+"?"+s.obj2string(c),n.onProgress.call(this,0),a&&(a.style.width="0%"),s.addEvent(e.upload,"progress",function(e){e.lengthComputable&&(e=Math.round(100*(e.loaded/e.total)),n.onProgress.call(t,e),a&&(a.style.width=e+"%"))}),s.addEvent(e.upload,"error",function(){t.log("transfer error during upload"),n.endXHR.call(t,i,o),n.onError.call(t,i,"transfer error","none")}),e.onreadystatechange=function(){4===this.readyState&&(200===this.status?(n.endXHR.call(t,i,o),t._finish(this.responseText,i,a,r,l)):(t.log("Progress key error. Status: "+this.status+" Response: "+this.responseText),n.onError.call(t,i,"server error",this.responseText)))},e.open(n.method.toUpperCase(),c,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("X-File-Name",encodeURIComponent(i)),"json"==n.responseType.toLowerCase()&&e.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),!0===n.multipart?(c=new FormData,c.append(n.name,this._file),this.log("commencing upload using multipart form"),e.send(c)):(e.setRequestHeader("Content-Type","application/octet-stream"),this.log("commencing upload using binary stream"),e.send(this._file)),this.removeCurrent())},_handleIframeResponse:function(e,t,n,i,o){var r;e.parentNode&&(r=e.contentWindow?e.contentWindow.document:e.contentDocument&&e.contentDocument.document?e.contentDocument.document:e.contentDocument,r.body&&!1===r.body.innerHTML||(r=r.body.innerHTML,s.remove(e),this._finish(r,t,n,i,o)))},_uploadIframe:function(){var e,t=this,n=this._settings,i=n.checkProgressInterval,o=this._uploadProgressKey,r=this._progressBar,a=this._progressContainer,l=this._fileSizeBox,c=this._filename,u=this._createIframe(),d=this._createForm(u);if(this._doProgressUpdates&&(e=this._createHiddenInput(n.keyParamName,o),d.appendChild(e)),!1===n.startNonXHR.call(this,c))this._disabled&&this.enable(),this._activeUploads--;else{e=n.data;for(var p in e)if(e.hasOwnProperty(p)){var f=this._createHiddenInput(p,e[p]);d.appendChild(f)}d.appendChild(this._file),n.onProgress.call(this,0),r&&(r.style.width="0%"),s.addEvent(u,"load",function(){s.contains(t._activeProgressKeys,o)&&s.removeItem(t._activeProgressKeys,o),s.removeEvent(u,"load",arguments.callee),n.endNonXHR.call(t,c),t._handleIframeResponse(u,c,r,l,a),o=null}),t.log("commencing upload using iframe"),d.submit(),s.remove(d),d=null,t._doProgressUpdates&&(this._activeProgressKeys.push(o),window.setTimeout(function(){t.log("requesting first progress update"),t._getUploadProgress(o,r,l,1)},i),this._alterProgressKey()),this.removeCurrent()}},_getUploadProgress:function(e,t,n,i){if(e){var o=this,r=this._settings,a=s.newXHR(),l=(new Date).getTime(),l=r.progressUrl+"?progresskey="+encodeURIComponent(e)+"&_="+l;a.onreadystatechange=function(){var a,l=r.checkProgressInterval;if(4===this.readyState)if(200===this.status){if((a=s.parseJSON(this.responseText))&&!0===a.success){if(i++,r.onUpdateFileSize.call(o,a.size),r.onProgress.call(o,a.pct),t&&(t.style.width=a.pct+"%"),n&&a.size&&(n.innerHTML=a.size+"K"),100>a.pct&&s.contains(o._activeProgressKeys,e)){if(0===a.pct&&0===a.size&&i>=o._maxUpdateFails)return void o.log("reached limit of failed progress requests");window.setTimeout(function(){o._getUploadProgress(e,t,n,i),i=e=null},l)}l=null}}else e=null,o._doProgressUpdates=!1,o._uploadProgressKey=null,s.removeItem(o._activeProgressKeys,e),o.log("Progress error. Status: "+this.status+" Response: "+this.responseText);a=null},a.open("GET",l,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),a.setRequestHeader("Cache-Control","no-cache"),a.send(),a=null}},_alterProgressKey:function(){this._uploadProgressKey+=s.getUID(),57<this._uploadProgressKey.length&&(this._uploadProgressKey=s.getUID()+this._uploadProgressKey.substring(0,15))},_getUploadProgressKey:function(){var e=this,t=s.newXHR(),n=(new Date).getTime(),n=e._settings.progressUrl+"?getkey="+n;e._uploadProgressKey=null,t.onreadystatechange=function(){var t;4===this.readyState&&(200===this.status?(t=s.parseJSON(this.responseText))&&t.key&&(e._uploadProgressKey=t.key,e.log("upload progress key received. Key: "+t.key)):e.log("error retrieving progress key. Status: "+this.status+" Server response: "+this.responseText))},t.open("GET",n,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01"),t.setRequestHeader("Cache-Control","no-cache"),t.send(),t=null},_checkExtension:function(e){var t=this._settings.allowedExtensions,n=t.length;for(e=e.toLowerCase();n--;)if(t[n].toLowerCase()==e)return!0;return!1},_checkFile:function(){var e=this._filename,t=this._ext,n=this._size;return this._file&&""!==e?0<this._settings.allowedExtensions.length&&!this._checkExtension(t)?(this.removeCurrent(),this.log("file extension not permitted"),this._settings.onExtError.call(this,e,t),!1):null!==n&&!1!==this._settings.maxSize&&n/1024>this._settings.maxSize?(this.removeCurrent(),this.log(e+" exceeds "+this._settings.maxSize+"K limit"),this._settings.onSizeError.call(this,e,n),!1):(this.log("pre-upload file check successful"),!0):(this.log("no file to upload"),!1)},submit:function(){this._disabled||this._activeUploads>=this._settings.maxUploads||1>this._queue.length||(this._file=this._queue[0],this._XhrIsSupported?(this._filename=s.getFilename(this._queue[0].name),this._size=this._queue[0].size):this._filename=s.getFilename(this._queue[0].value),this._ext=s.getExt(this._filename),this._checkFile()&&!1!==this._settings.onSubmit.call(this,this._filename,this._ext)&&(this._activeUploads++,(!1===this._settings.multiple||!1===this._settings.queue&&this._activeUploads>=this._settings.maxUploads)&&this.disable(),this._XhrIsSupported?this._uploadXhr():(!1!==this._settings.progressUrl&&null!==this._uploadProgressKey?this._doProgressUpdates=!0:(this._doProgressUpdates=!1,this.log("no upload progress - progressUrl not defined or progress key not available")),this._uploadIframe())))}},r("libs/fileUpload",["jquery"],function(){}),function(e){function t(e,t,n){return e+t<n&&(e=n-t),e>0&&(e=0),e}e.jWindowCrop=function(n,i){function o(){if(0==h.originalWidth&&(h.originalWidth=h.$image.width(),h.originalHeight=h.$image.height()),h.originalWidth>0){var e=h.options.targetWidth/h.originalWidth,t=h.options.targetHeight/h.originalHeight;e>=t?h.minPercent=h.originalWidth<h.options.targetWidth?h.options.targetWidth/h.originalWidth:e:h.minPercent=h.originalHeight<h.options.targetHeight?h.options.targetHeight/h.originalHeight:t,h.focalPoint={x:Math.round(h.originalWidth/2),y:Math.round(h.originalHeight/2)},h.setZoom(h.minPercent),h.$image.fadeIn("fast")}}function r(){var e=(parseInt(h.$image.css("left"))*-1+h.options.targetWidth/2)/h.workingPercent,t=(parseInt(h.$image.css("top"))*-1+h.options.targetHeight/2)/h.workingPercent;h.focalPoint={x:Math.round(e),y:Math.round(t)}}function a(){var e=t(Math.round(h.focalPoint.x*h.workingPercent-h.options.targetWidth/2)*-1,h.$image.width(),h.options.targetWidth),n=t(Math.round(h.focalPoint.y*h.workingPercent-h.options.targetHeight/2)*-1,h.$image.height(),h.options.targetHeight);h.$image.css({left:e.toString()+"px",top:n.toString()+"px"}),r()}function s(){h.result={cropX:Math.floor(parseInt(h.$image.css("left"))/h.workingPercent*-1),cropY:Math.floor(parseInt(h.$image.css("top"))/h.workingPercent*-1),cropW:Math.round(h.options.targetWidth/h.workingPercent),cropH:Math.round(h.options.targetHeight/h.workingPercent),mustStretch:h.minPercent>1},h.options.onChange.call(h.image,h.result)}function l(){o()}function c(e){e.preventDefault(),h.isDragging=!0,h.dragMouseCoords={x:e.pageX,y:e.pageY},h.dragImageCoords={x:parseInt(h.$image.css("left")),y:parseInt(h.$image.css("top"))}}function u(){h.isDragging=!1}function d(e){if(h.isDragging){var n=e.pageX-h.dragMouseCoords.x,i=e.pageY-h.dragMouseCoords.y,o=t(h.dragImageCoords.x+n,h.$image.width(),h.options.targetWidth),a=t(h.dragImageCoords.y+i,h.$image.height(),h.options.targetHeight);h.$image.css({left:o.toString()+"px",top:a.toString()+"px"}),r(),s()}}function p(){h.options.smartControls&&h.$frame.find(".jwc_controls").fadeIn("fast")}function f(){h.options.smartControls&&h.$frame.find(".jwc_controls").fadeOut("fast")}var h=this;h.$image=e(n),h.image=n,h.$image.data("jWindowCrop",h),h.namespace="jWindowCrop",h.originalWidth=0,h.isDragging=!1,h.init=function(){h.$image.css({display:"none"}),h.options=e.extend({},e.jWindowCrop.defaultOptions,i),h.options.zoomSteps<2&&(h.options.zoomSteps=2),h.$image.addClass("jwc_image").wrap('<div class="jwc_frame" />'),h.$frame=h.$image.parent(),h.$frame.css({overflow:"hidden"}),h.$frame.append('<div class="jwc_loader">'+h.options.loadingText+"</div>"),h.$frame.append('<div class="jwc_controls" style="display:'+(h.options.showControlsOnStart?"block":"none")+';"><span>'+h.options.clickToDragText+'</span><a href="#" class="jwc_zoom_in"></a><a href="#" class="jwc_zoom_out"></a></div>'),h.$frame.css({position:"relative",width:h.options.targetWidth,height:h.options.targetHeight}),h.$image.css({position:"absolute",top:"0px",left:"0px"}),o(),h.$frame.find(".jwc_zoom_in").on("click."+h.namespace,h.zoomIn),h.$frame.find(".jwc_zoom_out").on("click."+h.namespace,h.zoomOut),h.$frame.on("mouseenter."+h.namespace,p),h.$frame.on("mouseleave."+h.namespace,f),h.$image.on("load."+h.namespace,l),h.$image.on("mousedown."+h.namespace,c),e(document).on("mousemove."+h.namespace,d),e(document).on("mouseup."+h.namespace,u)},h.destroy=function(){h.$image.removeData("jWindowCrop"),e(document).unbind(),h.$image.unbind(),h.$frame.unbind(),h.$frame.find(".jwc_zoom_out").unbind(),h.$frame.find(".jwc_zoom_in").unbind(),e(".jwc_loader").remove(),e(".jwc_controls").remove(),h.$image.removeAttr("style"),h.$image.unwrap()},h.setZoom=function(e){h.minPercent>=1?e=h.minPercent:e>1?e=1:e<h.minPercent&&(e=h.minPercent),h.$image.width(Math.ceil(h.originalWidth*e)),h.workingPercent=e,a(),s()},h.zoomIn=function(){var e=(1-h.minPercent)/(h.options.zoomSteps-1);return h.setZoom(h.workingPercent+e),!1},h.zoomOut=function(){var e=(1-h.minPercent)/(h.options.zoomSteps-1);return h.setZoom(h.workingPercent-e),!1},h.init()},e.jWindowCrop.defaultOptions={targetWidth:320,targetHeight:180,zoomSteps:10,loadingText:"Loading...",clickToDragText:"Click to drag",smartControls:!0,showControlsOnStart:!0,onChange:function(){}},e.fn.jWindowCrop=function(t){return this.each(function(){new e.jWindowCrop(this,t)})},e.fn.getjWindowCrop=function(){return this.data("jWindowCrop")}}(jQuery),r("libs/cropImage",["jquery"],function(){}),r("reservio/pages/businessDetails",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/lang","reservio/data","reservio/ajax","reservio/analytics","libs/fileUpload","libs/cropImage","libs/popover","jquery-ui"],function(e,t,n,i,o,r,a,l,c){return function(n,u){i.notify("pageTitle",r.get("page-business-details-title"));var d={};d.tpl=t.observable("business-details-tpl"),d.leftColTpl=t.observable("business-menu-tpl");var p=[{code:"AF",text:"Afghanistan"},{code:"AL",text:"Albania"},{code:"DZ",text:"Algeria"},{code:"AS",text:"American Samoa"},{code:"AD",text:"Andorra"},{code:"AO",text:"Angola"},{code:"AI",text:"Anguilla"},{code:"AQ",text:"Antarctica"},{code:"AG",text:"Antigua and Barbuda"},{code:"AR",text:"Argentina"},{code:"AM",text:"Armenia"},{code:"AW",text:"Aruba"},{code:"AU",text:"Australia"},{code:"AT",text:"Austria"},{code:"AZ",text:"Azerbaijan"},{code:"BS",text:"Bahamas"},{code:"BH",text:"Bahrain"},{code:"BD",text:"Bangladesh"},{code:"BB",text:"Barbados"},{code:"BY",text:"Belarus"},{code:"BE",text:"Belgium"},{code:"BZ",text:"Belize"},{code:"BJ",text:"Benin"},{code:"BM",text:"Bermuda"},{code:"BT",text:"Bhutan"},{code:"BO",text:"Bolivia"},{code:"BA",text:"Bosnia and Herzegovina"},{code:"BW",text:"Botswana"},{code:"BV",text:"Bouvet Island"},{code:"BR",text:"Brazil"},{code:"IO",text:"British Indian Ocean Territory"},{code:"BN",text:"Brunei Darussalam"},{code:"BG",text:"Bulgaria"},{code:"BF",text:"Burkina Faso"},{code:"BI",text:"Burundi"},{code:"KH",text:"Cambodia"},{code:"CM",text:"Cameroon"},{code:"CA",text:"Canada"},{code:"CV",text:"Cape Verde"},{code:"KY",text:"Cayman Islands"},{code:"CF",text:"Central African Republic"},{code:"TD",text:"Chad"},{code:"CL",text:"Chile"},{code:"CN",text:"China"},{code:"CX",text:"Christmas Island"},{code:"CC",text:"Cocos (Keeling) Islands"},{code:"CO",text:"Colombia"},{code:"KM",text:"Comoros"},{code:"CG",text:"Congo"},{code:"CD",text:"Congo, the Democratic Republic of the"},{code:"CK",text:"Cook Islands"},{code:"CR",text:"Costa Rica"},{code:"CI",text:"Cote D'Ivoire"},{code:"HR",text:"Croatia"},{code:"CU",text:"Cuba"},{code:"CY",text:"Cyprus"},{code:"CZ",text:"Czech Republic"},{code:"DK",text:"Denmark"},{code:"DJ",text:"Djibouti"},{code:"DM",text:"Dominica"},{code:"DO",text:"Dominican Republic"},{code:"EC",text:"Ecuador"},{code:"EG",text:"Egypt"},{code:"SV",text:"El Salvador"},{code:"GQ",text:"Equatorial Guinea"},{code:"ER",text:"Eritrea"},{code:"EE",text:"Estonia"},{code:"ET",text:"Ethiopia"},{code:"FK",text:"Falkland Islands (Malvinas)"},{code:"FO",text:"Faroe Islands"},{code:"FJ",text:"Fiji"},{code:"FI",text:"Finland"},{code:"FR",text:"France"},{code:"GF",text:"French Guiana"},{code:"PF",text:"French Polynesia"},{code:"TF",text:"French Southern Territories"},{code:"GA",text:"Gabon"},{code:"GM",text:"Gambia"},{code:"GE",text:"Georgia"},{code:"DE",text:"Germany"},{code:"GH",text:"Ghana"},{code:"GI",text:"Gibraltar"},{code:"GR",text:"Greece"},{code:"GL",text:"Greenland"},{code:"GD",text:"Grenada"},{code:"GP",text:"Guadeloupe"},{code:"GU",text:"Guam"},{code:"GT",text:"Guatemala"},{code:"GN",text:"Guinea"},{code:"GW",text:"Guinea-Bissau"},{code:"GY",text:"Guyana"},{code:"HT",text:"Haiti"},{code:"HM",text:"Heard Island and Mcdonald Islands"},{code:"VA",text:"Holy See (Vatican City State)"},{code:"HN",text:"Honduras"},{code:"HK",text:"Hong Kong"},{code:"HU",text:"Hungary"},{code:"IS",text:"Iceland"},{code:"IN",text:"India"},{code:"ID",text:"Indonesia"},{code:"IR",text:"Iran, Islamic Republic of"},{code:"IQ",text:"Iraq"},{code:"IE",text:"Ireland"},{code:"IL",text:"Israel"},{code:"IT",text:"Italy"},{code:"JM",text:"Jamaica"},{code:"JP",text:"Japan"},{code:"JO",text:"Jordan"},{code:"KZ",text:"Kazakhstan"},{code:"KE",text:"Kenya"},{code:"KI",text:"Kiribati"},{code:"KP",text:"Korea, Democratic People's Republic of"},{code:"KR",text:"Korea, Republic of"},{code:"KW",text:"Kuwait"},{code:"KG",text:"Kyrgyzstan"},{code:"LA",text:"Lao People's Democratic Republic"},{code:"LV",text:"Latvia"},{code:"LB",text:"Lebanon"},{code:"LS",text:"Lesotho"},{code:"LR",text:"Liberia"},{code:"LY",text:"Libyan Arab Jamahiriya"},{code:"LI",text:"Liechtenstein"},{code:"LT",text:"Lithuania"},{code:"LU",text:"Luxembourg"},{code:"MO",text:"Macao"},{code:"MK",text:"Macedonia, the Former Yugoslav Republic of"},{code:"MG",text:"Madagascar"},{code:"MW",text:"Malawi"},{code:"MY",text:"Malaysia"},{code:"MV",text:"Maldives"},{code:"ML",text:"Mali"},{code:"MT",text:"Malta"},{code:"MH",text:"Marshall Islands"},{code:"MQ",text:"Martinique"},{code:"MR",text:"Mauritania"},{code:"MU",text:"Mauritius"},{code:"YT",text:"Mayotte"},{code:"MX",text:"Mexico"},{code:"FM",text:"Micronesia, Federated States of"},{code:"MD",text:"Moldova, Republic of"},{code:"MC",text:"Monaco"},{code:"MN",text:"Mongolia"},{code:"MS",text:"Montserrat"},{code:"MA",text:"Morocco"},{code:"MZ",text:"Mozambique"},{code:"MM",text:"Myanmar"},{code:"NA",text:"Namibia"},{code:"NR",text:"Nauru"},{code:"NP",text:"Nepal"},{code:"NL",text:"Netherlands"},{code:"AN",text:"Netherlands Antilles"},{code:"NC",text:"New Caledonia"},{code:"NZ",text:"New Zealand"},{code:"NI",text:"Nicaragua"},{code:"NE",text:"Niger"},{code:"NG",text:"Nigeria"},{code:"NU",text:"Niue"},{code:"NF",text:"Norfolk Island"},{code:"MP",text:"Northern Mariana Islands"},{code:"NO",text:"Norway"},{code:"OM",text:"Oman"},{code:"PK",text:"Pakistan"},{code:"PW",text:"Palau"},{code:"PS",text:"Palestinian Territory, Occupied"},{code:"PA",text:"Panama"},{code:"PG",text:"Papua New Guinea"},{code:"PY",text:"Paraguay"},{code:"PE",text:"Peru"},{code:"PH",text:"Philippines"},{code:"PN",text:"Pitcairn"},{code:"PL",text:"Poland"},{code:"PT",text:"Portugal"},{code:"PR",text:"Puerto Rico"},{code:"QA",text:"Qatar"},{code:"RE",text:"Reunion"},{code:"RO",text:"Romania"},{code:"RU",text:"Rossiyskaya Federatsiya"},{code:"RW",text:"Rwanda"},{code:"SH",text:"Saint Helena"},{code:"KN",text:"Saint Kitts and Nevis"},{code:"LC",text:"Saint Lucia"},{code:"PM",text:"Saint Pierre and Miquelon"},{code:"VC",text:"Saint Vincent and the Grenadines"},{code:"WS",text:"Samoa"},{code:"SM",text:"San Marino"},{code:"ST",text:"Sao Tome and Principe"},{code:"SA",text:"Saudi Arabia"},{code:"SN",text:"Senegal"},{code:"CS",text:"Serbia and Montenegro"},{code:"SC",text:"Seychelles"},{code:"SL",text:"Sierra Leone"},{code:"SG",text:"Singapore"},{code:"SK",text:"Slovakia"},{code:"SI",text:"Slovenia"},{code:"SB",text:"Solomon Islands"},{code:"SO",text:"Somalia"},{code:"ZA",text:"South Africa"},{code:"GS",text:"South Georgia and the South Sandwich Islands"},{code:"ES",text:"Spain"},{code:"LK",text:"Sri Lanka"},{code:"SD",text:"Sudan"},{code:"SR",text:"Suriname"},{code:"SJ",text:"Svalbard and Jan Mayen"},{code:"SZ",text:"Swaziland"},{code:"SE",text:"Sweden"},{code:"CH",text:"Switzerland"},{code:"SY",text:"Syrian Arab Republic"},{code:"TW",text:"Taiwan, Province of China"},{code:"TJ",text:"Tajikistan"},{code:"TZ",text:"Tanzania, United Republic of"},{code:"TH",text:"Thailand"},{code:"TL",text:"Timor-Leste"},{code:"TG",text:"Togo"},{code:"TK",text:"Tokelau"},{code:"TO",text:"Tonga"},{code:"TT",text:"Trinidad and Tobago"},{code:"TN",text:"Tunisia"},{code:"TR",text:"Turkey"},{code:"TM",text:"Turkmenistan"},{code:"TC",text:"Turks and Caicos Islands"},{code:"TV",text:"Tuvalu"},{code:"UG",text:"Uganda"},{code:"UA",text:"Ukraine"},{code:"AE",text:"United Arab Emirates"},{code:"GB",text:"United Kingdom"},{code:"US",text:"United States"},{code:"UM",text:"United States Minor Outlying Islands"},{code:"UY",text:"Uruguay"},{code:"UZ",text:"Uzbekistan"},{code:"VU",text:"Vanuatu"},{code:"VE",text:"Venezuela"},{code:"VN",text:"Viet Nam"},{code:"VG",text:"Virgin Islands, British"},{code:"VI",text:"Virgin Islands, U.S."},{code:"WF",text:"Wallis and Futuna"},{code:"EH",text:"Western Sahara"},{code:"YE",text:"Yemen"},{code:"ZM",text:"Zambia"},{code:"ZW",text:"Zimbabwe"}],f=[{code:"AL",text:"Alabama"},{code:"AK",text:"Alaska"},{code:"AZ",text:"Arizona"},{code:"AR",text:"Arkansas"},{code:"CA",text:"California"},{code:"CO",text:"Colorado"},{code:"CT",text:"Connecticut"},{code:"DE",text:"Delaware"},{code:"DC",text:"District Of Columbia"},{code:"FL",text:"Florida"},{code:"GA",text:"Georgia"},{code:"HI",text:"Hawaii"},{code:"ID",text:"Idaho"},{code:"IL",text:"Illinois"},{code:"IN",text:"Indiana"},{code:"IA",text:"Iowa"},{code:"KS",text:"Kansas"},{code:"KY",text:"Kentucky"},{code:"LA",text:"Louisiana"},{code:"ME",text:"Maine"},{code:"MD",text:"Maryland"},{code:"MA",text:"Massachusetts"},{code:"MI",text:"Michigan"},{code:"MN",text:"Minnesota"},{code:"MS",text:"Mississippi"},{code:"MO",text:"Missouri"},{code:"MT",text:"Montana"},{code:"NE",text:"Nebraska"},{code:"NV",text:"Nevada"},{code:"NH",text:"New Hampshire"},{code:"NJ",text:"New Jersey"},{code:"NM",text:"New Mexico"},{code:"NY",text:"New York"},{code:"NC",text:"North Carolina"},{code:"ND",text:"North Dakota"},{code:"OH",text:"Ohio"},{code:"OK",text:"Oklahoma"},{code:"OR",text:"Oregon"},{code:"PA",text:"Pennsylvania"},{code:"RI",text:"Rhode Island"},{code:"SC",text:"South Carolina"},{code:"SD",text:"South Dakota"},{code:"TN",text:"Tennessee"},{code:"TX",text:"Texas"},{code:"UT",text:"Utah"},{code:"VT",text:"Vermont"},{code:"VA",text:"Virginia"},{code:"WA",text:"Washington"},{code:"WV",text:"West Virginia"},{code:"WI",text:"Wisconsin"},{code:"WY",text:"Wyoming"}];d.editing=t.observable(null),d.editing.subscribe(function(e){e&&(d.informations.changed()&&d.changeEditing("informations"),d.openingHours.changed()&&d.changeEditing("openingHours"))});var h=function(){var t=e("#upload-profile-photo")[0];if(t){new s.SimpleUpload({button:t,url:"/account/photo/",name:"imgfile",hoverClass:"hover",allowedExtensions:["jpg","jpeg","png","gif"],accept:"image/*",multi:!1,responseType:"json",onComplete:function(t,n){d.profilePhotoTpl("business-details-cropPhoto-tpl");var i=e("#profile-photo img");i.one("load",function(){i.jWindowCrop({targetWidth:125,targetHeight:125,clickToDragText:""})}).attr("src",i.attr("src")+"?time="+(new Date).getTime())}})}};d.changeEditing=function(t){d.editing(t),e("#profile-photo img").error(function(){d.profilePhotoTpl("business-details-hasNotPhoto-tpl"),d.profilePhotoInfoTpl("business-details-hasNotPhotoInfo-tpl"),h(!0)}),h()},d.savePhoto=function(){var t=e("#profile-photo img").getjWindowCrop().result;l.post("/account/photo/",t,function(){d.profilePhotoTpl("business-details-hasPhoto-tpl"),h();var t=e("#profile-photo img");t.attr("src",t.attr("src")+"?time"+(new Date).getTime()),i.publish("showInformation",{text:r.get("alert-photoSaved")})})},d.cancelPhoto=function(){d.profilePhotoTpl("business-details-hasPhoto-tpl"),e("#profile-photo img").error(function(){d.profilePhotoTpl("business-details-hasNotPhoto-tpl"),h(!0)}),h()},d.changePhoto=function(){d.profilePhotoTpl("business-details-hasNotPhoto-tpl"),h()},d.profilePhotoTpl=t.observable("business-details-hasPhoto-tpl"),d.profilePhotoInfoTpl=t.observable("business-details-hasPhotoInfo-tpl"),d.informationsTemplate=t.computed(function(){return"informations"==this.editing()?"business-details-informations-edit-tpl":"business-details-informations-show-tpl"},d),d.openingHoursTemplate=t.computed(function(){return"openingHours"==this.editing()?"business-details-opening-hours-edit-tpl":"business-details-opening-hours-show-tpl"},d),d.informations=t.form(function(){var e=this;this.data={name:t.observable().required(r.get("error-businessName-required"),!0),description:t.observable(),slogan:t.observable(),phone:t.observable().phone(r.get("error-phone-format"),!0),street:t.observable().addValidator("street",function(e){var t=/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/;return!!t.test(e)||("string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,"")),""!=e&&null!=e)},r.get("error-street-required"),!0),city:t.observable().addValidator("city",function(t){var n=/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/;return!!n.test(e.data.street())||("string"==typeof t&&(t=t.replace(/^\s+|\s+$/g,"")),""!=t&&null!=t)},r.get("error-city-required"),!0),country:t.observable("CZ").setOptions(p,"code"),state:t.observable("").setOptions(f,"code"),website_url:t.observable("").url(r.get("error-url-format"),!0),website_name:t.observable(""),facebook_url:t.observable("").url(r.get("error-url-format"),!0),facebook_name:t.observable(""),google_analytics_id:t.observable("")}},{edit:function(){this.backup(),d.changeEditing("informations")},save:function(){var t=this;if(u.log("saveDetails"),this.isValid()){var n=this.toJS();o.Account.update({informations:n},function(){e.each(n,function(e,t){var n=a.account()[e];n(t),void 0!==n.commit&&n.commit()}),d.changeEditing(null),t.reset(),i.publish("showInformation",{text:r.get("alert-changesSaved")})})}else c.trackFormErrors(this)},onAddressSelect:function(t,n){var i=this,o=e("#frm-details-street")[0],r=new google.maps.places.PlacesService(o),a=function(t){var n={street:"",city:"",state:"",country:""};return e.each(t,function(){var t=this;e.each(t.types,function(e,i){switch(i){case"street_number":n.street=t.long_name;break;case"route":n.street=t.long_name+" "+n.street;break;case"postal_town":case"locality":n.city=t.long_name;break;case"country":n.country=t.short_name;break;case"administrative_area_level_1":n.state=t.short_name}})}),n};r.getDetails(n,function(t,n){"OK"==n&&e.each(a(t.address_components),function(e,t){i.data[e](t)})})},cancel:function(){this.restore(),d.changeEditing(null)}},"businessDetails-informationsForm");var g=function(){var t=r.getDays(),n=r.getDaysShort(),i=e.map(t,function(e,t){return{index:t,name:e,nameShort:n[t]}});if(1==_reservio.weekStart){var o=i.shift();i.push(o)}return i},m=function(e,n,o){var r=this;n=n||function(){},this.openingHours=e||new a.entities.OpeningHours,this.daysOptions=g(),this.isAdding=o||!1,this.isDaySelected=function(e){return this.openingHours.days.indexOf(e)>=0},this.dayClicked=function(e){this.isDaySelected(e)?this.openingHours.days.remove(e):(this.openingHours.days.push(e),this.openingHours.days.sort())},this.allDaysChecked=t.computed({read:function(){return 7==this.openingHours.days().length},write:function(e){this.openingHours.days.removeAll(),e&&this.openingHours.days([0,1,2,3,4,5,6])},owner:this}),this.saveClicked=function(){r.openingHours.days.isValid(!0)&&r.openingHours.end.isValid(!0)&&(n(r.openingHours),i.notify("popover.hide","openingHours"))},this.cancelClicked=function(){i.notify("popover.hide","openingHours")}},v=function(){var t="bottom",n=e(this.$element.parents(".container, body")[0]);this.$tip.show();var i=this.$tip.height();return this.$element.offset().top-n.offset().top+this.$element.outerHeight()+i>n.height()&&(t="top"),{side:t,offset:110}};return d.editRosterClicked=function(){window.location.hash="#/business/resources"},d.openingHours=t.form(function(){var n=this;u.log("saveOpeningHours"),this.data={openingHours:t.observableArray([])},this.sorted=t.computed(function(){var e=this.openingHours();if(this.openingHours().length>0&&1==_reservio.weekStart){for(var t=0,n=[],i=this.openingHours().slice();t<i.length&&0==i[t].days()[0];){var o=i.shift();n.push(o),t++}i.push.apply(i,n),e=i}return e},this.data),this.sortedView=t.computed(function(){var t,i,o,r=n.sorted(),a=[],s={};for(t=0,i=r.length;t<i;t++)o=r[t],o.days().join(",")in s||(s[o.days().join(",")]={days:o.days(),openingHours:[]},a.push(s[o.days().join(",")])),s[o.days().join(",")].openingHours.push(o);return e.each(a,function(e,t){t.openingHours.sort(function(e,t){return e.start()>t.start()})}),a})},{formatDays:function(t){var n=r.getDaysShort(),i=_reservio.weekStart,o=e.map(t,function(e){return n[e]});t=t.slice();var a=e.map(t,function(e,n){return(t[n]-i+7)%7}).sort();if(1==_reservio.weekStart&&0==t[0]){var s=o.shift();o.push(s)}return a.length>1&&a[a.length-1]-a[0]==a.length-1?7==o.length?r.get("openingHours-everyDay"):o[0]+" - "+o[o.length-1]:o.join(", ")},destroyOpeningHour:function(e){this.data.openingHours.remove(e)},editOpeningHour:function(t,n){n.stopPropagation(),i.notify("popover.show","openingHours",{$element:e(n.target),template:"popover-opening-hours-tpl",placement:v,appendTo:".container",cls:"opening-hours",viewModel:new m(new a.entities.OpeningHours({days:t.days().slice(),start:t.start(),end:t.end()}),function(e){t.days(e.days().slice()),t.start(e.start()),t.end(e.end())})})},addOpeningHours:function(t,n){var o=this;e(n.target).addClass("active"),n.stopPropagation(),i.notify("popover.show","openingHours",{$element:e(n.target),template:"popover-opening-hours-tpl",placement:v,appendTo:".container",cls:"opening-hours",afterHide:function(){e(n.target).removeClass("active")},viewModel:new m(new a.entities.OpeningHours,function(e){o.data.openingHours.push(e)},(!0))})},edit:function(){this.backup(),d.changeEditing("openingHours")},save:function(n){var s=this,l=this.toJS().openingHours;o.Account.update({openingHours:l.length?l:null},function(n){d.changeEditing(null);var o=e.map(n.data.openingHours,function(e){return new a.entities.OpeningHours(e)});s.data.openingHours(o),a.account().openingHours(t.toJS(o)),i.publish("showInformation",{text:r.get("alert-changesSaved")})})},cancel:function(){this.data.openingHours(e.map(this.dataBackup.openingHours,function(e){return new a.entities.OpeningHours(e)})),this.reset(),d.changeEditing(null)}}),n.afterRender=function(t){var o=a.account();d.openingHours.update({openingHours:e.map(o.openingHours(),function(e){return new a.entities.OpeningHours(e)})}),d.informations.update({name:o.name(),description:o.description(),slogan:o.slogan(),phone:o.phone(),street:o.street(),city:o.city(),country:o.country(),state:o.state(),website_url:o.website_url(),website_name:o.website_name(),facebook_url:o.facebook_url(),facebook_name:o.facebook_name(),google_analytics_id:o.google_analytics_id()}),i.notify("viewLoaded"),n.loading(!1),e("#profile-photo img").error(function(){d.profilePhotoTpl("business-details-hasNotPhoto-tpl"),d.profilePhotoInfoTpl("business-details-hasNotPhotoInfo-tpl"),h(!0)})},d}}),r("reservio/pages/businessHolidays",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/lang","reservio/data"],function(e,t,n,i,o,r,a){return function(n,s){i.notify("pageTitle",r.get("page-business-holidays-title"));var l={};return l.tpl=t.observable("business-holidays-tpl"),l.leftColTpl=t.observable("business-menu-tpl"),l.holidays=t.loadableArray(function(){var e=this;return o.Holidays.get({},function(t){e(t)})}),l.getResourcesById=function(e){return t.utils.arrayMap(e,function(e){return t.utils.arrayFirst(a.resources(),function(t){return t.data.id()==e})})},l.formatResources=function(e){return e.length==a.resources().length?r.get("basic-allResources"):0==e.length?r.get("basic-noResources"):t.utils.arrayMap(l.getResourcesById(e),function(e){return" "+e.data.name();
})},l.add=function(){window.location.hash="#/business/holidays/form/add"},l.edit=function(e){window.location.hash="#/business/holidays/form/"+e.id()},n.afterRender=function(t){e.when(l.holidays.load()).then(function(){i.notify("viewLoaded"),n.loading(!1)})},l}}),r("reservio/pages/businessHolidaysForm",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/lang","reservio/data","reservio/analytics","libs/datePicker","libs/modal"],function(e,t,n,i,o,r,a,s){return function(n,l){var c={};return c.tpl=t.observable("business-holidays-form-tpl"),c.leftColTpl=t.observable("business-menu-tpl"),c.title=t.observable(""),c.holiday=t.observable(),c.resources=t.loadableArray(function(){var e=this;return o.Resources.get({},function(t){e(t),e.loaded(!0)})}),c.save=function(t){var n=this,o=null==n.id(),a=e(t).find('input[type="submit"]');l.log(o?"holidayCreate":"holidayEdit"),a.button("loading"),n.name.isValid()||s.trackEventWithCounter("holidayForm","name-error"),n.end.isValid()||s.trackEventWithCounter("holidayForm","end-error"),n.resourcesIds.isValid()||s.trackEventWithCounter("holidayForm","resources-error"),n.commit(function(e){e?(s.trackEventWithCounter("holidayForm",o?"holidayCreated":"holidayEdited"),i.publish("showInformation",{text:r.get(o?"alert-holidaySaved":"alert-changesSaved")}),a.button("reset"),window.location.hash="#/business/holidays"):a.button("reset")},function(){a.button("reset")})},c.cancel=function(e,t){t.preventDefault(),null!==e.id()&&e.cancel(),window.location.hash="#/business/holidays"},c.destroy=function(t){l.log("holidayDelete");var n=e("body").modal({template:"modal-delete-tpl",viewModel:{title:r.get("modal-deleteHoliday-title"),text:r.get("modal-deleteHoliday-text"),item:t,deleteClicked:function(o,a){var l=e(a.target);l.button("loading"),s.trackEventWithCounter("holidayForm","holidayDeleted"),t.destroy(function(){i.publish("showInformation",{text:r.get("alert-holidayDeleted").format({name:t.name()})}),l.button("reset"),n.modal("hide"),window.location.hash="#/business/holidays"})},cancelClicked:function(){n.modal("hide")}}});e("body").modal("show")},n.afterRender=function(e){i.notify("viewLoaded")},n.hashParamsChanged=function(t){"add"==t.id?(c.title(r.get("page-business-holidays-add-title")),c.holiday(new o.Objects.Holiday(null,"",null,null,e.map(a.resources(),function(e){return e.data.id()}))),c.holiday().allDay.temp.subscribe(function(){c.holiday().end.hasError(!1)}),n.loading(!1),e("#frm-holiday-name").focus()):(i.notify("startLoading"),o.Holidays.get({id:t.id},function(t){t.length>0?(c.title(r.get("page-business-holidays-edit-title").format({name:t[0].name()})),c.holiday(t[0]),c.holiday().allDay.temp.subscribe(function(){c.holiday().end.hasError(!1)}),n.loading(!1),e("#frm-holiday-name").focus()):window.location.hash="#/business/holidays"}))},c}}),r("reservio/pages/businessOrders",["jquery","ko","reservio/utils","postbox","reservio/lang","reservio/ajax"],function(e,t,n,i,o,r){return function(n,a){i.notify("pageTitle",o.get("page-business-orders-title"));var s={};return s.tpl=t.observable("business-orders-tpl"),s.leftColTpl=t.observable("business-menu-tpl"),n.afterRender=function(t){i.notify("viewLoaded"),n.loading(!1),r.load("/upgrade/",{},e("#content > div"),function(){})},s}}),r("reservio/templates",["jquery","reservio/lang","reservio/utils"],function(e,t,n){return{eventEdit:function(n,i,o){var r='<form name="event_form">\t<div class="form-container">\t\t<div class="popover-inputs">';r+=o.clients.length>0?'<div class="person-card">\t<a href="#" title="Close" class="close"><i class="icon icon-close"></i></a>\t<img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-ash2/173637_659531225_245990467_n.jpg" class="profile-pic">\t<ul>\t\t<li class="client-name"></li>\t\t<li class="client-email"></li>\t\t<li class="client-phone"></li>\t</ul></div>\t\t\t<input name="name" type="text" placeholder="'+t.get("pages/index/index/popover/name/placeholder")+'" autocomplete="off" style="display:none" />':'\t\t\t<input name="name" type="text" placeholder="'+t.get("pages/index/index/popover/name/placeholder")+'" autocomplete="off" />',r+='\t\t\t<input name="email" type="text" placeholder="'+t.get("pages/index/index/popover/email/placeholder")+'" autocomplete="off" style="display:none" />\t\t\t<input name="phone" type="text" placeholder="'+t.get("pages/index/index/popover/phone/placeholder")+'" autocomplete="off" style="display:none" />\t\t\t<input name="date_start" type="text" placeholder="99/99/9999" class="span-date"> <label class="middle">'+t.get("pages/index/index/popover/at")+'</label> <input name="time_start" type="text" placeholder="99:99" class="span-time">\t\t\t<label class="middle">'+t.get("pages/index/index/popover/duration")+' </label> <input name="duration" class="span-time" type="text" placeholder="99:99" autocomplete="off" />';if(r+='<input name="service_id" type="hidden" /><input name="service_name" type="text" /><input name="resource_id" type="hidden" /><input name="resource_name" type="text" />',o.clients.length>0&&""!=o.clients[0].note){var a=o.clients[0].note;a.length>100&&(a=a.substr(0,100)+"..."),r+='         <p class="note information-bar" style="display: block;"><span class="note-text">'+a+'</span> <a class="edit-note" href="#">'+t.get("pages/index/index/popover/editNote")+"</a></p>",r+='          <textarea name="note" class="hidden">'+o.clients[0].note+"</textarea>"}else r+='         <p class="note" style="display: block;"><span class="note-text"></span> <a class="edit-note" href="#">'+t.get("pages/index/index/popover/addNote")+"</a></p>",r+='          <textarea name="note" class="hidden"></textarea>';return r+='\t\t\t<input name="id" type="hidden" />\t\t\t<input name="event_id" type="hidden" />\t\t\t<input name="client_id" type="hidden" />',r+='\t\t</div>\t\t<div class="form-actions">\t\t\t<input type="submit" value="'+t.get("basic/save")+'" class="btn btn-blue submit" data-loading-text="'+t.get("basic/saving")+'"> <a href="#" class="btn btn-grey popover-close">'+t.get("basic/cancel")+'</a> <a href="#" class="btn btn-red right delete">'+t.get("basic/delete")+"</a>\t\t</div>\t</div></form>",r=e(r.trim()),n.length<=1&&r.find('[name="service_id"]').hide(),i.length<=1&&r.find('[name="resource_id"]').hide(),r},eventUnconfirmed:function(i,o){var r='<form name="event_form">\t<div class="form-container">\t\t<div class="popover-inputs"><div class="person-card">\t<img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-ash2/173637_659531225_245990467_n.jpg" class="profile-pic">\t<ul>\t\t<li class="client-name"></li>\t\t<li class="client-email"></li>\t\t<li class="client-phone"></li>\t</ul></div>\t\t\t<input name="id" type="hidden" />\t\t\t<input name="event_id" type="hidden" />          <p class="h4">When:</p>          <p class="when"></p>          <p class="h4">What:</p>          <p class="what"></p>';if(null!=o.resource_id){r+='\t\t\t<div class="attach-resource">Assign resource?';var a,s,l=i.length;for(r+='<input name="resource_name" type="hidden"><select name="resource_id">\t<option value="0">'+t.get("pages/index/index/popover/resource")+"</option>",a=0;a<l;a++)s=i[a],r+='<option value="'+s.id+'">'+s.name()+"</option>";r+="</select>"}r+='\t\t\t</div>\t\t</div>\t\t<div class="form-actions">\t\t\t<input type="submit" value="'+t.get("pages/index/index/popover/approve")+'" class="btn btn-blue confirm" data-loading-text="'+t.get("basic/saving")+'"> <input type="submit" value="'+t.get("pages/index/index/popover/reject")+'" class="btn btn-red reject" data-loading-text="'+t.get("basic/saving")+'"> <a href="#" class="btn btn-grey right close-popover">'+t.get("basic/cancel")+"</a>\t\t</div>\t</div></form>",r=e(r.trim());var c=r.find(".when"),u=r.find(".what");return null!=o.service_name&&null!=o.resource_name?u.text(o.service_name+" "+t.get("notifications/by")+" "+o.resource_name):null!=o.service_name?u.text(o.service_name):null!=o.resource_name?u.text(t.get("notifications/by")+" "+o.resource_name):u.text(""),c.text(n.date.formatDate(o.start,"HH:mm")+" - "+n.date.formatDate(o.end,"HH:mm")),r},personCard:function(n,i,o,r){var a=e('<div class="person-card">\t<a href="#" title="'+t.get("basic/cancel")+'" class="close"><i class="icon icon-close"></i></a>\t<img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-ash2/173637_659531225_245990467_n.jpg" class="profile-pic">\t<ul>\t\t<li class="client-name"></li>\t\t<li class="client-email"></li>\t\t<li class="client-phone"></li>\t</ul></div>');return a.find(".client-name").text(n),a.find(".client-phone").text(o),a.find(".client-email").text(i),"undefined"==typeof r?a.find(".close").remove():a.find(".close").click(r),a},clientEdit:function(){var n='<form name="client_form">\t<div class="form-container">\t\t<div class="popover-inputs">\t\t\t<input name="name" type="text" placeholder="'+t.get("pages/index/index/popover/name/placeholder")+'" autocomplete="off" />\t\t\t<input name="email" type="text" placeholder="'+t.get("pages/index/index/popover/email/placeholder")+'" autocomplete="off" />\t\t\t<input name="phone" type="text" placeholder="'+t.get("pages/index/index/popover/phone/placeholder")+'" autocomplete="off" />\t\t</div>\t\t<div class="form-actions">\t\t\t<input type="submit" value="'+t.get("basic/save")+'" class="btn btn-blue submit"> <a href="#" class="btn btn-grey popover-close">'+t.get("basic/cancel")+"</a>\t\t</div>\t</div></form>";return n=e(n.trim())},sendEmailsForm:function(){var n='<form>   <div class="popover-inputs">'+t.get("pages/index/index/popover/sendEmailsForm/text")+'  </div>  <div class="form-actions">  \t<a href="#" class="btn btn-blue send" data-loading-text="'+t.get("basic/saving")+'">Reschedule appointment</a> <a href="#" class="btn btn-grey cancel">'+t.get("basic/cancel")+"</a>  </div><form>";return n=e(n.trim())},noteForm:function(){var n='   <div class="popover-inputs">  <h2>'+t.get("popover-appointment-note-title")+"</h2>      <p>"+t.get("popover-appointment-note-text")+'</p>      <textarea name="note" class="event-popover-note" placeholder="'+t.get("popover-appointment-note-placeholder")+'"></textarea>      <span class="character-counter" maxlength="1000"></span>  </div>  <div class="form-actions">  \t<a href="#" class="btn btn-blue save">'+t.get("popover-appointment-note-saveNote")+"</a>  </div>";return n=e(n.trim())}}}),r("reservio/pages/businessResources",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/templates","reservio/lang","reservio/data","libs/popover","libs/modal"],function(e,t,n,i,o,r,a,s){return function(n,o){i.notify("pageTitle",a.get("page-business-resources-title"));var r={};return r.tpl=t.observable("business-resources-tpl"),r.leftColTpl=t.observable("business-menu-tpl"),r.getServicesById=function(e){return s.services().length>0?t.utils.arrayMap(e,function(e){return t.utils.arrayFirst(s.services(),function(t){return t.data.id()==e})}):[]},r.formatServices=function(e){return e.length==s.services().length?a.get("basic-allServices"):0==e.length?a.get("basic-noServices"):t.utils.arrayMap(r.getServicesById(e),function(e){return" "+e.data.name()})},r.formattedOpeningHours=function(t){var n,i,o,r=t,a=[],s={};for(n=0,i=r.length;n<i;n++)o=r[n],o.days().join(",")in s||(s[o.days().join(",")]={days:o.days(),openingHours:[]},a.push(s[o.days().join(",")])),s[o.days().join(",")].openingHours.push(o);return e.each(a,function(e,t){t.openingHours.sort(function(e,t){return e.start()>t.start()})}),a},r.add=function(){window.location.hash="#/business/resources/form/add"},r.edit=function(e){window.location.hash="#/business/resources/form/"+e.data.id()},r}}),r("reservio/pages/businessResourcesForm",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/lang","reservio/data","reservio/modules/roster","reservio/analytics"],function(e,t,n,i,o,r,a,s,l){return function(o,c){var u={};u.tpl=t.observable("business-resources-form-tpl"),u.leftColTpl=t.observable("business-menu-tpl"),u.title=t.observable(""),u.original=t.observable(null),u.editing=t.observable(null);var d=function(e){e&&u.syncEnabled(!0)};i.listen("enableResourceSync",d);var p=function(e){return e.data.name.required(r.get("error-resource-name-required"),!0),e.data.services.minLength(1,r.get("error-resource-services-required"),!0),e.data.email.addValidator("email",function(t){var i=t.replace(/^\s+|\s+$/g,"");return!e.data.notificationsEnabled()&&!e.data.accesses.canLogin()||(e.data.notificationsEnabled()||e.data.accesses.canLogin())&&""!=i&&n.validators.email(i)},r.get("error-required"),!0),e};u.saveResource=function(e){if(this.isValid()){var t=this,n=this.isNew();c.log(n?"resourceCreate":"resourceEdit"),this.save(function(){window.location.hash="#/business/resources",l.trackEventWithCounter("resourceForm",n?"resourceCreated":"resourceEdited"),i.publish("showInformation",{text:r.get(n?"alert-resourceSaved":"alert-changesSaved")}),u.original().update(this.toJS())},function(e){e.data.userAlreadyHasAccessToCalendar&&(t.data.email.errorMessage(e.data.userAlreadyHasAccessToCalendar),t.data.email.hasError(!0))})}else l.trackFormErrors(this)},u.syncEnabled=t.computed({read:function(){return this()&&this().data.syncEnabled()&&this().data.icalUrl},write:function(e){""==this().data.icalUrl?e&&(l.trackEventWithCounter("resourceForm","syncClicked"),u.syncEnabled(!1),u.syncEnabled.notifySubscribers(),c.acl.showUpgradeModal(r.get("modal-upgrade-synchronization-title"),r.get("modal-upgrade-synchronization-text"),"synchronization.png","resourceSynchronization")()):this().changeSyncState(e)},owner:u.editing}),u.canLogin=t.computed(function(){return this()&&this().data.accesses.canLogin()},u.editing),u.toggleAccess=function(e,t){u.canLogin()||c.acl.activateTrialFeature("userAccess","pro",function(t){t||e.data.accesses.canLogin(!1)}),"pro"!=a.account().plan.code?(c.acl.showUpgradeModal(r.get("modal-upgrade-userAccess-title"),r.get("modal-upgrade-userAccess-text"),"userAccess.png","userAccess")(),e.data.accesses.canLogin(!1)):setTimeout(function(){e.data.accesses.canLogin(!u.canLogin())},0)},u.editRosterClicked=function(){l.trackEventWithCounter("resourceForm","editRosterClicked"),s.show(u.editing().data.id())},u.icalClicked=function(t,n){e(n.target).select()},u.cancel=function(){window.location.hash="#/business/resources"};var f=function(){var t=r.getDays(),n=r.getDaysShort(),i=e.map(t,function(e,t){return{index:t,name:e,nameShort:n[t]}});if(1==_reservio.weekStart){var o=i.shift();i.push(o)}return i},h=function(e,n,o){var r=this;n=n||function(){},this.openingHours=e||new a.entities.OpeningHours,this.daysOptions=f(),this.isAdding=o||!1,this.isDaySelected=function(e){return this.openingHours.days.indexOf(e)>=0},this.dayClicked=function(e){this.isDaySelected(e)?this.openingHours.days.remove(e):(this.openingHours.days.push(e),this.openingHours.days.sort())},this.allDaysChecked=t.computed({read:function(){return 7==this.openingHours.days().length},write:function(e){this.openingHours.days.removeAll(),e&&this.openingHours.days([0,1,2,3,4,5,6])},owner:this}),this.saveClicked=function(){r.openingHours.days.isValid(!0)&&r.openingHours.end.isValid(!0)&&(n(r.openingHours),i.notify("popover.hide","openingHours"))},this.cancelClicked=function(){i.notify("popover.hide","openingHours")}},g=function(){var t="bottom",n=e(this.$element.parents(".container, body")[0]);this.$tip.show();var i=this.$tip.height();return this.$element.offset().top-n.offset().top+this.$element.outerHeight()+i>n.height()&&(t="top"),{side:t,offset:110}};return u.sorted=t.computed(function(){if(u.editing()){if(u.editing().data.openingHours().length>0&&1==_reservio.weekStart){for(var e=0,n=[],i=u.editing().data.openingHours().slice();e<i.length&&0==t.utils.unwrapObservable(i[e].days)[0];){var o=i.shift();n.push(o),e++}return i.push.apply(i,n),i}return u.editing().data.openingHours()}},u),u.formatDays=function(t){var n=r.getDaysShort(),i=_reservio.weekStart,o=e.map(t,function(e){return n[e]});t=t.slice();var a=e.map(t,function(e,n){return(t[n]-i+7)%7}).sort();if(1==_reservio.weekStart&&0==t[0]){var s=o.shift();o.push(s)}return a.length>1&&a[a.length-1]-a[0]==a.length-1?7==o.length?r.get("openingHours-everyDay"):o[0]+" - "+o[o.length-1]:o.join(", ")},u.destroyOpeningHour=function(e){u.editing().data.openingHours.remove(e)},u.editOpeningHour=function(t,n){n.stopPropagation(),i.notify("popover.show","openingHours",{$element:e(n.target),template:"popover-opening-hours-tpl",placement:g,appendTo:".container",cls:"opening-hours",viewModel:new h(new a.entities.OpeningHours({days:t.days().slice(),start:t.start(),end:t.end()}),function(e){t.days(e.days().slice()),t.start(e.start()),t.end(e.end())})})},u.addOpeningHours=function(t,n){n.stopPropagation(),e(n.target).addClass("active"),i.notify("popover.show","openingHours",{$element:e(n.target),template:"popover-opening-hours-tpl",placement:g,appendTo:".container",cls:"opening-hours",afterHide:function(){e(n.target).removeClass("active")},viewModel:new h(new a.entities.OpeningHours,function(e){u.editing().data.openingHours.push(e)},(!0))})},u.destroy=function(t){if(i.stopListen(d),c.log("resourceDelete"),a.resources().length>1)var n=e("body").modal({template:"modal-delete-tpl",viewModel:{title:r.get("modal-deleteResource-title"),text:r.get("modal-deleteResource-text").format({name:t.data.name()}),item:t,deleteClicked:function(e,o){l.trackEventWithCounter("resourceForm","resourceDeleted"),t.destroy(function(){i.publish("showInformation",{text:r.get("alert-resourceDeleted").format({name:t.data.name()})}),n.modal("hide"),window.location.hash="#/business/resources"})},cancelClicked:function(){n.modal("hide")}}}).modal("show");else var o=e("body").modal({template:"modal-cannot-delete-tpl",viewModel:{title:r.get("modal-cannotDeleteResource-title"),text:r.get("modal-cannotDeleteResource-text"),okClicked:function(){o.modal("hide")}}}).modal("show")},u.syncClicked=function(){c.acl.activateTrialFeature("synchronization","starter",function(){window.location.hash="#/synchronization"})},u.icalTemplate=t.computed(function(){return this.editing()&&this.editing().data.syncEnabled()?"business-resources-form-sync-enabled-tpl":"business-resources-form-sync-disabled-tpl"},u),o.hashParamsChanged=function(t){if("add"==t.id){var n=new a.entities.ResourceNew({services:e.map(a.services(),function(e){return e.data.id()}),openingHours:a.account().openingHours().slice()});u.original(n),u.editing(p(n)),u.title(r.get("page-business-resources-add-title"))}else{var i=a.resources.find(t.id);i.data.hasOpeningHours()||i.data.openingHours(a.account().openingHours().slice()),u.original(i),u.original()?(u.editing(p(u.original()?u.original().clone():null)),u.title(r.get("page-business-resources-edit-title"))):window.location.hash="#/business/resources"}u.editing().data.notificationsEnabled.subscribe(function(e){e&&(l.trackEventWithCounter("resourceForm","resourceNotificationsClicked"),c.acl.activateTrialFeature("resourceNotifications","standard",function(e){e||u.editing().data.notificationsEnabled(!1)})),"free"!=a.account().plan.code&&"starter"!=a.account().plan.code||!e||(c.acl.showUpgradeModal(r.get("modal-upgrade-resourceNotifications-title"),r.get("modal-upgrade-resourceNotifications-text"),"resourceNotifications.png","resourceNotifications")(),u.editing().data.notificationsEnabled(!1))}),o.loading(!1),e("#frm-resource-name").focus()},u}}),r("reservio/pages/businessRoster",["jquery","ko","reservio/utils","postbox","reservio/lang","reservio/data","reservio/ajax"],function(e,t,n,i,o,r,a){return function(s,l){i.notify("pageTitle",o.get("page-business-roster-title"));var c={};c.tpl=t.observable("business-roster-tpl"),c.leftColTpl=t.observable("business-menu-tpl"),c.selectedResource=t.observable(r.resources()[0]),c.selectedResource.setOptions(r.resources()),c.selectedDate=t.observable(new Date),c.roster=t.observableArray([]);var u=function(){var t=c.selectedDate().getWeekStart(_reservio.weekStart),i=new Date(t.getTime()+5184e5),o=c.selectedResource().data.id();a.get("/account/availability/",{start:n.date.encodeDate(t),end:n.date.encodeDate(i),resourceId:o},function(t){c.roster(e.map(t.data.availability[o],function(e,t){return{date:n.date.decodeDate(t),slots:e}}).sort(function(e,t){return e>t}))})};c.selectedResource.subscribe(u),c.selectedDate.subscribe(u),u();var d=function(e,t,n){var o=this;t=t||function(){},this.openingHours=e||new r.entities.OpeningHours,this.saveClicked=function(){o.openingHours.end.isValid(!0)&&(t(o.openingHours),i.notify("popover.hide","openingHours"))},this.cancelClicked=function(){i.notify("popover.hide","openingHours")},this.isAdding=void 0===n},p=function(){var t="bottom",n=e(this.$element.parents(".container, body")[0]);this.$tip.show();var i=this.$tip.height();return this.$element.offset().top-n.offset().top+this.$element.outerHeight()+i>n.height()&&(t="top"),{side:t,offset:70}},f=function(e,t,r,s,l){a.post("/account/set-availability/",{date:n.date.encodeDate(e),resourceId:t,slots:r,checkForEvents:l},function(n){void 0!==n.data.error?i.notify("modal.show",{template:"modal-rosterEventsWarning-tpl",viewModel:{saveClicked:function(n,o){o.stopPropagation(),f(e,t,r,s,!1),i.notify("modal.hide")},cancelClicked:function(e,t){t.stopPropagation(),i.notify("modal.hide")}}}):(i.publish("showInformation",{text:o.get("alert-changesSaved")}),u(),s())})};return c.addHours=function(t,n){n.stopPropagation(),i.notify("popover.hide","openingHours"),i.notify("popover.show","openingHours",{$element:e(n.target),template:"popover-opening-hours-noDays-tpl",placement:p,appendTo:".container",cls:"opening-hours opening-hours-noDays",viewModel:new d(new r.entities.OpeningHours,function(e){var n=t.slots.slice(0);n.push({start:e.start(),end:e.end()}),f(t.date,c.selectedResource().data.id(),n,function(){},!0)})})},c.removeHours=function(e,t){return function(n,o){o.stopPropagation(),i.notify("popover.hide","openingHours");var r=e.slots.slice();r.splice(t,1),f(e.date,c.selectedResource().data.id(),r.length?r:"closed",function(){e.slots.splice(t,1)},!0)}},c.editHours=function(t,n){return function(o,a){i.notify("popover.hide","openingHours"),a.stopPropagation();var s=new r.entities.OpeningHours({start:t.slots[n].start,end:t.slots[n].end});i.notify("popover.show","openingHours",{$element:e(a.target),template:"popover-opening-hours-noDays-tpl",placement:p,appendTo:".container",cls:"opening-hours opening-hours-noDays",viewModel:new d(s,function(e){t.slots[n]={start:e.start(),end:e.end()},f(t.date,c.selectedResource().data.id(),t.slots,function(){t.slots[n]={start:e.start(),end:e.end()}},!0)},(!1))})}},c}}),r("reservio/pages/businessServices",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/templates","reservio/lang","reservio/data","reservio/ajax","libs/popover","libs/modal"],function(e,t,n,i,o,r,a,s,l){return function(n,o){i.notify("pageTitle",a.get("page-business-services-title"));var r={};return r.tpl=t.observable("business-services-tpl"),r.leftColTpl=t.observable("business-menu-tpl"),r.getResourcesById=function(e){return s.resources().length>0?t.utils.arrayMap(e,function(e){return t.utils.arrayFirst(s.resources(),function(t){return t.data.id()==e})}):[]},r.formatResources=function(e){return e.length==s.resources().length?a.get("basic-allResources"):0==e.length?a.get("basic-noResources"):t.utils.arrayMap(r.getResourcesById(e),function(e){return" "+e.data.name()})},r.moveUp=function(t,n,i){n.stopPropagation(),t.data.position(t.data.position()-1),t.save(function(){var t=e(n.target).parents(".clickable"),i=t.prev().prev();t.animate({top:"-75px"},function(){s.services.load()}),i.animate({top:"75px"})})},r.moveDown=function(t,n){n.stopPropagation(),t.data.position(t.data.position()+1),t.save(function(){var t=e(n.target).parents(".clickable"),i=t.next().next();t.animate({top:"75px"},function(){s.services.load()}),i.animate({top:"-75px"})})},r.add=function(){window.location.hash="#/business/services/form/add"},r.edit=function(e){window.location.hash="#/business/services/form/"+e.data.id()},r}}),r("reservio/pages/businessServicesForm",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/lang","reservio/data","reservio/analytics"],function(e,t,n,i,o,r,a,s){return function(n,o){var l={};l.tpl=t.observable("business-services-form-tpl"),l.leftColTpl=t.observable("business-menu-tpl"),l.title=t.observable(""),l.original=t.observable(null),l.editing=t.observable(null);var c=function(e){return e.data.name.required(r.get("error-service-name-required"),!0),e.data.resources.minLength(1,r.get("error-service-resources-required"),!0),e.data.duration.duration(),e.data.cost.decimal(2),e.data.questionText.addValidator("question",function(t){return!e.data.questionEnabled()||""!=t.replace(/^\s+|\s+$/g,"")},r.get("error-required"),!0),e};return l.save=function(t){if(this.isValid()){var n=this.isNew();if(o.log(n?"serviceCreate":"serviceEdit"),n){var c=1;e.each(a.services(),function(e,t){t.data.position()>c&&(c=t.data.position())}),this.data.position(c+1)}this.save(function(){s.trackEventWithCounter("serviceForm",n?"serviceCreated":"serviceEdited"),i.publish("showInformation",{text:r.get(n?"alert-serviceSaved":"alert-changesSaved")}),l.original().update(this.toJS()),window.location.hash="#/business/services"})}else s.trackFormErrors(this)},l.cancel=function(){window.location.hash="#/business/services"},l.destroy=function(t){if(o.log("serviceDelete"),a.services().length>1)var n=e("body").modal({template:"modal-delete-tpl",viewModel:{title:r.get("modal-deleteService-title"),text:r.get("modal-deleteService-text").format({name:t.data.name()}),item:t,deleteClicked:function(e,o){s.trackEventWithCounter("serviceForm","serviceDeleted"),t.destroy(function(){i.publish("showInformation",{text:r.get("alert-serviceDeleted").format({name:t.data.name()})}),n.modal("hide"),window.location.hash="#/business/services"})},cancelClicked:function(){n.modal("hide")}}}).modal("show");else var l=e("body").modal({template:"modal-cannot-delete-tpl",viewModel:{title:r.get("modal-cannotDeleteService-title"),text:r.get("modal-cannotDeleteService-text"),okClicked:function(){l.modal("hide")}}}).modal("show")},n.afterRender=function(){i.notify("viewLoaded"),n.loading(!1)},n.hashParamsChanged=function(t){if("add"==t.id){var i=new a.entities.ServiceNew({resources:e.map(a.resources(),function(e){return e.data.id()}),questionEnabled:!1});l.original(i),l.editing(c(i)),l.title(r.get("page-business-services-add-title"))}else l.original(a.services.find(t.id)),l.original()?(l.editing(c(l.original()?l.original().clone():null)),l.title(r.get("page-business-services-edit-title"))):window.location.hash="#/business/services";n.loading(!1),e("#frm-service-name").focus()},l}}),r("reservio/pages/businessSettings",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/data","reservio/lang","reservio/analytics","libs/popover"],function(e,t,n,i,o,r,a,s){return function(l,c){i.notify("pageTitle",a.get("page-business-settings-title"));var u={};u.tpl=t.observable("business-settings-tpl"),u.leftColTpl=t.observable("business-menu-tpl"),u.editing=t.observable(null),u.editing.subscribe(function(e){e&&(u.reservations.changed()&&u.changeEditing("reservations"),u.reminders.changed()&&u.changeEditing("reminders"),u.localization.changed()&&u.changeEditing("localization"),u.security.changed()&&u.changeEditing("security"))}),u.changeEditing=function(t){u.editing(t),"security"==t&&e("#frm-security-oldPassword").focus()},u.reservationsTemplate=t.computed(function(){return"reservations"==u.editing()?"business-settings-reservations-edit-tpl":"business-settings-reservations-show-tpl"},u),u.remindersTemplate=t.computed(function(){return"reminders"==u.editing()?"business-settings-reminders-edit-tpl":"business-settings-reminders-show-tpl"},u),u.localizationTemplate=t.computed(function(){return"localization"==u.editing()?"business-settings-localization-edit-tpl":"business-settings-localization-show-tpl"},u),u.securityTemplate=t.computed(function(){return"security"==u.editing()?"business-settings-security-edit-tpl":"business-settings-security-show-tpl"},u),u.reservations=t.form(function(){this.data={manualConfirmation:t.observable(),reservationsSlotSize:t.observable(),reservationsInAdvance:t.observable(),reservationsLaterThan:t.observable().addValidator("validator",function(){}),reservationsReminder:t.observable(),reservationsCancel:t.observable(),reservationsMaxCount:t.observable(),reservationsPermitted:t.observable(),removeBranding:t.observable(),publishingNetwork:t.observable()};var n=function(){var e=+this.reservationsInAdvance()<this.reservationsLaterThan();this.reservationsLaterThan.hasError(!e),this.reservationsLaterThan.errorMessage(a.get("page-business-settings-appointments-rangeError"))};this.data.reservationsInAdvance.subscribe(n,this.data),this.data.reservationsLaterThan.subscribe(n,this.data);var i=function(t,n,i){return e.map(t,function(e){return"object"==typeof e?e:{time:e,text:a.getDuration(e)}})};this.data.reservationsCancel.setOptions(i([{time:-1,text:a.get("page-business-settings-appointments-cannotCancel")},3600,18e3,43200,54e3,86400,172800,259200,345600,432e3,604800,864e3,1209600,1814400,2592e3,{time:31536e4,text:a.get("page-business-settings-appointments-everytime")}]),"time"),this.data.reservationsSlotSize.setOptions(i([300,600,900,1200,1800,2700,3600,4500,5400,6300,7200,9e3,10800,12600]),"time"),this.data.reservationsReminder.setOptions(i([{time:-1,text:a.get("page-business-settings-appointments-dontSend")},3600,10800,86400,129600,172800,259200,345600,432e3,604800,864e3,1209600,1814400,2592e3]),"time"),this.data.reservationsInAdvance.setOptions(i([3600,7200,10800,14400,18e3,36e3,54e3,86400,172800,259200,345600,432e3,604800,864e3,1209600,1814400,2592e3,5184e3]),"time"),this.data.reservationsLaterThan.setOptions(i([86400,172800,259200,345600,432e3,604800,864e3,1209600,1814400,2592e3,5184e3,7776e3,15552e3,31104e3]),"time");for(var o=[],r=1;r<=100;r+=r>=20?5:1)o.push({count:r,text:r+" "+a.getByCount("places",r)});this.data.reservationsMaxCount.setOptions(o,"count"),this.data.reservationsPermitted.setOptions([{value:0,text:a.get("page-business-settings-appointments-anyone")},{value:1,text:a.get("page-business-settings-appointments-existingClients")},{value:2,text:a.get("page-business-settings-appointments-passesClients")},{value:3,text:a.get("page-business-settings-appointments-passesClientsAllowFirst")}],"value")},{edit:function(){this.backup(),u.changeEditing("reservations")},save:function(){var t=this,n=this.toJS();c.log("saveSettingsReservations"),this.data.reservationsLaterThan.hasError()?s.trackEventWithCounter("businessSettings-reservationsForm","rangeError"):o.Account.update({settings:{reservations_manual_confirmation:n.manualConfirmation?1:0,reservations_slot_size:n.reservationsSlotSize,reservations_in_advance:n.reservationsInAdvance,reservations_later_than:n.reservationsLaterThan,reservations_cancel:n.reservationsCancel,reservations_reminder:n.reservationsReminder,reservations_max_count:n.reservationsMaxCount,reservations_permitted:n.reservationsPermitted,remove_branding:n.removeBranding?1:0,publishing_network:n.publishingNetwork?1:0}},function(){e.each(n,function(e,t){r.account().settings[e](t)}),r.account().settings.manualConfirmation.commit(),t.reset(),u.changeEditing(null),i.publish("showInformation",{text:a.get("alert-changesSaved")})})},cancel:function(){this.restore(),u.changeEditing(null)}});var d=function(e){var t=[];return e.indexOf("n")>=0&&t.push({value:0,text:a.get("page-business-settings-notifications-optionNone")}),e.indexOf("e")>=0&&t.push({value:1,text:a.get("page-business-settings-notifications-optionEmail")}),e.indexOf("s")>=0&&t.push({value:2,text:a.get("page-business-settings-notifications-optionSms")}),e.indexOf("a")>=0&&t.push({value:3,text:a.get("page-business-settings-notifications-optionEmailSms")}),t};return u.sms_balance=t.observable(0),u.reminders=t.form(function(){this.data={message_booking_confirmed_business:t.observable(),message_booking_confirmed_client:t.observable(),
message_booking_canceled_business:t.observable(),message_booking_canceled_client:t.observable(),message_booking_awaiting_business:t.observable(),message_booking_awaiting_client:t.observable(),message_booking_reminder_client:t.observable(),message_client_created_business:t.observable(),message_client_created_client:t.observable(),message_client_confirmed_client:t.observable(),message_client_rejected_client:t.observable(),message_newsletters_business:t.observable()},this.data.message_booking_confirmed_client.setOptions(d("nsea"),"value"),this.data.message_booking_confirmed_business.setOptions(d("nsea"),"value"),this.data.message_booking_canceled_business.setOptions(d("nsea"),"value"),this.data.message_booking_canceled_client.setOptions(d("nsea"),"value"),this.data.message_booking_awaiting_business.setOptions(d("nsea"),"value"),this.data.message_booking_awaiting_client.setOptions(d("nsea"),"value"),this.data.message_booking_reminder_client.setOptions(d("nsea"),"value"),this.data.message_client_created_business.setOptions(d("ne"),"value"),this.data.message_client_created_client.setOptions(d("ne"),"value"),this.data.message_client_confirmed_client.setOptions(d("ne"),"value"),this.data.message_client_rejected_client.setOptions(d("ne"),"value"),this.data.message_newsletters_business.setOptions(d("ne"),"value"),e.each(this.data,function(t,n){n.subscribe(function(t){2!==t&&3!==t||c.acl.activateTrialFeature("smsNotifications","starter"),"free"!=r.account().plan.code||2!==t&&3!==t||e(".modal").length||c.acl.showUpgradeModal(a.get("modal-upgrade-smsNotifications-title"),a.get("modal-upgrade-smsNotifications-text"),"smsNotifications.png","smsNotifications")()})})},{edit:function(){this.backup(),u.changeEditing("reminders")},save:function(){var t=this,n=this.toJS();c.log("saveSettingsReminders"),o.Account.update({settings:{message_booking_confirmed_business:+n.message_booking_confirmed_business,message_booking_confirmed_client:+n.message_booking_confirmed_client,message_booking_canceled_business:+n.message_booking_canceled_business,message_booking_canceled_client:+n.message_booking_canceled_client,message_booking_awaiting_business:+n.message_booking_awaiting_business,message_booking_awaiting_client:+n.message_booking_awaiting_client,message_booking_reminder_client:+n.message_booking_reminder_client,message_client_created_business:+n.message_client_created_business,message_client_created_client:+n.message_client_created_client,message_client_confirmed_client:+n.message_client_confirmed_client,message_client_rejected_client:+n.message_client_rejected_client,message_newsletters_business:+n.message_newsletters_business}},function(){e.each(n,function(e,t){r.account().settings[e](t)}),u.changeEditing(null),t.reset(),i.publish("showInformation",{text:a.get("alert-changesSaved")})})},cancel:function(){this.restore(),u.changeEditing(null)},optionOnRender:function(e,t){return e.text(t.text),"free"!=r.account().plan.code||2!==t.value&&3!==t.value||e.addClass("disabled"),e},requestOptionOnRender:function(e,t){return e.text(t.text),"free"!=r.account().plan.code||2!==t.value&&3!==t.value||e.addClass("disabled"),e},optionOnSelect:function(e,t){console.log(t)}}),u.localization=t.form(function(){var i=[{code:"en",text:"English"},{code:"cs",text:"Česky"},{code:"sk",text:"Slovensky"},{code:"br",text:"Português Brasileiro"},{code:"es",text:"Español"},{code:"de",text:"Deutsch"},{code:"it",text:"Italian"},{code:"fr",text:"Français"},{code:"hu",text:"Hungarian"},{code:"fr",text:"French"}];(!_reservio.production||window.location.href.indexOf("reserveyo")>=0)&&(i.push({code:"fi",text:"Suomalainen"}),i.push({code:"nl",text:"Nederlands"}),i.push({code:"de",text:"Deutsch"}),i.push({code:"sl",text:"Slovenščina"}),i.push({code:"sr",text:"Српски"}),i.push({code:"hr",text:"Hrvatski"}),i.push({code:"da",text:"Dansk"}),i.push({code:"no",text:"Norsk"}),i.push({code:"lt",text:"Lithuanian"})),this.data={language:t.observable().setOptions(i,"code"),frontend_language:t.observable().setOptions(e.map(_reservio.frontendLanguageOptions,function(e,t){return{code:t,text:e}}),"code"),currency:t.observable().setOptions(_reservio.currencies,"code"),timezone:t.observable().setOptions(n.date.getTimezones(),"code"),timeFormat:t.observable().setOptions([{value:12,text:"1:00 pm"},{value:24,text:"13:00"}],"value"),dateFormat:t.observable().setOptions([{value:"mdy",text:"12/31/2015"},{value:"dmy",text:"31.12.2015"},{value:"ymd",text:"2015.12.31."}],"value"),weekStart:t.observable().setOptions([{value:0,text:a.get("page-business-settings-localization-weekStartSunday")},{value:1,text:a.get("page-business-settings-localization-weekStartMonday")}],"value")}},{edit:function(){this.backup(),u.changeEditing("localization")},save:function(){var e=this,t=this.toJS();c.log("saveSettingsLocalization"),o.Account.update({settings:{language:t.language,frontend_language:t.frontend_language,currency:t.currency,timezone:t.timezone,date_format:t.dateFormat,time_format:t.timeFormat,week_start:t.weekStart}},function(){window.location.reload(),u.changeEditing(null),e.reset(),i.publish("showInformation",{text:a.get("alert-changesSaved")})})},cancel:function(){this.restore(),u.changeEditing(null)}}),u.security=t.form(function(){var e=this;this.data={oldPassword:t.observable("").required(a.get("error-password-length"),!0),newPassword:t.observable("").required(a.get("error-password-length"),!0).minLength(6,a.get("error-password-length"),!0),newPasswordAgain:t.observable("").addValidator("matchPasswords",function(t){return""==e.data.oldPassword()||""!=e.data.oldPassword()&&""!=e.data.newPasswordAgain()&&e.data.newPassword()==e.data.newPasswordAgain()},a.get("error-password-match"),!0)}},{edit:function(){this.backup(),u.changeEditing("security")},savePassword:function(){var e=this,t=this.toJS();c.log("saveSettingsPassword"),this.data.oldPassword.isValid()&&this.data.newPassword.isValid()&&this.data.newPasswordAgain.isValid()&&o.Account.update({security:{newPassword:t.newPassword,oldPassword:t.oldPassword}},function(){i.publish("showInformation",{text:a.get("alert-changesSaved")}),e.data.oldPassword(""),e.data.newPassword(""),e.data.newPasswordAgain(""),e.data.oldPassword.hasError(!1),e.data.newPassword.hasError(!1),e.data.newPasswordAgain.hasError(!1),e.reset(),u.changeEditing(null)},function(t){"Wrong password"==t.status.message&&(e.data.oldPassword.errorMessage("Wrong password"),e.data.oldPassword.hasError(!0))})},cancel:function(){this.restore(),u.changeEditing(null)}}),l.afterRender=function(e){o.Account.get(["settings","informations"],function(e){var t=e.data.account.settings,n=e.data.account.informations;u.sms_balance(n.sms_balance),u.reservations.update({manualConfirmation:1==t.reservations_manual_confirmation,reservationsSlotSize:t.reservations_slot_size,reservationsInAdvance:t.reservations_in_advance,reservationsLaterThan:t.reservations_later_than,reservationsCancel:t.reservations_cancel,reservationsReminder:t.reservations_reminder,reservationsMaxCount:t.reservations_max_count,reservationsPermitted:t.reservations_permitted,removeBranding:1==t.remove_branding,publishingNetwork:1==t.publishing_network}),u.reminders.update({message_booking_confirmed_business:t.message_booking_confirmed_business,message_booking_confirmed_client:t.message_booking_confirmed_client,message_booking_canceled_business:t.message_booking_canceled_business,message_booking_canceled_client:t.message_booking_canceled_client,message_booking_awaiting_business:t.message_booking_awaiting_business,message_booking_awaiting_client:t.message_booking_awaiting_client,message_booking_reminder_client:t.message_booking_reminder_client,message_client_created_business:t.message_client_created_business,message_client_created_client:t.message_client_created_client,message_client_confirmed_client:t.message_client_confirmed_client,message_client_rejected_client:t.message_client_rejected_client,message_newsletters_business:t.message_newsletters_business}),u.localization.update({language:t.language,frontend_language:t.frontend_language,currency:t.currency.toUpperCase(),timezone:t.timezone,dateFormat:t.date_format,timeFormat:t.time_format,weekStart:t.week_start}),u.reservations.data.removeBranding.subscribe(function(e){e&&(s.trackEventWithCounter("settings","removeBrandingClicked"),c.acl.activateTrialFeature("removeBranding","pro",function(e){e||u.reservations.data.removeBranding(!1)})),"pro"!=r.account().plan.code&&e&&(c.acl.showUpgradeModal(a.get("modal-upgrade-removeBranding-title"),a.get("modal-upgrade-removeBranding-text"),"removeBranding.png","removeBranding")(),u.reservations.data.removeBranding(!1))}),i.notify("viewLoaded"),l.loading(!1)})},u}}),r("reservio/pages/businessStatistics",["jquery","ko","reservio/utils","postbox","reservio/lang","reservio/ajax","reservio/data","moment"],function(e,t,n,i,o,r,a,s){return function(l,c){var u={};u.tpl=t.observable("business-statistics-tpl"),u.leftColTpl=t.observable("business-menu-tpl"),u.language=o,u.loading=t.observable(!1),u.displayFrom=t.observable(),u.displayTo=t.observable(),u.displayFromPicker=t.timeObservable(),u.displayToPicker=t.timeObservable(),u.displayFromPicker.temp.subscribe(function(e){var t=u.displayToPicker.temp();t&&(n.date.equalDate(e,t)&&e>=t||e>=t)&&u.displayToPicker(new Date(e.getTime()+1*n.date.hour))}),u.displayToPicker.temp.subscribe(function(e){var t=u.displayFromPicker.temp();t&&(n.date.equalDate(e,t)&&e<=t||e<=t)&&u.displayFromPicker(new Date(e.getTime()+1*n.date.hour))}),u.data=a,u.statistics=t.observable(),u.statisticsHasData=t.observable(!0),u.predefinedRanges=[{value:0,text:o.get("statistics-thisWeek"),from:s().startOfWeek(),to:s().endOfWeek()},{value:1,text:o.get("statistics-previousWeek"),from:s().subtract("week",1).startOfWeek(),to:s().subtract("week",1).endOfWeek()},{value:2,text:o.get("statistics-thisMonth"),from:s().startOf("month"),to:s().endOf("month")},{value:3,text:o.get("statistics-previousMonth"),from:s().subtract("month",1).startOf("month"),to:s().subtract("month",1).endOf("month")},{value:4,text:o.get("statistics-thisYear"),from:s().startOf("year"),to:s().endOf("year")},{value:5,text:o.get("statistics-previousYear"),from:s().subtract("year",1).startOf("year"),to:s().subtract("year",1).endOf("year")},{value:6,text:o.get("statistics-lastWeek"),from:s().subtract("days",6),to:s()},{value:7,text:o.get("statistics-lastMonth"),from:s().subtract("days",29),to:s()},{value:8,text:o.get("statistics-allTime"),from:a.account().createdAt,to:s()},{value:9,text:o.get("statistics-custom"),from:null,to:null}],u.selectedPredefinedRange=t.observable().setOptions(u.predefinedRanges,"value"),u.resourcesHeight=t.observable(0),u.servicesHeight=t.observable(0),u.couponsHeight=t.observable(0),u.displayBookingsBy=t.observable("days"),u.displayBookingsBy.subscribe(function(e){p(u.displayFromPicker.temp(),u.displayToPicker.temp())}),u.displayBookingsByDays=function(){u.displayBookingsBy("days")},u.displayBookingsByWeeks=function(){u.displayBookingsBy("weeks")},u.displayResourcesBy=t.observable("bookings"),u.displayResourcesBy.subscribe(function(e){"bookings"==e?v("#statistics-resources",u.statistics().bookings.by_top_resources):v("#statistics-resources",u.statistics().revenues.by_top_resources,!0)}),u.displayServicesBy=t.observable("bookings"),u.displayServicesBy.subscribe(function(e){"bookings"==e?b("#statistics-services",u.statistics().bookings.by_top_services):b("#statistics-services",u.statistics().revenues.by_top_services,!0)}),u.displayCouponsBy=t.observable("count"),u.displayCouponsBy.subscribe(function(e){"count"==e?y("#statistics-coupons",u.statistics().coupons.count):y("#statistics-coupons",u.statistics().coupons.revenues,!0)});var d=function(e,t,n){e=s(e).startOf("day"),t=s(t).startOf("day");var i=s.duration(t.diff(e)),o=[];if(i.asDays()>14)for("weeks"==u.displayBookingsBy()&&(e=e.startOfWeek());e<=t;)o.push(e.clone().toDate()),e.add("weeks",1);else{var r="weeks"==u.displayBookingsBy()?7:1;for(e=e.startOf("day"),e=e.startOf("day");e<=t;)o.push(e.clone().toDate()),e.add("days",r)}return o};u.bookingsChart=null,u.bookingsChartOptions={legend:{position:"none"},tooltip:{isHtml:!0},chartArea:{left:0,width:"100%",top:10,height:115},animation:{duration:500,easing:"out"},bar:{groupWidth:"85%"},hAxis:{gridlines:{count:7,color:"transparent"},ticks:[],baselineColor:"transparent",textStyle:{color:"#777",fontSize:"11"},format:"EEE, d.M."},vAxis:{gridlines:{color:"transparent"},baseline:0,baselineColor:"#E2E2E2",format:"0",textStyle:{color:"#777",fontSize:"11"},minValue:0,maxValue:10},series:{0:{color:"#1263bb"}}},u.bookingsChartData=new google.visualization.DataTable,u.bookingsChartData.addColumn("date","Date"),u.bookingsChartData.addColumn("number",o.get("statistics-typeBookings")),u.bookingsChartData.addColumn({type:"string",role:"tooltip",p:{html:!0}}),u.bookingsChartData.addColumn({calc:"stringify",sourceColumn:1,type:"string",role:"annotation"}),u.resourcesHasData=t.observable(!0),u.displayResourcesByBookings=function(){u.displayResourcesBy("bookings")},u.displayResourcesByRevenues=function(){u.displayResourcesBy("revenues")},u.servicesHasData=t.observable(!0),u.displayServicesByBookings=function(){u.displayServicesBy("bookings")},u.displayServicesByRevenues=function(){u.displayServicesBy("revenues")},u.couponsHasData=t.observable(!0),u.displayCouponsByCount=function(){u.displayCouponsBy("count")},u.displayCouponsByRevenues=function(){u.displayCouponsBy("revenues")};var p=function(e,t,i){i=i||function(){};var o=e?n.date.encodeDate(e):null,a=t?n.date.encodeDate(t):null;u.loading(!0),r.get("/statistics/",{from:o,to:a,group_by:u.displayBookingsBy()},function(e){var t=e.data;u.statistics(t),t.bookings.count>0||t.coupons.count.length>0?(u.statisticsHasData(!0),b("#statistics-services",t.bookings.by_top_services),g("#statistics-clients",t.bookings.by_client_type),m("#statistics-bookings-type",t.bookings.by_type),v("#statistics-resources",t.bookings.by_top_resources),y("#statistics-coupons",t.coupons.count),setTimeout(function(){h(t.bookings.by_days)},100),u.displayResourcesBy("bookings"),u.displayServicesBy("bookings"),u.displayCouponsBy("count")):u.statisticsHasData(!1),i(u.statistics()),u.loading(!1)})},f=function(e,t){var i;if("days"==u.displayBookingsBy())i=e.format(n.date.getDatePattern(_reservio.dateFormat));else{var r=s(e).add("days",7).toDate();i=e.format(n.date.getDatePattern(_reservio.dateFormat))+" - "+r.format(n.date.getDatePattern(_reservio.dateFormat))}return'<div style="padding: 0px 8px;color: #0F0F0F;"><p style="margin:5px 0 0;"><b>'+i+'</b></p><p style="margin:0 0 5px;">'+o.get("statistics-typeBookings")+": <b>"+t+"</b></p></div>"},h=function(t){var i=u.selectedPredefinedRange.selectedOption(),o=s.duration(i.to.diff(i.from));if(t){var r=o.asMonths()>1.5;u.bookingsChartData.removeRows(0,u.bookingsChartData.getNumberOfRows()),e.each(t,function(e,t){var i="";r||(i+=t.value.total),u.bookingsChartData.addRow([n.date.decodeDate(t.label),t.value.total,f(n.date.decodeDate(t.label),t.value.total),i])})}else for(var a=0;a<=30*o.months()+o.days();a++)u.bookingsChartData.addRow([i.from.clone().add("days",a).toDate(),0,"0",""]);u.bookingsChartOptions.hAxis.ticks=d(u.displayFromPicker.temp(),u.displayToPicker.temp(),7),u.bookingsChart.draw(u.bookingsChartData,u.bookingsChartOptions)},g=function(t,n){var i=[["Type",o.get("statistics-typeBookings")]];n["new"]+n.returning;i.push([o.get("statistics-label-newClients"),n["new"]]),i.push([o.get("statistics-label-returningClients"),n.returning]);var r=google.visualization.arrayToDataTable(i),a={legend:{position:"right",alignment:"center"},bar:{groupWidth:"75%"},focusTarget:"category",isStacked:!0,slices:{0:{color:"#54c219"},1:{color:"#1263bb"}},chartArea:{width:"80%",height:"80%"}},s=new google.visualization.DataView(r),l=new google.visualization.PieChart(e(t)[0]);l.draw(s,a)},m=function(t,n){var i=[["Type",o.get("statistics-typeBookings")]];i.push([o.get("statistics-label-profileBookings"),n.profile_page]),i.push([o.get("statistics-label-websiteBookings"),n.website]),i.push([o.get("statistics-label-facebookBookings"),n.facebook]),i.push([o.get("statistics-label-calendarBookings"),n.app]);var r=google.visualization.arrayToDataTable(i),a={legend:{position:"right",alignment:"center"},focusTarget:"category",isStacked:!0,slices:{0:{color:"#54c219"},1:{color:"#18C286"},2:{color:"#169BBF"},3:{color:"#1263bb"}},chartArea:{width:"80%",height:"80%"}},s=new google.visualization.DataView(r),l=new google.visualization.PieChart(e(t)[0]);l.draw(s,a)},v=function(t,i,r){if(r)var s=[["Name",o.get("statistics-typeRevenues"),{role:"annotation"},{role:"style"}]];else var s=[["Name",o.get("statistics-typeBookings"),{role:"annotation"},{role:"style"}]];var l=1;if(e.each(i,function(e,t){if(0!=t.label.id||t.data.value>0){t.data.value>l&&(l=t.data.value),0==t.label.id&&(t.label.name=o.get("basic-notAssigned"));var i=t.data.value;r&&(i=n.formatCurrency(a.account().settings.currency(),i)),s.push([t.label.name,t.data.value,i,"fill-color: #1263bb, stroke-color: #0f549f"])}}),s.length>1){u.resourcesHasData(!0);var c=google.visualization.arrayToDataTable(s);u.resourcesHeight(28*Math.min(c.getNumberOfRows(),10));var d={legend:{position:"none"},bar:{groupWidth:23},chartArea:{left:250,top:0,height:u.resourcesHeight()},width:890,hAxis:{format:"0",gridlines:{color:"transparent"},baselineColor:"transparent",minValue:0,maxValue:l},vAxis:{gridlines:{color:"transparent"},format:"0",textStyle:{fontSize:13}},annotations:{textStyle:{fontSize:13}},tooltip:{textStyle:{fontSize:13}}},p=new google.visualization.DataView(c),f=new google.visualization.BarChart(e(t)[0]);f.draw(p,d)}else u.resourcesHasData(!1)},b=function(t,i,r){if(r)var s=[["Name",o.get("statistics-typeRevenues"),{role:"annotation"},{role:"style"}]];else var s=[["Name",o.get("statistics-typeBookings"),{role:"annotation"},{role:"style"}]];var l=1;if(e.each(i,function(e,t){if(0!=t.label.id||t.data.value>0){t.data.value>l&&(l=t.data.value),0==t.label.id&&(t.label.name=o.get("basic-notAssigned"));var i=t.data.value;r&&(i=n.formatCurrency(a.account().settings.currency(),i)),s.push([t.label.name,t.data.value,i,"fill-color: #1263bb, stroke-color: #0f549f"])}}),s.length>1){u.servicesHasData(!0);var c=google.visualization.arrayToDataTable(s);u.servicesHeight(28*c.getNumberOfRows());var d={legend:{position:"none"},bar:{groupWidth:23},chartArea:{left:250,top:0,height:u.servicesHeight()},hAxis:{format:"0",gridlines:{color:"transparent"},baselineColor:"transparent",minValue:0,maxValue:l},vAxis:{gridlines:{color:"transparent"},format:"0",textStyle:{fontSize:13}},annotations:{textStyle:{fontSize:13}},tooltip:{textStyle:{fontSize:13}}},p=new google.visualization.DataView(c),f=new google.visualization.BarChart(e(t)[0]);f.draw(p,d)}else u.servicesHasData(!1)},y=function(t,i,r){if(r)var s=[["Name",o.get("statistics-typeRevenues"),{role:"annotation"},{role:"style"}]];else var s=[["Name",o.get("statistics-typeCount"),{role:"annotation"},{role:"style"}]];var l=1;if(e.each(i,function(e,t){if(0!=t.label.id||t.data.value>0){t.data.value>l&&(l=t.data.value),0==t.label.id&&(t.label.name=o.get("basic-notAssigned"));var i=t.data.value;r&&(i=n.formatCurrency(a.account().settings.currency(),i)),s.push([t.label.name,t.data.value,i,"fill-color: #1263bb, stroke-color: #0f549f"])}}),s.length>1){u.couponsHasData(!0);var c=google.visualization.arrayToDataTable(s);u.couponsHeight(28*c.getNumberOfRows());var d={legend:{position:"none"},bar:{groupWidth:23},chartArea:{left:250,top:0,height:u.couponsHeight()},hAxis:{format:"0",gridlines:{color:"transparent"},baselineColor:"transparent",minValue:0,maxValue:l},vAxis:{gridlines:{color:"transparent"},format:"0",textStyle:{fontSize:13}},annotations:{textStyle:{fontSize:13}},tooltip:{textStyle:{fontSize:13}}},p=new google.visualization.DataView(c),f=new google.visualization.BarChart(e(t)[0]);f.draw(p,d)}else u.couponsHasData(!1)};return l.afterRender=function(t){if(c.log("page-statistics"),Intercom("trackEvent","Viewed Statistics"),"free"==a.account().plan.code)window.location.hash="#/business/dashboard",c.acl.showUpgradeModal(o.get("modal-upgrade-statistics-title"),o.get("modal-upgrade-statistics-text"),"statistics.png","statistics")();else{i.notify("viewLoaded"),l.loading(!1),u.bookingsChart=new google.visualization.ColumnChart(e("#statistics-bookings")[0]);var n=!1;u.selectedPredefinedRange.subscribe(function(){n=!0;var e=u.selectedPredefinedRange.selectedOption();e.from&&e.to&&(u.displayFromPicker(e.from.clone().toDate()),u.displayToPicker(e.to.clone().toDate()),p(u.displayFromPicker.temp(),u.displayToPicker.temp())),n=!1}),u.selectedPredefinedRange(2),h(),u.displayFromPicker.temp.subscribe(function(){var e=u.predefinedRanges[9];e.from=s(u.displayFromPicker.temp()),e.to=s(u.displayToPicker.temp()),n||(u.selectedPredefinedRange(9),p(u.displayFromPicker.temp(),u.displayToPicker.temp()))}),u.displayToPicker.temp.subscribe(function(){u.displayFromPicker.temp.notifySubscribers(u.displayFromPicker.temp())})}},u}}),r("reservio/views/repeat",["jquery","ko","reservio/utils","reservio/lang","postbox"],function(e,t,n,i,o){var r=function(e){this.language=i,this.event=e.event,this.types=[{id:0,name:"none"},{id:1,name:"daily"},{id:2,name:"weekly"},{id:3,name:"monthly"}],this.type=t.observable(this.event.repeatType.temp()||0),this.type.setOptions(this.types,"id"),this.type.subscribe(this.typeChanged,this),this.interval=t.observable(this.event.repeatInterval.temp()||1),this.endsType=t.observable(this.event.repeatEndsType.temp()||2),this.endsAfter=t.observable(this.event.repeatEndsAfter.temp()||7),this.datePattern=n.date.getDatePattern(_reservio.dateFormat),this.endsOn=t.timeObservable(new Date((new Date).getTime()+6048e5)),this.daysOptions=this.getDays(),this.days=t.observableArray(this.decodeDays(this.event.repeatOptions.temp())).addValidator("validator",function(e){return e.length>0},i.get("openingHours-noDaysSelectedError")),this.tpl=t.computed(this.computeTpl,this),this.isDaySelected=this.isDaySelected.bind(this),this.dayClicked=this.dayClicked.bind(this)};return t.utils.extend(r.prototype,{typeChanged:function(e){2==e&&0==this.days().length&&this.days([this.event.start.temp().getDay()])},getDays:function(){var t=i.getDays(),n=i.getDaysShort(),o=e.map(t,function(e,t){return{index:t,name:e,nameShort:n[t]}});if(1==_reservio.weekStart){var r=o.shift();o.push(r)}return o},computeTpl:function(){return"eventRepeat-"+this.type()+"-tpl"},isDaySelected:function(e){return this.days.indexOf(e)>=0},dayClicked:function(e){this.isDaySelected(e)?this.days.remove(e):(this.days.push(e),this.days.sort())},decodeDays:function(e){for(var t=[],n=0,i=1;i<256;i*=2,n++)e&i&&t.push(n);return t},encodeDays:function(t){var n=0;return e.each(t,function(e,t){n+=1<<t}),n},saveClicked:function(e,t){t.stopPropagation(),this.event.repeatType(this.type()),this.event.repeatInterval(this.interval()),this.event.repeatOptions(this.encodeDays(this.days())),this.event.repeatEndsType(this.endsType()),this.event.repeatEndsAfter(this.endsAfter()),this.event.repeatEndsOn(this.endsOn()),o.notify("modal.hide","eventRepeat")},cancelClicked:function(e,t){t.stopPropagation(),o.notify("modal.hide","eventRepeat")}}),r}),r("reservio/views/eventPopover",["jquery","ko","postbox","reservio/models","reservio/data","reservio/lang","reservio/ajax","reservio/utils","reservio/analytics","reservio/views/repeat","reservio/modules/tutorial"],function(e,t,n,i,o,r,a,s,l,c,u){var d=function(e){var n=this;this.app=e.app,this.data=o,this.calendarView=e.calendarView,this.calendar=e.calendar,this.event=e.event,this.template=t.observable("eventEdit-preview-tpl"),this.options=e,this.processing=t.observable(!1),this.couponPopoverTimeout=null,this.language=r,this.serviceChangeSubscription=null,this.afterHide=function(){u.getTutorial("createBooking").showNextStep("createdEventGroup"),e.afterHide&&e.afterHide(),n.calendarNeedsReload&&e.calendar.fullCalendar("refetchEvents"),n.serviceChangeSubscription.dispose()},this.serviceChangeSubscription=n.event.service.temp.subscribe(n.serviceChanged,n),this.calendarNeedsReload=!1,this.resources=o.resources.slice(0),this.resources.unshift(new o.entities.ResourceNew({name:r.get("basic-notAssigned")})),this.services=o.services.slice(0),this.services.unshift(new o.entities.ServiceNew({name:r.get("basic-notAssigned")})),this.event.resource.setOptions(this.resources),this.event.service.setOptions(this.services),this.event.id||1!=o.services().length||this.event.service(o.services()[0]),this.event.service.changed(!1),this.repeatActive=t.observable(!1),this.message=t.observable("");for(var i=[],a=1;a<=100;a++)i.push({count:a,text:a+" "+r.getByCount("places",a)});this.newBooking={count:t.observable(1).setOptions(i,"count"),event_id:this.event.id,client:{id:t.observable(null),name:t.observable("").required(),email:t.observable("").email(),phone:t.observable("").phone()}},this.bookingBeingDeleted=t.observable(null),this.bookingNotificationMessage=t.observable(""),this.unconfirmedBookings=t.computed(this.computeUnconfirmedBookings,this),this.sortedBookings=t.computed(this.computeSortedBookings,this),this.isPromptDisplayed=t.computed(this.computeIsPromptDisplayed,this),this.hadRepeat=0!=this.event.repeatType(),this.daysOptions=t.computed({read:this.readDaysOptions,write:this.writeDaysOptions,owner:this}),this.tpl=t.computed(this.computeTpl,this),this.contactsOnSelect=this.contactsOnSelect.bind(this),this.editClicked=this.editClicked.bind(this),this.descriptionClicked=this.descriptionClicked.bind(this),this.deleteClicked=this.deleteClicked.bind(this),this.deleteEvent=this.deleteEvent.bind(this),this.cancelClicked=this.cancelClicked.bind(this),this.editSubmitted=this.editSubmitted.bind(this),this.addBookingSubmitted=this.addBookingSubmitted.bind(this),this.addBooking=this.addBooking.bind(this),this.deleteBookingClicked=this.deleteBookingClicked.bind(this),this.shareClicked=this.shareClicked.bind(this),this.unselectBooking=this.unselectBooking.bind(this),this.repeatClicked=this.repeatClicked.bind(this),this.printClicked=this.printClicked.bind(this),this.confirmBookingClicked=this.confirmBookingClicked.bind(this),this.rejectBookingClicked=this.rejectBookingClicked.bind(this),this.isDaySelected=this.isDaySelected.bind(this),this.dayClicked=this.dayClicked.bind(this),this.showCouponDetail=this.showCouponDetail.bind(this),this.hideCouponDetail=this.hideCouponDetail.bind(this),this.showNewClient=this.showNewClient.bind(this),this.hideNewClient=this.hideNewClient.bind(this),this.durationSetByHand=900!=this.event.duration()};return t.utils.extend(d.prototype,{computeUnconfirmedBookings:function(){return t.utils.arrayFilter(this.event.bookings(),function(e){return 0==e.state()})},computeSortedBookings:function(){var e=t.utils.arrayFilter(this.event.bookings(),function(e){return 1==e.state()});return e.sort(function(e,t){return s.normalizeString(e.contact().name())>s.normalizeString(t.contact().name())||t.displayOnTop?1:-1}),e},computeIsPromptDisplayed:function(){return null!=this.bookingBeingDeleted()},serviceChanged:function(e){this.event.id||(this.durationSetByHand||this.event.end.changed()||this.event.duration(e.data.duration()),this.event.capacity.changed()||this.event.capacity(e.data.capacity()),this.event.color.changed()||this.event.color(e.data.color()),this.event.cost.changed()||this.event.cost(e.data.cost()))},contactsItemTemplate:'<li style="white-space: nowrap;text-overflow: ellipsis;"><span class="client-name"></span><span class="help-block" style="margin-left: 15px"></span></li>',contactsOnRender:function(e,t){var n=[];""!=t.phone&&n.push(t.phone),""!=t.email&&n.push(t.email),e.find(".client-name").text(t.name),e.find(".help-block").text(n.join(", ")),n.unshift(t.name),e.attr("title",n.join(", "))},contactsOnSelect:function(e,t){var n=this.newBooking.client;n.id(t.id),n.name(t.name),n.email(t.email),n.phone(t.phone)},contactsOnFetch:function(e){return e.data.clients},show:function(){n.notify("modal.show","eventDetail",{template:"eventEdit-tpl",viewModel:this,afterShow:function(){setTimeout(function(){var t=u.getTutorial("createBooking");t.showActualStep();var n=e(".bookings-unconfirmed .bookings-item");n.length>0?(n.addClass("bookings-item-highlighted"),setTimeout(function(){n.removeClass("bookings-item-highlighted")},3e3)):e("#new-booking-client-name").focus()},50)},afterHide:this.afterHide,cls:"event-detail"})},editEvent:function(){var t=this;n.notify("modal.hideAndKeep","eventDetail"),n.notify("modal.show","editEvent",{template:"eventEdit-edit-tpl",viewModel:this,cls:"event-edit",afterShow:function(){var t=u.getTutorial("start");t.showNextStep("clickToCreateEventButtonGroup"),e("#frm-event-name").focus()},afterHide:function(){var e=u.getTutorial("start");e.showNextStep("createEventPopoverGroup"),t.options.afterHide()}})},previewEvent:function(){this.template("eventEdit-preview-tpl")},editClicked:function(){this.editEvent()},descriptionClicked:function(){this.editEvent(),setTimeout(function(){e("#frm-event-description").focus()},50)},deleteEvent:function(e,t){var i=this;i.app.log("eventPopoverDelete"),a.post("/appointments/destroy/",{id:i.event.id,reason:i.message(),changeAllFollowing:e,changeAll:t},function(e){""==i.message()?l.trackEventWithCounter("calendar","eventDeleted"):l.trackEventWithCounter("calendar","eventDeletedWithNote"),n.notify("modal.hide","eventDelete"),n.notify("modal.hide","editEvent"),n.notify("modal.hide","eventDetail"),n.notify("popover.hide","event"),i.calendar.fullCalendar("refetchEvents"),n.publish("showInformation",{text:r.get("alert-eventDeleted")}),i.app.acl.bookings.count(e.data.bookings)})},deleteEventClicked:function(){this.deleteEvent(!1,!1)},deleteEventAndAllFollowing:function(){this.deleteEvent(!0,!1)},deleteEventAndAll:function(){this.deleteEvent(!1,!0)},deleteClicked:function(){var t=this,i=!1;t.message(""),e.each(this.event.bookings(),function(){if(""!=this.contact().email())return i=!0,!1}),t.someoneHasEmail=i,!this.event.id||null===this.event.eventId&&0!=+this.event.repeatIndex()||0==+this.event.repeatType()?n.notify("modal.show","eventDelete",{template:"eventDelete-tpl",viewModel:t}):a.get("/appointments/repeat-has-bookings/",{event_id:this.event.eventId,repeat_index:this.event.repeatIndex()},function(e){t.repeatHasBookings=e.data.repeat_has_bookings>0,n.notify("modal.show","eventDelete",{template:"eventRepeatDelete-tpl",viewModel:t})})},showDropdown:function(t,n){var i=this;e(".event-share-dropdown").show(),setTimeout(function(){e(".modal").bind("click.dropdown",i.hideDropdown)},50)},hideDropdown:function(){e(".event-share-dropdown").hide(),e(".modal").unbind("click.dropdown")},shareClicked:function(t,n){var i=e(n.target).parent().find(".event-share-dropdown");i.is(":visible")?t.hideDropdown(t,n):t.showDropdown(t,n)},createBookingUrl:function(){return this.event.minipage_url},facebookShareClicked:function(e){var t=e.createBookingUrl();window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(t)+"&link="+t+"&name="+encodeURIComponent(e.event.title())+"&description=Event_description","facebookShareDialog","width=626,height=436")},twitterShareClicked:function(e){var t=e.createBookingUrl();window.open("http://twitter.com/share?url="+encodeURIComponent(t)+"&text="+encodeURIComponent(r.get("page-promote-overview-site-shareMessage"))+"&via=Reservio","twitterShareDialog","height=450,width=550,toolbar=0,location=0,menubar=0,directories=0,scrollbars=0")},gplusShareClicked:function(e){var t=e.createBookingUrl();window.open("https://plus.google.com/share?url="+encodeURIComponent(t),"gplusShareDialog","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},cancelClicked:function(e,t){t.stopPropagation(),n.notify("modal.hide","editEvent"),n.notify("modal.hide","eventDelete"),this.event.id},clientClicked:function(t,i){return n.notify("modal.hide","eventDetail"),window.location.hash=e(i.target).attr("href"),!0},editSubmitted:function(){var e=this;this.event.isValid()&&(this.hadRepeat&&(this.event.changed()||this.event.repeatChanged())?a.get("/appointments/repeat-has-bookings/",{
event_id:this.event.eventId,repeat_index:this.event.repeatIndex()},function(t){e.repeatHasBookings=t.data.repeat_has_bookings>0,n.notify("modal.show","eventChange",{template:!e.event.repeatEndChanged()||e.event.changed()||e.event.repeatChanged(!0)?"eventChange-tpl":"eventRepeatEndChange-tpl",viewModel:e})}):this.saveEvent())},saveEvent:function(e,t){var i=this;!this.event.id;this.processing(!0),this.event.changed()||this.event.repeatChanged()?this.event.commit(function(){n.notify("modal.hide","editEvent"),n.notify("modal.hide","eventChange"),n.notify("popover.hide","event");var e=i.calendarView.getDisplayedRange();i.event.start()>e.start&&i.event.end()<e.end?i.calendar.fullCalendar("refetchEvents"):i.calendarView.setHash({time:i.event.start.temp().getTime()}),n.publish("showInformation",{text:r.get("alert-eventSaved")}),i.processing(!1)},null,{changeAllFollowing:e,changeAll:t}):(i.processing(!1),n.notify("modal.hide","editEvent"),n.notify("modal.hide","eventChange"),n.notify("popover.hide","event"))},changeCancelClicked:function(){n.notify("modal.hide","eventChange")},saveEventClicked:function(){this.saveEvent(!1,!1)},saveEventAndChangeAllFollowing:function(){this.saveEvent(!0,!1)},saveEventAndChangeAll:function(){this.saveEvent(!1,!0)},bookingAfterAdd:function(t,n,i){var o=e(t).closest("ul").find("li").first();o.hide().slideDown().addClass("bookings-item-highlighted"),setTimeout(function(){o.removeClass("bookings-item-highlighted")},3e3)},bookingBeforeRemove:function(t,n,i){e(t).fadeOut(function(){e(t).remove()})},bookingTpl:function(e){return 0==e.state()?"booking-item-unconfirmed-tpl":"booking-item-tpl"},bookingPromptTpl:function(e){return e===this.bookingBeingDeleted()?"booking-delete-prompt-tpl":"empty-tpl"},repeatClicked:function(){0==this.event.repeatType()&&(this.event.repeatType(2),this.event.repeatType.commit(),this.event.repeatOptions(this.encodeDays([this.event.start().getDay()]))),this.repeatActive(!0),e(".modal-window .event-edit-inputs").scrollTop(500)},printClicked:function(){var e=this;e.app.acl.activateTrialFeature("printEvent","starter",function(){"free"==o.account().plan.code?e.app.acl.showUpgradeModal(r.get("modal-upgrade-printEvent-title"),r.get("modal-upgrade-printEvent-text"),"print.png","printEvent")():window.open("/exporter/event-bookings/?eventId="+e.event.id,"reservio-event-bookings-pdf")})},addBooking:function(){var o=this,s=this.newBooking,l=t.toJS(s);a.post("/appointments/create-booking/",l,function(t){l.client.id=t.data.client_id;var a=new i.Objects.Booking({id:+t.data.id,count:s.count(),contact:new i.Objects.Contact(l.client),clients_coupon_id:t.data.clients_coupon_id,client_name:l.client.name});if(a.displayOnTop=!0,o.event.bookings.push(a),s.client.id(null),s.client.name(""),s.client.email(""),s.client.phone(""),s.count(1),o.calendarNeedsReload=!0,1==o.event.bookings().length){o.bookingAfterAdd(e(".modal .bookings-item"))}o.app.acl.bookings.count(t.data.bookings),o.app.acl.bookings.isOverLimit();var c=u.getTutorial("createBooking");c.isActualStep("createdEventGroup")&&c.showNextStep("createdEventGroup"),n.notify("modal.hide","eventFullCapacity"),n.publish("showInformation",{text:r.get("alert-appointmentCreated")})})},addBookingSubmitted:function(){var t=this.newBooking.client,i=!1;this.app.acl.bookings.isOverLimit()||(e.each(this.event.bookings(),function(e,n){if(""!=t.email()){if(n.contact().email()==t.email())return i=!0,!1}else if(""!=t.name()&&n.contact().name()==t.name())return i=!0,!1}),i?(t.name.errorMessage(r.get("eventDetail-alreadyBooked")),t.name.hasError(!0)):(t.name.errorMessage(""),t.name.hasError(!1),t.name.isValid(!0)&&t.email.isValid(!0)&&t.phone.isValid(!0)&&(this.event.occupancy()+this.newBooking.count()>this.event.capacity()?n.notify("modal.show","eventFullCapacity",{template:"eventFullCapacity-tpl",viewModel:this}):this.addBooking())))},addBookingCancelClicked:function(){n.notify("modal.hide","eventFullCapacity")},deleteBookingClicked:function(i,o){var s=this,c=""!=i.contact().email();n.notify("modal.show","bookingDelete",{template:"modal-delete-event-tpl",viewModel:{title:r.get("modal-deleteAppointment-title"),text:c?r.get("modal-deleteAppointmentReason-text"):r.get("modal-deleteAppointment-text"),clientHasEmail:c,message:t.observable(""),deleteClicked:function(t,o){var c=this,u=e(o.target);u.button("loading"),s.app.log("eventPopoverDelete"),a.post("/appointments/destroy-booking/",{id:i.id,reason:c.message()},function(e){""==c.message()?l.trackEventWithCounter("calendar","bookingDeleted"):l.trackEventWithCounter("calendar","bookingDeletedWithNote"),s.calendarNeedsReload=!0,u.button("reset"),n.notify("modal.hide","bookingDelete"),s.app.acl.bookings.count(e.data.bookings),n.publish("showInformation",{text:r.get("alert-bookingDeleted")}),s.event.bookings.remove(i),s.unselectBooking()})},cancelClicked:function(e,t){t.stopPropagation(),n.notify("modal.hide","bookingDelete")}}})},confirmBookingClicked:function(t,i){var o=this;i.stopPropagation(),n.notify("approveAppointment",{id:t.id,after:function(){if(t.state(1),t.state.commit(),1==o.event.bookings().length){var n=e(".bookings-confirmed .bookings-item");n.addClass("bookings-item-highlighted"),setTimeout(function(){n.removeClass("bookings-item-highlighted")},3e3)}u.getTutorial("newBooking").showNextStep("confirmBooking"),o.calendarNeedsReload=!0}}),t.displayOnTop=!0},rejectBookingClicked:function(i,o){var a=this;o.stopPropagation(),n.notify("modal.show","bookingReject",{template:"modal-reject-event-tpl",viewModel:{title:r.get("modal-rejectAppointment-title"),text:r.get("modal-rejectAppointment-text"),message:t.observable(""),rejectClicked:function(t,o){var s=this,l=e(o.target);l.button("loading"),n.notify("rejectAppointment",{id:i.id,reason:s.message(),after:function(){n.notify("popover.hide","event"),a.calendarNeedsReload=!0,a.app.acl.bookings.isEventInRange(i.created())&&a.app.acl.bookings.count(a.app.acl.bookings.count()-1),a.event.bookings.remove(i),n.publish("showInformation",{text:r.get("alert-appointmentRejected")}),l.button("reset"),n.notify("modal.hide","bookingReject")}})},cancelClicked:function(e,t){t.stopPropagation(),n.notify("modal.hide","bookingReject")}}})},unselectBooking:function(){var t=this;e(".event-edit .booking-prompt").slideUp(function(){setTimeout(function(){t.bookingBeingDeleted(null)},10)})},showCouponDetail:function(t,i){var o=this;t.clients_coupon_id&&(clearTimeout(this.couponPopoverTimeout),this.couponPopoverTimeout=setTimeout(function(){a.get("/api/internal/clients-coupons/"+t.clients_coupon_id+"/",{fields:"id,created,visits,expire_on,credit,times_used,coupon(id,type,title,description,cost,visits,expire_after,expire_after_units,credit)"},function(t){var r=t.data;0==r.coupon.type&&(r.expire_on=s.date.decode(r.expire_on+" 00:00:00")),r.data=o.data,n.notify("popover.show","clientCouponDetail",{template:"booking-clientCoupon-tpl",$element:e(i.target),viewModel:r,afterShow:function(e){e.addClass("shown")},cls:"clientCoupon-detail",appendTo:".modal",placement:"bottom"})})},200))},hideCouponDetail:function(e,t){clearTimeout(this.couponPopoverTimeout),n.notify("popover.hide","clientCouponDetail")},showNewClient:function(t,i){clearTimeout(this.couponPopoverTimeout),this.couponPopoverTimeout=setTimeout(function(){n.notify("popover.show","newClient",{template:"booking-newClient-tpl",$element:e(i.target),viewModel:{},afterShow:function(e){e.addClass("shown")},cls:"clientCoupon-detail",appendTo:".modal",placement:"bottom"})},200)},hideNewClient:function(e,t){clearTimeout(this.couponPopoverTimeout),n.notify("popover.hide","newClient")},getDays:function(){var t=r.getDays(),n=r.getDaysShort(),i=e.map(t,function(e,t){return{index:t,name:e,nameShort:n[t]}});if(1==_reservio.weekStart){var o=i.shift();i.push(o)}return i},computeTpl:function(){return"eventRepeat-"+this.event.repeatType.temp()+"-tpl"},isDaySelected:function(e){return this.daysOptions().indexOf(e)>=0},dayClicked:function(e){var t=this.daysOptions().slice(0);this.isDaySelected(e)?(t.splice(t.indexOf(e),1),this.daysOptions(t)):(t.push(e),t.sort(),this.daysOptions(t))},decodeDays:function(e){for(var t=[],n=0,i=1;i<256;i*=2,n++)e&i&&t.push(n);return t},encodeDays:function(t){var n=0;return e.each(t,function(e,t){n+=1<<t}),n},readDaysOptions:function(){var e=this.event.repeatOptions.temp()||0;return this.decodeDays(e)},writeDaysOptions:function(e){this.event.repeatOptions(this.encodeDays(e))}}),d}),r("reservio/views/eventPopoverPreview",[],function(){var e=function(e){e=e||{},this.$element=e.$element,this.event=e.event};return e.prototype.editEventClicked=function(){},e}),r("reservio/pages/calendar",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/templates","reservio/lang","reservio/ajax","reservio/data","reservio/modules/tutorial","reservio/modules/roster","reservio/views/eventPopover","reservio/views/eventPopoverPreview","reservio/analytics","reservio/views/repeat","libs/fullcalendar"],function(n,i,o,r,a,s,l,c,u,d,p,f,h,g){return function(h,m){function v(e){var t=86400;return n.each(e,function(e,n){n.start<t&&(t=n.start)}),86400==t&&(t=32400),t}function b(e){1==e?C(!1):(C(!0),M&&r.notify("addEvent",M),E.selectedResourceId()&&E.selectedResourceId.notifySubscribers(E.selectedResourceId()),E.selectedServiceId()&&E.selectedServiceId.notifySubscribers(E.selectedServiceId())),n("#calendar .calendar-header").show();var t=D.find(".active-view .fc-event-added");if(t.length>0){var o=D.find(".active-view .overflow-content"),s=o.children();0==s.length&&(s=n("body")),(t.offset().top-s.offset().top<o.scrollTop()||t.offset().top-s.offset().top>o.scrollTop()+o.height())&&o.scrollTop(t.offset().top-s.offset().top-50)}if(E.highlightedEventId()){var l=D.fullCalendar("clientEvents",E.highlightedEventId());if(l=n.map(l,function(e){if(0==e.type||1==e.type||3==e.type)return e}),l.length>0)if(n.each(D.find(".fc-view .overflow-content"),function(){var e=n(this).find(".popover-holder");0==e.length&&(e=n("body")),(l[0].element.offset().top-e.offset().top<n(this).scrollTop()||l[0].element.offset().top-e.offset().top>n(this).scrollTop()+n(this).height())&&n(this).scrollTop(l[0].element.offset().top-e.offset().top-50)}),l[0].element.addClass("fc-event-active"),3==l[0].type)r.notify("popover.show","event",{$element:l[0].element,template:"event-popover-external-tpl",placement:k,viewModel:{},appendTo:".popover-holder",afterShow:y,afterHide:function(e){w(e)}}),C(!1);else if("appointment"==_reservio.categoryType&&l[0].unconfirmed>0){var c=l[0],p=c.bookings[0],h=p.contact;P=new a.Objects.Event({id:c.id,title:c.originalTitle,start:c.start,end:c.end,capacity:c.capacity,color:c.color,resource:i.utils.arrayFirst(u.resources(),function(e){return e.data.id()==c.resource_id}),service:i.utils.arrayFirst(u.services(),function(e){return e.data.id()==c.service_id}),bookings:[new a.Objects.Booking({id:p.id,note:p.note,created:p.created,state:p.state,isOverLimit:p.isOverLimit,clients_coupon_id:p.clients_coupon_id,is_first_booking:p.is_first_booking,client_name:p.client_name,contact:new a.Objects.Contact({id:h.id,name:h.name,email:h.email,phone:h.phone,fb_id:h.fb_id,fb_username:h.fb_username,isOverLimit:h.isOverLimit,is_deleted:h.is_deleted})})]}),P.bookingsLimitReached=l[0].bookingsLimitReached;var g=[];P.resource()&&P.resource().data.id()||(1==u.resources().length?P.resource(u.resources()[0]).commit():n.each(F,function(e,t){P.service().data.resources.indexOf(e)!=-1&&n.each(t,function(t,i){n.each(i,function(n,i){var o=new Date(+t+1e3*i.start),r=new Date(+t+1e3*i.end);P.start()>=o&&P.end()<=r&&g.push(e)})})})),C(!1);var v=new q(P);v.assignResourceItemRenderer=function(e,t){e.text(t.data.name()),g.indexOf(t.data.id())==-1,this.setListDirty()};var b=new f({event:P,app:m,calendar:D,calendarView:E,afterHide:function(){w()}});v.newViewModel=b,v.event.resource.temp.setOptions(v.resourcesByService(P.service().data.id())),r.notify("popover.show","event",{$element:l[0].element,template:"event-popover-unconfirmed-tpl",placement:k,viewModel:v,appendTo:".popover-holder",afterShow:y,afterHide:function(e){var t=d.getTutorial("newBooking");t.hideActualStep(),w(e)}})}else{var c=l[0];if("appointment"==_reservio.categoryType){var p=c.bookings[0],h=p.contact;P=new a.Objects.Event({id:c.id,event_id:c.event_id,title:c.originalTitle,start:c.start,end:c.end,capacity:c.capacity,color:c.color,resource:i.utils.findById(u.resources(),c.resource_id),service:i.utils.findById(u.services(),c.service_id),repeat_type:c.repeat_type,repeat_index:c.repeat_index,repeat_interval:c.repeat_interval,repeat_options:c.repeat_options,repeat_ends_type:c.repeat_ends_type,repeat_ends_on:c.repeat_ends_on,repeat_ends_after:c.repeat_ends_after,bookings:[new a.Objects.Booking({id:p.id,created:p.created,note:p.note,state:p.state,isOverLimit:p.isOverLimit,clients_coupon_id:p.clients_coupon_id,is_first_booking:p.is_first_booking,client_name:p.client_name,contact:new a.Objects.Contact({id:h.id,name:h.name,email:h.email,phone:h.phone,fb_id:h.fb_id,fb_username:h.fb_username,isOverLimit:h.isOverLimit,is_deleted:h.is_deleted})})]})}else"group"==_reservio.categoryType&&(P=new a.Objects.Event({id:c.id,event_id:c.event_id,title:c.originalTitle,start:c.start,end:c.end,capacity:c.capacity,color:c.color,cost:c.cost,"private":c["private"],minipage_url:c.minipage_url,description:c.description,resource:i.utils.findById(u.resources(),c.resource_id),service:i.utils.findById(u.services(),c.service_id),repeat_type:c.repeat_type,repeat_index:c.repeat_index,repeat_interval:c.repeat_interval,repeat_options:c.repeat_options,repeat_ends_type:c.repeat_ends_type,repeat_ends_on:c.repeat_ends_on,repeat_ends_after:c.repeat_ends_after,bookings:n.map(c.bookings,function(e){return new a.Objects.Booking({id:e.id,created:e.created,count:e.count,note:e.note,state:e.state,isOverLimit:e.isOverLimit,clients_coupon_id:e.clients_coupon_id,is_first_booking:e.is_first_booking,client_name:e.client_name,contact:new a.Objects.Contact({id:e.contact.id,name:e.contact.name,email:e.contact.email,phone:e.contact.phone,fb_id:e.contact.fb_id,fb_username:e.contact.fb_username,isOverLimit:e.contact.isOverLimit,is_deleted:e.contact.is_deleted})})})}));C(!1);var v=new q(P),b=new f({event:P,app:m,calendar:D,calendarView:E,afterHide:function(){w()}});v.event.resource.temp.setOptions(v.resources),v.event.service.temp.setOptions(v.services),v.newViewModel=b;var x=d.getTutorial("start");x.hideActualStep(),"appointment"==_reservio.categoryType?r.notify("popover.show","event",{$element:l[0].element,template:"event-popover-tpl",placement:k,viewModel:v,appendTo:".popover-holder",afterShow:y,afterHide:function(e){x.showNextStep("createdEvent"),w(e)}}):"group"==_reservio.categoryType&&b.show()}}}function y(e){z=!0,D.fullCalendar("option","selectable",!1),t(D.find(".fc-view")),n('.popover [name="name"]').focus()}function w(t){O&&(document.removeEventListener("click",O,!0),O=null),P=null,z=!1,D.fullCalendar("option","selectable",!0),D.fullCalendar("unselect"),D.find(".fc-event").removeClass("fc-event-active"),C(!0),e(D.find(".fc-view"));var n=d.getTutorial("start");n.showNextStep("createEventPopover"),E.highlightedEventId(0),x({eventId:0,contactId:0})}function x(e){e=e||{};var t=e.view||E.selectedView(),n=e.time||E.selectedTime(),i=o.undef(e.resourceId)?E.selectedResourceId():e.resourceId,r=o.undef(e.serviceId)?E.selectedServiceId():e.serviceId,a=o.undef(e.eventId)?E.highlightedEventId():e.eventId,s=(o.undef(e.contactId)?E.selectedContactId():e.contactId,"#/calendar/"+t+"/"+n+"/"+i+"/"+r+"/"+a+"/0");window.location.hash=s}function _(e){n(document).unbind("click",_),R?(C(!1),R.event.element.animate({left:R.left+"px",top:R.top+"px"},600,function(){R.event.start=R.start,R.event.end=R.end,R.event.resource_id=R.resource_id,D.fullCalendar("updateEvent",R.event),I=null,R=null,C(!0)})):I&&(C(!1),I.event.element.animate({left:R.left+"px",top:R.top+"px"},600,function(){I.event.start=I.start,I.event.end=I.end,I.event.resource_id=I.resource_id,D.fullCalendar("updateEvent",I.event),R=null,I=null,C(!0)}))}function C(e){e?D.find(".editable").removeClass("active"):D.find(".editable").addClass("active")}function k(e,t){function i(){var e=f+g/2-d/2;return e<b&&(v=-e+b+15),e=f+g/2+d/2,e+b>c&&(v=c-e-b-15),{side:"bottom",offset:v}}function o(){var e=f+g/2-d/2;return e<b&&(v=-e+b+15),e=f+g/2+d/2,e+b>c&&(v=c-e-b-15),{side:"top",offset:v}}function r(){var e=h+m/2-p/2;return e<y&&(v=-e+y),e=h+m/2+p/2,e+y>u&&(v=u-e-m/2-20),{side:"left",offset:v}}function a(){var e=h+m/2-p/2;return e<y&&(v=-e+y),e=h+m/2+p/2,e+y>u&&(v=u-e-m/2-20),{side:"right",offset:v}}var s=this.$element.parents(this.options.appendTo);0==s.length&&(s=n("body"));var l=D.offset(),c=D.width(),u=D.height();this.$tip.show();var d=this.$tip.width(),p=this.$tip.height(),f=this.$element.offset().left-l.left,h=this.$element.offset().top-l.top,g=this.$element.width(),m=this.$element.height(),v=(D.fullCalendar("getView"),0),b=n(".active-view .fc-agenda-axis.fc-first").first().outerWidth(),y=n(".active-view .fc-agenda-axis.fc-first").first().outerHeight();return h<y+20?y+h+m+p>u?f+g+d+30>c?r():a():i():y+h+m>u?o():f+g+d+30>c?f<=b?y+h+m+p>u?o():i():r():a()}r.notify("pageTitle",l.get("page-calendar-title"));var D,S,T,E={},M=!1,O=null,H=function(e){D.width()<170*u.resources().length?"resourceDay"==E.selectedView()&&D.fullCalendar("changeView","agendaDay"):"agendaDay"==E.selectedView()&&D.fullCalendar("changeView","resourceDay"),e.target==window&&r.notify("calendarHeight")},N=function(e){var t=e.target.tagName.toLowerCase();"input"==t||"textarea"==t||E.highlightedEventId()||z||(37==e.keyCode?E.prevClicked():39==e.keyCode&&E.nextClicked())};E.rendered=i.observable(!1);var P,A=null,R=null,I=null,z=!1,F={},L=function(e){var t=e.match(/(Day|Week|Month)/g);return t?t[0].toLowerCase():null},j=function(){var e=L(D.fullCalendar("getView").name||"week"),t="today"==E.selectedTime()?new Date:new Date(parseInt(E.selectedTime()));if("day"==e)return{start:t,end:new Date(t.getTime()+864e5)};if("week"==e){var n=t.getWeekStart();return{start:n,end:new Date(n.getTime()+6048e5)}}if("month"==e){var n=t.getWeekStart();return{start:n,end:new Date(n.getTime()+2592e6)}}return{start:0,end:0}};E.getDisplayedRange=j;"appointment"==_reservio.categoryType?E.views=["listDay","resourceDay","agendaWeek"]:E.views=["resourceDay","agendaWeek"],E.viewsLang=n.map(E.views,function(e){return l.get("page-calendar-views-"+e)}),E.selectedView=i.observable("agendaWeek"),E.selectedView.subscribe(function(e){r.notify("popover.hide","event"),D.fullCalendar("changeView",e),S.data("datePicker").setType(L(E.selectedView()))}),E.selectedViewType=i.computed(function(){if(this.selectedView()){var e=this.selectedView().match(/(Day|Week|Month)/g);if(e)return e[0].toLowerCase()}return null},E),E.changeViewClicked=function(){g.trackEventWithCounter("calendar","viewClicked"),g.trackEventWithCounter("calendar","viewClicked-"+this),x({view:this})},E.selectedTime=i.observable(),E.realSelectedTime=i.computed(function(){return"today"!=this.selectedTime()&&this.selectedTime()?new Date(parseInt(this.selectedTime())):new Date},E),E.displayedRange=i.computed(function(){var e=this.selectedViewType(),t=this.realSelectedTime();if(t.setHours(0,0,0,0),"day"==e)return{start:t,end:new Date(t.getTime()+864e5)};if("week"==e){var n=t.getWeekStart();return{start:n,end:new Date(n.getTime()+6048e5)}}if("month"==e){var n=t.getWeekStart();return{start:n,end:new Date(n.getTime()+2592e6)}}return{start:0,end:0}},E),E.displayedRange.subscribe(function(e){E.displayedRange.previous=e},null,"beforeChange"),E.selectedTime.subscribe(function(e){},null,"beforeChange"),E.selectedTime.subscribe(function(e){r.notify("popover.hide","event");var t=o.is_number(E.selectedTime())?new Date(parseInt(E.selectedTime())):new Date,n=E.displayedRange();S.data("datePicker").setDate(t),M&&t>=n.start&&t<n.end&&b(0),D.fullCalendar("gotoDate",t)}),E.selectedResourceId=i.observable(0),E.selectedResourceId.subscribe(function(e){r.notify("popover.hide","event"),D.fullCalendar("setSelectedResource",+e),D.fullCalendar("displayResourcesAvailability",+e)}),E.selectedServiceId=i.observable(0),E.selectedServiceId.subscribe(function(e){r.notify("popover.hide","event"),D.fullCalendar("setSelectedService",+e)}),E.resourceEditClicked=function(){return g.trackEventWithCounter("calendar","resourceEditClicked"),!0},E.serviceEditClicked=function(){return g.trackEventWithCounter("calendar","serviceEditClicked"),!0},E.dropdownShown=!1,E.dropdownPlacement=function(){this.$tip.show();var e=this.$tip.height(),t=this.$element.offset().top,i=this.$element.height(),o=n(document).height();return{side:e+t+i+20>o?"top":"bottom",offset:60}},E.resourceClicked=function(e,t){var i=n(t.target);i.hasClass("filter-dropdown-btn")?(g.trackEventWithCounter("calendar","resourceDropdownClicked"),E.dropdownShown?(r.notify("popover.hide","filterDropdown"),E.dropdownShown=!1,i.removeClass("active")):(i.addClass("active"),E.dropdownShown=!0,r.notify("popover.show","filterDropdown",{$element:i,template:"resource-dropdown-tpl",cls:"filter-dropdown-popover",placement:E.dropdownPlacement,viewModel:{resource:e,editResourceClicked:function(){return g.trackEventWithCounter("resourceDropdown","editResourceClicked"),!0},editRosterClicked:function(){g.trackEventWithCounter("resourceDropdown","editRosterClicked"),r.notify("popover.hide","filterDropdown"),p.show(e.data.id())},syncClicked:function(){g.trackEventWithCounter("resourceDropdown","syncClicked"),r.notify("popover.hide","filterDropdown"),m.acl.activateTrialFeature("synchronization","starter",function(){window.location.hash="#/synchronization"})}},afterHide:function(){E.dropdownShown=!1,i.removeClass("active")}})),t.stopPropagation()):(g.trackEventWithCounter("calendar","resourceFilterClicked"),x({resourceId:void 0===this.data?e:this.data.id()}))},E.syncClicked=function(){m.acl.activateTrialFeature("synchronization","starter",function(){window.location.hash="#/synchronization"})},E.serviceClicked=function(e,t){var i=n(t.target);i.hasClass("filter-dropdown-btn")?(g.trackEventWithCounter("calendar","serviceDropdownClicked"),E.dropdownShown?(r.notify("popover.hide","filterDropdown"),E.dropdownShown=!1,i.removeClass("active")):(i.addClass("active"),E.dropdownShown=!0,r.notify("popover.show","filterDropdown",{$element:i,template:"service-dropdown-tpl",cls:"filter-dropdown-popover",placement:E.dropdownPlacement,viewModel:{service:e,editServiceClicked:function(){return g.trackEventWithCounter("serviceDropdown","editServiceClicked"),!0},colorClicked:function(t){r.notify("popover.hide","filterDropdown"),c.post("/services/update/",{data:{id:e.data.id(),color:t}},function(){D.fullCalendar("refetchEvents")})}},afterHide:function(){E.dropdownShown=!1,i.removeClass("active")}})),t.stopPropagation()):(g.trackEventWithCounter("calendar","serviceFilterClicked"),x({serviceId:0===e?0:e.data.id()}))},E.selectedContactId=i.observable(),E.selectedContactId.subscribe(function(e){e>0&&E.createEventClicked(E,{stopPropagation:function(){},target:n("#calendar-create-event")[0]})}),E.toggleSettings=function(e,t){t&&t.stopPropagation();var i=n("#calendar-settings");i.toggle(),i.is(":visible")?n(document).bind("click",E.documentClick):n(document).unbind("click",E.documentClick)},E.calendarTitle=i.computed(function(){var e=this.selectedViewType(),t=this.displayedRange();return"week"==e?o.date.formatDates(t.start,new Date(t.end.getTime()-864e5),l.get("page-calendar-header-"+e)):o.date.formatDates(t.start,t.end,l.get("page-calendar-header-"+e))},E),E.todayClicked=function(e){g.trackEventWithCounter("calendar","todayClicked"),x({time:"today"})},E.prevClicked=function(e){g.trackEventWithCounter("calendar","prevClicked");var t="today"==E.selectedTime()?new Date:new Date(parseInt(E.selectedTime())),n=L(E.selectedView());"day"==n?t.setDate(t.getDate()-1):"week"==n?t.setTime(t.getTime()-6048e5):"month"==n&&t.setMonth(t.getMonth()-1),x({time:t.getTime()})},E.nextClicked=function(e){g.trackEventWithCounter("calendar","nextClicked");var t="today"==E.selectedTime()?new Date:new Date(parseInt(E.selectedTime())),n=L(E.selectedView());"day"==n?t.setDate(t.getDate()+1):"week"==n?t.setTime(t.getTime()+6048e5):"month"==n&&t.setMonth(t.getMonth()+1),x({time:t.getTime()})},E.printClicked=function(){m.acl.activateTrialFeature("printAgenda","starter",function(){if("free"==u.account().plan.code)m.acl.showUpgradeModal(l.get("modal-upgrade-print-title"),l.get("modal-upgrade-print-text"),"print.png","agendaPrint")();else{var e,t=null;e=u.resources.slice(0),e.unshift(new u.entities.ResourceNew({id:0,name:l.get("basic-allResources")})),1==u.resources().length&&(t=u.resources()[0]),g.trackEventWithCounter("print","modalShown");n("body").modal({template:"modal-print-tpl",cls:"print-form",viewModel:{language:l,resources:e,date:i.timeObservable(new Date),resource:i.observable(t).required("Please select resource").setOptions(e),eventHasOwnPage:i.observable(!1),addFreeSpace:i.observable(!1),printClicked:function(){var e=this,t=this.date.temp();if(this.resource.isValid(!0)){g.trackEventWithCounter("print","printClicked"),e.eventHasOwnPage()&&g.trackEventWithCounter("print","printOwnPage"),e.addFreeSpace()&&g.trackEventWithCounter("print","printFreeSpace");var n="/exporter/events/?start="+o.date.encodeDate(t)+"&end="+o.date.encodeDate(t)+"&resourceId="+e.resource().data.id()+"&eventHasOwnPage="+(e.eventHasOwnPage()?1:0)+"&addFreeSpace="+(e.addFreeSpace()?1:0);window.open(n,"reservio-agenda-print")}},cancelClicked:function(){n("body").modal("hide")}}}).modal("show")}})},E.highlightedEventId=i.observable(null),E.highlightedEventId.subscribe(function(e){r.notify("popover.hide","event"),0!=e&&null!=e&&("agendaWeek"!=E.selectedView()&&"resourceDay"!=E.selectedView()&&"agendaDay"!=E.selectedView()&&E.selectedView("agendaWeek"),b())});var B=function(e,t,i,r){a.Appointments.getAll(o.date.encode(e),o.date.encode(t),function(e){r(n.grep(e,function(e){return e.resource_id==i&&(0==e.type||1==e.type||3==e.type)}))})},W=function(e,t){B(e.start.temp(),e.end.temp(),e.resource.temp().data.id(),function(i){t(n.grep(i,function(t){return t.id!=e.id}).length>0)})},$=function(e){var t=e.start.temp(),i=e.end.temp();return n.grep(D.fullCalendar("clientEvents"),function(n){return n.resource_id==e.resource.temp().data.id()&&(0==n.type||1==n.type)&&n.id!=e.id&&(n.start>=t&&n.end<=i||n.start<=t&&n.end>t&&n.end<=i||n.start>=t&&n.start<i&&n.end>i||n.start<t&&n.end>i)}).length>0},q=function(e,t){var p=this;p.app=m,p.event=e,p.language=l,p.resources=u.resources.slice(0),p.resources.unshift(new u.entities.ResourceNew({name:l.get("basic-notAssigned")})),p.services=u.services.slice(0),p.services.unshift(new u.entities.ServiceNew({name:l.get("basic-notAssigned")})),e.resource()||e.resource(p.resources[0]),e.service()||e.service(p.services[0]),2==p.resources.length&&e.resource(p.resources[1]),2==p.services.length&&e.service(p.services[1]),p.durationChanged=!1,p.event.duration.subscribe(function(t){if(!p.durationChanged){var i=null;if(null===p.event.id)i=n(".fc-select-helper");else{var r=D.fullCalendar("clientEvents",p.event.id);r.length>0&&(i=n(r[0].element))}i&&(e.end.temp().setTime(e.start.temp().getTime()+1e3*t),t<900?(i.height(9),i.addClass("fc-event-smallslot")):(i.height(64*t/3600-5),i.removeClass("fc-event-smallslot")),i.find(".fc-event-time").text(o.date.formatDates(e.start.temp(),e.end.temp(),l.get("page-calendar-time"))))}}),e.id||(900==e.duration()&&e.service().data.id()?(e.duration(e.service().data.duration()),p.durationChanged=!0):(900!=e.duration()||e.service().data.id())&&(p.durationChanged=!0)),e.service.temp.subscribe(function(t){!p.durationChanged&&t.data.id()&&e.duration(t.data.duration())}),e.capacity()||e.capacity(e.service.temp().data.capacity()),p.isColliding=i.observable($(e));var h=function(){W(e,function(e){p.isColliding(e)})};e.start.temp.subscribe(h),e.end.temp.subscribe(h),e.resource.temp.subscribe(h);var v=new f({event:e,app:m,calendar:D,calendarView:E});v.saveRepeat=function(){e.repeatType.commit(),r.notify("popover.hideAlert","event")},v.cancelRepeat=function(){e.repeatType.reset(),e.repeatEndsType.reset(),e.repeatEndsAfter.reset(),e.repeatEndsOn.reset(),e.repeatInterval.reset(),e.repeatOptions.reset(),r.notify("popover.hideAlert","event")},p.contactTpl=function(){return p.event.bookings()[0].contact.temp().id()?"event-popover-contact-tpl":"event-popover-inputs-tpl"},e.resource.changed(!1),e.service.changed(!1),e.end.changed(!1),e.color.changed(!1),e.cost.changed(!1),e.capacity.changed(!1),p.cancelEvent=function(){p.event.cancel();var e=null;if(null===p.event.id)e=n(".fc-select-helper");else{var t=D.fullCalendar("clientEvents",p.event.id);t.length>0&&(e=n(t[0].element))}if(e){var i=p.event.end().getTimeS()-p.event.start().getTimeS();i<900?(e.height(19200/3600+5),e.addClass("fc-event-smallslot")):(e.height(64*i/3600-5),e.removeClass("fc-event-smallslot"))}m.log("eventPopoverCancel"),r.notify("popover.hide","event",!0)},O=function(e){var t=n(e.target);if((p.event.changed()||p.event.repeatChanged())&&!t.closest(".modal").length&&!t.closest(".popover").length){e.stopPropagation(),e.preventDefault();var i=n("body").modal({template:"modal-unsaved-data-tpl",viewModel:{title:l.get("modal-unsavedData-title"),text:l.get("modal-unsavedData-text"),continueClicked:function(e,t){t.stopPropagation(),i.modal("hide")},discardClicked:function(e,n){n.stopPropagation(),p.cancelEvent(),i.modal("hide");var o=t.closest("a");o.length>0&&""!=o.attr("href")&&(window.location.href=o.attr("href"))}}});i.modal("show")}},document.addEventListener("click",O,!0),p.hadRepeat=0!=e.repeatType(),p.saveEvent=function(){var e=this;null==e.id,e.start();if("appointment"==_reservio.categoryType){if(e.title(e.bookings()[0].contact().name.temp()),!e.bookings()[0].contact.temp().id()&&m.acl.clients.isOverLimit())return;var t=e.bookings()[0].contact();t.name.isValid()||g.trackEventWithCounter("eventForm","name-error"),t.email.isValid()||g.trackEventWithCounter("eventForm","email-error"),t.phone.isValid()||g.trackEventWithCounter("eventForm","phone-error"),e.resource.isValid()||g.trackEventWithCounter("eventForm","resource-error")}e.isValid()&&(p.hadRepeat&&e.id>0&&(e.changed()||e.repeatChanged())?c.get("/appointments/repeat-has-bookings/",{event_id:e.eventId,repeat_index:e.repeatIndex()},function(t){v.repeatHasBookings=t.data.repeat_has_bookings>0,r.notify("modal.show","eventChange",{template:e.repeatEndChanged()&&e.changed()&&!e.repeatChanged(!0)?"eventRepeatEndChange-tpl":"eventChange-tpl",viewModel:v})}):p.saveEvent2())},p.saveEvent2=function(){var a=n(".popover .btn.submit"),s=null==e.id;o.enableFormProcessingState(a),e.changed()||e.repeatChanged()?e.commit(function(n,c,u){if(n){if(r.notify("popover.hide","event"),D.fullCalendar("refetchEvents"),s){r.publish("showInformation",{text:l.get("alert-appointmentCreated").format({name:e.title()})}),"calendar"==t?g.trackEventWithCounter("calendar","eventCreatedByCalendar"):"button"==t&&g.trackEventWithCounter("calendar","eventCreatedByButton"),M=i.utils.unwrapVar(e);var d=j();e.start()>d.start&&e.end()<d.end&&b(0),x({time:e.start().getTime()})}else{"appointment"==_reservio.categoryType?r.publish("showInformation",{text:l.get("alert-appointmentUpdated").format({name:e.title()})}):r.publish("showInformation",{text:l.get("alert-eventSaved")}),M=i.utils.unwrapVar(e);var d=j();e.start()>d.start&&e.end()<d.end&&b(0),x({eventId:0}),g.trackEventWithCounter("calendar","eventEdited"),e.start.changed()&&setTimeout(function(){x({time:e.start().getTime()})},100)}o.disableFormProcessingState(a)}},function(){o.disableFormProcessingState(a)}):(o.disableFormProcessingState(a),r.notify("popover.hide","event"))},p.resourcesByService=function(e){return i.utils.arrayFilter(p.resources,function(t){return t.data.id&&t.data.services.indexOf(e)!=-1})},p.confirmRejectMessage=i.observable(""),p.confirmEvent=function(e,t){var i=D.fullCalendar("clientEvents",E.highlightedEventId());if(i){var o=i[0];if(o.resource_id=e.resource()?e.resource.temp().data.id():null,
o.resource_name=e.resource()?e.resource.temp().data.name():"",o.resource_id){var a=n(t.target);a.button("loading"),m.log("eventPopoverConfirm"),g.trackEventWithCounter("calendar","bookingConfirmed"),r.notify("approveAppointment",{id:o.bookings[0].id,resourceId:o.resource_id,resourceName:o.resource_name,message:p.confirmRejectMessage(),after:function(){o.bookings[0].state=1,o.unconfirmed--,o.editable=!0,D.fullCalendar("refetchEvents"),a.button("reset"),d.getTutorial("newBooking").showNextStep("confirmBooking"),r.notify("popover.hide","event")}})}else e.resource.errorMessage(l.get("error-bookingConfirmation-assignResource")),e.resource.hasError(!0)}},p.rejectEvent=function(e,t){var i=D.fullCalendar("clientEvents",E.highlightedEventId());if(i){var o=i[0],a=n(t.target);a.button("loading"),m.log("eventPopoverReject"),""==p.confirmRejectMessage()?g.trackEventWithCounter("calendar","bookingRejected"):g.trackEventWithCounter("calendar","bookingRejectedWithNote"),r.notify("rejectAppointment",{id:o.bookings[0].id,reason:p.confirmRejectMessage(),after:function(){r.notify("popover.hide","event"),D.fullCalendar("refetchEvents"),r.publish("showInformation",{text:l.get("alert-appointmentRejected")}),a.button("reset")}})}},p.deleteEvent=function(e,t){if(!e.id||null===e.eventId&&0!=+e.repeatIndex()||0==+e.repeatType()){var o=""!=e.bookings()[0].contact().email(),s=n("body").modal({template:"modal-delete-event-tpl",viewModel:{title:l.get("modal-deleteAppointment-title"),text:o?l.get("modal-deleteAppointmentReason-text"):l.get("modal-deleteAppointment-text"),clientHasEmail:o,message:i.observable(""),deleteClicked:function(e,t){var i=this,o=n(t.target);o.button("loading"),m.log("eventPopoverDelete"),a.Appointments.destroy({id:E.highlightedEventId(),reason:i.message()},function(e){r.notify("popover.hide","event"),""==i.message()?g.trackEventWithCounter("calendar","bookingDeleted"):g.trackEventWithCounter("calendar","bookingDeletedWithNote"),D.fullCalendar("refetchEvents"),r.publish("showInformation",{text:l.get("alert-appointmentDeleted").format({name:p.event.title()})}),o.button("reset"),s.modal("hide")})},cancelClicked:function(e,t){t.stopPropagation(),s.modal("hide")}}});n("body").modal("show")}else c.get("/appointments/repeat-has-bookings/",{event_id:e.eventId,repeat_index:e.repeatIndex()},function(e){v.repeatHasBookings=e.data.repeat_has_bookings>0,v.someoneHasEmail=!0,r.notify("modal.show","eventDelete",{template:"eventRepeatDelete-tpl",viewModel:v})})},p.noteTpl=function(){return p.event&&p.event.bookings().length&&""!=p.event.bookings()[0].note.temp()?"event-popover-edit-note-tpl":"event-popover-add-note-tpl"},p.editNote=function(){r.notify("popover.showAlert","event",{template:s.noteForm(80),bindings:function(){var e=this;n(e).find('[name="note"]').val(p.event.bookings()[0].note.temp()),n(this).find(".save").click(function(t){t.preventDefault(),r.notify("popover.hideAlert","event"),m.log("eventPopoverNoteEdit"),p.event.bookings()[0].note(n(e).find('[name="note"]').val())})},afterShow:function(){var e=this,t=n(e).find('[name="note"]'),i=function(){var i=1e3-t.val().length;p.event.bookings()[0].note.changed(!0),i<=0&&(i=0,t.val(t.val().substring(0,1e3))),n(e).find(".character-counter").text(l.get("basic-charactersLeft").format({count:i}))};t.focus().bind("keyup",i),i()}})},p.editRepeat=function(){r.notify("popover.showAlert","event",{template:n("#event-popover-edit-repeat-tpl").text(),bindings:function(){n(this).addClass("event-popover-repeat"),i.applyBindings(v,n(this)[0])}})},p.serviceOnSelect=function(e,t){p.event.service.temp(t),t.data.id()&&p.event.resource.temp.options.sort(function(e,n){var i=t.data.resources.indexOf(e.data.id())!=-1,o=t.data.resources.indexOf(n.data.id())!=-1;return e.data.id()?i===o?e.data.name()>n.data.name():i?-1:1:-1});var i=n("#frm-resource").data();return i&&i.selectBox.setListDirty(),!0},p.resourceOnSelect=function(e,t){p.event.resource.temp(t),t.data.id()&&p.event.service.temp.options.sort(function(e,n){var i=t.data.services.indexOf(e.data.id())!=-1,o=t.data.services.indexOf(n.data.id())!=-1;return e.data.id()?i===o?e.data.name()>n.data.name():i?-1:1:-1});var i=n("#frm-service").data().selectBox.setListDirty();return i&&i.selectBox.setListDirty(),!0},p.resourceItemRender=function(e,t){e.text(t.data.name()),!t.data.id()||null==p.event.service.temp().data.id()||"undefined"!=typeof t.data.services&&t.data.services.indexOf(p.event.service.temp().data.id())!=-1||e.addClass("disabled"),this.setListDirty()},p.serviceItemRender=function(e,t){e.text(t.data.name()),!t.data.id()||null==p.event.resource.temp().data.id()||"undefined"!=typeof t.data.resources&&t.data.resources.indexOf(p.event.resource.temp().data.id())!=-1||e.addClass("disabled"),this.setListDirty()},p.contactsItemTemplate='<li style="white-space: nowrap;text-overflow: ellipsis;"><span class="client-name"></span><span class="help-block" style="margin-left: 15px"></span></li>',p.contactsOnFetch=function(e){var t=e.data.clients;if(0==t.length){p.event.bookings()[0]}return t},p.contactClicked=function(e){r.notify("popover.hide","event"),window.location.hash="#/clients/detail/"+e.id()};var y=!1,w=function(e,t){var i=n(".popover"),o=(n(".active-view .fc-agenda-axis.fc-first").first().outerWidth(),n(".active-view .fc-agenda-axis.fc-first").first().outerHeight()),r=D.offset(),a=(D.width(),D.height()),s=(i.width(),i.height(),i.offset().left-r.left,i.offset().top-r.top),l=(i.width(),i.height());t&&(e*=-1),!y&&o+s+l+e>a&&(y=!0,i.animate({top:"-="+e+"px"},function(){y=!1}),i.hasClass("top")||i.find(".arrow2").animate({top:"+="+e+"px"},function(){y=!1}))};p.timeHasError=function(){},p.contactsOnRender=function(e,t){var n=[];""!=t.phone&&n.push(t.phone),""!=t.email&&n.push(t.email),e.find(".client-name").text(t.name),e.find(".help-block").text(n.join(", ")),n.unshift(t.name),e.attr("title",n.join(", "))},p.durationOnSelect=function(e,t){p.durationChanged=!0},p.contactsOnSelect=function(e,t){p.event.bookings()[0].id=null,p.event.bookings()[0].client_name=t.name,p.event.bookings()[0].contact.temp(new a.Objects.Contact({id:t.id,name:t.name,email:t.email,phone:t.phone,fb_id:t.fb_id,fb_username:t.fb_username})),p.event.bookings()[0].contact.commit(),p.event.bookingsChanged(!0),p.event.title.temp(t.name),p.showInputs(!1),w(0,!1)},p.showInputs=i.observable(!0),p.contactDelete=function(e,t){t.stopPropagation(),p.showInputs(!0),p.event.title.temp(""),p.event.bookings()[0].id=null,p.event.bookings()[0].contact.temp(new a.Objects.Contact)},p.afterRender=function(e){var t=D.find(".active-view .overflow-content").scrollTop();n(e).find('[name="name"]').focus(),D.find(".active-view .overflow-content").scrollTop(t),n(e).find(".icon-warning").tooltip({container:".popover-inner",cls:"error",placement:"top"})}};return E.createEventClicked=function(e,t){function o(e){if("appointment"==_reservio.categoryType){d.getTutorial("start").showNextStep("clickToCreateEventButton"),P=new a.Objects.Event({start:s,end:l,resource:i.utils.findById(u.resources(),E.selectedResourceId())||null,service:i.utils.findById(u.services(),E.selectedServiceId())||null,bookings:[new a.Objects.Booking({contact:e,client_name:""})]}),P.bookingsChanged(!0);var t=new q(P,"button");t.event.resource.temp.setOptions(t.resources),t.event.service.temp.setOptions(t.services),r.notify("popover.hide","event"),r.notify("popover.show","event",{$element:n("#calendar-create-event"),template:"event-popover-tpl",placement:"right-bottom",viewModel:t,cls:"by-button",afterShow:function(e){y(e),setInterval(function(){e.find(".tooltip.error").length>0&&d.getTutorial("start").hideActualStep()},200)},afterHide:function(e,n){var i=d.getTutorial("start");n?(i.showNextStep("createEventPopover",!0),i.showNextStep("createEventPopoverGroup",!0)):("appointment"==_reservio.categoryType&&(i.steps[2].placement=k,i.steps[2].onTooltipClicked=function(e){x({eventId:t.event.id})}),i.showNextStep("createEventPopover"),i.showNextStep("createEventPopoverGroup")),w(e)}})}else{P=new a.Objects.Event({start:s,end:l,resource:i.utils.findById(u.resources(),E.selectedResourceId())||null,service:i.utils.findById(u.services(),E.selectedServiceId())||null,capacity:20,bookings:[]});var t=new f({event:P,app:m,calendar:D,calendarView:E});d.getTutorial("start").showNextStep("clickToCreateEventButtonGroup"),r.notify("modal.show","editEvent",{template:"eventEdit-edit-tpl",viewModel:t,cls:"event-edit",afterShow:function(){n("#frm-event-name").focus()},afterHide:function(){M=P,w()}})}}if(m.log("createEventByButton"),!m.acl.bookings.isOverLimit()){t.stopPropagation();var s=new Date;s.setHours(parseInt(v(u.account().openingHours())/3600),0,0,0);var l=new Date(s.getTime()+9e5);e.selectedContactId()>0?a.Contacts.get({id:e.selectedContactId()},function(e){o(e.length>0?e[0]:new a.Objects.Contact)}):o(new a.Objects.Contact)}return!0},r.subscribe("viewSelect",function(e){E.selectedView(e)},this),r.subscribe("changeTime",function(e){E.selectedTime(e)},this),r.subscribe("resourceFilter",function(e){E.selectedResourceId(parseInt(e))},this),r.subscribe("serviceFilter",function(e){E.selectedServiceId(parseInt(e))},this),r.subscribe("highlightEvent",function(e){E.highlightedEventId(parseInt(e))},this),r.listen("calendarHeight",function(){D.fullCalendar("option","contentHeight",n(window).height()-D.offset().top)}),r.listen("addEvent",function(e){}),r.listen("removeEvent",function(e){D.fullCalendar("removeEvents",e)}),E.setHash=x,E.notifications=new function(){function e(e){t.hasRequests()||t.shown(!1),0==t.requestCnt&&t.requests().length>0&&(t.index=0,t.selectedRequest(t.requests()[t.index]),t.shown(!0)),t.requestCnt>t.requests().length&&(t.change("prev"),t.shown(!0));var n=t.requests().length;if(D&&n>t.requestCnt&&!P&&!+E.highlightedEventId()){var i=j(),r=t.requests()[n-1],a=o.date.decode(r.start);a>i.start&&a<i.end&&D.fullCalendar("refetchEvents")}t.requestCnt=t.requests().length}var t=this;this.requestCnt=0,this.index=0,this.animating=!1,this.requests=i.observableArray().subscribeTo("notifications",!0),this.selectedRequest=i.observable(),this.shown=i.observable(!1),this.requests.subscribe(e),this.hasRequests=i.computed({read:function(){return this.requests().length>0},deferEvaluation:!1,owner:t}),this.reservationsCountText=i.computed(function(){return l.getByCount("reservations",this.requests().length).format({count:this.requests().length})},this),this.hasRequests.subscribe(function(e){e?(d.getTutorial("newBooking").showActualStep("newBooking"),n("#canvas-scroll .paper").animate({top:"56px"},function(){t.shown(!0),r.notify("calendarHeight")})):n("#canvas-scroll .paper").animate({top:"0px"},function(){t.shown(!1),r.notify("calendarHeight")})}),this.highlight=function(e,n){if(n.stopPropagation(),_reservio.userRole.can_edit_events){var i=o.date.decode(t.selectedRequest().start);window.location.hash="#/calendar/agendaWeek/"+i.getTime()+"/0/0/"+t.selectedRequest().event_id+"/0",d.getTutorial("newBooking").showNextStep("newBooking"),g.trackEventWithCounter("calendar","highlightBookingRequestClicked")}},this.prevClicked=function(e,t){this.change("prev")},this.nextClicked=function(){this.change("next")},this.change=function(e){if(e=e||"next",!t.animating){t.animating=!0;var i=n(T).find(".calendar-notification-item");"prev"==e?i.css({opacity:1}).animate({top:"-10px",opacity:0},function(){i.css({top:"0px",display:"none"}),t.index--,t.index<0&&(t.index=t.requests().length-1),t.selectedRequest(t.requests()[t.index]),i.css({top:"10px",opacity:0,display:"block"}).animate({top:"0px",opacity:1},function(){t.selectedRequest(t.requests()[t.index]),t.animating=!1})}):i.css({opacity:1}).animate({top:"10px",opacity:0},function(){i.css({top:"0px",display:"none"}),t.index=(t.index+1)%t.requests().length,t.selectedRequest(t.requests()[t.index]),i.css({top:"-10px",opacity:0,display:"block"}).animate({top:"0px",opacity:1},function(){t.selectedRequest(t.requests()[t.index]),t.animating=!1})})}},e()},h.afterRender=function(e){D=n("#calendar .calendar-content"),S=n("#month-cal"),T=n("#calendar-notifications");var t=o.is_number(E.selectedTime())?new Date(parseInt(E.selectedTime())):new Date,p=i.toJS(u.resources());p.length>1&&p.push(i.toJS(new u.entities.ResourceNew({id:-1,name:l.get("basic-notAssigned")}))),D.fullCalendar({date:t.getDate(),month:t.getMonth(),year:t.getFullYear(),header:!1,firstDay:_reservio.weekStart,defaultView:"agendaWeek",allDaySlot:!1,startTime:v(u.account().openingHours()),minTime:"0:00",maxTime:"24:00",columnFormat:l.get("page-calendar-column"),timeFormat:o.date.getTimeRangePattern(_reservio.timeFormat),axisFormat:"'<span>'"+o.date.getTimePattern(_reservio.timeFormat,!0)+"'</span>'",editable:_reservio.userRole.can_edit_events,lazyFetching:!1,noEventsText:l.get("mobile-noEvents"),events:function(e,t,r){var s=o.date.encode(e).substring(0,10),l=o.date.encode(t).substring(0,10);a.Appointments.getAll(s,l,function(t){var a=1440;if(n.each(t,function(e,t){t.start=o.date.decode(t.start),t.end=o.date.decode(t.end),t.start.getTime()==t.end.getTime()&&(t.end=new Date(t.start.getTime()+9e5));var r=60*t.start.getHours()+t.start.getMinutes();if(r<a&&(a=r),t.repeat_ends_on&&(t.repeat_ends_on=o.date.decode(t.repeat_ends_on)),0==t.type||1==t.type){var s=0;n.each(t.bookings,function(e,t){t.created=o.date.decode(t.created),s+=+t.count}),"group"==_reservio.categoryType?(t.originalTitle=t.title,t.title=t.title+" ("+s+"/"+t.capacity+")"):t.bookings.length>0&&(t.title=t.bookings[0].client_name)}var l=i.bindingHandlers.colorPicker.colors[+t.color];l=l?l.hex:t.color&&"#"==t.color[0]?t.color:i.bindingHandlers.colorPicker.colors[0].hex,t.backgroundColor=l,t.borderColor=o.shadeColor(l,-30)}),!d.getTutorial("start").isAccomplished()){var s=new Date(e.getWeekStart().getTime()+864e5);s.setHours(12,0,0,0)}r(t||[]),"group"==_reservio.categoryType&&a<1440&&setTimeout(function(){n("#calendar .overflow-content").scrollTop(a*n("#calendar .overflow-content > div").height()/1440-15)},50)})},selectable:_reservio.userRole.can_create_events,selectHelper:!0,slotMinutes:15,select:function(e,t,o,s,l){if(P||!_reservio.userRole.can_create_events)return void D.fullCalendar("unselect");if("appointment"==_reservio.categoryType&&m.acl.bookings.isOverLimit(!1))return D.fullCalendar("unselect"),void m.acl.bookings.showModal();m.log("createEventByCalendar"),s.stopPropagation(),D.find(".fc-select-helper").click(function(e){e.stopPropagation()});var c=i.utils.findById(u.resources(),l);if("appointment"==_reservio.categoryType){P=new a.Objects.Event({start:e,end:t,resource:c||i.utils.findById(u.resources(),E.selectedResourceId())||null,service:i.utils.findById(u.services(),E.selectedServiceId())||null,bookings:[new a.Objects.Booking({contact:new a.Objects.Contact,client_name:""})]});var d=new q(P,"calendar");d.event.resource.temp.setOptions(d.resources),d.event.service.temp.setOptions(d.services),r.notify("popover.disable","event"),r.notify("popover.show","event",{$element:D.find(".fc-select-helper"),template:"event-popover-tpl",placement:k,viewModel:d,appendTo:".popover-holder",afterShow:function(e){setTimeout(function(){r.notify("popover.enable","event")},200),y(e)},afterHide:w}),C(!1)}else{P=new a.Objects.Event({start:e,end:t,resource:c||i.utils.findById(u.resources(),E.selectedResourceId())||null,service:i.utils.findById(u.services(),E.selectedServiceId())||null,capacity:20,bookings:[]});var d=new f({event:P,app:m,calendar:D,calendarView:E,afterShow:function(){n("#frm-event-name").focus()},afterHide:function(){w()}});d.editEvent()}P.bookingsChanged(!0)},unselectAuto:!1,unselect:function(e,t,n){r.notify("popover.hide","event")},eventAfterRender:function(e,t,i){var r=n(t);e.element=r,e.element.attr("id","fc-event-"+e.id),e.width=e.element.width(),e.height=e.element.height(),M&&e.id==M.id&&(e.element.addClass("fc-event-added"),setTimeout(function(){e.element.removeClass("fc-event-added"),M=!1},1e3));var a=n('<div class="fc-event-icons"></div>');if(1==e["private"]&&a.append('<i class="icon icon-private"></i>'),0!=e.repeat_type,2==e.type,r.find(".fc-event-inner").prepend(a),0==e.type||1==e.type){e.unconfirmed=0,e.canceled=0,e.bookingsLimitReached&&(e.element.addClass("fc-event-limited"),e.editable=!1);var s,c,d=e.bookings.length;for(s=0;s<d;s++)c=e.bookings[s],0==c.state&&(e.element.addClass("fc-event-unconfirmed"),e.unconfirmed+=1,e.editable=!1),2==c.state&&(e.element.addClass("fc-event-canceled"),e.canceled+=1);var p=u.services.find(e.service_id),f=u.resources.find(e.resource_id);"listDay"==i.name?("undefined"!=typeof e.clients&&e.clients.length>0&&""!=e.clients[0].note&&e.element.find(".note").text(e.clients[0].note),e.element.find(".time").text(o.date.formatDate(e.start,l.get("time-time"))),e.element.find(".detail").text(l.get("basic-serviceResource").format({service:p?p.data.name():null,employee:f?f.data.name():null})),e.element.find(".title a").text(e.title).attr("href","#/clients/detail/"+e.bookings[0].contact.id)):0==e.type&&e.service_id&&p&&e.element.find(".fc-event-time").append("<br /><p style='font-size: 9px;line-height: 10px;'>"+o.encodeHTML(p.data.name())+"</p>")}else if(3==e.type)e.editable=!1,e.element.addClass("fc-event-external");else if(2==e.type){e.editable=!1,e.element.addClass("fc-event-holiday");for(var h=e.element.find(".fc-event-content"),s=0;s<5;s++)h.after(h.clone())}E.highlightedEventId()==e.id&&e.element.addClass("fc-event-active")},eventClick:function(e,t){return t.stopPropagation(),m.log("eventDetail"),_reservio.userRole.can_edit_events&&("appointment"==_reservio.categoryType&&e.bookingsLimitReached&&0==e.unconfirmed?m.acl.bookings.showModal():R?(r.notify("popover.hide","event"),_()):2==e.type?window.location.hash="#/business/holidays/form/"+e.id.substr(7):x({eventId:e.id})),!1},loading:b,eventDrop:function(e,t,c,u,d,p,f){var h=e.element.offset(),v=e.element.parents(".popover-holder").offset();m.log("eventMoved"),A={event:e,start:new Date(e.start.getTime()),end:new Date(e.end.getTime()),resource_id:e.resource_id,left:h.left-v.left,top:h.top-v.top},g.trackEventWithCounter("calendar","eventDragAndDrop");new Date(1e3*(e.start.getTimeS()-86400*t-60*c));I&&I.event.id!=e.id?(C(!1),I.event.element.animate({left:I.left+"px",top:I.top+"px"},600,function(){I.event.start=I.start,I.event.end=I.end,I.event.resource_id=I.resource_id,D.fullCalendar("updateEvent",I.event),C(!0)})):D.fullCalendar("updateEvent",e);var b=(s.sendEmailsForm(),D.fullCalendar("getView"),function(){var s=this;s.isColliding=i.observable(!1),B(A.start,A.end,A.resource_id,function(t){s.isColliding(n.grep(t,function(t){return t.id!=e.id}).length>0)}),s.sendEmail=i.observable(!1),s.rechedule=function(i,u){var d=n(u.target);d.button("loading");var p=function(){r.notify("popover.hide","event"),I=null,R=null,d.button("reset"),r.notify("popover.hide","event"),"appointment"==_reservio.categoryType?r.publish("showInformation",{text:l.get("alert-appointmentMoved").format({name:e.title,to:o.date.formatDate(e.start,l.get("time-datetime")),from:o.date.formatDate(new Date(e.start.getTime()-24*t*60*60*1e3-60*c*1e3),"MMMM d, HH:mm")})}):r.publish("showInformation",{text:l.get("alert-eventRescheduled").format({name:e.title,to:o.date.formatDate(e.start,l.get("time-datetime")),from:o.date.formatDate(new Date(e.start.getTime()-24*t*60*60*1e3-60*c*1e3),"MMMM d, HH:mm")})}),D.fullCalendar("refetchEvents")};a.Appointments.update({id:e.id,start:o.date.encode(e.start),end:o.date.encode(e.end),resource_id:e.resource_id,resource_name:e.resource_name,send_notification:s.sendEmail()},function(e){p()})},s.cancel=function(){r.notify("popover.hide","event")}});if(0!=t||0!=c){var x="event-popover-reschedule-no-email-tpl";n.each(e.bookings,function(){if(""!=this.contact.email)return x="event-popover-reschedule-tpl",!1}),C(!1),e.element.addClass("fc-event-active"),n(document).bind("click",_),r.notify("popover.show","event",{$element:e.element,template:x,placement:k,viewModel:new b,appendTo:".popover-holder",afterShow:function(e){e.click(function(e){e.stopPropagation()}),y(e)},afterHide:w})}else{var S=function(){I=null,R=null,"appointment"==_reservio.categoryType?r.publish("showInformation",{text:l.get("alert-appointmentUpdated").format({name:item.title()})}):r.publish("showInformation",{text:l.get("alert-eventSaved")})};a.Appointments.update({id:e.id,resource_id:e.resource_id,resource_name:e.resource_name},function(e){S()})}},eventDragStart:function(e,t,n,i){var o=e.element.offset(),a=e.element.parents(".popover-holder").offset();r.notify("popover.hide","event"),R?R.event.id!=e.id?(I=R,R={event:e,start:new Date(e.start.getTime()),end:new Date(e.end.getTime()),resource_id:e.resource_id,left:o.left-a.left,top:o.top-a.top,eOffset:o}):I={event:e,start:new Date(e.start.getTime()),end:new Date(e.end.getTime()),resource_id:e.resource_id,left:o.left-a.left,top:o.top-a.top,eOffset:o}:R={event:e,start:new Date(e.start.getTime()),end:new Date(e.end.getTime()),resource_id:e.resource_id,left:o.left-a.left,top:o.top-a.top,eOffset:o}},eventDragStop:function(e){var t=e.element.offset();R.eOffset.top==t.top&&R.eOffset.left==t.left&&(R=null,I=null);var n=u.services.find(e.service_id);n&&e.element.find(".fc-event-time").text(e.title).append("<br /><p style='font-size: 9px;line-height: 10px;'>"+n.data.name()+"</p>")},dayNames:l.getDays(),dayNamesShort:l.getDaysShort(),monthNames:l.getMonths(),resources:p,availability:function(e,t,i,r){c.get("/account/availability/",{start:o.date.encodeDate(e),end:o.date.encodeDate(t)},function(e){var t={};n.each(e.data.availability,function(e,i){t[e]={},n.each(i,function(n,i){t[e][o.date.decodeDate(n).getTime()]=i})}),t[-1]=t[0],F=t,r(t)})},compactWidth:700,compactColumnFormat:{week:"ddd '<strong>'d'</strong>'",day:"dddd '<strong>'d'</strong>'"},currentTimeIndicator:!0,dragRevertDuration:500,contentHeight:n(window).height()-D.offset().top-36,eventResizeStart:function(e,t,i,o){R&&(_(),r.notify("popover.hide","event"),n(this).resizable("widget").trigger("mouseup"),n("body").css("cursor","auto"))},eventResizeActual:function(e,t,n){P&&P.duration(e)},eventResize:function(e,t,n,i,s,c,u){if(m.log("eventResized"),R)i();else{g.trackEventWithCounter("calendar","eventResized");var d=o.date.encode(e.end);0!=d?a.Appointments.update({id:e.id,start:o.date.encode(e.start),end:d},function(){r.publish("showInformation",{text:l.get("alert-appointmentDurationChanged").format({name:e.title,duration:o.date.formatDuration(e.end.getTimeS()-e.start.getTimeS())})})}):m.log("eventResizedError")}}}),S.datePicker({dayClick:function(e){g.trackEventWithCounter("calendarPicker","dayClicked"),m.log("datePickerClicked",e),x({time:e.getTime(),eventId:0})},dayDblClick:function(e){g.trackEventWithCounter("calendarPicker","dayDoubleClicked"),E.selectedView().indexOf("Day")>=0?x({view:"agendaWeek",time:e.getTime()}):E.selectedView().indexOf("Week")>=0&&x({view:"resourceDay",time:e.getTime()})},monthNames:l.getMonthsForm1(),dayNames:l.getDaysShort(),firstDay:_reservio.weekStart,type:"week"}),1==u.resources().length&&D.fullCalendar("displayResourcesAvailability",u.resources()[0].data.id()),n("#filters").scrollbar({handleResize:!0}),d.getTutorial("start").steps[0].onTooltipClicked=function(e){E.createEventClicked(E,e)},n(document).bind("keydown",N),n(window).bind("resize",H),r.notify("viewLoaded")},h.destroy=function(){n(document).unbind("keydown",N),n(window).unbind("resize",H),n("#calendar").remove(),n(".popover").remove()},h.hashParamsChanged=function(e){if(e.view&&E.selectedView(e.view),e.time){if("today"!=e.time){var t=new Date(parseInt(e.time));t.setHours(0,0,0,0),e.time=t.getTime()}e.time!=E.selectedTime()&&E.selectedTime(e.time)}e.resource_id&&E.selectedResourceId(+e.resource_id),e.service_id&&E.selectedServiceId(+e.service_id),e.event_id&&E.highlightedEventId(e.event_id),e.contact_id&&E.selectedContactId(parseInt(e.contact_id))},E}}),r("reservio/pages/clients",["jquery","ko","reservio/utils","reservio/models","postbox","reservio/lang","reservio/data","reservio/modules/tutorial","reservio/analytics","reservio/ajax"],function(e,t,n,i,o,r,a,s,l,c){return function(n,s){o.notify("pageTitle",r.get("menu-clients"));var u={};u.tpl=t.observable("clientsList-tpl"),u.data=a,u.levenshtein=function(e,t){var n=[],i=e.length,o=t.length;if(0==i)return o;if(0==o)return i;for(var r=i;r>=0;r--)n[r]=[];for(var r=i;r>=0;r--)n[r][0]=r;for(var a=o;a>=0;a--)n[0][a]=a;for(var r=1;r<=i;r++)for(var s=e.charAt(r-1),a=1;a<=o;a++){if(r==a&&n[r][a]>4)return i;var l=t.charAt(a-1),c=s==l?0:1,u=n[r-1][a]+1,d=n[r][a-1]+1,p=n[r-1][a-1]+c;d<u&&(u=d),p<u&&(u=p),n[r][a]=u,r>1&&a>1&&s==t.charAt(a-2)&&e.charAt(r-2)==l&&(n[r][a]=Math.min(n[r][a],n[r-2][a-2]+c))}return n[i][o]},u.clientsLoading=t.observable(!1),u.clientCount=t.observable(0),u.clients=t.observableArray([]),u.limit=50,u.page=t.observable(1),u.filterClicked=function(){l.trackEventWithCounter("clients","filterClicked")},u.fetchClients=function(){u.limit=50,u.page(1);var t={limit:u.limit,page:u.page()};""!=s.clientsFilter()&&(t.query=s.clientsFilter()),i.Contacts.get(t,function(t){u.clients(t.clients),s.acl.clients.count(t.totalCount),u.clientCount(t.resultCount),e("#clients-filter").focus(),u.clientsLoading(!1),n.loading(!1)})},u.fetchNextPageClients=function(){u.page(u.page()+1);var t={limit:u.limit,page:u.page()};""!=s.clientsFilter()&&(t.query=s.clientsFilter()),i.Contacts.get(t,function(t){u.clients.push.apply(u.clients,t.clients),e("#clients-filter").focus(),u.clientsLoading(!1),n.loading(!1)})},u.showCouponDetail=function(t,n){var i=this;clearTimeout(this.couponPopoverTimeout),this.couponPopoverTimeout=setTimeout(function(){c.get("/api/internal/clients-coupons/"+t.clients_coupons()[0].id+"/",{fields:"id,created,visits,expire_on,credit,times_used,coupon(id,type,title,description,cost,visits,expire_after,expire_after_units,credit)"},function(t){var r=t.data;0==r.coupon.type&&(r.expire_on=utils.date.decode(r.expire_on+" 00:00:00")),r.data=i.data,o.notify("popover.show","clientCouponDetail",{template:"booking-clientCoupon-tpl",$element:e(n.target),viewModel:r,afterShow:function(e){e.addClass("shown")},cls:"clientCoupon-detail",appendTo:".modal",placement:"bottom"})})},200)},u.hideCouponDetail=function(e,t){clearTimeout(this.couponPopoverTimeout),o.notify("popover.hide","clientCouponDetail")};var d=null;return n.afterRender=function(e){u.clientsLoading(!0),u.fetchClients(),d=s.clientsFilter.subscribe(function(){u.fetchClients()})},n.destroy=function(){window.location.hash.indexOf("#/clients")==-1&&s.clientsFilter(""),d&&d.dispose()},n.hashParamsChanged=function(e){s.clientsFilter("")},n.scroll=function(e){"bottom"==e&&u.fetchNextPageClients()},u}}),r("reservio/views/clientAddCoupon",["jquery","ko","postbox","reservio/utils","reservio/data","reservio/ajax","reservio/lang"],function(e,t,n,i,o,r,a){var s=function(e){this.data=o,this.language=a,this.coupons=o.coupons,this.clientId=e.clientId,this.coupon=t.observable(this.coupons()[0]),this.onCouponSelect=e.onCouponSelect,this.expireOn=t.timeObservable(new Date((new Date).getTime()+108e6)),this.hasExpiration=t.observable(!1),this.useCoupon=t.observable(!1),this.couponTpl=this.couponTpl.bind(this)};return s.prototype.show=function(){var e=this;this.coupons.load(function(){e.coupon.setOptions(e.coupons()),n.notify("modal.show","clientAddCoupon",{template:"clientAddCoupon-tpl",cls:"clientAddCoupon",viewModel:e})})},s.prototype.cancelClicked=function(e){n.notify("modal.hide","clientAddCoupon")},s.prototype.couponTpl=function(){return"clientAddCoupon-"+this.coupon().type()+"-tpl"},s.prototype.saveClicked=function(){var e=this;r.post("/api/internal/clients-coupons/",{client_id:this.clientId,coupon_id:this.coupon().id(),expire_after:this.coupon().expire_after(),expire_after_units:this.coupon().expire_after_units(),expire_on:i.date.encode(this.expireOn.temp()),has_expiration:this.hasExpiration(),credit:this.coupon().credit(),visits:this.coupon().visits(),useCoupon:this.useCoupon()?1:0},function(){n.notify("modal.hide","clientAddCoupon"),e.onCouponSelect(e.coupon())})},s}),r("reservio/views/clientEditCoupon",["jquery","ko","postbox","reservio/data","reservio/ajax","reservio/lang","reservio/utils"],function(e,t,n,i,o,r,a){var s=function(e){this.data=i,this.language=r,this.clientId=e.clientId,this.clientCoupon=t.observable(e.clientCoupon),this.couponTpl=this.couponTpl.bind(this),this.expireOn=t.timeObservable(e.clientCoupon.expire_on()),this.hasExpiration=t.observable(e.has_expiration)};return s.prototype.show=function(){var e=this;n.notify("modal.show","clientEditCoupon",{template:"clientEditCoupon-tpl",cls:"clientEditCoupon",viewModel:e})},s.prototype.cancelClicked=function(e){n.notify("modal.hide","clientEditCoupon")},s.prototype.couponTpl=function(){return"clientEditCoupon-"+this.clientCoupon().type()+"-tpl"},s.prototype.saveClicked=function(){o.put("/api/internal/clients-coupons/"+this.clientCoupon().clientCouponId()+"/",{expire_after:this.clientCoupon().expire_after(),expire_after_units:this.clientCoupon().expire_after_units(),credit:this.clientCoupon().credit(),visits:this.clientCoupon().visits(),has_expiration:this.hasExpiration(),expire_on:a.date.encodeDate(this.expireOn.temp())},function(){n.notify("modal.hide","clientEditCoupon"),window.location.reload()})},s}),r("reservio/pages/clientsDetail",["jquery","ko","reservio/utils","reservio/models","postbox","reservio/lang","reservio/data","reservio/modules/tutorial","reservio/analytics","reservio/views/clientAddCoupon","reservio/views/clientEditCoupon","reservio/ajax"],function(e,t,n,i,o,r,a,s,l,c,u,d){return function(n,p){o.notify("pageTitle",r.get("menu-clients"));var f={};f.tpl=t.observable("clients-detail-tpl"),f.leftColTpl=t.observable("clients-list-tpl"),f.title=t.observable(""),f.clientId=t.observable(),f.client=t.observable(),f.client.subscribe(function(e){f.title(e&&null!=e.id()?r.get("page-clients-edit-title"):r.get("page-clients-add-title"))}),f.backToClientListClicked=function(){p.clientsFilter(""),window.location.hash="#/clients"},f.saveClient=function(){var e=this,t=null==e.id();p.log(t?"clientCreate":"clientEdit"),f.birthMonth()&&f.birthDate()?e.birthday(new Date((new Date).getFullYear(),f.birthMonth()-1,f.birthDate())):f.birthMonth()||f.birthDate()||e.birthday(null),f.birthMonth.isValid(!0)&&e.commit(function(){t&&p.acl.clients.count(p.acl.clients.count()+1),l.trackEventWithCounter("clientForm",t?"clientCreated":"clientEdited"),o.publish("showInformation",{text:r.get(t?"alert-clientSaved":"alert-changesSaved")}),window.location.hash="#/clients/detail/"+e.id()})},f.cancelClient=function(e,t){t.preventDefault(),e.cancel(),null===e.id()?(f.client(null),window.location.hash="#/clients"):(e.cancel(),window.location.hash="#/clients/detail/"+e.id())},f.historyLimitReached=t.computed(function(){return!!f.client()&&null!=t.utils.arrayFirst(f.client().history(),function(e){return 1==e.historyLimitReached})}),f.itemEditing=t.observable(),f.editItemClicked=function(t,n){f.itemEditing(t),e(".add-note-to-client textarea").focus()},f.cancelItemClicked=function(){f.itemEditing(null)},f.noteSaveClicked=function(){f.itemEditing().commit(function(){o.publish("showInformation",{text:r.get("alert-clientNoteSaved")}),f.itemEditing(null),l.trackEventWithCounter("clientDetail","noteEdited")})},f.itemAdd=function(t){1!==t.nodeType||f.client().history.loading()||e(t).hide().slideDown()},f.itemRemove=function(t){1===t.nodeType&&e(t).slideUp(function(){e(t).remove()})},f.deleteItemClicked=function(t){var n=e("body").modal({template:"modal-delete-tpl",viewModel:{title:r.get("modal-deleteClientNote-title"),text:"",item:t,deleteClicked:function(i,a){var s=e(a.target);s.button("loading"),t.destroy(function(){o.publish("showInformation",{text:r.get("alert-clientNoteDeleted")}),l.trackEventWithCounter("clientDetail","noteDeleted"),s.button("reset"),n.modal("hide"),f.client().history.remove(t)})},cancelClicked:function(){n.modal("hide")}}});e("body").modal("show")},f.templateToUse=function(e){return"note"==e.type?e===f.itemEditing()?"block-story-note-edit-tpl":"block-story-note-tpl":"coupon"==e.type?"block-story-coupon-tpl":e.bookingsLimitReached?"block-story-overLimit-tpl":"block-story-no-photo-tpl";
},f.addNoteText=t.observable(""),f.addNoteActive=t.observable(!1),f.addNoteClicked=function(){f.addNoteActive(!0),e("#client-note").focus(),s.getTutorial("clientNote").showNextStep("clientNote")},f.closeNoteClicked=function(){f.addNoteActive(!1)},f.addNoteSubmit=function(e){var t=new a.entities.Note({text:f.addNoteText(),clientId:f.client().id()});t.commit(function(){l.trackEventWithCounter("clientDetail","noteCreated"),f.client().history().push(t),f.client().history.notifySubscribers(),f.addNoteText(""),o.publish("showInformation",{text:r.get("alert-clientNoteSaved")})})},f.destroy=function(t){var n=e("body").modal({template:"modal-delete-tpl",viewModel:{title:r.get("modal-deleteClient-title"),text:r.get("modal-deleteClient-text").format({name:t.name()}),item:t,deleteClicked:function(i,a){var s=e(a.target);s.button("loading"),t.destroy(function(){p.acl.clients.count(p.acl.clients.count()-1),l.trackEventWithCounter("clientDetail","clientDeleted"),o.publish("showInformation",{text:r.get("alert-clientDeleted").format({name:t.name()})}),s.button("reset"),n.modal("hide"),f.client(null),window.location.hash="#/clients"})},cancelClicked:function(){n.modal("hide")}}});e("body").modal("show")},f.makeReservation=function(){p.acl.bookings.isOverLimit()||(window.location.hash="#/calendar/agendaWeek/today/0/0/0/"+this.id()),l.trackEventWithCounter("clientDetail","createBookingClicked")},f.documentClick=function(){f.toggleActionsBar()},f.addCouponClicked=function(){if("free"==a.account().plan.code||"starter"==a.account().plan.code||0==a.coupons().length||0==a.coupons().length)window.location.hash="#/business/coupons";else{var e=new c({clientId:this.id(),onCouponSelect:function(e){window.location.reload()}});e.show()}},f.editCouponClicked=function(){if("free"==a.account().plan.code||"starter"==a.account().plan.code||0==a.coupons().length||0==a.coupons().length)window.location.hash="#/business/coupons";else{this.clientCouponId=this.id;var e=new a.entities.Coupon({id:this.coupon.id,clientCouponId:this.id,visits:this.visits,credit:this.credit,expire_on:this.expire_on,type:this.coupon.type}),t=new u({clientCoupon:e,has_expiration:this.has_expiration});t.show()}},f.deleteCouponClicked=function(e){o.notify("modal.show","clientCouponDelete",{template:"modal-delete-tpl",viewModel:{title:r.get("modal-clientCouponDelete-title"),text:r.get("modal-clientCouponDelete-text"),item:{saving:t.observable(!1)},deleteClicked:function(){var t=this;t.item.saving(!0),d["delete"]("/api/internal/clients-coupons/"+e.id+"/",function(){t.item.saving(!1),window.location.reload(),o.notify("modal.hide","clientCouponDelete")})},cancelClicked:function(){o.notify("modal.hide","clientCouponDelete")}}})},f.additionalInfoVisible=t.computed(function(){var e=f.client();return e&&(""!=e.address()||null!=e.gender()||""!=e.note()||""!=e.birthday.date()||e.clients_coupons().length>0)}),f.toggleActionsBar=function(t,n){n&&n.stopPropagation();var i=e("#client-actions-bar");i.toggle(),i.is(":visible")?e(document).bind("click",f.documentClick):e(document).unbind("click",f.documentClick)};var h=function(e,t,n){n=n||function(e){return e};var i=[];i.push({value:0,text:"--"});for(var o=e;o<=t;o++)i.push({value:o,text:n(o)});return i},g=r.getMonths();return f.birthDate=t.observable(0).setOptions(h(1,31),"value"),f.birthMonth=t.observable(0).setOptions(h(1,12,function(e){return g[e-1]}),"value").addValidator("birthday",function(){return!!f.birthMonth()==!!f.birthDate()},r.get("page-clients-edit-birthday-error")),n.afterRender=function(e){o.notify("viewLoaded")},n.scroll=function(e){"bottom"==e&&f.client().history.load()},n.hashParamsChanged=function(t){if(t.id&&(f.addNoteActive(!1),"add"==t.id?p.acl.clients.isOverLimit()?window.location.hash="#/clients":f.client(new i.Objects.Contact):i.Contacts.get({id:t.id},function(e){var t=e.clients;if(t.length>0){var n=t[0];if(n.isOverLimit)window.location.hash="#/clients",p.acl.showUpgradeModal(r.get("modal-upgrade-clientsReached-title"),r.get("modal-upgrade-clientsReached-text"),"clients-2.png")();else{if(f.client(n),n.birthday()){var i=n.birthday();f.birthDate(i.getDate()),f.birthMonth(i.getMonth()+1)}f.client().upcoming.load(),f.client().history.load(),o.notify("pageTitle",f.client().name())}}else window.location.hash="#/clients0"})),t.action)if("detail"==t.action)s.check(),f.tpl("clients-detail-tpl");else if("form"==t.action){var a=s.getTutorial("clientNote");a.hideActualStep(),f.tpl("clients-form-tpl")}n.loading(!1),e("#frm-client-name").focus()},f}}),r("reservio/pages/promoteOverview",["jquery","ko","reservio/utils","postbox","reservio/models","reservio/lang","reservio/data","reservio/modules/tutorial","reservio/analytics"],function(e,t,n,i,o,r,a,s,l){return function(o,c){i.notify("pageTitle",r.get("menu-promote"));var u={};u.tpl=t.observable("promote-overview-tpl");var d=function(){var i=this,o=function(e,t,n,i,o){this.id=e,this.text=t||"",this.color=n||"",this.bgColor=i||"",this.cls=o||""},s=function(){var e=i.buttonStyles[i.buttonStyle()];i.buttonCode("<!-- "+r.get("page-promote-integration-codeComment")+' -->\n<div class="reservio-booking-button'+e.cls+'" data-business-id="'+a.account().hash()+'" data-text="'+n.encodeHTML(i.buttonText())+'" data-bgcolor="'+e.bgColor+'" data-color="'+e.color+'"></div>\n<script id="reservio-widgets-script" type="text/javascript" src="https://static.'+_reservio.host+'/js/widget.js">\n</script>')};if(this.buttonStyles=[new o(0,"Red","#fff","#cf0d00"),new o(1,"Blue","#fff","#4b7bbc"),new o(2,"Black","#fff","#434343"),new o(3,"Red","#fff","#cf0d00"," btn-large"),new o(4,"Blue","#fff","#4b7bbc"," btn-large"),new o(5,"Black","#fff","#434343"," btn-large")],this.buttonText=t.observable(r.get("page-promote-integration-defaultButtonText")),this.buttonText.subscribe(s),this.buttonStyle=t.observable(this.buttonStyles[0].id),this.buttonStyle.subscribe(s),this.buttonCode=t.observable(""),this.buttonCodeGenerator=function(e){return'<div class="'+e.cls+'"><div class="btn-book" style="background: '+e.bgColor+";color: "+e.color+";border: 1px solid "+n.shadeColor(e.bgColor,-15)+'"><span></span>'+n.encodeHTML(i.buttonText())+"</div></div>"},this.buttonCodeClicked=function(t,n){e(n.target).select()},this.styleClicked=function(e,t){i.buttonStyle(e.id)},!document.getElementById("reservio-booking-styles")){var l=document.createElement("link");l.id="reservio-booking-styles",l.type="text/css",l.rel="stylesheet",l.href="//static."+_reservio.host+"/css/button.css",l.media="screen",document.getElementsByTagName("head")[0].appendChild(l)}s()},p=function(){var n=this;this.linkText=t.observable(r.get("page-promote-integration-defaultButtonText")),this.linkCode=t.computed(function(){return'<a href="http://'+a.account().identifier()+"."+_reservio.host+'" target="_blank">'+n.linkText()+"</a>"}),this.linkCodeClicked=function(t,n){e(n.target).select()}};return u.getButtonClicked=function(){l.trackEventWithCounter("promote","getButtonClicked"),s.getTutorial("start").showNextStep("integrationOptions"),i.notify("modal.show","promoteGetButton",{template:"modal-getButtonCode-tpl",viewModel:new d,width:650})},u.getTextLinkClicked=function(){l.trackEventWithCounter("promote","getTextLinkClicked"),s.getTutorial("start").showNextStep("integrationOptions"),i.notify("modal.show","promoteGetLink",{template:"modal-getTextLink-tpl",viewModel:new p,width:650})},u.installFbTabClicked=function(){l.trackEventWithCounter("promote","installFacebookTabClicked"),s.getTutorial("start").showNextStep("integrationOptions");var e=window.location.host.split(".").slice(1).join(".");window.open("http://www.facebook.com/dialog/pagetab?display=popup&app_id=867601833383076&next="+encodeURIComponent("http://app."+e+"/facebook/tab/"),"installFacebookTab","width=626,height=250")},u.selectAddress=function(e,t){return n.selectText(t.target),!0},u.openPage=function(){return s.getTutorial("start").showNextStep("bookingLink"),l.trackEventWithCounter("promote","minipageLinkClicked"),!0},u.openPageImage=function(){return l.trackEventWithCounter("promote","minipageImageClicked"),!0},u.fbTabTpl=t.computed(function(){return this.id?"promote-fbTab-installed":"promote-fbTab-notInstalled"},a.account().fbPage),u.shareOnFacebook=function(){l.trackEventWithCounter("promote","minipageShareOnFacebookClicked"),window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(a.account().minipageUrl)+"&link="+encodeURIComponent(a.account().minipageUrl)+"&name="+encodeURIComponent(r.get("booking-title")+": "+a.account().name())+"&description="+encodeURIComponent(r.get("page-promote-overview-shareMessage")),"facebookShareDialog","width=626,height=436")},u.shareOnTwitter=function(){l.trackEventWithCounter("promote","minipageShareOnTwitterClicked"),window.open("http://twitter.com/share?url="+encodeURIComponent(a.account().minipageUrl)+"&text="+encodeURIComponent(r.get("page-promote-overview-site-shareMessage"))+"&via=Reservio","twitterShareDialog","height=450,width=550,toolbar=0,location=0,menubar=0,directories=0,scrollbars=0")},u.shareOnGplus=function(){l.trackEventWithCounter("promote","minipageShareOnGplusClicked"),window.open("https://plus.google.com/share?url="+encodeURIComponent(a.account().minipageUrl),"gplusShareDialog","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},o.afterRender=function(e){i.notify("viewLoaded"),o.loading(!1);var t=s.getTutorial("start");t.showNextStep("goToPromote")},u}}),r("reservio/pages/synchronization",["jquery","ko","reservio/utils","postbox","reservio/ajax","reservio/data","reservio/lang"],function(e,t,n,i,o,r,a){return function(n,s){i.notify("pageTitle","Synchronization");var l={};l.tpl=t.observable("synchronization-tpl"),l.list=t.observableArray();var c=!1,u=function(n){n=n||function(){},o.get("/sync/list/",{},function(i){i.data=e.each(i.data,function(){this.loading=t.observable(!1),this.icalEnabled=t.observable(this.icalEnabled),this.authUrl=t.observable(this.authUrl)}),l.list(i.data),c=!0,n(i.data)})},d=function(e){return t.utils.arrayFirst(l.list(),function(t){return t.id==e})},p=function(n){var s=d(n),l={resource:s,loading:t.observable(!0),calendars:t.observableArray(),selectedCalendar:t.observable(),saveCalendar:function(){s.loading(!0),s.authUrl("temp"),i.publish("showInformation",{text:a.get("page-synchronization-synchronizing"),timeout:864e5}),i.notify("modal.hide","selectCalendarModal"),e.get("/sync/authorize/?action=connectCalendar&resource_id="+n+"&google_calendar_id="+this.selectedCalendar()+"&sync=1").success(function(){i.publish("hideInformation"),s.loading(!1),r.resources.load()}),setTimeout(function(){u(function(){s=d(n),s.loading(!0)})},1e3)}};o.get("/sync/list-google-calendars/"+n+"/",{},function(t){l.calendars(t.data.calendars),l.selectedCalendar.setOptions(t.data.calendars,"id"),e.each(t.data.calendars,function(){this.primary&&l.selectedCalendar(this.id)}),l.loading(!1),i.notify("modal.show","selectCalendarModal",{template:"modal-select-google-calendar-tpl",viewModel:l,afterShow:function(){},afterHide:function(){window.location.hash="#/synchronization"}})})},f=function(){var e="free"!=r.account().plan.code;return e||s.acl.showUpgradeModal(a.get("modal-upgrade-synchronization-title"),a.get("modal-upgrade-synchronization-text"),"synchronization.png","synchronization")(),e};return l.refreshPage=function(t,n){if(f()){var i=e(n.target).attr("href");t.loading(!0),e.get(i).success(function(){}),setTimeout(function(){t.loading(!1),u(),r.resources.load()},1e3)}},l.authClicked=function(e,t){return!!f()||void t.preventDefault()},l.toggleIcal=function(e,t){f()&&(e.id?(e.loading(!0),e.icalEnabled(!e.icalEnabled()),o.post("/resources/update/",{data:{id:e.id,syncEnabled:e.icalEnabled()?0:1}},function(){e.icalEnabled(!e.icalEnabled()),e.loading(!1)})):(e.loading(!0),e.icalEnabled(!e.icalEnabled()),o.post("/account/update/",{informations:{syncEnabled:e.icalEnabled()?0:1}},function(){e.icalEnabled(!e.icalEnabled()),e.loading(!1)})))},l.icalClicked=function(t,n){t.icalEnabled()?e(n.target).select():(n.preventDefault(),e("html").focus())},n.afterRender=function(e){s.log("page-synchronization"),i.notify("viewLoaded")},n.hashParamsChanged=function(e){n.loading(!1),c?void 0!==e.id&&p(e.id):u(function(){void 0!==e.id&&p(e.id)})},l}}),"undefined"==typeof console&&(console={},console.log=function(){}),Function("/*@cc_on return document.documentMode===10@*/")()&&document.createStyleSheet("https://static.reservio.com/css/framework-ie.css"),o.config({baseUrl:"//static."+_reservio.host+"/desktop/js/",paths:{jquery:"libs/jquery-1.12.4","jquery-ui":"libs/jquery-ui-1.10.0.custom",knockout:"libs/knockout-2.2.1",ko:"libs/knockout-custom",postbox:"libs/knockout-postbox",path:"libs/path",facebook:"//connect.facebook.net/en_US/all",twitter:"//platform.twitter.com/widgets","libs/fileUpload":"libs/SimpleAjaxUploader.min","libs/cropImage":"libs/jquery.jWindowCrop",moment:"libs/moment.min",placeholder:"libs/jquery.simplePlaceholder"},shim:{"jquery-ui":{deps:["jquery"]},postbox:{deps:["knockout"]},"libs/scrollbar":{deps:["jquery"]},"libs/selectBox":{deps:["jquery","libs/scrollbar"]},"libs/buttons":{deps:["jquery"]},"libs/fileUpload":{deps:["jquery"]},"libs/cropImage":{deps:["jquery"]},placeholder:{deps:["jquery"]},facebook:{"export":"FB"}},urlArgs:"v="+_reservio.version}),o(["reservio/app","jquery","jquery-ui","ko","knockout","postbox","path","libs/buttons","libs/datePicker","libs/fullcalendar","libs/scrollbar","libs/modal","libs/popover","libs/selectBox","reservio/ajax","reservio/data","reservio/lang","reservio/models","reservio/utils","reservio/modules/informationBar","reservio/modules/notificationsChecker","reservio/modules/popover-new","reservio/modules/tutorial","reservio/modules/modal","reservio/modules/roster","reservio/pages/businessCoupons","reservio/pages/businessCouponsForm","reservio/pages/businessDashboard","reservio/pages/businessDetails","reservio/pages/businessHolidays","reservio/pages/businessHolidaysForm","reservio/pages/businessOrders","reservio/pages/businessResources","reservio/pages/businessResourcesForm","reservio/pages/businessRoster","reservio/pages/businessServices","reservio/pages/businessServicesForm","reservio/pages/businessSettings","reservio/pages/businessStatistics","reservio/pages/calendar","reservio/pages/clients","reservio/pages/clientsDetail","reservio/pages/promoteOverview","reservio/pages/synchronization"],function(e,t){t("html").hasClass("oldie")&&(window.location.hash="#",window.location.href="//app.reservio.com/browser-not-supported/"),e.init()}),r("main",function(){})}();